{"meta":{"version":1,"warehouse":"4.0.2"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":0,"renderable":0},{"_id":"source/README.md","path":"README.md","modified":0,"renderable":0},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":0,"renderable":1},{"_id":"themes/next/source/css/noscript.styl","path":"css/noscript.styl","modified":0,"renderable":1},{"_id":"themes/next/source/images/alipay.jpg","path":"images/alipay.jpg","modified":0,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/avatar3.jpg","path":"images/avatar3.jpg","modified":0,"renderable":1},{"_id":"themes/next/source/images/avatar4.png","path":"images/avatar4.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/cucumber_16.ico","path":"images/cucumber_16.ico","modified":0,"renderable":1},{"_id":"themes/next/source/images/background.png","path":"images/background.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/cucumber_32.ico","path":"images/cucumber_32.ico","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/avatar1.gif","path":"images/avatar1.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/logo-algolia-nebula-blue-full.svg","path":"images/logo-algolia-nebula-blue-full.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/panda_favicon16.ico","path":"images/panda_favicon16.ico","modified":0,"renderable":1},{"_id":"themes/next/source/images/panda_favicon32.ico","path":"images/panda_favicon32.ico","modified":0,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/wechatpay.jpg","path":"images/wechatpay.jpg","modified":0,"renderable":1},{"_id":"themes/next/source/js/bookmark.js","path":"js/bookmark.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/comments-buttons.js","path":"js/comments-buttons.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/config.js","path":"js/config.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/motion.js","path":"js/motion.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/comments.js","path":"js/comments.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/next-boot.js","path":"js/next-boot.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/schedule.js","path":"js/schedule.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/utils.js","path":"js/utils.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/pjax.js","path":"js/pjax.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/addtoany.js","path":"js/third-party/addtoany.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/schemes/muse.js","path":"js/schemes/muse.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/fancybox.js","path":"js/third-party/fancybox.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/pace.js","path":"js/third-party/pace.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/quicklink.js","path":"js/third-party/quicklink.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/analytics/google-analytics.js","path":"js/third-party/analytics/google-analytics.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/analytics/growingio.js","path":"js/third-party/analytics/growingio.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/chat/chatra.js","path":"js/third-party/chat/chatra.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/chat/gitter.js","path":"js/third-party/chat/gitter.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/analytics/matomo.js","path":"js/third-party/analytics/matomo.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/chat/tidio.js","path":"js/third-party/chat/tidio.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/disqusjs.js","path":"js/third-party/comments/disqusjs.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/changyan.js","path":"js/third-party/comments/changyan.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/gitalk.js","path":"js/third-party/comments/gitalk.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/analytics/baidu-analytics.js","path":"js/third-party/analytics/baidu-analytics.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/livere.js","path":"js/third-party/comments/livere.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/isso.js","path":"js/third-party/comments/isso.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/disqus.js","path":"js/third-party/comments/disqus.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/math/mathjax.js","path":"js/third-party/math/mathjax.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/math/katex.js","path":"js/third-party/math/katex.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/utterances.js","path":"js/third-party/comments/utterances.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/search/local-search.js","path":"js/third-party/search/local-search.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/search/algolia-search.js","path":"js/third-party/search/algolia-search.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/statistics/firestore.js","path":"js/third-party/statistics/firestore.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/tags/pdf.js","path":"js/third-party/tags/pdf.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/tags/mermaid.js","path":"js/third-party/tags/mermaid.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/third-party/statistics/lean-analytics.js","path":"js/third-party/statistics/lean-analytics.js","modified":0,"renderable":1}],"Cache":[{"_id":"source/CNAME","hash":"962cd85e6b23e528cce54095c427eaa945ce2341","modified":1684307912000},{"_id":"source/404.html","hash":"5a3a44928f2b58c94c83f6a6c6d9692494731e8b","modified":1684317646000},{"_id":"source/README.md","hash":"2fa78d31021449cf7aa47b22edc109a4bbbe3c07","modified":1684391438000},{"_id":"source/_data/styles.styl","hash":"7e1740e72bd79ba8d757afd04c3244c89ac6fc6d","modified":1684561582000},{"_id":"source/about/index.md","hash":"9884d3d384cecfd8a0bbc47c41a0e31059522096","modified":1702948460000},{"_id":"source/_posts/Deg-volcano.md","hash":"7964e3deef5121cdef34001a3ddf4c71f91b02e9","modified":1684750944000},{"_id":"source/_posts/Passway-dotplot.md","hash":"ff2c84b5e1bcac4727ad42e6158a3fe60369d263","modified":1684750936000},{"_id":"source/.MWebMetaData/setting.json","hash":"bdceda6a661945449ae3491a39910b9fa112c406","modified":1734252035672},{"_id":"source/_posts/code-server安装教程.md","hash":"df0e73f14927f8012675d9b0cc376c913fd491e6","modified":1684488884000},{"_id":"source/_posts/Passway-Enrich.md","hash":"fe03ba67d46a3b342fe89855585bcd8398cd31f9","modified":1684750938000},{"_id":"source/_posts/jupyter安装教程.md","hash":"ea404efab08561c3a518b2f711b29082fe522222","modified":1684488880000},{"_id":"source/_posts/tmux安装教程.md","hash":"8b55deea4767b457e41834d6ad71ffaecc58a823","modified":1684488876000},{"_id":"source/_posts/Tfh总结.md","hash":"25f1960ed8c43c24c4b6d2bcc93d84b5fc338193","modified":1684751160000},{"_id":"source/_posts/免疫基础知识.md","hash":"fd1a44a1c5181caadce2d2672192599d67a9283b","modified":1684564276000},{"_id":"source/_posts/ATAC分析流程.md","hash":"476e0de6267b695bdcc506265d48236ae1e957cc","modified":1684488890000},{"_id":"source/_posts/有意思的图片.md","hash":"d922e492b8eba0069382c1da843ff9a2732abfc9","modified":1702893022000},{"_id":"source/_posts/生信常用文件格式.md","hash":"875b320d0183acd2b67087ffb7c6dc3412338853","modified":1690858852000},{"_id":"source/_posts/如何通俗地理解Family-wise error rate(FWER)和False discovery rate(FDR).md","hash":"bfa077656e5d82e15d5457779e5b24c9697b7e42","modified":1701772706000},{"_id":"source/_posts/记忆Tfh.md","hash":"63539ccda4cdd6489dc4fa4eb1cadc70126130a5","modified":1684751138000},{"_id":"source/archives/index.md","hash":"582981648e4f0ffee528939082333c05c32f2982","modified":1684316208000},{"_id":"source/_posts/简书笔记汇总.md","hash":"a20310690ebf0459307d9a270cea3b2023913109","modified":1684404378000},{"_id":"source/home/index.md","hash":"ec1e6138f6373e146a16ed81cbe498cff45e131d","modified":1684334124000},{"_id":"source/tags/index.md","hash":"e25c277ad91228b4245ddb40151e24c13c5dead0","modified":1684327556000},{"_id":"source/categories/index.md","hash":"de729059f454752d0573143220a8ed2ac61b7db3","modified":1684327534000},{"_id":"themes/next/.editorconfig","hash":"731c650ddad6eb0fc7c3d4a91cad1698fe7ad311","modified":1684304972000},{"_id":"themes/next/.eslintrc.json","hash":"611e15c3fcb41dc68fa8532ee595a1262a1b5a8a","modified":1684304972000},{"_id":"themes/next/.gitattributes","hash":"aeeca2f1e987d83232d7870d1435a4e3ed66b648","modified":1684304972000},{"_id":"themes/next/_vendors.yml","hash":"728a7a21c2ad80882405615cc0aeb93717d91ce1","modified":1684304972000},{"_id":"themes/next/LICENSE.md","hash":"8cfb03967dd4cbaf3b825271ffce0039aa3fc22a","modified":1684304972000},{"_id":"themes/next/package.json","hash":"8ccdf4e4d4e8ab50d4ae2d2e8876722d323210d9","modified":1684304972000},{"_id":"themes/next/README.md","hash":"fe1761cb3eab07a1742296c5976c30f2346073b7","modified":1684304972000},{"_id":"themes/next/.stylelintrc","hash":"c6b473cc7337d35b278cd9d85855c60ee2fead3e","modified":1684304972000},{"_id":"themes/next/crowdin.yml","hash":"4a53f5985e545c635cb56b2a57ed290cb8cf8942","modified":1684304972000},{"_id":"themes/next/.gitignore","hash":"087b7677078303acb2acb47432165950e4d29b43","modified":1684304972000},{"_id":"themes/next/.githooks/install.js","hash":"72757c6827909a5f2c217ddbbdf6034ca6fab74a","modified":1684304972000},{"_id":"themes/next/renovate.json","hash":"767b077c7b615e20af3cf865813cd64674a9bea6","modified":1684304972000},{"_id":"themes/next/.githooks/pre-commit","hash":"b69b9d0b51e27d5d4c87c3242f5067c2cda26e44","modified":1684304972000},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"2fdca1040427cabfe27cae6754ec5e027ec7092e","modified":1684304972000},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"009b397b686bba7b63885da59d904144ff59b24e","modified":1684304972000},{"_id":"themes/next/.github/issue_label_bot.yaml","hash":"533fbe6b2f87d7e7ec6949063bb7ea7eb4fbe52d","modified":1684304972000},{"_id":"themes/next/_config.yml","hash":"19732b0b2f510945d2609712f375b9a80f30f03b","modified":1684305230000},{"_id":"themes/next/.github/config.yml","hash":"0956bf71b6f36632b63b14d26580458041a5abd2","modified":1684304972000},{"_id":"themes/next/.github/release.yml","hash":"83b4dae3f8d76619e208d2110a247b3ccadd64d8","modified":1684304972000},{"_id":"themes/next/.github/CODE_OF_CONDUCT.md","hash":"593ae64e72d43c020a697eac65b1f9c3483ff097","modified":1684304972000},{"_id":"themes/next/.github/label-commenter-config.yml","hash":"a1aa85a2fc66ff0c52c65bd97b0fa282e297a73f","modified":1684304972000},{"_id":"themes/next/.github/labeler.yml","hash":"ff76a903609932a867082b8ccced906e9910533a","modified":1684304972000},{"_id":"themes/next/docs/LICENSE.txt","hash":"d1cd5a8e83d3bbdb50f902d2b487813da95ddfd3","modified":1684304972000},{"_id":"themes/next/docs/AUTHORS.md","hash":"579014d47f45b27fd1618b9709f0efe9585c7449","modified":1684304972000},{"_id":"themes/next/docs/AGPL3.md","hash":"f463f95b169d64983f59fa6f3e4b6760290a0e6b","modified":1684304972000},{"_id":"themes/next/languages/bn.yml","hash":"f63980b95710fe19b19e6fbc09c7cb93b8f065ed","modified":1684304972000},{"_id":"themes/next/languages/default.yml","hash":"ea5e6aee4cb14510793ac4593a3bddffe23e530c","modified":1684304972000},{"_id":"themes/next/languages/ar.yml","hash":"c77fc13e0431e71eeb0f767a0a436284fc81df90","modified":1684304972000},{"_id":"themes/next/languages/en.yml","hash":"5ca2c0b3c95dd87485f2d2b3477f88810ad1a63b","modified":1684304972000},{"_id":"themes/next/languages/README.md","hash":"b1c96465b3bc139bf5ba6200974b66581d8ff85a","modified":1684304972000},{"_id":"themes/next/languages/es.yml","hash":"31c2a47d14cd5b804cae0c0b44d43bece069d3aa","modified":1684304972000},{"_id":"themes/next/languages/fa.yml","hash":"cc6ef3144b954daa29ce7d42f08191eafe052fab","modified":1684304972000},{"_id":"themes/next/languages/fr.yml","hash":"2ff880efe524ae557f27da89003da3c08edef3bd","modified":1684304972000},{"_id":"themes/next/languages/de.yml","hash":"5101612f7cac38884206d28319532f1aab32fbe6","modified":1684304972000},{"_id":"themes/next/languages/id.yml","hash":"bd2c30def05a37c66653900ca07952d52a142961","modified":1684304972000},{"_id":"themes/next/languages/it.yml","hash":"4969c4f17d88003135218de72ddf0bf8d894dc07","modified":1684304972000},{"_id":"themes/next/languages/ko.yml","hash":"04927e331652ee13f9c8a110fe12d7f936a6b0e6","modified":1684304972000},{"_id":"themes/next/languages/nl.yml","hash":"4575f93c4ee4383bdfaca01ad6ffff5664cbbbae","modified":1684304972000},{"_id":"themes/next/languages/ja.yml","hash":"e660ec12b9eade103492aba7aa9b23ef06d353a9","modified":1684304972000},{"_id":"themes/next/languages/pt-BR.yml","hash":"ff9aa6a6549d07b7dc667094f34a06945e2c21b4","modified":1684304972000},{"_id":"themes/next/languages/pt.yml","hash":"1fa9f4f4f208191afd0e6108ce89d91c657a6bd0","modified":1684304972000},{"_id":"themes/next/languages/ru.yml","hash":"d726265bc5cf8bd4fb64f85b2d07b3326439bb00","modified":1684304972000},{"_id":"themes/next/languages/th.yml","hash":"dc434da945d52dc7a8d26acc80b23e6922712f89","modified":1684304972000},{"_id":"themes/next/languages/tk.yml","hash":"7b9115e0520dc81a95a7c8e4f56a01fc84f74017","modified":1684304972000},{"_id":"themes/next/languages/si.yml","hash":"07f98d6ca99bceef35254c60fc0e4401ff608557","modified":1684304972000},{"_id":"themes/next/languages/tr.yml","hash":"822ec400a0a2bb2245abf31e9ed4f3af77b2814e","modified":1684304972000},{"_id":"themes/next/languages/uk.yml","hash":"10a2f2e7183410d1d10fa937e3e0198b46bf4930","modified":1684304972000},{"_id":"themes/next/languages/zh-CN.yml","hash":"c06c95121b3e5bd5abe01848073fbe7f9d6dcda9","modified":1684304972000},{"_id":"themes/next/languages/zh-HK.yml","hash":"6cfdc633870b814f3d75438e86f6ee5dba068987","modified":1684304972000},{"_id":"themes/next/languages/vi.yml","hash":"8344cb90ee92a21a398faff3317c025a43446db5","modified":1684304972000},{"_id":"themes/next/layout/_layout.njk","hash":"c3cf484dab0bdae376c0685952dafb0522688309","modified":1701771766000},{"_id":"themes/next/languages/zh-TW.yml","hash":"198e3745b99ba5a2b75cc24d03f3412e272b7fa1","modified":1684304972000},{"_id":"themes/next/layout/category.njk","hash":"82f541452cae76a94ee15cb8d8a888f44260a0fd","modified":1684304972000},{"_id":"themes/next/layout/archive.njk","hash":"aa491dba8f746e626c273a920effedf7d0b32170","modified":1684304972000},{"_id":"themes/next/layout/index.njk","hash":"fa52c3049871e879980cb6abccdea3792ca4ce70","modified":1684304972000},{"_id":"themes/next/layout/tag-color.njk","hash":"f5cb4c4ac9343a0e2a663247ce141586a5fce02c","modified":1684502964000},{"_id":"themes/next/layout/post.njk","hash":"6767de9702a07a2a4e16a8a6bc9c5919536c1e3f","modified":1684304972000},{"_id":"themes/next/layout/tag.njk","hash":"b6c017d30d08ddd30d66e9c6f3a71aa65d214eac","modified":1684304972000},{"_id":"themes/next/.github/ISSUE_TEMPLATE/bug-report.yml","hash":"3f19cbf0c2b2fee6bf3788870b842c9ccc1425ca","modified":1684304972000},{"_id":"themes/next/.github/workflows/codeql.yml","hash":"1e4e4a7ea522b76d6fc5947ddd07260f9fecbcf4","modified":1684304972000},{"_id":"themes/next/.github/ISSUE_TEMPLATE/other.yml","hash":"10eca518b91a19984f6a5a912d41222042f61d63","modified":1684304972000},{"_id":"themes/next/.github/ISSUE_TEMPLATE/feature-request.yml","hash":"fbc3062cd4591c8329fab9db72803746f0d11920","modified":1684304972000},{"_id":"themes/next/.github/ISSUE_TEMPLATE/config.yml","hash":"daeedc5da2ee74ac31cf71846b766ca6499e9fc6","modified":1684304972000},{"_id":"themes/next/test/index.js","hash":"983a505399796b9d9e174ba46d89abbdde38f8ee","modified":1684304972000},{"_id":"themes/next/.github/workflows/labeler.yml","hash":"bfea9b04e3ea7da31a2095277c4c23ae6bd14baa","modified":1684304972000},{"_id":"themes/next/.github/workflows/label-commenter.yml","hash":"b87ffaf40820461159c891d0d41c87e00e312ff3","modified":1684304972000},{"_id":"themes/next/.github/workflows/lock.yml","hash":"ea346568ab811fea4dacc69081af2d6177b5aafb","modified":1684304972000},{"_id":"themes/next/docs/zh-CN/CODE_OF_CONDUCT.md","hash":"7befb4325b107dd668d9eae3d7e86a34910ce3f2","modified":1684304972000},{"_id":"themes/next/docs/ru/README.md","hash":"caf25da442d08b3d0a4e4503c6f4d6b68b1ac2f2","modified":1684304972000},{"_id":"themes/next/docs/zh-CN/README.md","hash":"5500b0c6db58bf2e93e8ace98ae8da65de7e8318","modified":1684304972000},{"_id":"themes/next/docs/zh-CN/CONTRIBUTING.md","hash":"a09ceb82b45dd8b7da76c227f3d0bb7eebe7d5d1","modified":1684304972000},{"_id":"themes/next/.github/workflows/tester.yml","hash":"dda18899fe62652c633f60c300a93df18f58862f","modified":1684304972000},{"_id":"themes/next/layout/_partials/languages.njk","hash":"537026fc120adeef9148c98ebf074207e3810538","modified":1684304972000},{"_id":"themes/next/.github/workflows/pr-reminder.yml","hash":"7d9f270dda6b28688b68118d9001ceaa4991d965","modified":1684304972000},{"_id":"themes/next/.github/workflows/linter.yml","hash":"74ecdd99cc20a8f5103579210353de33536aa45c","modified":1684304972000},{"_id":"themes/next/layout/_partials/pagination.njk","hash":"c55167bc0dbe7e104d4f4d782e98fcabc7e07a35","modified":1684304972000},{"_id":"themes/next/layout/_partials/comments.njk","hash":"60f4620dd479da6d86d1d493440e9e2a28b6e132","modified":1684304972000},{"_id":"themes/next/layout/_macro/sidebar.njk","hash":"b9fc0a6b02f0380de939d1ea2a7c7d2e6be9f462","modified":1684304972000},{"_id":"themes/next/layout/_macro/post-collapse.njk","hash":"d9d8e6d7a6a8c80009dd5334cc17fd3e4977a008","modified":1684304972000},{"_id":"themes/next/layout/_partials/footer.njk","hash":"3b98d3681df49b0ce61669f02ba1445d603aec59","modified":1684315638000},{"_id":"themes/next/layout/_partials/widgets.njk","hash":"9471c4f3aeee101b9b9a8c2aae7d21ec7277574e","modified":1684304972000},{"_id":"themes/next/layout/_macro/post.njk","hash":"8b83c1a3c16fe3d0c4a9018684bb3c6aa04c5b8d","modified":1684504294000},{"_id":"themes/next/layout/_third-party/quicklink.njk","hash":"73bc15a9c3c5c239ab90efa19a1e721f41f3cb93","modified":1684304972000},{"_id":"themes/next/scripts/events/index.js","hash":"8ae618d4436dab49928c2bebc0837e5310dbe7de","modified":1684304972000},{"_id":"themes/next/layout/_third-party/pace.njk","hash":"13b2a77b4858a127f458ea092b6f713b052befac","modified":1684304972000},{"_id":"themes/next/layout/_third-party/fancybox.njk","hash":"53ad3c31762b74e5d29787b37d5e494cc4fded9b","modified":1684304972000},{"_id":"themes/next/layout/_third-party/index.njk","hash":"4eac9d0b3b78ab5b8aed4656db1cae2bf070885b","modified":1684304972000},{"_id":"themes/next/layout/_scripts/index.njk","hash":"4eb65641b47ea9b23ed2ddfd69b18f21d7d8f214","modified":1684304972000},{"_id":"themes/next/scripts/helpers/engine.js","hash":"43568a872a93259fc1c497724a53914474ef83ae","modified":1684304972000},{"_id":"themes/next/scripts/helpers/next-config.js","hash":"ad764d48715c5da87d33f048ad5f1ae8b4e2eb52","modified":1684304972000},{"_id":"themes/next/scripts/helpers/font.js","hash":"0a6fa582a0890ecaf5f03f758a730936e48aeca1","modified":1684304972000},{"_id":"themes/next/scripts/helpers/next-paginator.js","hash":"2e8dcc12a52517bb4e00ea611720bcd298624112","modified":1684304972000},{"_id":"themes/next/scripts/helpers/next-url.js","hash":"483d75522e76c7e67c7e0dfd5cac8ab04784a04c","modified":1684304972000},{"_id":"themes/next/scripts/helpers/navigation.js","hash":"82f6e81bacf23d10cac71b09cff8708e47891ef3","modified":1684304972000},{"_id":"themes/next/scripts/filters/default-injects.js","hash":"0c9a1fe9906672724dbf274154a37bac1915ca2c","modified":1684304972000},{"_id":"themes/next/scripts/filters/minify.js","hash":"997fc7153a7055bdf278e93d16a17c2d0bd62b8f","modified":1684304972000},{"_id":"themes/next/scripts/helpers/next-vendors.js","hash":"52acbc74c1ead8a77cd3bbcba4e033053683f7d0","modified":1684304972000},{"_id":"themes/next/scripts/filters/post.js","hash":"e6cf4c94fc2291215a3345134ddbbc74d5091b00","modified":1684304972000},{"_id":"themes/next/scripts/tags/button.js","hash":"86c71c73a63744efbbbb367612871fede0d69529","modified":1684304972000},{"_id":"themes/next/layout/_third-party/addtoany.njk","hash":"9ef81adb0c35ebdb4499602155e87611aee0762a","modified":1684304972000},{"_id":"themes/next/scripts/tags/caniuse.js","hash":"8e912c715702addaf0cefe63e580e45b97ae8c3f","modified":1684304972000},{"_id":"themes/next/layout/_scripts/vendors.njk","hash":"0a1470440f11362df2b1cd6b6228e273d9f999d6","modified":1684304972000},{"_id":"themes/next/scripts/filters/locals.js","hash":"87f3bff03fa9fd96cf0787a6442464a7ff57f76b","modified":1684304972000},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"b4d12e6fe29089be0f43bafc9eea736602cd16bf","modified":1684304972000},{"_id":"themes/next/scripts/tags/index.js","hash":"255dd1090e8319b557eeca43571f0e4f8aab013b","modified":1684304972000},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"1c609312a71d47f838226346aad5c2e1c35f15dd","modified":1684304972000},{"_id":"themes/next/scripts/tags/label.js","hash":"c18b0e619a779ed40be7f014db92af18f45fbd5c","modified":1684304972000},{"_id":"themes/next/scripts/tags/note.js","hash":"a12fd53e421400836a3722ae69130969558d6ac0","modified":1684304972000},{"_id":"themes/next/scripts/tags/link-grid.js","hash":"3f358bb78c5c6fdf45de287f3ead553e3a6a93c2","modified":1684304972000},{"_id":"themes/next/layout/page.njk","hash":"6bdb205508590c70f172f30fc711d2d853f2efed","modified":1684504288000},{"_id":"themes/next/scripts/tags/pdf.js","hash":"317ba4611020cc840854386dde098dbbe452777e","modified":1684304972000},{"_id":"themes/next/scripts/tags/video.js","hash":"f6ad3f52779f0636251238d3cbdc5b6f91cc5aba","modified":1684304972000},{"_id":"themes/next/scripts/tags/tabs.js","hash":"e0ed5fe1bc9d2957952a1aacdf3252d6ef3f9743","modified":1684304972000},{"_id":"themes/next/scripts/tags/mermaid.js","hash":"b3844e168b51a99d495ca05562ffac47677f5728","modified":1684304972000},{"_id":"themes/next/test/helpers/font.js","hash":"6f5076bd3f2724e47b46ca69028393a9b6275cd1","modified":1684304972000},{"_id":"themes/next/test/tags/center-quote.js","hash":"2ac4b5a358681691a17e736de06fce0b640a7023","modified":1684304972000},{"_id":"themes/next/test/helpers/next-url.js","hash":"08e84781f1cd54e5634b86877ad9cefae4a78e95","modified":1684304972000},{"_id":"themes/next/test/tags/index.js","hash":"5cad001936a694bf32d59751cc2b68a66199f976","modified":1684304972000},{"_id":"themes/next/test/tags/group-pictures.js","hash":"8f66d3c6f03fb11d85aa2ab05c9b3c9aa2b4e994","modified":1684304972000},{"_id":"themes/next/test/tags/label.js","hash":"6cad7d84c42511459a89cda3971e8ea5cdee0125","modified":1684304972000},{"_id":"themes/next/test/tags/caniuse.js","hash":"2852be850d9103c25114253a45e6c62e32517de4","modified":1684304972000},{"_id":"themes/next/test/tags/note.js","hash":"161a81ce749e239d2403681372d48ecc1b51d7b9","modified":1684304972000},{"_id":"themes/next/test/tags/link-grid.js","hash":"41730266306c02362258384cd73659223928361f","modified":1684304972000},{"_id":"themes/next/test/tags/button.js","hash":"a50ca44eaec3d91c2958e3157d624cd3e68828c7","modified":1684304972000},{"_id":"themes/next/test/helpers/index.js","hash":"2fb58dca3df2fe53116ee2b1232fa26ebe7b2ce5","modified":1684304972000},{"_id":"themes/next/test/tags/pdf.js","hash":"2d114596a8a180b2f3cd2a9c6528a328961f12d4","modified":1684304972000},{"_id":"themes/next/source/css/_colors.styl","hash":"a88430865c99f47ce1d8240f8895819b8b7b0c06","modified":1684304972000},{"_id":"themes/next/source/css/main.styl","hash":"c326550ce8b4deaa9b647bcfe3cdc04c100644e6","modified":1684304972000},{"_id":"themes/next/test/tags/mermaid.js","hash":"f718a3d0e303d842e2ca5a3b162539a49e45a520","modified":1684304972000},{"_id":"themes/next/test/tags/video.js","hash":"88db9a3a26cd35525c43c0339fcd1c5965ec9518","modified":1684304972000},{"_id":"themes/next/test/validate/index.js","hash":"560862194991c5963da5a411629d8e6c71d20ee2","modified":1684304972000},{"_id":"themes/next/test/tags/tabs.js","hash":"b19d2592347eae5d6a7a97ca7e8cec03e8f25b51","modified":1684304972000},{"_id":"themes/next/source/css/noscript.styl","hash":"64b378a4d2f0b36bf666fba13b57c59da3a8ac83","modified":1684304972000},{"_id":"themes/next/source/images/avatar.gif","hash":"2dbc3e2f2d624b2ca1afe6edc2ca17307f1950c8","modified":1684304972000},{"_id":"themes/next/source/images/cucumber_16.ico","hash":"cbf56acf43fe8ba235d948b52adcd44e6a9626f9","modified":1684806972000},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1684304972000},{"_id":"themes/next/source/css/_mixins.styl","hash":"eacfdd1795ccc0138e194fbf9381d3a64b5ba130","modified":1684304972000},{"_id":"themes/next/source/images/cucumber_32.ico","hash":"fa2de9040c64487e7f5bf95877ca3ca51a9515a7","modified":1684806766000},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1684304972000},{"_id":"themes/next/source/images/logo-algolia-nebula-blue-full.svg","hash":"b85e274207b1392782476a0430feac98db1e7da0","modified":1684304972000},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1684304972000},{"_id":"themes/next/source/images/logo.svg","hash":"099e11ab995a2c8981427a85476d082609848c77","modified":1684304972000},{"_id":"themes/next/source/images/panda_favicon32.ico","hash":"d3c3915b7121a1268a5f2f233428614db6837827","modified":1684328212000},{"_id":"themes/next/source/images/panda_favicon16.ico","hash":"b56eca7553f45be5954367787dd277073d54eb7d","modified":1684328256000},{"_id":"themes/next/source/js/motion.js","hash":"d4c01d5317d45444e91a52236b751c9e9ab1bc16","modified":1684304972000},{"_id":"themes/next/source/js/comments.js","hash":"0b4daf0ce610760bd52e95d423f61f3e1c72442a","modified":1684304972000},{"_id":"themes/next/source/js/config.js","hash":"211a9ab35205ccfa6b7c74394bade84da0d00af7","modified":1684304972000},{"_id":"themes/next/source/js/next-boot.js","hash":"da11083557070d947da48d29d2d60988c8d628e9","modified":1684304972000},{"_id":"themes/next/source/js/bookmark.js","hash":"1457291a7244b7786ec35b949d97183e4fbd181d","modified":1684304972000},{"_id":"themes/next/source/js/comments-buttons.js","hash":"81ea6cbcdf0357094753d7523919c1eafa38e79f","modified":1684304972000},{"_id":"themes/next/source/js/utils.js","hash":"6b8152558a7c3b1ab6649cf3dfa897c7ada97138","modified":1684304972000},{"_id":"themes/next/source/js/schedule.js","hash":"4858233224756e3cadfabd8135f7c4b1e3673b44","modified":1684304972000},{"_id":"themes/next/layout/_partials/head/head-unique.njk","hash":"fd75652957c1c3668874fdfd16f4f56027be0d8b","modified":1684304972000},{"_id":"themes/next/source/js/pjax.js","hash":"c999bfc7cad747e3da0fe3d75c31dd933bf63016","modified":1684304972000},{"_id":"themes/next/layout/_partials/head/head.njk","hash":"e016c3f80db433f17781caf26e44f2089a71550a","modified":1684304972000},{"_id":"themes/next/layout/_partials/page/categories.njk","hash":"b352346dd2cb42f7eeaec5e39d9a2a353b029775","modified":1684304972000},{"_id":"themes/next/layout/_partials/page/breadcrumb.njk","hash":"1fe44a1e156cd30e3e9fd8313e1011ad30970f83","modified":1684304972000},{"_id":"themes/next/layout/_partials/header/index.njk","hash":"1b2ae17f3c394ce310fe2d9ed5f4d07d8cc74ae7","modified":1684304972000},{"_id":"themes/next/layout/_partials/page/schedule.njk","hash":"6ec9c97e91c793cc2eb5ac0f7c3c36fdaaf637d1","modified":1684304972000},{"_id":"themes/next/layout/_partials/page/page-header.njk","hash":"92553feb26f30f7fc9147bc4ef122908a9da06be","modified":1684304972000},{"_id":"themes/next/layout/_partials/header/menu-item.njk","hash":"62513f08e9e7f4abeaeedca91fd0af0861a2540f","modified":1684304972000},{"_id":"themes/next/layout/_partials/header/sub-menu.njk","hash":"20cb9c39bcdcfa3f710df7bc5838d6e62d4dd674","modified":1684304972000},{"_id":"themes/next/layout/_partials/header/brand.njk","hash":"7bf2b6ab499775355bbf8f3ae597ff7bc00e89e4","modified":1684304972000},{"_id":"themes/next/layout/_partials/header/menu.njk","hash":"828700af2a2f273d3e3e0554ffc60706d889d539","modified":1684304972000},{"_id":"themes/next/layout/_partials/page/tags.njk","hash":"752df7d12360a077c51a25609916a3ecc1763bb3","modified":1684304972000},{"_id":"themes/next/layout/_partials/search/algolia-search.njk","hash":"93fbb449fbd599cb4315d7eb0daeb239811b233f","modified":1684304972000},{"_id":"themes/next/layout/_partials/search/localsearch.njk","hash":"f73d25a8ccfdd5d4ca2953dc434ff8ce36034c57","modified":1684304972000},{"_id":"themes/next/layout/_partials/post/post-copyright.njk","hash":"f318d8fe2cf1b97877abb0648a9be85502df0cf1","modified":1684304972000},{"_id":"themes/next/layout/_partials/search/index.njk","hash":"9766852e72c1809d8c1eea71ac6116b4cc0886d2","modified":1684304972000},{"_id":"themes/next/layout/_partials/post/post-followme.njk","hash":"ebe45ab38ace03ea74eed3f676ec1cb5805a3c8a","modified":1684304972000},{"_id":"themes/next/layout/_partials/post/post-related.njk","hash":"9a7eda45ad0753d5f624c51a56e00277ba97c93d","modified":1684304972000},{"_id":"themes/next/layout/_partials/post/post-reward.njk","hash":"fd6fde597ea2fb7b80cffd0a3553c8e73acb8ab2","modified":1684304972000},{"_id":"themes/next/layout/_partials/post/post-share.njk","hash":"e84952ae13fe7285675dffce81748af5fee8aed6","modified":1684304972000},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.njk","hash":"3e80332f88b101141be69f2a07f54ed8c053eabb","modified":1684304972000},{"_id":"themes/next/layout/_partials/post/post-meta.njk","hash":"9a9c4fb7e7c4fe4b7d474bdfdb4ed2b0a5423df2","modified":1684304972000},{"_id":"themes/next/layout/_third-party/analytics/cloudflare.njk","hash":"17173c45f0b740669ef45aaae1fe96eeb0a0ff52","modified":1684304972000},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.njk","hash":"52ad137450f7b3d6a330e16b3ed1c6174290f0eb","modified":1684304972000},{"_id":"themes/next/layout/_partials/sidebar/site-overview.njk","hash":"1b2108f775c7cc34182afa4d39fd95f073c20995","modified":1684490284000},{"_id":"themes/next/layout/_third-party/analytics/growingio.njk","hash":"9ff9ec05c2037beea229a6bb698f9e3546973220","modified":1684304972000},{"_id":"themes/next/layout/_third-party/analytics/index.njk","hash":"81abcf790cf97395cde9e3cd6d5d1aa5656bd134","modified":1684304972000},{"_id":"themes/next/layout/_third-party/analytics/matomo.njk","hash":"43238bc1bc2e88d707f8097814ef3ff830cbe641","modified":1684304972000},{"_id":"themes/next/layout/_third-party/analytics/microsoft-clarity.njk","hash":"24719266662fcff63e88a21ee9b5b284abb8b37c","modified":1684304972000},{"_id":"themes/next/layout/_third-party/analytics/umami.njk","hash":"c8b8c10dcf5c4ffa4a8aec5ba5892842ec204ac0","modified":1684304972000},{"_id":"themes/next/layout/_third-party/analytics/plausible.njk","hash":"64ed6fecae79f9f9c61e956d2bd077792473e069","modified":1684304972000},{"_id":"themes/next/layout/_third-party/comments/disqus.njk","hash":"b0828dd1b1fd66ecd612d9e886a08e7579e9a4f7","modified":1684304972000},{"_id":"themes/next/layout/_third-party/comments/changyan.njk","hash":"5f7967bd946060f4102263a552ddfbae9975e7ea","modified":1684304972000},{"_id":"themes/next/layout/_third-party/comments/livere.njk","hash":"b8e0d5de584cece5e05b03db5b86145aa1e422b4","modified":1684304972000},{"_id":"themes/next/layout/_third-party/comments/disqusjs.njk","hash":"c5086b4c35f730f82c99c4a8317f2f153ebde869","modified":1684304972000},{"_id":"themes/next/layout/_third-party/comments/utterances.njk","hash":"a7921be7328e1509d33b435175f5333a9aada66f","modified":1684304972000},{"_id":"themes/next/layout/_third-party/comments/gitalk.njk","hash":"6fd4df5c21cfe530dbb0c012bc0b202f2c362b9c","modified":1684304972000},{"_id":"themes/next/layout/_third-party/math/index.njk","hash":"1856c4b035c5b8e64300a11af0461b519dfc4cf4","modified":1684304972000},{"_id":"themes/next/layout/_third-party/comments/isso.njk","hash":"38badcc7624a13961381c2465478056b9602aee5","modified":1684304972000},{"_id":"themes/next/layout/_third-party/math/katex.njk","hash":"1df65b1390add93b86ae3f9423d96a130b0ece04","modified":1684304972000},{"_id":"themes/next/layout/_third-party/math/mathjax.njk","hash":"a62aa1ed4e35b8d0451d83f341bf0a97538bc9a4","modified":1684304972000},{"_id":"themes/next/layout/_third-party/chat/gitter.njk","hash":"375a86f0b19e130cfa7707007e3a53d9ae7c9b64","modified":1684304972000},{"_id":"themes/next/layout/_third-party/chat/chatra.njk","hash":"09d2c9487d75894d45a823e3237ae9f90fd6ee01","modified":1684304972000},{"_id":"themes/next/layout/_third-party/chat/tidio.njk","hash":"3fbc72427c1211e5dcfd269af1a74852a7ba5c1a","modified":1684304972000},{"_id":"themes/next/layout/_third-party/search/algolia-search.njk","hash":"67f67a77f27103177b9940446f43610229536d82","modified":1684304972000},{"_id":"themes/next/layout/_third-party/statistics/firestore.njk","hash":"af5336e8bbdc4638435971da115bb7443d374ade","modified":1684304972000},{"_id":"themes/next/layout/_third-party/statistics/index.njk","hash":"866ffa15a3250678eb8a90aa6f609fa965db90fd","modified":1684304972000},{"_id":"themes/next/layout/_third-party/search/localsearch.njk","hash":"210c32b654adae3d8076c4417d370b42af258cea","modified":1684304972000},{"_id":"themes/next/scripts/events/lib/injects.js","hash":"1f1ea7b579a49f17574c31d78d663c54896133eb","modified":1684304972000},{"_id":"themes/next/layout/_third-party/statistics/busuanzi-counter.njk","hash":"d97790e4b442a1e3ded7d7b4f84b8ee6cdb6e8ea","modified":1684304972000},{"_id":"themes/next/scripts/events/lib/highlight.js","hash":"00cec6980cafd417def885f496371856cd524a25","modified":1684304972000},{"_id":"themes/next/scripts/events/lib/config.js","hash":"7c29184a37222d6499c5220264fda6942afc03a9","modified":1684304972000},{"_id":"themes/next/scripts/events/lib/navigation.js","hash":"0a2df7d40d64c61ce7e730bb8269b848b03526d1","modified":1684304972000},{"_id":"themes/next/scripts/events/lib/utils.js","hash":"5a1a3be0b75db88be183c33c798bf719c0905758","modified":1684304972000},{"_id":"themes/next/scripts/filters/comment/common.js","hash":"550cc7f57bc3ab3d093e34741e7860222851d4d4","modified":1684304972000},{"_id":"themes/next/scripts/events/lib/vendors.js","hash":"a96050b0a9bcb49f1f6897660efc77991024790a","modified":1684304972000},{"_id":"themes/next/layout/_third-party/statistics/lean-analytics.njk","hash":"8703d1855bb8d251c9b7c2940b7e3be525e53000","modified":1684304972000},{"_id":"themes/next/scripts/filters/comment/disqus.js","hash":"3283bdd6e5ac7d10376df8ddd5faaec5dc1bd667","modified":1684304972000},{"_id":"themes/next/scripts/filters/comment/default-config.js","hash":"1cb58aa6b88f7461c3c3f9605273686adcc30979","modified":1684304972000},{"_id":"themes/next/scripts/filters/comment/changyan.js","hash":"761760031e49edb77277bd4a8582774959240d6b","modified":1684304972000},{"_id":"themes/next/scripts/filters/comment/gitalk.js","hash":"96e58efba0dc76af409cc7d2db225f0fe4526ea8","modified":1684304972000},{"_id":"themes/next/scripts/filters/comment/livere.js","hash":"bb8ebb541c40362c0cbbd8e83d3b777302bb6c40","modified":1684304972000},{"_id":"themes/next/scripts/filters/comment/isso.js","hash":"c22cbccd7d514947e084eeac6a3af1aa41ec857a","modified":1684304972000},{"_id":"themes/next/layout/_third-party/tags/mermaid.njk","hash":"dd8f963acd5a3685be46fd5319c06df0308d99b2","modified":1684304972000},{"_id":"themes/next/layout/_third-party/tags/pdf.njk","hash":"0386c708975cc5faea4f782611c5d2c6b8ac2850","modified":1684304972000},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"5092cacdfbc482996d0bee9fdf2c37d8d3ae863c","modified":1684304972000},{"_id":"themes/next/source/css/_variables/base.styl","hash":"53a41ab200ad12d8bd589116e11326b776fdb9c5","modified":1690860704000},{"_id":"themes/next/scripts/filters/comment/utterances.js","hash":"a50718c081685fd35ff8ea9ca13682c284399ed8","modified":1684304972000},{"_id":"themes/next/scripts/filters/comment/disqusjs.js","hash":"4dbe9652ae53a181c86eb7e9005a5255f0540055","modified":1684304972000},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"c4537fa2de33d98baff2c87a73801770414e0b69","modified":1684304972000},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"d1a4d2f603c021d6d8a29d917789eb67de1b49e6","modified":1690860710000},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"d3a8f6e71c86926d0c2a247a31d7446d829736d5","modified":1684304972000},{"_id":"themes/next/source/js/third-party/pace.js","hash":"0ebee77b2307bf4b260afb06c060171ef42b7141","modified":1684304972000},{"_id":"themes/next/source/js/third-party/fancybox.js","hash":"8a847a7bbdbc0086dd1de12b82107a854b43f5e5","modified":1684304972000},{"_id":"themes/next/source/js/third-party/quicklink.js","hash":"5b0197e061f57e00875be3636ba372a67693abe0","modified":1684304972000},{"_id":"themes/next/source/css/_common/outline/mobile.styl","hash":"949b0dee398760f4a929f889d4f436dce8df3963","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/index.styl","hash":"49c3063b46d65796003a822deed971abee41675e","modified":1684304972000},{"_id":"themes/next/source/css/_common/outline/index.styl","hash":"7782dfae7a0f8cd61b936fa8ac980440a7bbd3bb","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"969c3797d4315a2873aa143d0674d251fa0c5703","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/reading-progress.styl","hash":"f3defd56be33dba4866a695396d96c767ce63182","modified":1684304972000},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"1239f1b432a6932b2bb9ebcfbaabf724b8f4e59a","modified":1684304972000},{"_id":"themes/next/source/css/_common/scaffolding/comments.styl","hash":"cf8446f4378dcab27b55ede1635c608ae6b8a5c8","modified":1684304972000},{"_id":"themes/next/source/css/_common/scaffolding/buttons.styl","hash":"f768ecb2fe3e9384777c1c115cd7409e9155edd7","modified":1684304972000},{"_id":"themes/next/source/css/_common/scaffolding/index.styl","hash":"43045d115f8fe95732c446aa45bf1c97609ff2a5","modified":1684304972000},{"_id":"themes/next/source/css/_common/scaffolding/pagination.styl","hash":"fd4a2d2303f107a021837aa6e3d977c2f9d14c42","modified":1684304972000},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"6d740699fb6a7640647a8fd77c4ea4992d8d6437","modified":1684304972000},{"_id":"themes/next/source/css/_common/scaffolding/toggles.styl","hash":"aa34abe71ad476922a0371bcac82cd8e5b45d383","modified":1684304972000},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"b9388016f8d9274703e77e306a1feaad1b7b9d6c","modified":1684304972000},{"_id":"themes/next/source/js/third-party/addtoany.js","hash":"5cff12a5c9fc55a68f0f57a291494cd738301ba4","modified":1684304972000},{"_id":"themes/next/source/js/schemes/muse.js","hash":"aa84bdd853a9b0646ad9157e26df949ba0ec57c3","modified":1684304972000},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"be9d0e9493802c22f16a0645a59d0c2b556c1c3c","modified":1684304972000},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"c9db93cfeaf3ab57ba51936d9ffe76a2564c7e40","modified":1684511000000},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"89bf3f6b82cb0fafbbd483431df8f450857c5a0b","modified":1684304972000},{"_id":"themes/next/source/css/_schemes/Mist/_layout.styl","hash":"2db5ada757f7ffb9a36b06400cf30d80ec039b6e","modified":1684304972000},{"_id":"themes/next/source/css/_schemes/Muse/_header.styl","hash":"2f19fe2aba8f63fc99641e50bcb96cc9a4feb8a4","modified":1684304972000},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expand.styl","hash":"68f8d30071516913a7a958e01d010e8a93f7aa24","modified":1684304972000},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"e6e8892fccb02bff163d9b574984e0440a00d756","modified":1684304972000},{"_id":"themes/next/source/css/_schemes/Pisces/_header.styl","hash":"6630a642ad2311ec09466c962963c006c4df4c38","modified":1684304972000},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"82311a531e26ca5a6ad17cf14959da75d4ac6106","modified":1684304972000},{"_id":"themes/next/source/css/_schemes/Muse/_sidebar.styl","hash":"06835446a1c7353f434a9527889a53d6be69766c","modified":1684304972000},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"5393f045f12b1eb9373c421627727f40f5b148e7","modified":1684304972000},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"1d29eca70fa686d895f8e98a283e4a159e40905a","modified":1684304972000},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"e06e0fd44e39838ce22ac7829a2421f8c9e1b12d","modified":1684304972000},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"25c2a7930da14f023329df20f38df2728057fb4d","modified":1684304972000},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"ec5d4e8ffe74722a092a69ace2f8dec7776466a8","modified":1684304972000},{"_id":"themes/next/source/css/_schemes/Muse/_sub-menu.styl","hash":"2d3e05015796a790abd9d68957a5c698c0c9f9b6","modified":1684304972000},{"_id":"themes/next/source/css/_schemes/Pisces/_sub-menu.styl","hash":"b5c3dd08c520a16ee49f85fa12b4935e725ef261","modified":1684304972000},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"5c6ac91eb0d490fb26aa50c10f805cfbf81b97ad","modified":1684511448000},{"_id":"themes/next/source/js/third-party/analytics/google-analytics.js","hash":"d77d4934d959e7125128754b568f1d041c3fbfff","modified":1684304972000},{"_id":"themes/next/source/js/third-party/chat/chatra.js","hash":"72e0766752b78a723fb30e92d533a8b353104e2d","modified":1684304972000},{"_id":"themes/next/source/js/third-party/chat/tidio.js","hash":"77c231bcd64f1c09bd9989909e9fee703b65f47f","modified":1684304972000},{"_id":"themes/next/source/js/third-party/analytics/growingio.js","hash":"f755e8537ccbbb0bd84c26923f320d4e206e7428","modified":1684304972000},{"_id":"themes/next/source/js/third-party/chat/gitter.js","hash":"14b024c920a8b359777d79dd8e1a849387f8f3ad","modified":1684304972000},{"_id":"themes/next/source/js/third-party/analytics/matomo.js","hash":"f24604710002234f18a7b5cfe9ccdf3ed6e725a8","modified":1684304972000},{"_id":"themes/next/source/js/third-party/comments/disqusjs.js","hash":"5673d28509a8e837a512da490a88b7bf5162fc49","modified":1684304972000},{"_id":"themes/next/source/js/third-party/comments/livere.js","hash":"68892d74ef5fc308c6e7e6b4f190826d79f3055d","modified":1684304972000},{"_id":"themes/next/source/js/third-party/comments/changyan.js","hash":"b4cb06fdf531292e2361398a98d75a4ca2b8473a","modified":1684304972000},{"_id":"themes/next/source/js/third-party/comments/gitalk.js","hash":"1e8509356fb027d948d118ab220d9631f4d482fa","modified":1684304972000},{"_id":"themes/next/source/js/third-party/comments/isso.js","hash":"b9b9fd2f0e098a123b34a4932da912a9485ffe6c","modified":1684304972000},{"_id":"themes/next/source/js/third-party/comments/disqus.js","hash":"07e0038b221b9a4fd8ccac75093de3dee1f8315e","modified":1684304972000},{"_id":"themes/next/source/js/third-party/math/mathjax.js","hash":"d93556184b2c0aa1dbc4a6fb892d2f77b80d7d9f","modified":1684304972000},{"_id":"themes/next/source/js/third-party/math/katex.js","hash":"5c63ec71458b4fe0cd98fd4a04e11c3746764f11","modified":1684304972000},{"_id":"themes/next/source/js/third-party/comments/utterances.js","hash":"ec44d7f1c8b51b0aa3cccba099a78f3575ac828c","modified":1684304972000},{"_id":"themes/next/source/js/third-party/search/local-search.js","hash":"e6361ed3d5fa959e11e90f7dab8fdaff398b4425","modified":1684304972000},{"_id":"themes/next/source/js/third-party/statistics/firestore.js","hash":"ce12b5007c9aa997738641c06a1c081c357e27bd","modified":1684304972000},{"_id":"themes/next/source/js/third-party/analytics/baidu-analytics.js","hash":"f9579a02599de063ccff336177ba964a2931a6e9","modified":1684304972000},{"_id":"themes/next/source/js/third-party/tags/pdf.js","hash":"e109c2d6828f527f0289d5fa3bb02fce63ee6d93","modified":1684304972000},{"_id":"themes/next/source/js/third-party/tags/mermaid.js","hash":"e9fffe2a14751e86aed5e84a5e96514413eac2dc","modified":1684304972000},{"_id":"themes/next/source/css/_common/outline/header/bookmark.styl","hash":"c8648c8ea3105556be0068d9fb2735261d0d94bc","modified":1684304972000},{"_id":"themes/next/source/css/_common/outline/footer/index.styl","hash":"39066b4e2e914d85736c9c33fa51f21a3f86c0e4","modified":1684304972000},{"_id":"themes/next/source/css/_common/outline/header/github-banner.styl","hash":"05af22f3edc2383a3d97ec4c05e9ac43b014bead","modified":1684304972000},{"_id":"themes/next/source/css/_common/outline/header/site-meta.styl","hash":"dce8ea62d7d7b08a0444fbb2f617be30bfcfc152","modified":1684304972000},{"_id":"themes/next/source/css/_common/outline/sidebar/index.styl","hash":"bdfef8d2363bc199dfbcc23ee833edca27cc9fcf","modified":1684304972000},{"_id":"themes/next/source/css/_common/outline/header/site-nav.styl","hash":"d9bc2b520636b9df7f946295cd430593df4118ff","modified":1684304972000},{"_id":"themes/next/source/css/_common/outline/header/index.styl","hash":"038625515ba4760e4dda6792549bddc0db5a3d20","modified":1684304972000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-author-links.styl","hash":"2c2bfbc34b6f19d262ae7c041474985e12f4f4ad","modified":1684304972000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-author.styl","hash":"d8a028f532d562e6a86bb3b9c7b992e4b6dbbb51","modified":1684304972000},{"_id":"themes/next/source/css/_common/outline/header/menu.styl","hash":"06d551ef6e26d426bb3ffb4638714488c7cbce66","modified":1684304972000},{"_id":"themes/next/source/css/_common/outline/sidebar/related-posts.styl","hash":"b3689beb90cda64cafecaf6b25981fe8a9525992","modified":1684304972000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-blogroll.styl","hash":"f8a97aad14e0b16b555ee0048da5402f818f9693","modified":1684304972000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-button.styl","hash":"63d8f5f169c2b1c969928fc79244c5fe89ee484e","modified":1684304972000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-toggle.styl","hash":"509bad7d1d6b5c6f24a3f205b2ed7b65a2326dd4","modified":1684304972000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-toc.styl","hash":"cbc6b0938a2e60f35a5df32210904fb16e4938da","modified":1684304972000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-nav.styl","hash":"8f82d5141a18f6319e0609a3f6e4fcca6d442203","modified":1684304972000},{"_id":"themes/next/source/js/third-party/statistics/lean-analytics.js","hash":"7db3233f0b33870943ce1547326a67f9e628b411","modified":1684304972000},{"_id":"themes/next/source/css/_common/outline/sidebar/site-state.styl","hash":"2de038def2cb91da143b14696366c14a66e0e569","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/pages/index.styl","hash":"6cf78a379bb656cc0abb4ab80fcae60152ce41ad","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"80595d274f593b321c0b644a06f3165fe07b16f5","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/pages/breadcrumb.styl","hash":"fde10ce94e9ae21a03b60d41d532835b54abdcb1","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/post/index.styl","hash":"9b702f0b4875f0e5259b25ae33e2e9f818535d0c","modified":1684562242000},{"_id":"themes/next/source/css/_common/components/pages/tag-cloud.styl","hash":"56d719bcdcba3d725141c55bbd4b168f3942f912","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"091b8c763e43447d087c122a86538f290f83136a","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/post/post-body.styl","hash":"268e0a4cf638b9ce4db07268031ab34c5f31ac65","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"eebe3013a9a976011570dce2d04dfeae4c31d790","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/post/post-footer.styl","hash":"4790d37a40b80f7278ec55274f017dad21791038","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/post/post-followme.styl","hash":"7245d8364092c2d184e658e801ba94815a2a1f81","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"c34936a17c3d8af6c0988ac6746d7509dc0b50eb","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"777efaacbabb623f1d77fac5dd784401f8dea4cd","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"69dff7cf231d01f85671758455726dd666664a73","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"0a698c3adba896a46e26850967cb73295c521940","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/post/post-header.styl","hash":"4d29b6ae7ed3dc44b10df851a4128b6441efa8be","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/third-party/gitter.styl","hash":"7b36f776c41fbb744572c5de2c8d49b35656ec21","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/third-party/disqusjs.styl","hash":"a2ffaa06c963514a79fda52665e707af6e8e2f5e","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/third-party/index.styl","hash":"08d609b0534b9a5151cab7e6d54c0dec6a8dad8c","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/third-party/math.styl","hash":"1e5776ad4c5c8bcf7596ac74dcabc30704b3f5a0","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/third-party/search.styl","hash":"49c26184580fde8a732899a4de5aae8662e289b8","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/third-party/gitalk.styl","hash":"406c03be3cf8a8411227bc1fecf942ca368f7e2a","modified":1684304972000},{"_id":"themes/next/source/css/_common/components/third-party/utterances.styl","hash":"d28856f365a9373c4ae6fe1e5673d63df2dfd65f","modified":1684304972000},{"_id":"themes/next/source/css/_common/scaffolding/highlight/index.styl","hash":"a3ea8e3d2347f417ec163d191c9d7c1e9d606c1e","modified":1684304972000},{"_id":"themes/next/source/css/_common/scaffolding/tags/blockquote-center.styl","hash":"6b3680e0dbea8e14c1cec24ef63b7fae5e37f7ef","modified":1684304972000},{"_id":"themes/next/source/css/_common/scaffolding/tags/link-grid.styl","hash":"7075dd32dd70da1e161e4bd14b46f1e8be62fa3c","modified":1684304972000},{"_id":"themes/next/source/css/_common/scaffolding/tags/index.styl","hash":"e22fde6f1657d311d46f64d868c4491d535c8caa","modified":1684304972000},{"_id":"themes/next/source/js/third-party/search/algolia-search.js","hash":"e927000b375e79e2d173bdc6b8b45e67364fad4a","modified":1684304972000},{"_id":"themes/next/source/css/_common/scaffolding/tags/mermaid.styl","hash":"c7754dc6c866928b538f0863a05b96ec44b5e986","modified":1684304972000},{"_id":"themes/next/source/css/_common/scaffolding/tags/label.styl","hash":"531daf2612c6217950677a2d03924459ce57c291","modified":1684304972000},{"_id":"themes/next/source/css/_common/scaffolding/tags/pdf.styl","hash":"77122986509a6b4968bae2729417b7016137534c","modified":1684304972000},{"_id":"themes/next/source/css/_common/scaffolding/tags/note.styl","hash":"3324e9d09faf3903bc9815358bda4000bbb691fa","modified":1684304972000},{"_id":"themes/next/source/css/_common/scaffolding/tags/group-pictures.styl","hash":"8d9218980e185210ce034e9769ab639b9630fd88","modified":1684304972000},{"_id":"themes/next/source/css/_common/scaffolding/tags/tabs.styl","hash":"f71b2022094c5bc8c74b4ed049639f7262e0b182","modified":1684304972000},{"_id":"themes/next/source/css/_common/scaffolding/highlight/copy-code.styl","hash":"047bf8176ea24e277b1a4f6e6ad599033f1d1a44","modified":1684304972000},{"_id":"themes/next/source/images/wechatpay.jpg","hash":"9a80edc951d9fa0c112768a0818e1bfc4711c79f","modified":1684333102000},{"_id":"themes/next/source/images/alipay.jpg","hash":"86657846ad661805e385025a1188d1f2e7613023","modified":1684333130000},{"_id":"themes/next/source/images/avatar1.gif","hash":"2670d28583b9c8739a48dd52507ee750f2eb916c","modified":1684330540000},{"_id":"themes/next/source/images/avatar3.jpg","hash":"eb05aabb19bb5b2db47ec23a5fc92dce477cca01","modified":1711335468000},{"_id":"themes/next/source/images/avatar4.png","hash":"ac6cb27ad60045f9eb5221dc031542d3d58b6a43","modified":1711347608000},{"_id":"themes/next/source/images/background.png","hash":"f9ab46b3487190ed00a2b19f9f642d335047f3c7","modified":1639577168000},{"_id":"public/search.json","hash":"d15bb067837ca2d0b923a9a7ede9f2000572a0df","modified":1734255316629},{"_id":"public/404.html","hash":"7c4a6179a9d3888fb9dcc7c51232eb4723082e5b","modified":1734255316629},{"_id":"public/about/index.html","hash":"1321d4cc37f7b2900b91af05464316d8db5fc76a","modified":1734255316629},{"_id":"public/archives/index.html","hash":"254e709b8e4d16d61563a24b5749db6c82fa2cf6","modified":1734255316629},{"_id":"public/home/index.html","hash":"558a6f66d321fc45bd9d35839e8be287ace46fe6","modified":1734255316629},{"_id":"public/categories/index.html","hash":"d4386122fc8cd1bde377d0069429edc5ab8624a2","modified":1734255316629},{"_id":"public/tags/index.html","hash":"e6cae7445aad8cfaafaba06e068972f1532198f3","modified":1734255316629},{"_id":"public/post/fa92398f.html","hash":"2f170bed8ccc0c42578d4c02c1da7cb09461dd18","modified":1734255316629},{"_id":"public/post/c61694ea.html","hash":"bada4ad0890eb294325b0b881c055a1ef54c9d70","modified":1734255316629},{"_id":"public/post/86e006c4.html","hash":"a537e44a409362068833b9d55f3f9e786c4d83ba","modified":1734255316629},{"_id":"public/post/d1d177a0.html","hash":"58ab8b6ca81775466263e482e3f8a8d682fa49b4","modified":1734255316629},{"_id":"public/post/6c0be4fd.html","hash":"b12ef973ed923068c231a1419999f2d65dad9b06","modified":1734255316629},{"_id":"public/post/c093987d.html","hash":"ee373e1cf3ad9b4ddc9a324065ad5482f293478f","modified":1734255316629},{"_id":"public/post/a14b8b86.html","hash":"4e73333f95fa5761aceb53cebbf8363aac5db449","modified":1734255316629},{"_id":"public/post/fd2daa16.html","hash":"6903dfd9f8f170026f5d5270c22658d9f9dfe9d7","modified":1734255316629},{"_id":"public/post/786e1faa.html","hash":"633587138c37747372d682870db224db28aea6fd","modified":1734255316629},{"_id":"public/post/b40e0536.html","hash":"684f7ffee72e2209a268cf3d54748671f396d3aa","modified":1734255316629},{"_id":"public/post/686264ec.html","hash":"96e06383eb780d18e58df6dd11b5f08952625bc1","modified":1734255316629},{"_id":"public/post/66d9cc71.html","hash":"01f8b2b2b6119c3f63bbcf529551e20e064456e1","modified":1734255316629},{"_id":"public/post/4c46dc20.html","hash":"bdaa721befb006668211b366a42badbd8a4d28a9","modified":1734255316629},{"_id":"public/post/b3b948e8.html","hash":"cc42f711c725bf74db56856ab33c784d97e64b49","modified":1734255316629},{"_id":"public/archives/page/2/index.html","hash":"921ca17f536adb4db193789ce8cbe1a82e0e81cf","modified":1734255316629},{"_id":"public/archives/2023/index.html","hash":"4e0e496a31b8e400618e4ede68e3eae54e89ca49","modified":1734255316629},{"_id":"public/archives/2023/page/2/index.html","hash":"cb4d4a8f0da30ce0ed18d8df892e96f707a30ca1","modified":1734255316629},{"_id":"public/archives/2023/05/index.html","hash":"f3965bdb488265cbbfe049f575fbf24c5797ddd7","modified":1734255316629},{"_id":"public/archives/2023/05/page/2/index.html","hash":"51549ddb4f998dbd22e6f0b44c08dab11f6b18f8","modified":1734255316629},{"_id":"public/archives/2023/08/index.html","hash":"a845988b451d4feb85979050d0a7547a03808c69","modified":1734255316629},{"_id":"public/archives/2023/12/index.html","hash":"935e81b6ae63ab583c121e5deba79322e408bf61","modified":1734255316629},{"_id":"public/categories/code/index.html","hash":"72f340aa11d03fd3ced0693f98ba65eeef56160f","modified":1734255316629},{"_id":"public/categories/notes/index.html","hash":"5232c880bf57556447b0ba752691046a33e050da","modified":1734255316629},{"_id":"public/categories/code/R/index.html","hash":"e325d5c982f889735a7997ada251fbc1b6e4e772","modified":1734255316629},{"_id":"public/categories/paper/index.html","hash":"6dce1064f4e1371f1d43c7dd96a8ee34b785a0a3","modified":1734255316629},{"_id":"public/categories/tool/index.html","hash":"0c6e99ed8bb0af01d16193008e830518318ff1c0","modified":1734255316629},{"_id":"public/categories/notes/ATAC/index.html","hash":"624331b0c06e99032de078a7580d48fa86310c39","modified":1734255316629},{"_id":"public/categories/notes/immune/index.html","hash":"f7e10959f1b0e483cbb9094aed17f1ab61213673","modified":1734255316629},{"_id":"public/categories/Statistics/index.html","hash":"03f8a46e9c4c08794cb4c2edf95dde7b73c02504","modified":1734255316629},{"_id":"public/categories/notes/bioinformatics/index.html","hash":"9013b0232fde3da00279918ed8d2faa27129127f","modified":1734255316629},{"_id":"public/categories/code/inbox/index.html","hash":"3f8fab8925dd8ad28aac3fb7ab43caaa16ef89b1","modified":1734255316629},{"_id":"public/categories/paper/review/index.html","hash":"b5f8035242343294d20542dd4c6527517112398f","modified":1734255316629},{"_id":"public/categories/tool/linux/index.html","hash":"6de95e566b44184bba2d15ecb068d2880acc1a3e","modified":1734255316629},{"_id":"public/categories/paper/review/celltype/index.html","hash":"f29009323d969872671d8848a1bff4712a979a05","modified":1734255316629},{"_id":"public/categories/notes/essay/index.html","hash":"f2a12cb672247398949bcb017905c9a469dfc669","modified":1734255316629},{"_id":"public/index.html","hash":"a98c33b2805f57a97280b74192de62d5ee994cac","modified":1734255316629},{"_id":"public/page/2/index.html","hash":"06fef32cc53298e7bf57e0852d6ab1f40b4e036e","modified":1734255316629},{"_id":"public/tags/R/index.html","hash":"13011e2af66db64f5f4a2dd04bfd00547dfc412b","modified":1734255316629},{"_id":"public/tags/note/index.html","hash":"b0864695a0b63697aaa9fa2276244ddb4f1446dc","modified":1734255316629},{"_id":"public/tags/ATAC/index.html","hash":"1aa747c8553cd4c0a677e745abc3cea2a0ac541a","modified":1734255316629},{"_id":"public/tags/pipeline/index.html","hash":"de8ca254d8e3db2615ca2ac39f7694e97c6fc1f7","modified":1734255316629},{"_id":"public/tags/paper/index.html","hash":"810646dc2329e6cec06f118af03406c82574fc04","modified":1734255316629},{"_id":"public/tags/celltype/index.html","hash":"2260b3e3b5028e6beb381b81e2423a6b7aface68","modified":1734255316629},{"_id":"public/tags/Tfh/index.html","hash":"06788d613baf26e114ebd1741c9b5eebe1a79c24","modified":1734255316629},{"_id":"public/tags/tool/index.html","hash":"d4a055b8ef818af697243041310df420b8435b7d","modified":1734255316629},{"_id":"public/tags/linux/index.html","hash":"d122f2a8bc1a3624b7611de3384d65a24fd4010f","modified":1734255316629},{"_id":"public/tags/immune/index.html","hash":"cf1c7eea7d4274e2a457e3f8bd04114fdaace19b","modified":1734255316629},{"_id":"public/tags/statistics/index.html","hash":"ee046434600116f5d15c84c139d2089fdd3c3310","modified":1734255316629},{"_id":"public/tags/knowledge/index.html","hash":"43ec0d536cb23372b53216ca5fa3c4522e442ecd","modified":1734255316629},{"_id":"public/tags/bioinformatics/index.html","hash":"fa2c196a307a02e2bc7af887e5d2a90f1fda9c56","modified":1734255316629},{"_id":"public/tags/essay/index.html","hash":"c1cf22df402abc701d424ccf82821cc31c16c97c","modified":1734255316629},{"_id":"public/README.md","hash":"2fa78d31021449cf7aa47b22edc109a4bbbe3c07","modified":1734255316629},{"_id":"public/CNAME","hash":"962cd85e6b23e528cce54095c427eaa945ce2341","modified":1734255316629},{"_id":"public/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1734255316629},{"_id":"public/images/avatar.gif","hash":"2dbc3e2f2d624b2ca1afe6edc2ca17307f1950c8","modified":1734255316629},{"_id":"public/images/cucumber_16.ico","hash":"cbf56acf43fe8ba235d948b52adcd44e6a9626f9","modified":1734255316629},{"_id":"public/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1734255316629},{"_id":"public/images/cucumber_32.ico","hash":"fa2de9040c64487e7f5bf95877ca3ca51a9515a7","modified":1734255316629},{"_id":"public/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1734255316629},{"_id":"public/images/logo-algolia-nebula-blue-full.svg","hash":"b85e274207b1392782476a0430feac98db1e7da0","modified":1734255316629},{"_id":"public/images/panda_favicon16.ico","hash":"b56eca7553f45be5954367787dd277073d54eb7d","modified":1734255316629},{"_id":"public/images/panda_favicon32.ico","hash":"d3c3915b7121a1268a5f2f233428614db6837827","modified":1734255316629},{"_id":"public/images/logo.svg","hash":"099e11ab995a2c8981427a85476d082609848c77","modified":1734255316629},{"_id":"public/images/wechatpay.jpg","hash":"9a80edc951d9fa0c112768a0818e1bfc4711c79f","modified":1734255316629},{"_id":"public/css/main.css","hash":"b2f7f5490b5b99adf6ab6e1c906a17ab6767bb34","modified":1734255316629},{"_id":"public/js/bookmark.js","hash":"0f563ffbf05fad30e854e413ab17ff7164ab5a53","modified":1734255316629},{"_id":"public/js/comments-buttons.js","hash":"1a7344440321713426a0b2ab17e276b5bdf85ade","modified":1734255316629},{"_id":"public/css/noscript.css","hash":"4cd5301e478e0e0d4b176740ec314087ec5cb707","modified":1734255316629},{"_id":"public/js/config.js","hash":"4c4ebbe3b3f3841a26f9d5af6d0ba8bc6da01c54","modified":1734255316629},{"_id":"public/js/motion.js","hash":"770d63c26f22705311028a36b52e999cc8a2da82","modified":1734255316629},{"_id":"public/js/comments.js","hash":"66ae2e26ea36a41b72c638ea8b220296638ae952","modified":1734255316629},{"_id":"public/js/next-boot.js","hash":"da0f07f9eaaa83de70128b0feaea3fdadb90457a","modified":1734255316629},{"_id":"public/js/schedule.js","hash":"a1333258726caf84f368a8f8454639c7dc1626bb","modified":1734255316629},{"_id":"public/js/pjax.js","hash":"b03ba78c6916ad2f390d55bc1bc18fafb64b0ebf","modified":1734255316629},{"_id":"public/js/utils.js","hash":"5e1cf39de050964e97fb3ba0825aeec7f4bc36dd","modified":1734255316629},{"_id":"public/js/third-party/addtoany.js","hash":"5276c8f78ee562a8965216dc67d762e59cb4a9f2","modified":1734255316629},{"_id":"public/js/schemes/muse.js","hash":"ba7ba2c129d1f240c6a22cec3e53f3f22af64b6b","modified":1734255316629},{"_id":"public/js/third-party/quicklink.js","hash":"eed02e6fced8e5a653077205d4d4d7834ca71472","modified":1734255316629},{"_id":"public/js/third-party/analytics/google-analytics.js","hash":"59684383385059dc4f8a1ff85dbbeb703bcdbcb5","modified":1734255316629},{"_id":"public/js/third-party/fancybox.js","hash":"c098d14e65dd170537134358d4b8359ad0539c2c","modified":1734255316629},{"_id":"public/js/third-party/analytics/growingio.js","hash":"78dd3cf04082b7dbe6246e404b2aa8e726922402","modified":1734255316629},{"_id":"public/js/third-party/pace.js","hash":"0ef04218b93561ba4d0ff420d556c3d90a756d32","modified":1734255316629},{"_id":"public/js/third-party/analytics/matomo.js","hash":"c6a25b26a1443caa70b47fd3dfa282271574deb5","modified":1734255316629},{"_id":"public/js/third-party/chat/chatra.js","hash":"c32180522788c10e51df1803aa6842ef0432ddc9","modified":1734255316629},{"_id":"public/js/third-party/chat/gitter.js","hash":"cc38c94125f90dadde11b5ebac7d8bf99a1a08a2","modified":1734255316629},{"_id":"public/js/third-party/chat/tidio.js","hash":"b0079f6a4601e06ca6fe46e83a2f5af553e9bc3c","modified":1734255316629},{"_id":"public/js/third-party/comments/changyan.js","hash":"260d1a77d6a3bb33a579d3e4cca1997003e799b5","modified":1734255316629},{"_id":"public/js/third-party/analytics/baidu-analytics.js","hash":"f629acc46ff40c071ffd31b77d5c7616f0fdd778","modified":1734255316629},{"_id":"public/js/third-party/comments/gitalk.js","hash":"0ec038cf83e8ec067534f16a54041e47a3c1e59a","modified":1734255316629},{"_id":"public/js/third-party/comments/disqusjs.js","hash":"1e826dea3f684c0515f362dc1352447a1f0eae71","modified":1734255316629},{"_id":"public/js/third-party/comments/livere.js","hash":"2247d88c934c765c43013337860774aaa99f0b31","modified":1734255316629},{"_id":"public/js/third-party/comments/isso.js","hash":"753a873b6f566aff5ba77ca23f91b78eb880ca64","modified":1734255316629},{"_id":"public/js/third-party/comments/disqus.js","hash":"da361917d65e5dca8362f8cdeb6c8cc0e8316cec","modified":1734255316629},{"_id":"public/js/third-party/math/mathjax.js","hash":"5c749b9c1c3bb738122d0516211ecff6496d4907","modified":1734255316629},{"_id":"public/js/third-party/math/katex.js","hash":"83c54ee536e487a1031783443fe0cb63b1b4767e","modified":1734255316629},{"_id":"public/js/third-party/comments/utterances.js","hash":"f67f90eb03e284c82da2b8cf2f1e31801813c16d","modified":1734255316629},{"_id":"public/js/third-party/search/local-search.js","hash":"4536cb6d0a9bbaaa86fab3fa0101f6a3a3ec5a76","modified":1734255316629},{"_id":"public/js/third-party/statistics/firestore.js","hash":"6e0682bb42170d61b13b786295f45f9c785f8b73","modified":1734255316629},{"_id":"public/js/third-party/search/algolia-search.js","hash":"fdb7b7cef1a147d897e7f7cd8903b58368ec2062","modified":1734255316629},{"_id":"public/js/third-party/tags/pdf.js","hash":"af78c22f0e61c8c8aa8794e585e0d632c6d4fcb8","modified":1734255316629},{"_id":"public/js/third-party/statistics/lean-analytics.js","hash":"835cbf54c49ef1327f47df70ff2636ad36b6f57d","modified":1734255316629},{"_id":"public/js/third-party/tags/mermaid.js","hash":"f27d817b0c2138dd3215b1f46af0753f60a008f3","modified":1734255316629},{"_id":"public/images/alipay.jpg","hash":"86657846ad661805e385025a1188d1f2e7613023","modified":1734255316629},{"_id":"public/images/avatar1.gif","hash":"2670d28583b9c8739a48dd52507ee750f2eb916c","modified":1734255316629},{"_id":"public/images/avatar3.jpg","hash":"eb05aabb19bb5b2db47ec23a5fc92dce477cca01","modified":1734255316629},{"_id":"public/images/avatar4.png","hash":"ac6cb27ad60045f9eb5221dc031542d3d58b6a43","modified":1734255316629},{"_id":"public/images/background.png","hash":"f9ab46b3487190ed00a2b19f9f642d335047f3c7","modified":1734255316629}],"Category":[{"name":"code","_id":"cm4peu6my0004dbzr5jyd1xhl"},{"name":"notes","_id":"cm4peu6mz000cdbzr3awq3gx3"},{"name":"R","parent":"cm4peu6my0004dbzr5jyd1xhl","_id":"cm4peu6n0000ndbzrfzl4cqq1"},{"name":"paper","_id":"cm4peu6n1000vdbzre4ki0myt"},{"name":"tool","_id":"cm4peu6n10013dbzr5fj9d6ra"},{"name":"ATAC","parent":"cm4peu6mz000cdbzr3awq3gx3","_id":"cm4peu6n10016dbzr44zu31e1"},{"name":"immune","parent":"cm4peu6mz000cdbzr3awq3gx3","_id":"cm4peu6n1001bdbzrawjac8k4"},{"name":"Statistics","_id":"cm4peu6n2001pdbzrgihfbaat"},{"name":"bioinformatics","parent":"cm4peu6mz000cdbzr3awq3gx3","_id":"cm4peu6n2001udbzr85bj9ez6"},{"name":"inbox","parent":"cm4peu6my0004dbzr5jyd1xhl","_id":"cm4peu6n2001zdbzrch2b1guu"},{"name":"review","parent":"cm4peu6n1000vdbzre4ki0myt","_id":"cm4peu6n20023dbzr7w6n48hz"},{"name":"linux","parent":"cm4peu6n10013dbzr5fj9d6ra","_id":"cm4peu6n30028dbzr6bsn1fw0"},{"name":"celltype","parent":"cm4peu6n20023dbzr7w6n48hz","_id":"cm4peu6n3002ldbzr4m15769c"},{"name":"essay","parent":"cm4peu6mz000cdbzr3awq3gx3","_id":"cm4peu6n40031dbzr5q04c4jd"}],"Data":[{"_id":"styles","data":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}],"Page":[{"_content":"<!DOCTYPE html>\n<html lang=\"en\">\n\t<head>\n\t\t<meta charset=\"UTF-8\">\n\t\t<title>404</title>\n\t</head>\n\t<body>\n\t\t<script type=\"text/javascript\" \t\t\t  src=\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\" charset=\"utf-8\"></script>\n\t</body>\n</html>","source":"404.html","raw":"<!DOCTYPE html>\n<html lang=\"en\">\n\t<head>\n\t\t<meta charset=\"UTF-8\">\n\t\t<title>404</title>\n\t</head>\n\t<body>\n\t\t<script type=\"text/javascript\" \t\t\t  src=\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\" charset=\"utf-8\"></script>\n\t</body>\n</html>","date":"2024-12-15T09:06:15.426Z","updated":"2023-05-17T10:00:46.000Z","path":"404.html","title":"","comments":1,"layout":"page","_id":"cm4peu6mv0000dbzrehace2dp","content":"<!DOCTYPE html>\n<html lang=\"en\">\n\t<head>\n\t\t<meta charset=\"UTF-8\">\n\t\t<title>404</title>\n\t</head>\n\t<body>\n\t\t<script type=\"text/javascript\" \t\t\t  src=\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\" charset=\"utf-8\"></script>\n\t</body>\n</html>","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":32,"excerpt":"","more":"<!DOCTYPE html>\n<html lang=\"en\">\n\t<head>\n\t\t<meta charset=\"UTF-8\">\n\t\t<title>404</title>\n\t</head>\n\t<body>\n\t\t<script type=\"text/javascript\" \t\t\t  src=\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\" charset=\"utf-8\"></script>\n\t</body>\n</html>"},{"title":"简介","type":"about","comments":0,"date":"2023-05-17T09:30:13.000Z","_content":"\n2021年于**哈尔滨医科大学**毕业。目前就读于**中国科学院大学**，从事癌症免疫单细胞多组学方向的分析工作。\n\n熟悉的编程语言：\n\n1. R\n2. Shell\n3. Python\n\n\n\n> 你所热爱的，就是你的生活\n\n","source":"about/index.md","raw":"---\ntitle: 简介\ntype: \"about\"\ncomments: false\ndate: 2023-05-17 17:30:13\n---\n\n2021年于**哈尔滨医科大学**毕业。目前就读于**中国科学院大学**，从事癌症免疫单细胞多组学方向的分析工作。\n\n熟悉的编程语言：\n\n1. R\n2. Shell\n3. Python\n\n\n\n> 你所热爱的，就是你的生活\n\n","updated":"2023-12-19T01:14:20.000Z","path":"about/index.html","layout":"page","_id":"cm4peu6mx0002dbzrcgb20vcx","content":"<p>2021年于<strong>哈尔滨医科大学</strong>毕业。目前就读于<strong>中国科学院大学</strong>，从事癌症免疫单细胞多组学方向的分析工作。</p>\n<p>熟悉的编程语言：</p>\n<ol>\n<li>R</li>\n<li>Shell</li>\n<li>Python</li>\n</ol>\n<blockquote>\n<p>你所热爱的，就是你的生活</p>\n</blockquote>\n","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":67,"excerpt":"","more":"<p>2021年于<strong>哈尔滨医科大学</strong>毕业。目前就读于<strong>中国科学院大学</strong>，从事癌症免疫单细胞多组学方向的分析工作。</p>\n<p>熟悉的编程语言：</p>\n<ol>\n<li>R</li>\n<li>Shell</li>\n<li>Python</li>\n</ol>\n<blockquote>\n<p>你所热爱的，就是你的生活</p>\n</blockquote>\n"},{"title":"archives","type":"archives","comments":0,"date":"2023-05-17T09:35:56.000Z","_content":"","source":"archives/index.md","raw":"---\ntitle: archives\ntype: \"archives\"\ncomments: false\ndate: 2023-05-17 17:35:56\n---\n","updated":"2023-05-17T09:36:48.000Z","path":"archives/index.html","layout":"page","_id":"cm4peu6my0006dbzr2z9vflyu","content":"","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":0,"excerpt":"","more":""},{"title":"首页","date":"2023-05-17T14:33:48.000Z","_content":"\n<center>天下风云出我辈，一入江湖岁月催。</center>\n\n<center>皇图霸业谈笑中，不胜人生一场醉。</center>\n\n<center>提剑跨骑挥鬼雨，白骨如山鸟惊飞。</center>\n\n<center>尘事如潮人如水，只叹江湖几人回。</center>\n","source":"home/index.md","raw":"---\ntitle: 首页\ndate: 2023-05-17 22:33:48\n---\n\n<center>天下风云出我辈，一入江湖岁月催。</center>\n\n<center>皇图霸业谈笑中，不胜人生一场醉。</center>\n\n<center>提剑跨骑挥鬼雨，白骨如山鸟惊飞。</center>\n\n<center>尘事如潮人如水，只叹江湖几人回。</center>\n","updated":"2023-05-17T14:35:24.000Z","path":"home/index.html","comments":1,"layout":"page","_id":"cm4peu6my0008dbzrfvna7mzd","content":"<center>天下风云出我辈，一入江湖岁月催。</center>\n<center>皇图霸业谈笑中，不胜人生一场醉。</center>\n<center>提剑跨骑挥鬼雨，白骨如山鸟惊飞。</center>\n<center>尘事如潮人如水，只叹江湖几人回。</center>\n","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":64,"excerpt":"","more":"<center>天下风云出我辈，一入江湖岁月催。</center>\n<center>皇图霸业谈笑中，不胜人生一场醉。</center>\n<center>提剑跨骑挥鬼雨，白骨如山鸟惊飞。</center>\n<center>尘事如潮人如水，只叹江湖几人回。</center>\n"},{"title":"分类","type":"categories","comments":0,"date":"2023-05-17T09:35:38.000Z","_content":"","source":"categories/index.md","raw":"---\ntitle: 分类\ntype: \"categories\"\ncomments: false\ndate: 2023-05-17 17:35:38\n---\n","updated":"2023-05-17T12:45:34.000Z","path":"categories/index.html","layout":"page","_id":"cm4peu6mz000adbzrc1yq9gj2","content":"","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":0,"excerpt":"","more":""},{"title":"标签","type":"tags","date":"2023-05-17T09:29:27.000Z","comments":0,"_content":"","source":"tags/index.md","raw":"---\ntitle: 标签\ntype: \"tags\"\ndate: 2023-05-17 17:29:27\ncomments: false\n---\n","updated":"2023-05-17T12:45:56.000Z","path":"tags/index.html","layout":"page","_id":"cm4peu6mz000fdbzrcof9bn6h","content":"","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":0,"excerpt":"","more":""}],"Post":[{"title":"差异基因火山图","abbrlink":"6c0be4fd","date":"2023-05-22T10:07:48.000Z","_content":"\n## 差异基因画火山图 \n\n<!--more-->\n\n```R\nindir <- \"/path\"\ndegfile <- \"deg.txt\"\nid <- \"deg_vol\"\nla1 <- \"control\" \nla2 <- \"case\"\nday <- \"230522\"\n\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(ggrepel)\nsetwd(indir)\n\n### 读取数据\ndf <- read.delim(degfile,sep=\"\\t\",header=TRUE,check.names=FALSE)\ndf$avg_log2FC <- ifelse(df$cluster==la2,-df$avg_log2FC,df$avg_log2FC )\nhead(df)\n\n\n### 阈值确定：\npvalue = 0.05\nlog2FC = 1\n\n### 根据阈值添加上下调分组标签：\ndf$group <- case_when(\n    df$avg_log2FC > log2FC & df$p_val_adj < pvalue & df$cluster==la1 ~ la1,\n    df$avg_log2FC < -log2FC & df$p_val_adj < pvalue & df$cluster==la2 ~ la2,\n    TRUE ~ 'none'\n)\nhead(df)\n\n\n### 转换为因子，指定绘图顺序；\ndf$'-log10(p_val_adj)' <- -log10(df$p_val_adj) #新增-log10p列\ndf$group <- factor(df$group, levels = c(la1,la2,\"none\"))\n\n\n#自定义颜色：\nmycol <- c(\"#EB4232\",\"#2DB2EB\",\"#d8d8d8\")\n#自定义主题：\nmytheme <- theme_classic() +\n    theme(axis.title = element_text(size = 15),\n          axis.text = element_text(size = 14),\n          legend.text = element_text(size = 14),\n\t\t  plot.margin = margin(15,5.5,5.5,5.5))\n\n### 绘制基本图形\np <- ggplot(data = df,aes(x = avg_log2FC, y = -log10(p_val_adj),color = group)) + #建立映射\n    geom_point(size = 2.2) + #绘制散点\n    scale_colour_manual(name = \"\", values = alpha(mycol, 0.7)) + #自定义散点颜色\n    scale_x_continuous(limits = c(-5, 5),breaks = seq(-5, 5, by = 2)) + #x轴限制\n    scale_y_continuous(expand = expansion(add = c(2, 0)),limits = c(0, 40),\n                       breaks = seq(0, 40, by = 10)) + #y轴限制\n    geom_hline(yintercept = c(-log10(pvalue)),linewidth = 0.7,color = \"black\",lty = \"dashed\") + #水平阈值线\n    geom_vline(xintercept = c(-log2FC, log2FC),linewidth = 0.7,color = \"black\",lty = \"dashed\") + #垂直阈值线\n    mytheme\np\n\n\n### 分别筛选两个分组中的满足条件的基因, 此处通过阈值筛选\nup <- filter(df, group == la1) %>% distinct(gene, .keep_all = T) %>% filter(avg_log2FC > log2FC & p_val_adj < pvalue)\ndown <- filter(df, group == la2) %>% distinct(gene, .keep_all = T) %>% filter(avg_log2FC < -log2FC  & p_val_adj < pvalue)\nhead(up);head(down)\n\n\n### 个性化调整：对齐基因标签\np1 <- p +\n    geom_point(data = up,\n               aes(x = avg_log2FC , y = -log10(p_val_adj)),\n               color = '#EB4232', size = 4.5, alpha = 0.2) +\n    geom_text_repel(data = up,\n                    aes(x = avg_log2FC , y = -log10(p_val_adj), label = gene),\n                    seed = 233,size = 2.5,color = 'black',min.segment.length = 0,\n                    force = 2,force_pull = 2,box.padding = 0.1, max.overlaps = Inf,\n                    segment.linetype = 3, #线段类型,1为实线,2-6为不同类型虚线\n                    segment.color = 'black', #线段颜色\n                    segment.alpha = 0.5, #线段不透明度\n                    nudge_x = 3 - up$avg_log2FC , #标签x轴起始位置调整\n                    direction = \"y\", #按y轴调整标签位置方向，若想水平对齐则为x\n                    hjust = 0 #对齐标签：0右对齐，1左对齐，0.5居中\n                    )\n\np2 <- p1 +\n    geom_point(data = down,aes(x = avg_log2FC , y = -log10(p_val_adj)),\n               color = '#2DB2EB',size = 4.5, alpha = 0.2) +\n    geom_text_repel(data = down,\n                    aes(x = avg_log2FC , y = -log10(p_val_adj), label = gene),\n                    seed = 233,size = 2.5,color = 'black',min.segment.length = 0,\n                    force = 2,force_pull = 2,box.padding = 0.1,max.overlaps = Inf,\n                    segment.linetype = 3,segment.color = 'black',segment.alpha = 0.8,\n                    nudge_x = -3 - down$avg_log2FC ,direction = \"y\",\n                    hjust = 1 #改为左对齐即可\n                    )\n\nggsave(filename = paste0(id,\"_\",day,\".pdf\"),plot = p2,width = 7,height = 5.5)\n```\n\n","source":"_posts/Deg-volcano.md","raw":"---\ntitle: 差异基因火山图\ncategories:\n  - code\n  - R\ntags:\n  - R\nabbrlink: 6c0be4fd\ndate: 2023-05-22 18:07:48\n---\n\n## 差异基因画火山图 \n\n<!--more-->\n\n```R\nindir <- \"/path\"\ndegfile <- \"deg.txt\"\nid <- \"deg_vol\"\nla1 <- \"control\" \nla2 <- \"case\"\nday <- \"230522\"\n\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(ggrepel)\nsetwd(indir)\n\n### 读取数据\ndf <- read.delim(degfile,sep=\"\\t\",header=TRUE,check.names=FALSE)\ndf$avg_log2FC <- ifelse(df$cluster==la2,-df$avg_log2FC,df$avg_log2FC )\nhead(df)\n\n\n### 阈值确定：\npvalue = 0.05\nlog2FC = 1\n\n### 根据阈值添加上下调分组标签：\ndf$group <- case_when(\n    df$avg_log2FC > log2FC & df$p_val_adj < pvalue & df$cluster==la1 ~ la1,\n    df$avg_log2FC < -log2FC & df$p_val_adj < pvalue & df$cluster==la2 ~ la2,\n    TRUE ~ 'none'\n)\nhead(df)\n\n\n### 转换为因子，指定绘图顺序；\ndf$'-log10(p_val_adj)' <- -log10(df$p_val_adj) #新增-log10p列\ndf$group <- factor(df$group, levels = c(la1,la2,\"none\"))\n\n\n#自定义颜色：\nmycol <- c(\"#EB4232\",\"#2DB2EB\",\"#d8d8d8\")\n#自定义主题：\nmytheme <- theme_classic() +\n    theme(axis.title = element_text(size = 15),\n          axis.text = element_text(size = 14),\n          legend.text = element_text(size = 14),\n\t\t  plot.margin = margin(15,5.5,5.5,5.5))\n\n### 绘制基本图形\np <- ggplot(data = df,aes(x = avg_log2FC, y = -log10(p_val_adj),color = group)) + #建立映射\n    geom_point(size = 2.2) + #绘制散点\n    scale_colour_manual(name = \"\", values = alpha(mycol, 0.7)) + #自定义散点颜色\n    scale_x_continuous(limits = c(-5, 5),breaks = seq(-5, 5, by = 2)) + #x轴限制\n    scale_y_continuous(expand = expansion(add = c(2, 0)),limits = c(0, 40),\n                       breaks = seq(0, 40, by = 10)) + #y轴限制\n    geom_hline(yintercept = c(-log10(pvalue)),linewidth = 0.7,color = \"black\",lty = \"dashed\") + #水平阈值线\n    geom_vline(xintercept = c(-log2FC, log2FC),linewidth = 0.7,color = \"black\",lty = \"dashed\") + #垂直阈值线\n    mytheme\np\n\n\n### 分别筛选两个分组中的满足条件的基因, 此处通过阈值筛选\nup <- filter(df, group == la1) %>% distinct(gene, .keep_all = T) %>% filter(avg_log2FC > log2FC & p_val_adj < pvalue)\ndown <- filter(df, group == la2) %>% distinct(gene, .keep_all = T) %>% filter(avg_log2FC < -log2FC  & p_val_adj < pvalue)\nhead(up);head(down)\n\n\n### 个性化调整：对齐基因标签\np1 <- p +\n    geom_point(data = up,\n               aes(x = avg_log2FC , y = -log10(p_val_adj)),\n               color = '#EB4232', size = 4.5, alpha = 0.2) +\n    geom_text_repel(data = up,\n                    aes(x = avg_log2FC , y = -log10(p_val_adj), label = gene),\n                    seed = 233,size = 2.5,color = 'black',min.segment.length = 0,\n                    force = 2,force_pull = 2,box.padding = 0.1, max.overlaps = Inf,\n                    segment.linetype = 3, #线段类型,1为实线,2-6为不同类型虚线\n                    segment.color = 'black', #线段颜色\n                    segment.alpha = 0.5, #线段不透明度\n                    nudge_x = 3 - up$avg_log2FC , #标签x轴起始位置调整\n                    direction = \"y\", #按y轴调整标签位置方向，若想水平对齐则为x\n                    hjust = 0 #对齐标签：0右对齐，1左对齐，0.5居中\n                    )\n\np2 <- p1 +\n    geom_point(data = down,aes(x = avg_log2FC , y = -log10(p_val_adj)),\n               color = '#2DB2EB',size = 4.5, alpha = 0.2) +\n    geom_text_repel(data = down,\n                    aes(x = avg_log2FC , y = -log10(p_val_adj), label = gene),\n                    seed = 233,size = 2.5,color = 'black',min.segment.length = 0,\n                    force = 2,force_pull = 2,box.padding = 0.1,max.overlaps = Inf,\n                    segment.linetype = 3,segment.color = 'black',segment.alpha = 0.8,\n                    nudge_x = -3 - down$avg_log2FC ,direction = \"y\",\n                    hjust = 1 #改为左对齐即可\n                    )\n\nggsave(filename = paste0(id,\"_\",day,\".pdf\"),plot = p2,width = 7,height = 5.5)\n```\n\n","slug":"Deg-volcano","published":1,"updated":"2023-05-22T10:22:24.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm4peu6mw0001dbzreguc9t3p","content":"<h2 id=\"差异基因画火山图\"><a class=\"markdownIt-Anchor\" href=\"#差异基因画火山图\"></a> 差异基因画火山图</h2>\n<span id=\"more\"></span>\n<figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">indir <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;/path&quot;</span></span><br><span class=\"line\">degfile <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;deg.txt&quot;</span></span><br><span class=\"line\">id <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;deg_vol&quot;</span></span><br><span class=\"line\">la1 <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;control&quot;</span> </span><br><span class=\"line\">la2 <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;case&quot;</span></span><br><span class=\"line\">day <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;230522&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>dplyr<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>ggplot2<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>ggrepel<span class=\"punctuation\">)</span></span><br><span class=\"line\">setwd<span class=\"punctuation\">(</span>indir<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 读取数据</span></span><br><span class=\"line\">df <span class=\"operator\">&lt;-</span> read.delim<span class=\"punctuation\">(</span>degfile<span class=\"punctuation\">,</span>sep<span class=\"operator\">=</span><span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">,</span>header<span class=\"operator\">=</span><span class=\"literal\">TRUE</span><span class=\"punctuation\">,</span>check.names<span class=\"operator\">=</span><span class=\"literal\">FALSE</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">df<span class=\"operator\">$</span>avg_log2FC <span class=\"operator\">&lt;-</span> ifelse<span class=\"punctuation\">(</span>df<span class=\"operator\">$</span>cluster<span class=\"operator\">==</span>la2<span class=\"punctuation\">,</span><span class=\"operator\">-</span>df<span class=\"operator\">$</span>avg_log2FC<span class=\"punctuation\">,</span>df<span class=\"operator\">$</span>avg_log2FC <span class=\"punctuation\">)</span></span><br><span class=\"line\">head<span class=\"punctuation\">(</span>df<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 阈值确定：</span></span><br><span class=\"line\">pvalue <span class=\"operator\">=</span> <span class=\"number\">0.05</span></span><br><span class=\"line\">log2FC <span class=\"operator\">=</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 根据阈值添加上下调分组标签：</span></span><br><span class=\"line\">df<span class=\"operator\">$</span>group <span class=\"operator\">&lt;-</span> case_when<span class=\"punctuation\">(</span></span><br><span class=\"line\">    df<span class=\"operator\">$</span>avg_log2FC <span class=\"operator\">&gt;</span> log2FC <span class=\"operator\">&amp;</span> df<span class=\"operator\">$</span>p_val_adj <span class=\"operator\">&lt;</span> pvalue <span class=\"operator\">&amp;</span> df<span class=\"operator\">$</span>cluster<span class=\"operator\">==</span>la1 <span class=\"operator\">~</span> la1<span class=\"punctuation\">,</span></span><br><span class=\"line\">    df<span class=\"operator\">$</span>avg_log2FC <span class=\"operator\">&lt;</span> <span class=\"operator\">-</span>log2FC <span class=\"operator\">&amp;</span> df<span class=\"operator\">$</span>p_val_adj <span class=\"operator\">&lt;</span> pvalue <span class=\"operator\">&amp;</span> df<span class=\"operator\">$</span>cluster<span class=\"operator\">==</span>la2 <span class=\"operator\">~</span> la2<span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"literal\">TRUE</span> <span class=\"operator\">~</span> <span class=\"string\">&#x27;none&#x27;</span></span><br><span class=\"line\"><span class=\"punctuation\">)</span></span><br><span class=\"line\">head<span class=\"punctuation\">(</span>df<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 转换为因子，指定绘图顺序；</span></span><br><span class=\"line\">df<span class=\"operator\">$</span><span class=\"string\">&#x27;-log10(p_val_adj)&#x27;</span> <span class=\"operator\">&lt;-</span> <span class=\"operator\">-</span>log10<span class=\"punctuation\">(</span>df<span class=\"operator\">$</span>p_val_adj<span class=\"punctuation\">)</span> <span class=\"comment\">#新增-log10p列</span></span><br><span class=\"line\">df<span class=\"operator\">$</span>group <span class=\"operator\">&lt;-</span> factor<span class=\"punctuation\">(</span>df<span class=\"operator\">$</span>group<span class=\"punctuation\">,</span> levels <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span>la1<span class=\"punctuation\">,</span>la2<span class=\"punctuation\">,</span><span class=\"string\">&quot;none&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#自定义颜色：</span></span><br><span class=\"line\">mycol <span class=\"operator\">&lt;-</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#EB4232&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#2DB2EB&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#d8d8d8&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"comment\">#自定义主题：</span></span><br><span class=\"line\">mytheme <span class=\"operator\">&lt;-</span> theme_classic<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span></span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>axis.title <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>size <span class=\"operator\">=</span> <span class=\"number\">15</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">          axis.text <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>size <span class=\"operator\">=</span> <span class=\"number\">14</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">          legend.text <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>size <span class=\"operator\">=</span> <span class=\"number\">14</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">\t\t  plot.margin <span class=\"operator\">=</span> margin<span class=\"punctuation\">(</span><span class=\"number\">15</span><span class=\"punctuation\">,</span><span class=\"number\">5.5</span><span class=\"punctuation\">,</span><span class=\"number\">5.5</span><span class=\"punctuation\">,</span><span class=\"number\">5.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 绘制基本图形</span></span><br><span class=\"line\">p <span class=\"operator\">&lt;-</span> ggplot<span class=\"punctuation\">(</span>data <span class=\"operator\">=</span> df<span class=\"punctuation\">,</span>aes<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> avg_log2FC<span class=\"punctuation\">,</span> y <span class=\"operator\">=</span> <span class=\"operator\">-</span>log10<span class=\"punctuation\">(</span>p_val_adj<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>color <span class=\"operator\">=</span> group<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> <span class=\"comment\">#建立映射</span></span><br><span class=\"line\">    geom_point<span class=\"punctuation\">(</span>size <span class=\"operator\">=</span> <span class=\"number\">2.2</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> <span class=\"comment\">#绘制散点</span></span><br><span class=\"line\">    scale_colour_manual<span class=\"punctuation\">(</span>name <span class=\"operator\">=</span> <span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span> values <span class=\"operator\">=</span> alpha<span class=\"punctuation\">(</span>mycol<span class=\"punctuation\">,</span> <span class=\"number\">0.7</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> <span class=\"comment\">#自定义散点颜色</span></span><br><span class=\"line\">    scale_x_continuous<span class=\"punctuation\">(</span>limits <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"operator\">-</span><span class=\"number\">5</span><span class=\"punctuation\">,</span> <span class=\"number\">5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>breaks <span class=\"operator\">=</span> seq<span class=\"punctuation\">(</span><span class=\"operator\">-</span><span class=\"number\">5</span><span class=\"punctuation\">,</span> <span class=\"number\">5</span><span class=\"punctuation\">,</span> by <span class=\"operator\">=</span> <span class=\"number\">2</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> <span class=\"comment\">#x轴限制</span></span><br><span class=\"line\">    scale_y_continuous<span class=\"punctuation\">(</span>expand <span class=\"operator\">=</span> expansion<span class=\"punctuation\">(</span>add <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"number\">2</span><span class=\"punctuation\">,</span> <span class=\"number\">0</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>limits <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"number\">0</span><span class=\"punctuation\">,</span> <span class=\"number\">40</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                       breaks <span class=\"operator\">=</span> seq<span class=\"punctuation\">(</span><span class=\"number\">0</span><span class=\"punctuation\">,</span> <span class=\"number\">40</span><span class=\"punctuation\">,</span> by <span class=\"operator\">=</span> <span class=\"number\">10</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> <span class=\"comment\">#y轴限制</span></span><br><span class=\"line\">    geom_hline<span class=\"punctuation\">(</span>yintercept <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"operator\">-</span>log10<span class=\"punctuation\">(</span>pvalue<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>linewidth <span class=\"operator\">=</span> <span class=\"number\">0.7</span><span class=\"punctuation\">,</span>color <span class=\"operator\">=</span> <span class=\"string\">&quot;black&quot;</span><span class=\"punctuation\">,</span>lty <span class=\"operator\">=</span> <span class=\"string\">&quot;dashed&quot;</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> <span class=\"comment\">#水平阈值线</span></span><br><span class=\"line\">    geom_vline<span class=\"punctuation\">(</span>xintercept <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"operator\">-</span>log2FC<span class=\"punctuation\">,</span> log2FC<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>linewidth <span class=\"operator\">=</span> <span class=\"number\">0.7</span><span class=\"punctuation\">,</span>color <span class=\"operator\">=</span> <span class=\"string\">&quot;black&quot;</span><span class=\"punctuation\">,</span>lty <span class=\"operator\">=</span> <span class=\"string\">&quot;dashed&quot;</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> <span class=\"comment\">#垂直阈值线</span></span><br><span class=\"line\">    mytheme</span><br><span class=\"line\">p</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 分别筛选两个分组中的满足条件的基因, 此处通过阈值筛选</span></span><br><span class=\"line\">up <span class=\"operator\">&lt;-</span> filter<span class=\"punctuation\">(</span>df<span class=\"punctuation\">,</span> group <span class=\"operator\">==</span> la1<span class=\"punctuation\">)</span> <span class=\"operator\">%&gt;%</span> distinct<span class=\"punctuation\">(</span>gene<span class=\"punctuation\">,</span> .keep_all <span class=\"operator\">=</span> <span class=\"built_in\">T</span><span class=\"punctuation\">)</span> <span class=\"operator\">%&gt;%</span> filter<span class=\"punctuation\">(</span>avg_log2FC <span class=\"operator\">&gt;</span> log2FC <span class=\"operator\">&amp;</span> p_val_adj <span class=\"operator\">&lt;</span> pvalue<span class=\"punctuation\">)</span></span><br><span class=\"line\">down <span class=\"operator\">&lt;-</span> filter<span class=\"punctuation\">(</span>df<span class=\"punctuation\">,</span> group <span class=\"operator\">==</span> la2<span class=\"punctuation\">)</span> <span class=\"operator\">%&gt;%</span> distinct<span class=\"punctuation\">(</span>gene<span class=\"punctuation\">,</span> .keep_all <span class=\"operator\">=</span> <span class=\"built_in\">T</span><span class=\"punctuation\">)</span> <span class=\"operator\">%&gt;%</span> filter<span class=\"punctuation\">(</span>avg_log2FC <span class=\"operator\">&lt;</span> <span class=\"operator\">-</span>log2FC  <span class=\"operator\">&amp;</span> p_val_adj <span class=\"operator\">&lt;</span> pvalue<span class=\"punctuation\">)</span></span><br><span class=\"line\">head<span class=\"punctuation\">(</span>up<span class=\"punctuation\">)</span>;head<span class=\"punctuation\">(</span>down<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 个性化调整：对齐基因标签</span></span><br><span class=\"line\">p1 <span class=\"operator\">&lt;-</span> p <span class=\"operator\">+</span></span><br><span class=\"line\">    geom_point<span class=\"punctuation\">(</span>data <span class=\"operator\">=</span> up<span class=\"punctuation\">,</span></span><br><span class=\"line\">               aes<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> avg_log2FC <span class=\"punctuation\">,</span> y <span class=\"operator\">=</span> <span class=\"operator\">-</span>log10<span class=\"punctuation\">(</span>p_val_adj<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">               color <span class=\"operator\">=</span> <span class=\"string\">&#x27;#EB4232&#x27;</span><span class=\"punctuation\">,</span> size <span class=\"operator\">=</span> <span class=\"number\">4.5</span><span class=\"punctuation\">,</span> alpha <span class=\"operator\">=</span> <span class=\"number\">0.2</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span></span><br><span class=\"line\">    geom_text_repel<span class=\"punctuation\">(</span>data <span class=\"operator\">=</span> up<span class=\"punctuation\">,</span></span><br><span class=\"line\">                    aes<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> avg_log2FC <span class=\"punctuation\">,</span> y <span class=\"operator\">=</span> <span class=\"operator\">-</span>log10<span class=\"punctuation\">(</span>p_val_adj<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> label <span class=\"operator\">=</span> gene<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                    seed <span class=\"operator\">=</span> <span class=\"number\">233</span><span class=\"punctuation\">,</span>size <span class=\"operator\">=</span> <span class=\"number\">2.5</span><span class=\"punctuation\">,</span>color <span class=\"operator\">=</span> <span class=\"string\">&#x27;black&#x27;</span><span class=\"punctuation\">,</span>min.segment.length <span class=\"operator\">=</span> <span class=\"number\">0</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                    force <span class=\"operator\">=</span> <span class=\"number\">2</span><span class=\"punctuation\">,</span>force_pull <span class=\"operator\">=</span> <span class=\"number\">2</span><span class=\"punctuation\">,</span>box.padding <span class=\"operator\">=</span> <span class=\"number\">0.1</span><span class=\"punctuation\">,</span> max.overlaps <span class=\"operator\">=</span> <span class=\"literal\">Inf</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                    segment.linetype <span class=\"operator\">=</span> <span class=\"number\">3</span><span class=\"punctuation\">,</span> <span class=\"comment\">#线段类型,1为实线,2-6为不同类型虚线</span></span><br><span class=\"line\">                    segment.color <span class=\"operator\">=</span> <span class=\"string\">&#x27;black&#x27;</span><span class=\"punctuation\">,</span> <span class=\"comment\">#线段颜色</span></span><br><span class=\"line\">                    segment.alpha <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> <span class=\"comment\">#线段不透明度</span></span><br><span class=\"line\">                    nudge_x <span class=\"operator\">=</span> <span class=\"number\">3</span> <span class=\"operator\">-</span> up<span class=\"operator\">$</span>avg_log2FC <span class=\"punctuation\">,</span> <span class=\"comment\">#标签x轴起始位置调整</span></span><br><span class=\"line\">                    direction <span class=\"operator\">=</span> <span class=\"string\">&quot;y&quot;</span><span class=\"punctuation\">,</span> <span class=\"comment\">#按y轴调整标签位置方向，若想水平对齐则为x</span></span><br><span class=\"line\">                    hjust <span class=\"operator\">=</span> <span class=\"number\">0</span> <span class=\"comment\">#对齐标签：0右对齐，1左对齐，0.5居中</span></span><br><span class=\"line\">                    <span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">p2 <span class=\"operator\">&lt;-</span> p1 <span class=\"operator\">+</span></span><br><span class=\"line\">    geom_point<span class=\"punctuation\">(</span>data <span class=\"operator\">=</span> down<span class=\"punctuation\">,</span>aes<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> avg_log2FC <span class=\"punctuation\">,</span> y <span class=\"operator\">=</span> <span class=\"operator\">-</span>log10<span class=\"punctuation\">(</span>p_val_adj<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">               color <span class=\"operator\">=</span> <span class=\"string\">&#x27;#2DB2EB&#x27;</span><span class=\"punctuation\">,</span>size <span class=\"operator\">=</span> <span class=\"number\">4.5</span><span class=\"punctuation\">,</span> alpha <span class=\"operator\">=</span> <span class=\"number\">0.2</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span></span><br><span class=\"line\">    geom_text_repel<span class=\"punctuation\">(</span>data <span class=\"operator\">=</span> down<span class=\"punctuation\">,</span></span><br><span class=\"line\">                    aes<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> avg_log2FC <span class=\"punctuation\">,</span> y <span class=\"operator\">=</span> <span class=\"operator\">-</span>log10<span class=\"punctuation\">(</span>p_val_adj<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> label <span class=\"operator\">=</span> gene<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                    seed <span class=\"operator\">=</span> <span class=\"number\">233</span><span class=\"punctuation\">,</span>size <span class=\"operator\">=</span> <span class=\"number\">2.5</span><span class=\"punctuation\">,</span>color <span class=\"operator\">=</span> <span class=\"string\">&#x27;black&#x27;</span><span class=\"punctuation\">,</span>min.segment.length <span class=\"operator\">=</span> <span class=\"number\">0</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                    force <span class=\"operator\">=</span> <span class=\"number\">2</span><span class=\"punctuation\">,</span>force_pull <span class=\"operator\">=</span> <span class=\"number\">2</span><span class=\"punctuation\">,</span>box.padding <span class=\"operator\">=</span> <span class=\"number\">0.1</span><span class=\"punctuation\">,</span>max.overlaps <span class=\"operator\">=</span> <span class=\"literal\">Inf</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                    segment.linetype <span class=\"operator\">=</span> <span class=\"number\">3</span><span class=\"punctuation\">,</span>segment.color <span class=\"operator\">=</span> <span class=\"string\">&#x27;black&#x27;</span><span class=\"punctuation\">,</span>segment.alpha <span class=\"operator\">=</span> <span class=\"number\">0.8</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                    nudge_x <span class=\"operator\">=</span> <span class=\"operator\">-</span><span class=\"number\">3</span> <span class=\"operator\">-</span> down<span class=\"operator\">$</span>avg_log2FC <span class=\"punctuation\">,</span>direction <span class=\"operator\">=</span> <span class=\"string\">&quot;y&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                    hjust <span class=\"operator\">=</span> <span class=\"number\">1</span> <span class=\"comment\">#改为左对齐即可</span></span><br><span class=\"line\">                    <span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">ggsave<span class=\"punctuation\">(</span>filename <span class=\"operator\">=</span> paste0<span class=\"punctuation\">(</span>id<span class=\"punctuation\">,</span><span class=\"string\">&quot;_&quot;</span><span class=\"punctuation\">,</span>day<span class=\"punctuation\">,</span><span class=\"string\">&quot;.pdf&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>plot <span class=\"operator\">=</span> p2<span class=\"punctuation\">,</span>width <span class=\"operator\">=</span> <span class=\"number\">7</span><span class=\"punctuation\">,</span>height <span class=\"operator\">=</span> <span class=\"number\">5.5</span><span class=\"punctuation\">)</span></span><br></pre></td></tr></table></figure>\n","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":554,"excerpt":"<h2 id=\"差异基因画火山图\"><a class=\"markdownIt-Anchor\" href=\"#差异基因画火山图\"></a> 差异基因画火山图</h2>","more":"<figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">indir <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;/path&quot;</span></span><br><span class=\"line\">degfile <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;deg.txt&quot;</span></span><br><span class=\"line\">id <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;deg_vol&quot;</span></span><br><span class=\"line\">la1 <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;control&quot;</span> </span><br><span class=\"line\">la2 <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;case&quot;</span></span><br><span class=\"line\">day <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;230522&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>dplyr<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>ggplot2<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>ggrepel<span class=\"punctuation\">)</span></span><br><span class=\"line\">setwd<span class=\"punctuation\">(</span>indir<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 读取数据</span></span><br><span class=\"line\">df <span class=\"operator\">&lt;-</span> read.delim<span class=\"punctuation\">(</span>degfile<span class=\"punctuation\">,</span>sep<span class=\"operator\">=</span><span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">,</span>header<span class=\"operator\">=</span><span class=\"literal\">TRUE</span><span class=\"punctuation\">,</span>check.names<span class=\"operator\">=</span><span class=\"literal\">FALSE</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">df<span class=\"operator\">$</span>avg_log2FC <span class=\"operator\">&lt;-</span> ifelse<span class=\"punctuation\">(</span>df<span class=\"operator\">$</span>cluster<span class=\"operator\">==</span>la2<span class=\"punctuation\">,</span><span class=\"operator\">-</span>df<span class=\"operator\">$</span>avg_log2FC<span class=\"punctuation\">,</span>df<span class=\"operator\">$</span>avg_log2FC <span class=\"punctuation\">)</span></span><br><span class=\"line\">head<span class=\"punctuation\">(</span>df<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 阈值确定：</span></span><br><span class=\"line\">pvalue <span class=\"operator\">=</span> <span class=\"number\">0.05</span></span><br><span class=\"line\">log2FC <span class=\"operator\">=</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 根据阈值添加上下调分组标签：</span></span><br><span class=\"line\">df<span class=\"operator\">$</span>group <span class=\"operator\">&lt;-</span> case_when<span class=\"punctuation\">(</span></span><br><span class=\"line\">    df<span class=\"operator\">$</span>avg_log2FC <span class=\"operator\">&gt;</span> log2FC <span class=\"operator\">&amp;</span> df<span class=\"operator\">$</span>p_val_adj <span class=\"operator\">&lt;</span> pvalue <span class=\"operator\">&amp;</span> df<span class=\"operator\">$</span>cluster<span class=\"operator\">==</span>la1 <span class=\"operator\">~</span> la1<span class=\"punctuation\">,</span></span><br><span class=\"line\">    df<span class=\"operator\">$</span>avg_log2FC <span class=\"operator\">&lt;</span> <span class=\"operator\">-</span>log2FC <span class=\"operator\">&amp;</span> df<span class=\"operator\">$</span>p_val_adj <span class=\"operator\">&lt;</span> pvalue <span class=\"operator\">&amp;</span> df<span class=\"operator\">$</span>cluster<span class=\"operator\">==</span>la2 <span class=\"operator\">~</span> la2<span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"literal\">TRUE</span> <span class=\"operator\">~</span> <span class=\"string\">&#x27;none&#x27;</span></span><br><span class=\"line\"><span class=\"punctuation\">)</span></span><br><span class=\"line\">head<span class=\"punctuation\">(</span>df<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 转换为因子，指定绘图顺序；</span></span><br><span class=\"line\">df<span class=\"operator\">$</span><span class=\"string\">&#x27;-log10(p_val_adj)&#x27;</span> <span class=\"operator\">&lt;-</span> <span class=\"operator\">-</span>log10<span class=\"punctuation\">(</span>df<span class=\"operator\">$</span>p_val_adj<span class=\"punctuation\">)</span> <span class=\"comment\">#新增-log10p列</span></span><br><span class=\"line\">df<span class=\"operator\">$</span>group <span class=\"operator\">&lt;-</span> factor<span class=\"punctuation\">(</span>df<span class=\"operator\">$</span>group<span class=\"punctuation\">,</span> levels <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span>la1<span class=\"punctuation\">,</span>la2<span class=\"punctuation\">,</span><span class=\"string\">&quot;none&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#自定义颜色：</span></span><br><span class=\"line\">mycol <span class=\"operator\">&lt;-</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#EB4232&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#2DB2EB&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;#d8d8d8&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"comment\">#自定义主题：</span></span><br><span class=\"line\">mytheme <span class=\"operator\">&lt;-</span> theme_classic<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span></span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>axis.title <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>size <span class=\"operator\">=</span> <span class=\"number\">15</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">          axis.text <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>size <span class=\"operator\">=</span> <span class=\"number\">14</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">          legend.text <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>size <span class=\"operator\">=</span> <span class=\"number\">14</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">\t\t  plot.margin <span class=\"operator\">=</span> margin<span class=\"punctuation\">(</span><span class=\"number\">15</span><span class=\"punctuation\">,</span><span class=\"number\">5.5</span><span class=\"punctuation\">,</span><span class=\"number\">5.5</span><span class=\"punctuation\">,</span><span class=\"number\">5.5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 绘制基本图形</span></span><br><span class=\"line\">p <span class=\"operator\">&lt;-</span> ggplot<span class=\"punctuation\">(</span>data <span class=\"operator\">=</span> df<span class=\"punctuation\">,</span>aes<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> avg_log2FC<span class=\"punctuation\">,</span> y <span class=\"operator\">=</span> <span class=\"operator\">-</span>log10<span class=\"punctuation\">(</span>p_val_adj<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>color <span class=\"operator\">=</span> group<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> <span class=\"comment\">#建立映射</span></span><br><span class=\"line\">    geom_point<span class=\"punctuation\">(</span>size <span class=\"operator\">=</span> <span class=\"number\">2.2</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> <span class=\"comment\">#绘制散点</span></span><br><span class=\"line\">    scale_colour_manual<span class=\"punctuation\">(</span>name <span class=\"operator\">=</span> <span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span> values <span class=\"operator\">=</span> alpha<span class=\"punctuation\">(</span>mycol<span class=\"punctuation\">,</span> <span class=\"number\">0.7</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> <span class=\"comment\">#自定义散点颜色</span></span><br><span class=\"line\">    scale_x_continuous<span class=\"punctuation\">(</span>limits <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"operator\">-</span><span class=\"number\">5</span><span class=\"punctuation\">,</span> <span class=\"number\">5</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>breaks <span class=\"operator\">=</span> seq<span class=\"punctuation\">(</span><span class=\"operator\">-</span><span class=\"number\">5</span><span class=\"punctuation\">,</span> <span class=\"number\">5</span><span class=\"punctuation\">,</span> by <span class=\"operator\">=</span> <span class=\"number\">2</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> <span class=\"comment\">#x轴限制</span></span><br><span class=\"line\">    scale_y_continuous<span class=\"punctuation\">(</span>expand <span class=\"operator\">=</span> expansion<span class=\"punctuation\">(</span>add <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"number\">2</span><span class=\"punctuation\">,</span> <span class=\"number\">0</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>limits <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"number\">0</span><span class=\"punctuation\">,</span> <span class=\"number\">40</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                       breaks <span class=\"operator\">=</span> seq<span class=\"punctuation\">(</span><span class=\"number\">0</span><span class=\"punctuation\">,</span> <span class=\"number\">40</span><span class=\"punctuation\">,</span> by <span class=\"operator\">=</span> <span class=\"number\">10</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> <span class=\"comment\">#y轴限制</span></span><br><span class=\"line\">    geom_hline<span class=\"punctuation\">(</span>yintercept <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"operator\">-</span>log10<span class=\"punctuation\">(</span>pvalue<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>linewidth <span class=\"operator\">=</span> <span class=\"number\">0.7</span><span class=\"punctuation\">,</span>color <span class=\"operator\">=</span> <span class=\"string\">&quot;black&quot;</span><span class=\"punctuation\">,</span>lty <span class=\"operator\">=</span> <span class=\"string\">&quot;dashed&quot;</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> <span class=\"comment\">#水平阈值线</span></span><br><span class=\"line\">    geom_vline<span class=\"punctuation\">(</span>xintercept <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"operator\">-</span>log2FC<span class=\"punctuation\">,</span> log2FC<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>linewidth <span class=\"operator\">=</span> <span class=\"number\">0.7</span><span class=\"punctuation\">,</span>color <span class=\"operator\">=</span> <span class=\"string\">&quot;black&quot;</span><span class=\"punctuation\">,</span>lty <span class=\"operator\">=</span> <span class=\"string\">&quot;dashed&quot;</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span> <span class=\"comment\">#垂直阈值线</span></span><br><span class=\"line\">    mytheme</span><br><span class=\"line\">p</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 分别筛选两个分组中的满足条件的基因, 此处通过阈值筛选</span></span><br><span class=\"line\">up <span class=\"operator\">&lt;-</span> filter<span class=\"punctuation\">(</span>df<span class=\"punctuation\">,</span> group <span class=\"operator\">==</span> la1<span class=\"punctuation\">)</span> <span class=\"operator\">%&gt;%</span> distinct<span class=\"punctuation\">(</span>gene<span class=\"punctuation\">,</span> .keep_all <span class=\"operator\">=</span> <span class=\"built_in\">T</span><span class=\"punctuation\">)</span> <span class=\"operator\">%&gt;%</span> filter<span class=\"punctuation\">(</span>avg_log2FC <span class=\"operator\">&gt;</span> log2FC <span class=\"operator\">&amp;</span> p_val_adj <span class=\"operator\">&lt;</span> pvalue<span class=\"punctuation\">)</span></span><br><span class=\"line\">down <span class=\"operator\">&lt;-</span> filter<span class=\"punctuation\">(</span>df<span class=\"punctuation\">,</span> group <span class=\"operator\">==</span> la2<span class=\"punctuation\">)</span> <span class=\"operator\">%&gt;%</span> distinct<span class=\"punctuation\">(</span>gene<span class=\"punctuation\">,</span> .keep_all <span class=\"operator\">=</span> <span class=\"built_in\">T</span><span class=\"punctuation\">)</span> <span class=\"operator\">%&gt;%</span> filter<span class=\"punctuation\">(</span>avg_log2FC <span class=\"operator\">&lt;</span> <span class=\"operator\">-</span>log2FC  <span class=\"operator\">&amp;</span> p_val_adj <span class=\"operator\">&lt;</span> pvalue<span class=\"punctuation\">)</span></span><br><span class=\"line\">head<span class=\"punctuation\">(</span>up<span class=\"punctuation\">)</span>;head<span class=\"punctuation\">(</span>down<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 个性化调整：对齐基因标签</span></span><br><span class=\"line\">p1 <span class=\"operator\">&lt;-</span> p <span class=\"operator\">+</span></span><br><span class=\"line\">    geom_point<span class=\"punctuation\">(</span>data <span class=\"operator\">=</span> up<span class=\"punctuation\">,</span></span><br><span class=\"line\">               aes<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> avg_log2FC <span class=\"punctuation\">,</span> y <span class=\"operator\">=</span> <span class=\"operator\">-</span>log10<span class=\"punctuation\">(</span>p_val_adj<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">               color <span class=\"operator\">=</span> <span class=\"string\">&#x27;#EB4232&#x27;</span><span class=\"punctuation\">,</span> size <span class=\"operator\">=</span> <span class=\"number\">4.5</span><span class=\"punctuation\">,</span> alpha <span class=\"operator\">=</span> <span class=\"number\">0.2</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span></span><br><span class=\"line\">    geom_text_repel<span class=\"punctuation\">(</span>data <span class=\"operator\">=</span> up<span class=\"punctuation\">,</span></span><br><span class=\"line\">                    aes<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> avg_log2FC <span class=\"punctuation\">,</span> y <span class=\"operator\">=</span> <span class=\"operator\">-</span>log10<span class=\"punctuation\">(</span>p_val_adj<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> label <span class=\"operator\">=</span> gene<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                    seed <span class=\"operator\">=</span> <span class=\"number\">233</span><span class=\"punctuation\">,</span>size <span class=\"operator\">=</span> <span class=\"number\">2.5</span><span class=\"punctuation\">,</span>color <span class=\"operator\">=</span> <span class=\"string\">&#x27;black&#x27;</span><span class=\"punctuation\">,</span>min.segment.length <span class=\"operator\">=</span> <span class=\"number\">0</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                    force <span class=\"operator\">=</span> <span class=\"number\">2</span><span class=\"punctuation\">,</span>force_pull <span class=\"operator\">=</span> <span class=\"number\">2</span><span class=\"punctuation\">,</span>box.padding <span class=\"operator\">=</span> <span class=\"number\">0.1</span><span class=\"punctuation\">,</span> max.overlaps <span class=\"operator\">=</span> <span class=\"literal\">Inf</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                    segment.linetype <span class=\"operator\">=</span> <span class=\"number\">3</span><span class=\"punctuation\">,</span> <span class=\"comment\">#线段类型,1为实线,2-6为不同类型虚线</span></span><br><span class=\"line\">                    segment.color <span class=\"operator\">=</span> <span class=\"string\">&#x27;black&#x27;</span><span class=\"punctuation\">,</span> <span class=\"comment\">#线段颜色</span></span><br><span class=\"line\">                    segment.alpha <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> <span class=\"comment\">#线段不透明度</span></span><br><span class=\"line\">                    nudge_x <span class=\"operator\">=</span> <span class=\"number\">3</span> <span class=\"operator\">-</span> up<span class=\"operator\">$</span>avg_log2FC <span class=\"punctuation\">,</span> <span class=\"comment\">#标签x轴起始位置调整</span></span><br><span class=\"line\">                    direction <span class=\"operator\">=</span> <span class=\"string\">&quot;y&quot;</span><span class=\"punctuation\">,</span> <span class=\"comment\">#按y轴调整标签位置方向，若想水平对齐则为x</span></span><br><span class=\"line\">                    hjust <span class=\"operator\">=</span> <span class=\"number\">0</span> <span class=\"comment\">#对齐标签：0右对齐，1左对齐，0.5居中</span></span><br><span class=\"line\">                    <span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">p2 <span class=\"operator\">&lt;-</span> p1 <span class=\"operator\">+</span></span><br><span class=\"line\">    geom_point<span class=\"punctuation\">(</span>data <span class=\"operator\">=</span> down<span class=\"punctuation\">,</span>aes<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> avg_log2FC <span class=\"punctuation\">,</span> y <span class=\"operator\">=</span> <span class=\"operator\">-</span>log10<span class=\"punctuation\">(</span>p_val_adj<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">               color <span class=\"operator\">=</span> <span class=\"string\">&#x27;#2DB2EB&#x27;</span><span class=\"punctuation\">,</span>size <span class=\"operator\">=</span> <span class=\"number\">4.5</span><span class=\"punctuation\">,</span> alpha <span class=\"operator\">=</span> <span class=\"number\">0.2</span><span class=\"punctuation\">)</span> <span class=\"operator\">+</span></span><br><span class=\"line\">    geom_text_repel<span class=\"punctuation\">(</span>data <span class=\"operator\">=</span> down<span class=\"punctuation\">,</span></span><br><span class=\"line\">                    aes<span class=\"punctuation\">(</span>x <span class=\"operator\">=</span> avg_log2FC <span class=\"punctuation\">,</span> y <span class=\"operator\">=</span> <span class=\"operator\">-</span>log10<span class=\"punctuation\">(</span>p_val_adj<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> label <span class=\"operator\">=</span> gene<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                    seed <span class=\"operator\">=</span> <span class=\"number\">233</span><span class=\"punctuation\">,</span>size <span class=\"operator\">=</span> <span class=\"number\">2.5</span><span class=\"punctuation\">,</span>color <span class=\"operator\">=</span> <span class=\"string\">&#x27;black&#x27;</span><span class=\"punctuation\">,</span>min.segment.length <span class=\"operator\">=</span> <span class=\"number\">0</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                    force <span class=\"operator\">=</span> <span class=\"number\">2</span><span class=\"punctuation\">,</span>force_pull <span class=\"operator\">=</span> <span class=\"number\">2</span><span class=\"punctuation\">,</span>box.padding <span class=\"operator\">=</span> <span class=\"number\">0.1</span><span class=\"punctuation\">,</span>max.overlaps <span class=\"operator\">=</span> <span class=\"literal\">Inf</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                    segment.linetype <span class=\"operator\">=</span> <span class=\"number\">3</span><span class=\"punctuation\">,</span>segment.color <span class=\"operator\">=</span> <span class=\"string\">&#x27;black&#x27;</span><span class=\"punctuation\">,</span>segment.alpha <span class=\"operator\">=</span> <span class=\"number\">0.8</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                    nudge_x <span class=\"operator\">=</span> <span class=\"operator\">-</span><span class=\"number\">3</span> <span class=\"operator\">-</span> down<span class=\"operator\">$</span>avg_log2FC <span class=\"punctuation\">,</span>direction <span class=\"operator\">=</span> <span class=\"string\">&quot;y&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                    hjust <span class=\"operator\">=</span> <span class=\"number\">1</span> <span class=\"comment\">#改为左对齐即可</span></span><br><span class=\"line\">                    <span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\">ggsave<span class=\"punctuation\">(</span>filename <span class=\"operator\">=</span> paste0<span class=\"punctuation\">(</span>id<span class=\"punctuation\">,</span><span class=\"string\">&quot;_&quot;</span><span class=\"punctuation\">,</span>day<span class=\"punctuation\">,</span><span class=\"string\">&quot;.pdf&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>plot <span class=\"operator\">=</span> p2<span class=\"punctuation\">,</span>width <span class=\"operator\">=</span> <span class=\"number\">7</span><span class=\"punctuation\">,</span>height <span class=\"operator\">=</span> <span class=\"number\">5.5</span><span class=\"punctuation\">)</span></span><br></pre></td></tr></table></figure>"},{"title":"ATAC分析流程","abbrlink":"786e1faa","date":"2023-05-18T09:39:47.000Z","_content":"\n> 转载于网络，原文地址 [www.plob.org](https://www.plob.org/article/24719.html)\n\n### 一、基础知识\n\n#### 1. 解密表观遗传学的三个方向与测序方法\n\n*   **1. 探索染色质的开放性**（chromatin accessibility）  \n    `ATAC-seq`: Assay of Transposase Accessible Chromatin sequencing  \n    `DNase-seq`: DNase I hypersensitive sites sequencing  \n    `FAIRE-seq`: Formaldehyde-Assisted Isolation of Regulatory Elements sequencing\n*   **2. 探索转录因子的绑定与组蛋白修饰**（TF binding and histone modifications）  \n    `ChIP-seq`: Chromatin Immuno-Precipitation sequencing\n*   **3. 探索核小体占位**（nucleosome positioning and occupancy）  \n    `MNase-seq`: Micrococcal Nuclease sequencing\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632949992-700x506.png)\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632949994-700x844.png)\n\n#### 2. 名词解释\n\n*   `epigenetics`：表观遗传学。表观遗传学修饰在不改变 DNA 序列的情况下控制着基因的表达，包括染色质重塑、组蛋白修饰、DNA 甲基化和 microRNA 通路等\n*   `peaks`: 峰。常用来表示染色质的开放程度，因为是测序的 reads 落在了染色质的开放区，堆叠后被可视化的一种丰度的体现。\n\n但 peaks 到底代表什么？莫非 peaks 所在区域要么是启动子要么是增强子？再或者就是笼统定义为调控元件？（我目前的观点是，只能把他理解为酶切的位点，如果非要定义是否是特定分调控元件，只能进行后续分析。）\n\n* `THSs`: 转座酶超敏感位点（transposase hypersensitive sites）。\n\n* `CREs`: 顺式调控元件（cis-regulatory elements）。即 DNA 分子中具有转录调节功能的特异 DNA 序列。按功能特性，真核基因顺式作用元件分为启动子、增强子及沉默子。\n\n* `ACRs`: 染色质开放区域（accessible chromatin regions）。即正常或核小体被酶切裸露出来的 DNA 片段所在的区域。这篇[【NP | 2019】](https://www.nature.com/articles/s41477-019-0548-z)根据 ACRs 距离最近基因的距离将 ACRs 分为三种类型：genic (gACRs; overlapping a gene), proximal (pACRs; within 2kb of a gene) or distal (dACRs; >2 kb from a gene)，分别是跨越基因的，近端的，远端的染色质开放区。\n\n* `transposon`: 转座子。一段可以从原位上单独复制或断裂下来，环化后插入另一位点，并对其后的基因起调控作用的 DNA 序列。\n\n* `promoter`: 启动子。启动子是位于结构基因 5'端上游的 DNA 序列，能活化 RNA 聚合酶，使之与模板 DNA 准确的结合并具有转录起始的特异性。每个启动子包括至少一个转录起始点以及一个以上的功能组件（典型的如 TATA 盒子）\n\n* `proximal promoters`: 近端启动子。是 DNA 上位于基因开始之前的一个区域，在那里蛋白质和其他分子结合在一起准备读取该基因。\n\n* `enhancer`: 增强子。增强子是远离转录起始点、决定基因的时间、空间特异性表达、增强启动子转录活性的 DNA 序列，其发挥作用的方式通常与方向、距离**无关**，可位于转录起始点的上游或下游。从功能上讲，没有增强子存在，启动子通常不能表现活性；没有启动子时，增强子也无法发挥作用。根据南京大学陈迪俊老师的研究表明增强子比启动子能结合更多的转录因子 [(Nature Communications)](https://www.nature.com/articles/s41467-019-09513-2)\n\n* `TFs`: 转录因子（transcription factors）是保证目的基因以特定的强度在特定的时间与空间表达的蛋白质分子。与 RNA 聚合酶 Ⅱ 形成转录起始复合体，共同参与转录起始的过程。\n\n* `TSS`: 转录起始位点（transcription start site）。在一个典型的基因内部，排列顺序为转录起始位点 (TSS，一个碱基)- 起始密码子编码序列 (ATG)- 终止密码子编码序列 (TGA)- 转录终止位点 (TTS)，即 TSS-ATG-TGA-TTS\n\n* `histone`：组蛋白。通常含有 H1，H2A，H2B，H3，H4 等 5 种成分，其中 H1 与 H3 极度富含赖氨酸（lysine），H1 不保守，其他组蛋白的基因非常保守。除 H1 外，其他 4 种组蛋白均分别以二聚体 (共八聚体）相结合，形成核小体核心。DNA 便缠绕在核小体的核心上。而 H1 则与核小体间的 DNA 结合\n\n* `nucleosome`: 核小体。是由 DNA 和组蛋白形成的染色质基本结构单位。每个核小体由 146bp 的 DNA 缠绕组蛋白八聚体 1.75 圈形成。核小体核心颗粒之间通过 50bp 左右的连接 DNA 相连，暴露在核小体表面的 DNA 能被特定的核酸酶接近并切割\n\n* `H3K4me1`: 组蛋白 H3 上的第 4 位赖氨酸发生单甲基化（mono-methylation of H3 at lysine 4） [（NG | H3K4me1 与增强子的关系）](https://www.nature.com/articles/s41588-017-0018-3)\n\n* `H3K9ac`：组蛋白 H3 上的第 9 位赖氨酸发生乙酰化（H3 acetylation marks at lysine 9）关于 H3K4me1 与 H3K9ac 的不同，依旧可以参考这篇文献[【NP | 2019】](https://www.nature.com/articles/s41477-019-0548-z)或[【NC | 2019】](https://www.nature.com/articles/s41467-019-09513-2)\n\n* `组蛋白甲基化`：甲基化可发生在组蛋白的赖氨酸和精氨酸残基上，而且赖氨酸残基能够发生单、双、三甲基化，而精氨酸残基能够单、双甲基化，这些不同程度的甲基化极大地增加了组蛋白修饰和调节基因表达的复杂性\n\n* `组蛋白乙酰化`：四种类型的组蛋白相互作用，将细胞核里的 DNA 紧紧地包装起来。这样的紧密包装能够有效阻止酶读取 DNA 上的遗传信息。然而，乙酰基连到组蛋白上能削弱它们对 DNA 的占据。因此局部乙酰化能暴露出相应的基因，让它们更容易激活![](https://static.plob.org/wp-content/uploads/2021/09/1632949997-700x318.png)\n\n    真核生物细胞核内染色质结构\n\n### 二、基础分析\n\n### 1. 分析前的准备\n\n1.1 下载 ATAC 测序数据（或者用你自己的数据也行）\n\n*   所需软件：[Aspera Connect](https://www.ibm.com/aspera/connect/)\n*   软件安装与使用：参考[这系列文章](https://www.plob.org/tag/aspera)\n*   数据下载：项目 ID[【PRJNA480717】](https://www.ncbi.nlm.nih.gov/bioproject/PRJNA480717/)[【文章原文】](https://academic.oup.com/jxb/article/70/15/3867/5481770)，SRR 序列号如下图，下载方法和上文相同。由于数据量大，测试浪费时间，所以我在每个文件中取了 100w 条 reads，由于百度网盘太慢了，你可以去扣扣群 559758504 里面随便下载一个用于测试。\n\n```\nfastqc -t 8 -o ./ *.fastq.gz\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950000-700x238.png)\n\nimage.png\n\n1.2 下载 tair10 基因组与 gff3 注释文件\n\n```\nbwa index -p /路径/bwaIndexTair /路径/TAIR10_genome.fa\n```\n\n1.3 安装 miniconda\n\n*   由于后续分析大多数软件都是来源于 conda，因此你必须知道怎么使用。参考[【conda 的安装与使用】](https://www.plob.org/article/13100.html)\n\n1.4 所需软件安装（分析中所用到的软件都汇集于此，下文不再介绍如何下载）\n\n请先激活 conda 环境在安装！\n\n```\nconda install -c bioconda -y fastqc\nconda install -c bioconda -y trimmomatic\nconda install -c bioconda -y bwa\nconda install -c bioconda -y samtools\nconda install -c bioconda -y picard\nconda install -c bioconda -y macs2\nconda install -c bioconda -y bedtools\nconda install -c bioconda -y deeptools\nconda install -c bioconda -y homer\n\n```\n\n后续分析是使用 SRR7512044 作为测试数据，但是思路和方法都可以借鉴。\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950000-1.png)\n\n测试数据\n\n### 2. 测序质量检测\n\n*   所需软件：[FastQC](https://anaconda.org/bioconda/fastqc)[【官方网站】](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/)\n\n```\nfastqc -t 8 -o ./ *.fastq.gz\n```\n\n`-t`: 线程  \n`-o`: 存放路径，不用指定前缀，默认为. fastq.gz 前面的字段  \n`*.fastq.gz`: fastqc 可以同时接受多个 fastq.gz 文件，因此采用正则表达式【*】表示全部\n\n*   结果解读  \n    由于开始测序时不准确，因此前 15bp 左右的 ATGC 含量有波动，需要在后面截掉。而最长 reads 为 76bp，则暗示着我最后至少要保留多长的序列。  \n    一般我的计算思路是：保留的序列长度 =（最长的的 reads 长度 - 前面波动的碱基长度）× 40%\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950001-700x514.png)\n\n### 2. 测序质量检控制\n\n*   所需软件：[Trimmomatic](https://anaconda.org/bioconda/trimmomatic)[【官方网站】](https://links.jianshu.com/go?to=%255Bhttp%3A//www.usadellab.org/cms/%3Fpage%3Dtrimmomatic%255D%28http%3A//www.usadellab.org/cms/%3Fpage%3Dtrimmomatic%29)[【中文介绍】](https://www.plob.org/article/6258.html)  \n    其实这批数据已经做过质控了，如何判断的呢？QC 的为一个范围且短于提供给 NCBI 上的数据。因此我们没必要质控，但为了流程的完整性，还是假装质控一下。质控之后，还要进行质检，如此循环，直到合格。\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950001-1-700x296.png)\n\n```\n# 定义一些变量，后面修改起来方便\nfilename=SRR7512044\n \ntrimmomatic PE -threads 10 \n./${filename}_1.fastq.gz ./${filename}_2.fastq.gz \n./${filename}_1.clean.fq.gz ./${filename}_1.drop.fq.gz \n./${filename}_2.clean.fq.gz ./${filename}_2.drop.fq.gz \nHEADCROP:15 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:24\n\n```\n\n`PE`: 双端模式。需要两个输入文件，正向测序序列和反向测序序列：`sample_R1.fastq.gz`和`sample_R2.fastq.gz`；  \n以及四个输出文件：`sample_1.clean.fq.gz`和`sample_1.drop.fq.gz`；`sample_2.clean.fq.gz`和`sample_2.drop.fq.gz`  \n`-threads`: 线程数  \n`HEADCROP`: 从 reads 的开头切掉指定数量的碱基，即从 fastqc 中看的  \n`LEADING`: 从 reads 的开头切除质量值低于阈值的碱基  \n`TRAILING`: 从 reads 的末尾开始切除质量值低于阈值的碱基  \n`SLIDINGWINDOW`: 从 reads 的 5' 端开始，进行滑窗质量过滤，切掉碱基质量平均值低于阈值的滑窗  \n`MINLEN`: 如果经过剪切后 reads 的长度低于阈值则丢弃这条 reads，即上面的计算方法：（76-15）×40%≈24\n\n### 3. 建立索引与序列比对\n\n*   所需软件：[bwa](https://www.plob.org/tag/bwa) 和 [samtools](https://www.plob.org/tag/samtools)\n*   建立基因组索引。需要的时间挺长的，建议放后台。建好之后以后就可以跳过这一步了，且在经典的比对软件 STAR、hisat2、bowtie2 和 bwa-mem 中我更喜欢使用 STAR 和 bwa-mem。本次使用 bwa-mem 操作演示\n\n```\nbwa index -p /路径/bwaIndexTair /路径/TAIR10_genome.fa\n```\n\n`-p`: 索引前缀，后缀自动补充  \n`TAIR10_genome.fa`: 基因组文件\n\n*   序列比对  \n    由于 sam 文件较大，因此我们直接跳过 sam，使用 samtools 转换为排序后的 bam 文件，注意【|】不要漏掉，且排序是依据 reads 比对到基因组的位置排的\n\n```\n# 定义一些变量，后面用\nfilename=SRR7512044\nindex=/路径/bwaIndexTair\n \nbwa mem -M -t 8 \n-R \"@RGtID:${filename}tSM:${filename}tLB:WXStPL:Illumina\" \n$index \n${filename}_1.clean.fq.gz \n${filename}_2.clean.fq.gz \n| samtools sort -O bam -@ 10 -o ./${filename}.raw.bam\n#无论干啥，生成bam文件后就要建立bam索引，并检查比对情况\nsamtools index -@ 10 -b ./${filename}.raw.bam\nsamtools flagstat ./${filename}.raw.bam > ./${filename}.raw.stat\ncat ${filename}.raw.stat\n\n```\n\n`-M`: 将 shorter split hits 标记为次优，以兼容 Picard’s markDuplicates 软件  \n`-R`: STR 完整的 read group 的头部，可以用't' 作为分隔符， 在输出的 SAM 文件中被解释为制表符 TAB. read group 的 ID，会被添加到输出文件的每一个 read 的头部，  \n`-O`: 表示输出的 bam 文件  \n`-o`: 输出的 bam 文件名  \n`-t`与`@`: 线程数\n\n*   关于 stat 中内容的解释如下\n\n```\n14608455   0 in total (QC-passed reads   QC-failed reads) reads总数\n37967   0 secondary                                       出现比对到参考基因组多个位置的reads数\n0   0 supplementary                                       可能存在嵌合的reads数\n0   0 duplicates                                          重复的reads数\n14590894   0 mapped (99.88% : N/A)                        比对到参考基因组上的reads数\n14570488   0 paired in sequencing                         属于PE read的reads总数。\n7285244   0 read1                                         PE read中Read 1 的reads 总数。\n7285244   0 read2                                         PE read中Read 2 的reads 总数。\n14507068   0 properly paired (99.56% : N/A)               完美比对的reads总数。PE两端reads比对到同一条序列，且根据比对结果推断的插入片段大小符合设置的阈值。\n14551500   0 with itself and mate mapped                  PE两端reads都比对上参考序列的reads总数。\n1427   0 singletons (0.01% : N/A)                         PE两端reads，其中一端比上，另一端没比上的reads总数。\n26260   0 with mate mapped to a different chr             PE read中，两端分别比对到两条不同的序列的reads总数。\n17346   0 with mate mapped to a different chr (mapQ>=5)   PE read中，两端分别比对到两条不同\n\n```\n\n### 4. 去除 PCR 重复并再次进行质控\n\n*   所需软件：picard 与 [samtools](https://www.plob.org/tag/samtools)  \n    不建议使用 sambamba，虽然快，但是毛病多，尤其是在你不知情的情况下，软件卡死或者在最后输出文件时提示输出文件夹过多等。\n\n```\npicard MarkDuplicates \nREMOVE_DUPLICATES=true \nI=${filename}.raw.bam \nO=${filename}.rmdup.bam \nM=${filename}.rmdup.log\n# 实时监测我们的数据发生了什么变化\nsamtools index ${filename}.rmdup.bam\nsamtools flagstat ${filename}.rmdup.bam > ./${filename}.rmdup.stat\n\n```\n\n`REMOVE_DUPLICATES=true`: 表示将检测出的 PCR duplication 直接去除；  \n`I`: 或者 INPUT 指定输入的 bam 文件；  \n`O`: 或者 OUTPUT 指定输出去除 PCR duplication 的 bam 文件；  \n`M`: 或者 METRICS_FILE 指定输出的 matrix log 文件。\n\n*   下面是再次进行质控\n\n```\nsamtools view -h -f 2 -q 30 ${filename}.rmdup.bam \n| grep -v -e \"mitochondria\" -e \"*\" -e \"chloroplast\" \n| samtools sort -O bam -@ 10 -o - > ${filename}.last.bam\n# 实时监测我们的数据发生了什么变化\nsamtools index ${filename}.last.bam\nsamtools flagstat ${filename}.last.bam > ./${filename}.last.stat\n\n```\n\n`-h`: 输出的 sam 文件带 header，默认不带  \n`-f`: 输出含有所有 flag 的 reads  \n`-q` 比对的最低质量值，一般 20/30 都可以  \n其他参数介绍看 [samtools 使用简述](https://www.plob.org/tag/samtools)，需要说明的是由于比对到线粒体和叶绿体的 reads 不是我们关注的重点，因此使用`grep`剔除掉，当然了，做动物的话需要剔除什么视情况而定了。\n\n*   好了，下面来看看我们的数据从 raw data -> rmdup -> last 到底发生了那些变化![](https://static.plob.org/wp-content/uploads/2021/09/1632950002-700x344.png)\n*   然后，从 IGV 看看发生了什么变化  \n    关于使用 IGV 查看 bam 文件中 reads 呈现不同颜色的说明\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950005-700x773.png)\n\n### 5. 统计过滤后的结果中 Insertsize 长度分布\n\n*   所需软件：picard  \n    Insertsize =（read2 的比对位点 - read1 的比对位点） read2 的长度。也可以随便点击上图 IGV 中任一一条 reads 查看插入片段的大小\n\n```\npicard CollectInsertSizeMetrics \nI=./${filename}.last.bam \nO=./${filename}.last.insertsize \nH=./${filename}.last.hist.pdf\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950006-700x683.png)\n\n### 5. peak calling 与 FRiP_score/SPOT_score 的计算\n\n*   所需软件：[macs2](https://www.plob.org/article/7118.html) 和 [bedtools](https://www.plob.org/tag/bedtools)  \n    因为 macs2 需要用到基因组的有效大小，而软件本身就提供了 4 个物种的有效基因组大小。\n\n```\neffective_genome_size=119481543\n \nbedtools bamtobed -i ${filename}.last.bam > ${filename}.last.bed\nmacs2 callpeak \n-t ${filename}.last.bed \n-g ${effective_genome_size} \n--nomodel --shift -100 --extsize 200 \n-n ${filename}.last \n-q 0.01 --outdir ./peaks\n\n```\n\n*   其实，这里面讨论最多的是`--nomodel --shift -100 --extsize 200`这些参数如何选择，下面的图很形象的展示了参数的作用。当然，我也是查阅了很多资料与文献，一般默认在`ATAC-seq，DNase-seq，FAIRE-seq`的时候将`shift`设置为`extsize`的一半，且参数固定为：`--nomodel --shift 100 --extsize 200`。而在`MNase-seq`的时候，参数固定为：`--nomodel --shift 37 --extsize 73`。在`ChiP-seq`的时候不用移峰，所以只使用`-nomodel`，当做组蛋白修饰的时候，由于 peak 并[不典型](http://blog.sina.com.cn/s/blog_4bc742520102uy64.html)，所以使用`–nomodel –shift 73`参数。另外如何使用`macs2 predictd`预测双峰模型，这里就不展开介绍了，可以私聊我，我把脚本发你。\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950007.png)\n\nshift 与 extsize 到底在干啥？\n\n*   下面是我见过的图中解释**移峰**现象最清楚的了，可以参考\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950007-1-700x503.png)\n\n移峰\n\n*   最后，就是输出文件的解读\n    1.  **${filename}_peaks.xls**\n\n```\n前几行是callpeak时的命令。后面是：\n1.染色体号\n2.peak起始位点\n3.peak结束位点\n4.peak区域长度\n5.peak的峰值位点（summit position）\n6.peak 峰值的高度（pileup height at peak summit, -log10(pvalue) for the peak summit）\n7.peak的富集倍数（相对于random Poisson distribution with local lambda）\n\n```\n\n*   2.  **${filename}_peaks.narrowPeak**\n\n```\nnarrowPeak文件是BED6 4格式，可以上传到IGV查看\n1.染色体号\n2.peak起始位点\n3.peak结束位点\n4.peak name（样本名 _peak_1的后缀之类的）\n5.-10*log10qvalue\n6.正负链\n7.fold change\n8.-log10pvalue\n9.-log10qvalue\n10.相对于峰的峰顶位置（relative summit position to peak start）\n\n```\n\n*   注意：excel 里的起始坐标需要减 1 才与 narrowPeak 的坐标一致，见下图。\n    3.  **${filename}_summits.bed**\n\n```\nBED格式的文件，包含peak的summits（峰顶）位置\n1.染色体号\n2.峰的峰顶起始位点（注意是峰顶，不是峰，他只是一个点）\n3.峰的峰顶起始位点（因此二者就差一个碱基的位置）\n4.峰顶（样本名 _peak_1的后缀之类的）\n5.-log10pvalue\n\n```\n\n* 注意：excel 里的起始坐标需要减 1 才与 narrowPeak 的坐标一致，见下图。\n\n* **另外，需要告诉你的是，bed 文件中第 2 列中的峰顶起始位点是如何计算的？**  \n    bed 文件中第 2 列（峰的峰顶起始位点） = xls 第二列 xls 第十列 -1。或者↓↓↓↓  \n    bed 文件中第 2 列（峰的峰顶起始位点） = narrowPeak 第二列 narrowPeak 第十列\n\n* 总览比较：![](https://static.plob.org/wp-content/uploads/2021/09/1632950008-700x407.png)\n\n    bed，narrowPeak，bdg，xls 四种类型输出文件的比较\n\n* FRiP_score 的计算[【官方介绍】](https://www.encodeproject.org/atac-seq/)  \n    简单来说，FRiP_score 说的就是统计落在 Peaks 里面的 reads 数量与所有比对到基因组上 reads 数量的比值。可以作为判定样本测序质量的一个指标。\n\n```\nReads=$(bedtools intersect -a ${filename}.last.bed -b ${filename}_peaks.narrowPeak |wc -l|awk '{print $1}')\ntotalReads=$(wc -l ${filename}.last.bed|awk '{print $1}') \necho ${Reads} ${totalReads} ${filename} 'FRiP_score:' $(echo \"scale=2;100*${Reads}/${totalReads}\"|bc)'%'\n\n```\n\n*   官网上说 ATAC-Seq 的 FRiP score should be >30%（[https://www.encodeproject.org/atac-seq/](https://www.encodeproject.org/atac-seq/)）我猜是如果大多数 reads 都不在 peaks 区域，说明测序质量或者实验效果不是太好，因为酶切切开的就是 peaks 区域，太少不是就偏离实验目的了嘛\n*   SPOT_score 的计算[【官方介绍】](https://www.encodeproject.org/data-standards/terms/)[【软件安装】](https://www.encodeproject.org/software/hotspot/)  \n    简单来说，SPOT_score 就是在 FRiP_score 的基础上增加了测序深度的条件限制，比如 FRiP 是统计全局的 reads，而 SPOT 只统计测序深度为 30× 的 reads，大于 30× 的 reads 不再参与统计。目前我还在探索中如何计算。\n\n### 二、高级分析\n\n所谓的高级并不高大上，做了有可能也不能让你的文章提升档次，望周知！\n\n### 1. IGV 可视化\n\n*   前面的 bam 文件，narrowPeak 文件，bed 文件都有了，现在还差一个 bw 文件，因此我们先跑下面的代码，然后在 IGV 里面统一看一下\n*   所需软件：[deeptools](https://anaconda.org/bioconda/deeptools) 和 [IGV](https://software.broadinstitute.org/software/igv/download)  \n    主要是为生成 bw 文件用于 IGV 展示\n\n```\nbamCoverage --bam ${filename}.last.bam -o ${filename}.last.bw \n    --binSize 10 \n    --normalizeUsing RPGC \n    --effectiveGenomeSize ${effective_genome_size} \n    --ignoreForNormalization chrX \n    --extendReads\n\n```\n\n注：如果发现没有这个包 pysam.libchtslib，直接安装`pip install numpydoc`  \n`-o`: 生成 bw 文件  \n`binSize`: 自行设定覆盖度计算的窗口大小 (bin)  \n`normalizeUsing`: 数据准化方法，有三种 RPGC，RPKM，CPM，BPM  \n`ignoreForNormalization`: 设置你想忽略的染色体名称  \n`extendReads`: 让 reads 扩展至 fragment 的大小\n\n*   IGV 一览\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950009-700x436.png)\n\nIGV 可视化 bw、narrowpeak，bed，bam，gff 文件\n\n### 2. TSS/TES 可视化\n\n* 所需软件：[deeptools](https://anaconda.org/bioconda/deeptools)  \n    主要是如何生成 [Refseq 文件](http://www.bio-info-trainee.com/2494.html)，虽然官网上提供了一些，但总归是不能覆盖所有物种，因此，我们可以从 gff/gtf 文件中自己创造。\n\n* 先提取**基因**的位置信息（不是 cds 或者 exon），根据不同的 gff 进行修改，但格式始终是`` `chrom/chromStart/chromEnd/name/score/strand` ``\n\n    ```\n    awk -vFS='[\\t=;]' -vOFS=\"\\t\" \\\n    '{if ($3==\"gene\") print $1,$4,$5,$10,$6,$7}' \\\n    TAIR10.gff|sed 's/Chr//g' > refseq.bed  \n    #由于tair官网上提供的基因组文件中染色人命名没有Chr，为保持一致，这里去掉\n    \n    ```\n\n* 然后进行 TSS 可视化\n\n```\ncomputeMatrix reference-point --referencePoint TSS  -p 15 \n    -b 2000 -a 2000 \n    -R ./refseq.bed \n    -S *.bw \n    -o TSS.gz \n    --skipZeros \n    --outFileSortedRegions Heatmap1sortedRegions.bed\nplotHeatmap -m TSS.gz -out TSS.Heatmap.pdf --plotFileFormat pdf\nplotProfile -m TSS.gz -out TSS.Profile.pdf --plotFileFormat pdf --perGroup\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950010-700x629.png)\n\n*   然后进行 TES 可视化\n\n```\ncomputeMatrix scale-regions  -p 15  \n    -b 2000 -a 2000 \n    -R ./refseq.bed \n    -S *.bw \n    --skipZeros -o body.gz\nplotHeatmap -m body.gz -out body.Heatmap.pdf --plotFileFormat pdf\nplotProfile -m body.gz -out body.Profile.pdf --plotFileFormat pdf --perGroup\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950011-700x630.png)\n\n*   另外，参考下面这个图，看每个参数控制的哪里，如何同时绘制多个等。这是我好久之前总结的，清晰度堪忧\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950013-700x649.png)\n\n### 3. 相关性可视化（依旧是使用 deeptools）\n\n*   因为我测试样本少，所以就使用[官网的图](https://deeptools.readthedocs.io/en/latest/content/tools/plotCorrelation.html)了哈，但代码是能跑通的，放心使用。\n*   先使用 [bw] 文件生成 [npz] 文件。所有样本做相关性，用 [*.last.bw]，多个单列出来也行\n\n```\nmultiBigwigSummary bins -b *.last.bw -o number.of.bins.npz\n\n```\n\n*   画相关性热图\n\n```\nplotCorrelation -in number.of.bins.npz \n--corMethod pearson \n--skipZeros \n--plotTitle \"Pearson Correlation of Average Scores Per Transcript\" \n--plotFileFormat pdf \n--whatToPlot heatmap --colorMap RdYlBu --plotNumbers \n-o heatmap_PearsonCorr_bigwigScores.pdf \n--outFileCorMatrix PearsonCorr_bigwigScores.tab\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950014-700x605.png)\n\nheatmap\n\n*   画相关性点图\n\n```\nplotCorrelation -in number.of.bins.npz \n--corMethod pearson \n--skipZeros \n--plotTitle \"Pearson Correlation of Average Scores Per Transcript\" \n--plotFileFormat pdf \n--whatToPlot scatterplot \n-o scatterplot_PearsonCorr_bigwigScores.pdf \n--outFileCorMatrix PearsonCorr_bigwigScores.tab\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950015-700x734.png)\n\n相关性点图\n\n### 5. ChIPseeker 对 peaks 进行注释和可视化\n\n*   对 peak 的注释分为两个部分——结构注释和功能注释  \n    结构注释会将 peak 所落在基因组上的区域结构注释出来，比如说启动子区域，UTR 区域，内含子区域等等。同时，也会将与 peak 最临近的基因注释出来，非常好用。  \n    功能注释其实并不是对 peak 进行注释的，而是对 peak 最临近的基因注释的，因此这部分就和传统的 GO/KEGG 等分析如出一辙啦。\n\n#### **5.1 结构注释**\n\n5.1.1 **准备工作**：导入包，没有的安装吧。另外需要使用 gff/gtf 构建一个 TxDb。因为[官网](http://www.bioconductor.org/packages/release/BiocViews.html%23___TxDb)上 TxDb 也不是每一个物种都有（目前共 43 个），因此我们自己手动构建。\n\n```\n#if (!requireNamespace(\"BiocManager\", quietly = TRUE))\n#    install.packages(\"BiocManager\")\n#BiocManager::install(\"clusterProfiler\")\n \nlibrary(clusterProfiler)\nlibrary(ChIPseeker)\nlibrary(GenomicFeatures)\ntxdb <- makeTxDbFromGFF(\"public/bioinfoYu/genome/tair10/TAIR10.gff\",\n                        format=\"gff\")    #也可以使用gtf\nkeytypes(txdb)    #感兴趣的话，可以用以下方法探索txdb都包含了什么内容\nkeys(txdb)\n\n```\n\n5.1.2 **单个文件的结构注释**（不推荐在这一步加 OrgDB 的内容，没用）\n\n```\n#读入单个summits文件\npeaks <- readPeakFile(\"SRR7512044_summits.bed\")\n#结构注释\npeakAnno <- annotatePeak(peaks,\n                         TxDb=txdb,\n                         tssRegion=c(-1000, 1000))\n\n```\n\n上面的 tssRegion 取值有说法的，因为判定 \"Promoter\", \"Exon\", \"Intron\", \"Intergenic\" 等结构的依据就是根据范围来的。比如定义 1000 以内的，则在 1kbp 之内规定为 \"Promoter (<=1kb)\"，而 1k-2k 内定义为 \"Downstream (1-2kb)\"。但你定义 2000 以内呢，则在 1kbp 之内规定为 \"Promoter (<=1kb)\"，而 1k-2k 内定义为 \"Promoter (1-2kb)\"。虽然，ChIPseeker 会标记出来区域，但还是三思后再取范围。\n\n```\n#注释完，进行可视化，多种图可供选择\nplotAnnoBar(peakAnno)\nplotDistToTSS(peakAnno)\nvennpie(peakAnno)\nplotAnnoPie(peakAnno)\n#install.packages(\"ggupset\")\nlibrary(ggupset)\nupsetplot(peakAnno)\n#install.packages(\"ggimage\")\nlibrary(ggimage)\nupsetplot(peakAnno, vennpie=TRUE)\n \n#最后将我们的注释结果转为数据框，便于查看\ndf <- as.data.frame(peakAnno)\n#将注释到的基因提取出来（第14列），用于后续功能分析\ngene <- df[,14]\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950016-700x323.png)\n\n提供可视化的方法\n\n5.1.3 **多个文件的结构注释**\n\n```\n#一次也可以读入多个summits文件，使用list存储，然后使用lapply注释\nfiles = list(peak1 = \"peaks.bed\", peak2 = (\"peak.bed\"))\npeakAnnoList <- lapply(files, \n                       annotatePeak,\n                       TxDb=txdb,\n                       tssRegion=c(-2000, 2000))\nplotAnnoBar(peakAnnoList)\nplotDistToTSS(peakAnnoList)\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950019-700x220.png)\n\n读入多个 summits 文件的可视化\n\n#### **5.2 功能注释**\n\n5.2.1 **可选支线**  \n由于这里需要物种的 OrgDb 注释库。如果你足够幸运，研究的物种正好在[官网](http://www.bioconductor.org/packages/release/BiocViews.html%23___OrgDb)仅提供的 20 个物种中存在，那就拿来用吧。除了以上这些都好说，还有是 id 转换，后面再说。  \n5.2.2 **OrgDb 下载**  \n本次测试是用拟南芥的样本，我推荐在[官网](http://www.bioconductor.org/packages/release/BiocViews.html%23___OrgDb)中直接将所需要的的 OrgDb 库下载到服务器上，这样就不用在 R 里面重复在网上获取浪费时间了。比如说拟南芥，就可以下载，这样就把【org.At.tair.db】下载到了服务器或者本地了。\n\n```\nwget http://www.bioconductor.org/packages/release/data/annotation/src/contrib/org.At.tair.db_3.13.0.tar.gz\ntar -zvxf org.At.tair.db_3.13.0.tar.gz\n\n```\n\n5.2.3 **导入 OrgDb**\n\n```\n#从本地下载OrgDb库（如果你直接下载到了R的lib里面，就直接library也可）\ninstall.packages(\"/public/bioinfoYu/genome/tair10/org.At.tair.db\", repos=NULL)\n#另外一种方法\n#if (!requireNamespace(\"BiocManager\", quietly = TRUE))install.packages(\"BiocManager\")\n#BiocManager::install(\"org.At.tair.db\")\n#载入库\nlibrary(org.At.tair.db)\n#感兴趣的话，看看org.At.tair.db包含的都是些啥\n#查看包含的列名\nkeytypes(org.At.tair.db)\n#查看包含的基因ID\nkeys(org.At.tair.db)\n#随便选择一个基因和一些列名，看一看到第是什么东东，不过因为导入了其他包，下面命令报错，我至今还没有解决\nselect(org.At.tair.db,keys=\"AT1G01010\",columns = c(\"ENTREZID\",\"GO\",\"SYMBOL\"))\n\n```\n\n5.2.4 **ID 转换**（非必须）  \n上面`5.1.2`已经得到 peak 附近的基因集【gene】了，如果需要 ID 转换，就是用`clusterProfiler`中的`bitr`函数\n\n```\n#首先，去除版本号，如AT1G50040.1后面的.1，当然我们的测试集没有，因此不用做\n#gene_rm <- gsub(\".[0-9] $\",\"\",gene)\n#下面进行ID转换\nkeytypes(org.At.tair.db)\ngene_last <- bitr(geneID = gene, \n                    fromType = \"TAIR\",\n                    toType = c(\"ENTREZID\", \"SYMBOL\", \"GENENAME\"),\n                    OrgDb = org.At.tair.db)\n \n# geneID    需要转换的ID\n# fromType  当前ID类型\n# toType    转换成什么ID，使用keytypes()查看有哪些类型\n# OrgDb     注释数据库\n\n```\n\n5.2.5 **GO 功能注释**\n\n```\n# 因为keyType不接受数据框类型的数据，因此我们转换为字符型\ngenelist <- gene.symbol[,2]  #注意我这里把ENTREZID单独拿出来了，所以下面自然是keyType = \"ENTREZID\",\ngo_result <- enrichGO(genelist,\n                      keyType = \"ENTREZID\", \n                      OrgDb = org.At.tair.db, \n                      ont = \"BP\", #BP,MF,CC,ALL可选\n                      pAdjustMethod = \"BH\", \n                      qvalueCutoff = 0.05, \n                      readable = FALSE)\n#可视化，showCategory=20调整显示的条目多少\ndotplot(go_result, showCategory=20)\n#将结果转为数据框，可以选择导出\ngoresult <- as.data.frame(go_result)\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950021-700x685.png)\n\nGO 可视化\n\n5.2.6 **KEGG 通路注释**\n\n```\n#geneClusters必须是数据框类型，ID必须是ENTREZID类型\nclass(gene.symbol)\ncompKEGG <- compareCluster(geneClusters=gene.symbol, \n                           fun = \"enrichKEGG\",\n                           organism = \"ath\",    #在 http://www.genome.jp/kegg/catalog/org_list.html 上查看物种简写\n                           pvalueCutoff  = 0.05, \n                           pAdjustMethod = \"BH\")\ndotplot(compKEGG, showCategory = 20, title = \"KEGG Pathway Enrichment Analysis\")\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950022-700x342.png)\n\nKEGG 可视化\n\n### 6. homer 寻找 motif\n\n*   所需软件：[homer](https://anaconda.org/bioconda/homer)[【官方网站】](http://homer.ucsd.edu/homer/)\n\n```\n# 提取peaks的位置信息文件\nawk '{print $4\"t\"$1\"t\"$2\"t\"$3\"t \"}' \nSRR7512044_peaks.narrowPeak > SRR7512044.homer_peaks.tmp\n# 寻找motif\nfindMotifsGenome.pl SRR7512044.homer_peaks.tmp \n./TAIR10_genome.fa   #指定参考基因组\n./SRR7512044.motif   #输出文件夹的名字\n-size 200 -len 8,10,12\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950023-700x261.png)\n\n### 7. DiffBind 找差异 peak\n\n*   所需软件：[DiffBind](http://www.bioconductor.org/packages/release/bioc/html/DiffBind.html)\n\n首先根据我自己的理解将**找差异 peak 的原理**说一下：既然是找差异的 peak，那首先就要保证不同样本间 peak 所在的区间基本一致才可以。因此**第一步**就是找到多个样本相同的 peak 区间。**第二步**，基于这些相同区域的 peak 开始找差异，这个地方的差异和传统的 RNA-Seq 找差异基因的原理一模一样，都是**对落在峰区间的 reads 进行计数**，数量不同的话差异就由此而来。但软件都帮我们做了，就不用考虑那么多了\n\n*   我废话真多，其实最麻烦的就是**准备输入数据**，下面来看怎么做  \n    一般情况相下需要包括以下几列：`\"SampleID\"， \"Tissue\"， \"Factor\"， \"Condition\" ，\"Treatment\"，\"Replicate\"， \"bamReads\" ，\"ControlID\" ，\"bamControl\" ，\"Peaks\"和\"PeakCaller\"`\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950025-700x148.png)\n\n*   但我们做 ATAC-Seq 的哪里有什么`control，controlID，bamControl`，因此删掉，而`\"Tissue\"， \"Factor\"， \"Condition\" ，\"Treatment\"，\"Replicate\"，`表示的都是分组的意思，因此我保留了两个`\"Factor\"，\"Replicate\"`，最后 csv 文件的样子如下：![](https://static.plob.org/wp-content/uploads/2021/09/1632950026-700x127.png)\n\n`SampleID`：不能有重复  \n`Factor`：进行分组，后面要做差异分析的依据  \n`Replicate`：重复的编号  \n`bamReads`：最后生成的 bam 文件。全路径 bam 文件名  \n`Peaks`：macs2 生成的 narrowPeak 文件。全路径 narrowPeak 文件名  \n`PeakCaller`：说明 peak 类型，使用 narrowPeak 文件则为`narrow`。使用 xls 文件，则用`macs`。使用 bed 文件，则用`bed`\n\n*   开始正题\n\n```\n# 安装包\nif (!requireNamespace(\"BiocManager\", quietly = TRUE))install.packages(\"BiocManager\")\nBiocManager::install(\"DiffBind\")\nlibrary(DiffBind)\n#导入数据，dba函数会将会将bam文件一同导入，因此csv中的路径一定要准确\ntamoxifen <- dba(sampleSheet=\"atDiff.csv\")\n#查看样本间的相关性\nplot(tamoxifen)\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950027.png)\n\n```\n#计算每个样本中的reads数\ntamoxifen <- dba.count(tamoxifen)\n#简单查看计算结果\ninfo <- dba.show(tamoxifen)\nlibsizes <- cbind(LibReads=info$Reads, FRiP=info$FRiP, PeakReads=round(info$Reads * info$FRiP))\nrownames(libsizes) <- info$ID\nlibsizes\n\n```\n\n```\n#统计结果\n       LibReads FRiP PeakReads\ncmt2_1  6720462 0.29   1948934\ncmt2_2  7747491 0.33   2556672\nwild_1  7078309 0.36   2548191\nwild_2  8030752 0.34   2730456\nddcc_1  6370232 0.30   1911069\nddcc_2  6956429 0.35   2434750\n\n```\n\n<pre\"># 默认基于测序深度对数据进行标椎化 tamoxifen <- dba.normalize(tamoxifen) norm <- dba.normalize(tamoxifen, bRetrieve=TRUE) norm #查看进行标准化的文库大小 (library-size)，其实就是各样本文库大小总和的平均值，你可以计算验证一下 normlibs <- cbind(FullLibSize=norm$lib.sizes, NormFacs=norm$norm.factors, NormLibSize=round(norm$lib.sizes/norm$norm.factors)) rownames(normlibs) <- info$ID normlibs\n\n```\n#标椎化结果\n       FullLibSize  NormFacs NormLibSize\ncmt2_1     6720462 0.9398443     7150612\ncmt2_2     7747491 1.0834724     7150612\nwild_1     7078309 0.9898885     7150612\nwild_2     8030752 1.1230859     7150612\nddcc_1     6370232 0.8908652     7150612\nddcc_2     6956429 0.9728438     7150612\n\n```\n\n```\n#分组，格式是表头在最前面，要分的组依次写在后面，只能两两比较，因此后面只能写两组，但可以多执行几次，都会追加到tamoxifen 中\n#分组1，后面使用contrast=1单独查看\ntamoxifen <- dba.contrast(tamoxifen, contrast=c(\"Factor\",\"ddcc\",\"wild\"))\n#分组2，后面使用contrast=2单独查看\ntamoxifen <- dba.contrast(tamoxifen, contrast=c(\"Factor\",\"cmt2\",\"wild\"))\n#当然还可有分组3,4,5等，均可以使用contrast=number单独查看\ntamoxifen\n#按照分组分别进行差异分析，默认使用DESeq2进行计算，可以选择method = DBA_EDGER(edgR)，或者两个都要method = DBA_ALL_METHODS\ntamoxifen <- dba.analyze(tamoxifen)\ndba.show(tamoxifen, bContrasts=TRUE)\n#查看差异分析的结果与导出为csv文件\n#查看第1组差异分析的结果\ntamoxifen.DB_1 <- dba.report(tamoxifen,contrast=1)\ntamoxifen.DB_1\nwrite.csv(tamoxifen.DB_1, file=\"diffBind_result.csv\")\n \n#查看第2组差异分析的结果\ntamoxifen.DB_2 <- dba.report(tamoxifen,contrast=2) tamoxifen.DB_2 write.csv(tamoxifen.DB_2, file=\"diffBind_result.csv\") ##传统的上下调在找差异peak中称为“Gain”或“Loss” #查看第1组的差异peak数量“Fold>0或<0”控制是“Gain”或“Loss” sum(tamoxifen.DB$Fold>0,contrast=1)\nsum(tamoxifen.DB$Fold<0,contrast=1) #查看第2组的差异peak数量“Fold>0或<0”控制是“Gain”或“Loss” sum(tamoxifen.DB$Fold>0,contrast=2)\nsum(tamoxifen.DB$Fold<0,contrast=2)\n\n```\n\n*   由于我是使用两组进行测试的，所以可以使用 contrast=1 或 contrast=2 分别查看，由于都是相同的代码，下面进行可视化的时候，**只选择 contrast=1 进行可视化**\n\n```\n#韦恩图可视化\ndba.plotVenn(tamoxifen, contrast=1, bDB=TRUE, bGain=TRUE, bLoss=TRUE, bAll=FALSE)\n \n#PCA\ndba.plotPCA(tamoxifen) #这里可以使用所有样本进行PCA\ndba.plotPCA(tamoxifen, contrast=1, label=DBA_FACTOR)#单独对分组1进行PCA\n \n#MA plots\ndba.plotMA(tamoxifen, contrast=1)\n \n#Volcano plots\ndba.plotVolcano(tamoxifen, contrast=1)\n \n#Box plots\ndba.plotBox(tamoxifen, contrast=1)\n \n#Heatmap\nhmap <- colorRampPalette(c(\"red\", \"black\", \"green\"))(n = 13)\n#对所有样本的所有的差异peak画热图\ndba.plotHeatmap(tamoxifen,correlations=FALSE,scale=\"row\",colScheme = hmap)\n#单独对分组1中所有的差异peak画热图\ndba.plotHeatmap(tamoxifen, contrast=1, correlations=FALSE, scale=\"row\", colScheme = hmap)\ndba.plotHeatmap(tamoxifen,correlations=FALSE,scale=\"row\",colScheme = hmap)\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950027-1-700x349.png)\n\n*   想画下面的图，可是一直提示 could not find function dba.plotProfile，因此还没有成功，用官方提供的图展示一下吧，大家能画出来可以和我说一声哦。这是[【官方文档】](https://content.cruk.cam.ac.uk/bioinformatics/software/DiffBind/plotProfileDemo.html)可以参考\n\n```\n#Profiling and Profile Heatmaps\ndba.plotProfile(tamoxifen)\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950029-700x643.png)\n\n### 8. footprint 分析\n\n目前我还没有找到使用于所有物种的软件，HINT-ATAC 用来做 footprint 分析的话，应该只支持不几个物种，比较鸡肋。[ATACseqQC](https://bioconductor.org/packages/release/bioc/manuals/ATACseqQC/man/ATACseqQC.pdf) 应该是一款不错的软件，最近还在探索\n\n### 三、ATAC-seq 与多组学数据联合分析\n\n**转录因子 ChIP-seq**：由于大部分转录因子结合的是染色质开放区域，所以 ATAC-seq 的 Peak 可能和转录因子 ChIP-seq 的 Peak 存在部分重叠的情况，而且 ATAC-seq 得到的 Peak 长度往往更长，因此 ATAC-seq 数据和转录因子 ChIP-seq 数据可以相互验证。转录因子在 ChIP-seq 中独有的 Peak 暗示这个转录因子可能是结合在异染色质区域的驱动型转录因子（Pioneer TFs），驱动型转录因子随后招募染色质重塑复合体以及其它转录因子开始转录。另外，联合分析已经报道的 ChIP-seq 数据可以更准确地分析转录因子的足迹。  \n**组蛋白修饰 ChIP-seq**：ATAC-seq 数据同样可以和组蛋白修饰 ChIP-seq 数据进行联合分析，其中转录激活性修饰（H3K4me3，H3K4me1 和 H3K27ac 等）与染色质开放程度呈正相关，转录抑制性修饰（H3K27me3）与染色质开放程度呈负相关。联合已知的增强子和启动子之间的相互作用数据也可以帮助构建调控网络。  \n**RNA-seq**：ATAC-seq 数据可以通过联合分析 RNA-seq 数据来发现哪些差异表达的基因是受染色质可及性调控的，进一步可以推测这些差异表达的基因哪些是受开放染色质中具有 motif 和 footprint 的转录因子调控的，因此 ATAC-seq 与 RNA-seq 的联合分析有助于破译基因调控网络和细胞异质性。\n","source":"_posts/ATAC分析流程.md","raw":"---\ntitle: ATAC分析流程\ncategories:\n  - notes\n  - ATAC\ntags:\n  - note\n  - ATAC\n  - pipeline\nabbrlink: 786e1faa\ndate: 2023-05-18 17:39:47\n---\n\n> 转载于网络，原文地址 [www.plob.org](https://www.plob.org/article/24719.html)\n\n### 一、基础知识\n\n#### 1. 解密表观遗传学的三个方向与测序方法\n\n*   **1. 探索染色质的开放性**（chromatin accessibility）  \n    `ATAC-seq`: Assay of Transposase Accessible Chromatin sequencing  \n    `DNase-seq`: DNase I hypersensitive sites sequencing  \n    `FAIRE-seq`: Formaldehyde-Assisted Isolation of Regulatory Elements sequencing\n*   **2. 探索转录因子的绑定与组蛋白修饰**（TF binding and histone modifications）  \n    `ChIP-seq`: Chromatin Immuno-Precipitation sequencing\n*   **3. 探索核小体占位**（nucleosome positioning and occupancy）  \n    `MNase-seq`: Micrococcal Nuclease sequencing\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632949992-700x506.png)\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632949994-700x844.png)\n\n#### 2. 名词解释\n\n*   `epigenetics`：表观遗传学。表观遗传学修饰在不改变 DNA 序列的情况下控制着基因的表达，包括染色质重塑、组蛋白修饰、DNA 甲基化和 microRNA 通路等\n*   `peaks`: 峰。常用来表示染色质的开放程度，因为是测序的 reads 落在了染色质的开放区，堆叠后被可视化的一种丰度的体现。\n\n但 peaks 到底代表什么？莫非 peaks 所在区域要么是启动子要么是增强子？再或者就是笼统定义为调控元件？（我目前的观点是，只能把他理解为酶切的位点，如果非要定义是否是特定分调控元件，只能进行后续分析。）\n\n* `THSs`: 转座酶超敏感位点（transposase hypersensitive sites）。\n\n* `CREs`: 顺式调控元件（cis-regulatory elements）。即 DNA 分子中具有转录调节功能的特异 DNA 序列。按功能特性，真核基因顺式作用元件分为启动子、增强子及沉默子。\n\n* `ACRs`: 染色质开放区域（accessible chromatin regions）。即正常或核小体被酶切裸露出来的 DNA 片段所在的区域。这篇[【NP | 2019】](https://www.nature.com/articles/s41477-019-0548-z)根据 ACRs 距离最近基因的距离将 ACRs 分为三种类型：genic (gACRs; overlapping a gene), proximal (pACRs; within 2kb of a gene) or distal (dACRs; >2 kb from a gene)，分别是跨越基因的，近端的，远端的染色质开放区。\n\n* `transposon`: 转座子。一段可以从原位上单独复制或断裂下来，环化后插入另一位点，并对其后的基因起调控作用的 DNA 序列。\n\n* `promoter`: 启动子。启动子是位于结构基因 5'端上游的 DNA 序列，能活化 RNA 聚合酶，使之与模板 DNA 准确的结合并具有转录起始的特异性。每个启动子包括至少一个转录起始点以及一个以上的功能组件（典型的如 TATA 盒子）\n\n* `proximal promoters`: 近端启动子。是 DNA 上位于基因开始之前的一个区域，在那里蛋白质和其他分子结合在一起准备读取该基因。\n\n* `enhancer`: 增强子。增强子是远离转录起始点、决定基因的时间、空间特异性表达、增强启动子转录活性的 DNA 序列，其发挥作用的方式通常与方向、距离**无关**，可位于转录起始点的上游或下游。从功能上讲，没有增强子存在，启动子通常不能表现活性；没有启动子时，增强子也无法发挥作用。根据南京大学陈迪俊老师的研究表明增强子比启动子能结合更多的转录因子 [(Nature Communications)](https://www.nature.com/articles/s41467-019-09513-2)\n\n* `TFs`: 转录因子（transcription factors）是保证目的基因以特定的强度在特定的时间与空间表达的蛋白质分子。与 RNA 聚合酶 Ⅱ 形成转录起始复合体，共同参与转录起始的过程。\n\n* `TSS`: 转录起始位点（transcription start site）。在一个典型的基因内部，排列顺序为转录起始位点 (TSS，一个碱基)- 起始密码子编码序列 (ATG)- 终止密码子编码序列 (TGA)- 转录终止位点 (TTS)，即 TSS-ATG-TGA-TTS\n\n* `histone`：组蛋白。通常含有 H1，H2A，H2B，H3，H4 等 5 种成分，其中 H1 与 H3 极度富含赖氨酸（lysine），H1 不保守，其他组蛋白的基因非常保守。除 H1 外，其他 4 种组蛋白均分别以二聚体 (共八聚体）相结合，形成核小体核心。DNA 便缠绕在核小体的核心上。而 H1 则与核小体间的 DNA 结合\n\n* `nucleosome`: 核小体。是由 DNA 和组蛋白形成的染色质基本结构单位。每个核小体由 146bp 的 DNA 缠绕组蛋白八聚体 1.75 圈形成。核小体核心颗粒之间通过 50bp 左右的连接 DNA 相连，暴露在核小体表面的 DNA 能被特定的核酸酶接近并切割\n\n* `H3K4me1`: 组蛋白 H3 上的第 4 位赖氨酸发生单甲基化（mono-methylation of H3 at lysine 4） [（NG | H3K4me1 与增强子的关系）](https://www.nature.com/articles/s41588-017-0018-3)\n\n* `H3K9ac`：组蛋白 H3 上的第 9 位赖氨酸发生乙酰化（H3 acetylation marks at lysine 9）关于 H3K4me1 与 H3K9ac 的不同，依旧可以参考这篇文献[【NP | 2019】](https://www.nature.com/articles/s41477-019-0548-z)或[【NC | 2019】](https://www.nature.com/articles/s41467-019-09513-2)\n\n* `组蛋白甲基化`：甲基化可发生在组蛋白的赖氨酸和精氨酸残基上，而且赖氨酸残基能够发生单、双、三甲基化，而精氨酸残基能够单、双甲基化，这些不同程度的甲基化极大地增加了组蛋白修饰和调节基因表达的复杂性\n\n* `组蛋白乙酰化`：四种类型的组蛋白相互作用，将细胞核里的 DNA 紧紧地包装起来。这样的紧密包装能够有效阻止酶读取 DNA 上的遗传信息。然而，乙酰基连到组蛋白上能削弱它们对 DNA 的占据。因此局部乙酰化能暴露出相应的基因，让它们更容易激活![](https://static.plob.org/wp-content/uploads/2021/09/1632949997-700x318.png)\n\n    真核生物细胞核内染色质结构\n\n### 二、基础分析\n\n### 1. 分析前的准备\n\n1.1 下载 ATAC 测序数据（或者用你自己的数据也行）\n\n*   所需软件：[Aspera Connect](https://www.ibm.com/aspera/connect/)\n*   软件安装与使用：参考[这系列文章](https://www.plob.org/tag/aspera)\n*   数据下载：项目 ID[【PRJNA480717】](https://www.ncbi.nlm.nih.gov/bioproject/PRJNA480717/)[【文章原文】](https://academic.oup.com/jxb/article/70/15/3867/5481770)，SRR 序列号如下图，下载方法和上文相同。由于数据量大，测试浪费时间，所以我在每个文件中取了 100w 条 reads，由于百度网盘太慢了，你可以去扣扣群 559758504 里面随便下载一个用于测试。\n\n```\nfastqc -t 8 -o ./ *.fastq.gz\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950000-700x238.png)\n\nimage.png\n\n1.2 下载 tair10 基因组与 gff3 注释文件\n\n```\nbwa index -p /路径/bwaIndexTair /路径/TAIR10_genome.fa\n```\n\n1.3 安装 miniconda\n\n*   由于后续分析大多数软件都是来源于 conda，因此你必须知道怎么使用。参考[【conda 的安装与使用】](https://www.plob.org/article/13100.html)\n\n1.4 所需软件安装（分析中所用到的软件都汇集于此，下文不再介绍如何下载）\n\n请先激活 conda 环境在安装！\n\n```\nconda install -c bioconda -y fastqc\nconda install -c bioconda -y trimmomatic\nconda install -c bioconda -y bwa\nconda install -c bioconda -y samtools\nconda install -c bioconda -y picard\nconda install -c bioconda -y macs2\nconda install -c bioconda -y bedtools\nconda install -c bioconda -y deeptools\nconda install -c bioconda -y homer\n\n```\n\n后续分析是使用 SRR7512044 作为测试数据，但是思路和方法都可以借鉴。\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950000-1.png)\n\n测试数据\n\n### 2. 测序质量检测\n\n*   所需软件：[FastQC](https://anaconda.org/bioconda/fastqc)[【官方网站】](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/)\n\n```\nfastqc -t 8 -o ./ *.fastq.gz\n```\n\n`-t`: 线程  \n`-o`: 存放路径，不用指定前缀，默认为. fastq.gz 前面的字段  \n`*.fastq.gz`: fastqc 可以同时接受多个 fastq.gz 文件，因此采用正则表达式【*】表示全部\n\n*   结果解读  \n    由于开始测序时不准确，因此前 15bp 左右的 ATGC 含量有波动，需要在后面截掉。而最长 reads 为 76bp，则暗示着我最后至少要保留多长的序列。  \n    一般我的计算思路是：保留的序列长度 =（最长的的 reads 长度 - 前面波动的碱基长度）× 40%\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950001-700x514.png)\n\n### 2. 测序质量检控制\n\n*   所需软件：[Trimmomatic](https://anaconda.org/bioconda/trimmomatic)[【官方网站】](https://links.jianshu.com/go?to=%255Bhttp%3A//www.usadellab.org/cms/%3Fpage%3Dtrimmomatic%255D%28http%3A//www.usadellab.org/cms/%3Fpage%3Dtrimmomatic%29)[【中文介绍】](https://www.plob.org/article/6258.html)  \n    其实这批数据已经做过质控了，如何判断的呢？QC 的为一个范围且短于提供给 NCBI 上的数据。因此我们没必要质控，但为了流程的完整性，还是假装质控一下。质控之后，还要进行质检，如此循环，直到合格。\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950001-1-700x296.png)\n\n```\n# 定义一些变量，后面修改起来方便\nfilename=SRR7512044\n \ntrimmomatic PE -threads 10 \n./${filename}_1.fastq.gz ./${filename}_2.fastq.gz \n./${filename}_1.clean.fq.gz ./${filename}_1.drop.fq.gz \n./${filename}_2.clean.fq.gz ./${filename}_2.drop.fq.gz \nHEADCROP:15 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:24\n\n```\n\n`PE`: 双端模式。需要两个输入文件，正向测序序列和反向测序序列：`sample_R1.fastq.gz`和`sample_R2.fastq.gz`；  \n以及四个输出文件：`sample_1.clean.fq.gz`和`sample_1.drop.fq.gz`；`sample_2.clean.fq.gz`和`sample_2.drop.fq.gz`  \n`-threads`: 线程数  \n`HEADCROP`: 从 reads 的开头切掉指定数量的碱基，即从 fastqc 中看的  \n`LEADING`: 从 reads 的开头切除质量值低于阈值的碱基  \n`TRAILING`: 从 reads 的末尾开始切除质量值低于阈值的碱基  \n`SLIDINGWINDOW`: 从 reads 的 5' 端开始，进行滑窗质量过滤，切掉碱基质量平均值低于阈值的滑窗  \n`MINLEN`: 如果经过剪切后 reads 的长度低于阈值则丢弃这条 reads，即上面的计算方法：（76-15）×40%≈24\n\n### 3. 建立索引与序列比对\n\n*   所需软件：[bwa](https://www.plob.org/tag/bwa) 和 [samtools](https://www.plob.org/tag/samtools)\n*   建立基因组索引。需要的时间挺长的，建议放后台。建好之后以后就可以跳过这一步了，且在经典的比对软件 STAR、hisat2、bowtie2 和 bwa-mem 中我更喜欢使用 STAR 和 bwa-mem。本次使用 bwa-mem 操作演示\n\n```\nbwa index -p /路径/bwaIndexTair /路径/TAIR10_genome.fa\n```\n\n`-p`: 索引前缀，后缀自动补充  \n`TAIR10_genome.fa`: 基因组文件\n\n*   序列比对  \n    由于 sam 文件较大，因此我们直接跳过 sam，使用 samtools 转换为排序后的 bam 文件，注意【|】不要漏掉，且排序是依据 reads 比对到基因组的位置排的\n\n```\n# 定义一些变量，后面用\nfilename=SRR7512044\nindex=/路径/bwaIndexTair\n \nbwa mem -M -t 8 \n-R \"@RGtID:${filename}tSM:${filename}tLB:WXStPL:Illumina\" \n$index \n${filename}_1.clean.fq.gz \n${filename}_2.clean.fq.gz \n| samtools sort -O bam -@ 10 -o ./${filename}.raw.bam\n#无论干啥，生成bam文件后就要建立bam索引，并检查比对情况\nsamtools index -@ 10 -b ./${filename}.raw.bam\nsamtools flagstat ./${filename}.raw.bam > ./${filename}.raw.stat\ncat ${filename}.raw.stat\n\n```\n\n`-M`: 将 shorter split hits 标记为次优，以兼容 Picard’s markDuplicates 软件  \n`-R`: STR 完整的 read group 的头部，可以用't' 作为分隔符， 在输出的 SAM 文件中被解释为制表符 TAB. read group 的 ID，会被添加到输出文件的每一个 read 的头部，  \n`-O`: 表示输出的 bam 文件  \n`-o`: 输出的 bam 文件名  \n`-t`与`@`: 线程数\n\n*   关于 stat 中内容的解释如下\n\n```\n14608455   0 in total (QC-passed reads   QC-failed reads) reads总数\n37967   0 secondary                                       出现比对到参考基因组多个位置的reads数\n0   0 supplementary                                       可能存在嵌合的reads数\n0   0 duplicates                                          重复的reads数\n14590894   0 mapped (99.88% : N/A)                        比对到参考基因组上的reads数\n14570488   0 paired in sequencing                         属于PE read的reads总数。\n7285244   0 read1                                         PE read中Read 1 的reads 总数。\n7285244   0 read2                                         PE read中Read 2 的reads 总数。\n14507068   0 properly paired (99.56% : N/A)               完美比对的reads总数。PE两端reads比对到同一条序列，且根据比对结果推断的插入片段大小符合设置的阈值。\n14551500   0 with itself and mate mapped                  PE两端reads都比对上参考序列的reads总数。\n1427   0 singletons (0.01% : N/A)                         PE两端reads，其中一端比上，另一端没比上的reads总数。\n26260   0 with mate mapped to a different chr             PE read中，两端分别比对到两条不同的序列的reads总数。\n17346   0 with mate mapped to a different chr (mapQ>=5)   PE read中，两端分别比对到两条不同\n\n```\n\n### 4. 去除 PCR 重复并再次进行质控\n\n*   所需软件：picard 与 [samtools](https://www.plob.org/tag/samtools)  \n    不建议使用 sambamba，虽然快，但是毛病多，尤其是在你不知情的情况下，软件卡死或者在最后输出文件时提示输出文件夹过多等。\n\n```\npicard MarkDuplicates \nREMOVE_DUPLICATES=true \nI=${filename}.raw.bam \nO=${filename}.rmdup.bam \nM=${filename}.rmdup.log\n# 实时监测我们的数据发生了什么变化\nsamtools index ${filename}.rmdup.bam\nsamtools flagstat ${filename}.rmdup.bam > ./${filename}.rmdup.stat\n\n```\n\n`REMOVE_DUPLICATES=true`: 表示将检测出的 PCR duplication 直接去除；  \n`I`: 或者 INPUT 指定输入的 bam 文件；  \n`O`: 或者 OUTPUT 指定输出去除 PCR duplication 的 bam 文件；  \n`M`: 或者 METRICS_FILE 指定输出的 matrix log 文件。\n\n*   下面是再次进行质控\n\n```\nsamtools view -h -f 2 -q 30 ${filename}.rmdup.bam \n| grep -v -e \"mitochondria\" -e \"*\" -e \"chloroplast\" \n| samtools sort -O bam -@ 10 -o - > ${filename}.last.bam\n# 实时监测我们的数据发生了什么变化\nsamtools index ${filename}.last.bam\nsamtools flagstat ${filename}.last.bam > ./${filename}.last.stat\n\n```\n\n`-h`: 输出的 sam 文件带 header，默认不带  \n`-f`: 输出含有所有 flag 的 reads  \n`-q` 比对的最低质量值，一般 20/30 都可以  \n其他参数介绍看 [samtools 使用简述](https://www.plob.org/tag/samtools)，需要说明的是由于比对到线粒体和叶绿体的 reads 不是我们关注的重点，因此使用`grep`剔除掉，当然了，做动物的话需要剔除什么视情况而定了。\n\n*   好了，下面来看看我们的数据从 raw data -> rmdup -> last 到底发生了那些变化![](https://static.plob.org/wp-content/uploads/2021/09/1632950002-700x344.png)\n*   然后，从 IGV 看看发生了什么变化  \n    关于使用 IGV 查看 bam 文件中 reads 呈现不同颜色的说明\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950005-700x773.png)\n\n### 5. 统计过滤后的结果中 Insertsize 长度分布\n\n*   所需软件：picard  \n    Insertsize =（read2 的比对位点 - read1 的比对位点） read2 的长度。也可以随便点击上图 IGV 中任一一条 reads 查看插入片段的大小\n\n```\npicard CollectInsertSizeMetrics \nI=./${filename}.last.bam \nO=./${filename}.last.insertsize \nH=./${filename}.last.hist.pdf\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950006-700x683.png)\n\n### 5. peak calling 与 FRiP_score/SPOT_score 的计算\n\n*   所需软件：[macs2](https://www.plob.org/article/7118.html) 和 [bedtools](https://www.plob.org/tag/bedtools)  \n    因为 macs2 需要用到基因组的有效大小，而软件本身就提供了 4 个物种的有效基因组大小。\n\n```\neffective_genome_size=119481543\n \nbedtools bamtobed -i ${filename}.last.bam > ${filename}.last.bed\nmacs2 callpeak \n-t ${filename}.last.bed \n-g ${effective_genome_size} \n--nomodel --shift -100 --extsize 200 \n-n ${filename}.last \n-q 0.01 --outdir ./peaks\n\n```\n\n*   其实，这里面讨论最多的是`--nomodel --shift -100 --extsize 200`这些参数如何选择，下面的图很形象的展示了参数的作用。当然，我也是查阅了很多资料与文献，一般默认在`ATAC-seq，DNase-seq，FAIRE-seq`的时候将`shift`设置为`extsize`的一半，且参数固定为：`--nomodel --shift 100 --extsize 200`。而在`MNase-seq`的时候，参数固定为：`--nomodel --shift 37 --extsize 73`。在`ChiP-seq`的时候不用移峰，所以只使用`-nomodel`，当做组蛋白修饰的时候，由于 peak 并[不典型](http://blog.sina.com.cn/s/blog_4bc742520102uy64.html)，所以使用`–nomodel –shift 73`参数。另外如何使用`macs2 predictd`预测双峰模型，这里就不展开介绍了，可以私聊我，我把脚本发你。\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950007.png)\n\nshift 与 extsize 到底在干啥？\n\n*   下面是我见过的图中解释**移峰**现象最清楚的了，可以参考\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950007-1-700x503.png)\n\n移峰\n\n*   最后，就是输出文件的解读\n    1.  **${filename}_peaks.xls**\n\n```\n前几行是callpeak时的命令。后面是：\n1.染色体号\n2.peak起始位点\n3.peak结束位点\n4.peak区域长度\n5.peak的峰值位点（summit position）\n6.peak 峰值的高度（pileup height at peak summit, -log10(pvalue) for the peak summit）\n7.peak的富集倍数（相对于random Poisson distribution with local lambda）\n\n```\n\n*   2.  **${filename}_peaks.narrowPeak**\n\n```\nnarrowPeak文件是BED6 4格式，可以上传到IGV查看\n1.染色体号\n2.peak起始位点\n3.peak结束位点\n4.peak name（样本名 _peak_1的后缀之类的）\n5.-10*log10qvalue\n6.正负链\n7.fold change\n8.-log10pvalue\n9.-log10qvalue\n10.相对于峰的峰顶位置（relative summit position to peak start）\n\n```\n\n*   注意：excel 里的起始坐标需要减 1 才与 narrowPeak 的坐标一致，见下图。\n    3.  **${filename}_summits.bed**\n\n```\nBED格式的文件，包含peak的summits（峰顶）位置\n1.染色体号\n2.峰的峰顶起始位点（注意是峰顶，不是峰，他只是一个点）\n3.峰的峰顶起始位点（因此二者就差一个碱基的位置）\n4.峰顶（样本名 _peak_1的后缀之类的）\n5.-log10pvalue\n\n```\n\n* 注意：excel 里的起始坐标需要减 1 才与 narrowPeak 的坐标一致，见下图。\n\n* **另外，需要告诉你的是，bed 文件中第 2 列中的峰顶起始位点是如何计算的？**  \n    bed 文件中第 2 列（峰的峰顶起始位点） = xls 第二列 xls 第十列 -1。或者↓↓↓↓  \n    bed 文件中第 2 列（峰的峰顶起始位点） = narrowPeak 第二列 narrowPeak 第十列\n\n* 总览比较：![](https://static.plob.org/wp-content/uploads/2021/09/1632950008-700x407.png)\n\n    bed，narrowPeak，bdg，xls 四种类型输出文件的比较\n\n* FRiP_score 的计算[【官方介绍】](https://www.encodeproject.org/atac-seq/)  \n    简单来说，FRiP_score 说的就是统计落在 Peaks 里面的 reads 数量与所有比对到基因组上 reads 数量的比值。可以作为判定样本测序质量的一个指标。\n\n```\nReads=$(bedtools intersect -a ${filename}.last.bed -b ${filename}_peaks.narrowPeak |wc -l|awk '{print $1}')\ntotalReads=$(wc -l ${filename}.last.bed|awk '{print $1}') \necho ${Reads} ${totalReads} ${filename} 'FRiP_score:' $(echo \"scale=2;100*${Reads}/${totalReads}\"|bc)'%'\n\n```\n\n*   官网上说 ATAC-Seq 的 FRiP score should be >30%（[https://www.encodeproject.org/atac-seq/](https://www.encodeproject.org/atac-seq/)）我猜是如果大多数 reads 都不在 peaks 区域，说明测序质量或者实验效果不是太好，因为酶切切开的就是 peaks 区域，太少不是就偏离实验目的了嘛\n*   SPOT_score 的计算[【官方介绍】](https://www.encodeproject.org/data-standards/terms/)[【软件安装】](https://www.encodeproject.org/software/hotspot/)  \n    简单来说，SPOT_score 就是在 FRiP_score 的基础上增加了测序深度的条件限制，比如 FRiP 是统计全局的 reads，而 SPOT 只统计测序深度为 30× 的 reads，大于 30× 的 reads 不再参与统计。目前我还在探索中如何计算。\n\n### 二、高级分析\n\n所谓的高级并不高大上，做了有可能也不能让你的文章提升档次，望周知！\n\n### 1. IGV 可视化\n\n*   前面的 bam 文件，narrowPeak 文件，bed 文件都有了，现在还差一个 bw 文件，因此我们先跑下面的代码，然后在 IGV 里面统一看一下\n*   所需软件：[deeptools](https://anaconda.org/bioconda/deeptools) 和 [IGV](https://software.broadinstitute.org/software/igv/download)  \n    主要是为生成 bw 文件用于 IGV 展示\n\n```\nbamCoverage --bam ${filename}.last.bam -o ${filename}.last.bw \n    --binSize 10 \n    --normalizeUsing RPGC \n    --effectiveGenomeSize ${effective_genome_size} \n    --ignoreForNormalization chrX \n    --extendReads\n\n```\n\n注：如果发现没有这个包 pysam.libchtslib，直接安装`pip install numpydoc`  \n`-o`: 生成 bw 文件  \n`binSize`: 自行设定覆盖度计算的窗口大小 (bin)  \n`normalizeUsing`: 数据准化方法，有三种 RPGC，RPKM，CPM，BPM  \n`ignoreForNormalization`: 设置你想忽略的染色体名称  \n`extendReads`: 让 reads 扩展至 fragment 的大小\n\n*   IGV 一览\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950009-700x436.png)\n\nIGV 可视化 bw、narrowpeak，bed，bam，gff 文件\n\n### 2. TSS/TES 可视化\n\n* 所需软件：[deeptools](https://anaconda.org/bioconda/deeptools)  \n    主要是如何生成 [Refseq 文件](http://www.bio-info-trainee.com/2494.html)，虽然官网上提供了一些，但总归是不能覆盖所有物种，因此，我们可以从 gff/gtf 文件中自己创造。\n\n* 先提取**基因**的位置信息（不是 cds 或者 exon），根据不同的 gff 进行修改，但格式始终是`` `chrom/chromStart/chromEnd/name/score/strand` ``\n\n    ```\n    awk -vFS='[\\t=;]' -vOFS=\"\\t\" \\\n    '{if ($3==\"gene\") print $1,$4,$5,$10,$6,$7}' \\\n    TAIR10.gff|sed 's/Chr//g' > refseq.bed  \n    #由于tair官网上提供的基因组文件中染色人命名没有Chr，为保持一致，这里去掉\n    \n    ```\n\n* 然后进行 TSS 可视化\n\n```\ncomputeMatrix reference-point --referencePoint TSS  -p 15 \n    -b 2000 -a 2000 \n    -R ./refseq.bed \n    -S *.bw \n    -o TSS.gz \n    --skipZeros \n    --outFileSortedRegions Heatmap1sortedRegions.bed\nplotHeatmap -m TSS.gz -out TSS.Heatmap.pdf --plotFileFormat pdf\nplotProfile -m TSS.gz -out TSS.Profile.pdf --plotFileFormat pdf --perGroup\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950010-700x629.png)\n\n*   然后进行 TES 可视化\n\n```\ncomputeMatrix scale-regions  -p 15  \n    -b 2000 -a 2000 \n    -R ./refseq.bed \n    -S *.bw \n    --skipZeros -o body.gz\nplotHeatmap -m body.gz -out body.Heatmap.pdf --plotFileFormat pdf\nplotProfile -m body.gz -out body.Profile.pdf --plotFileFormat pdf --perGroup\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950011-700x630.png)\n\n*   另外，参考下面这个图，看每个参数控制的哪里，如何同时绘制多个等。这是我好久之前总结的，清晰度堪忧\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950013-700x649.png)\n\n### 3. 相关性可视化（依旧是使用 deeptools）\n\n*   因为我测试样本少，所以就使用[官网的图](https://deeptools.readthedocs.io/en/latest/content/tools/plotCorrelation.html)了哈，但代码是能跑通的，放心使用。\n*   先使用 [bw] 文件生成 [npz] 文件。所有样本做相关性，用 [*.last.bw]，多个单列出来也行\n\n```\nmultiBigwigSummary bins -b *.last.bw -o number.of.bins.npz\n\n```\n\n*   画相关性热图\n\n```\nplotCorrelation -in number.of.bins.npz \n--corMethod pearson \n--skipZeros \n--plotTitle \"Pearson Correlation of Average Scores Per Transcript\" \n--plotFileFormat pdf \n--whatToPlot heatmap --colorMap RdYlBu --plotNumbers \n-o heatmap_PearsonCorr_bigwigScores.pdf \n--outFileCorMatrix PearsonCorr_bigwigScores.tab\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950014-700x605.png)\n\nheatmap\n\n*   画相关性点图\n\n```\nplotCorrelation -in number.of.bins.npz \n--corMethod pearson \n--skipZeros \n--plotTitle \"Pearson Correlation of Average Scores Per Transcript\" \n--plotFileFormat pdf \n--whatToPlot scatterplot \n-o scatterplot_PearsonCorr_bigwigScores.pdf \n--outFileCorMatrix PearsonCorr_bigwigScores.tab\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950015-700x734.png)\n\n相关性点图\n\n### 5. ChIPseeker 对 peaks 进行注释和可视化\n\n*   对 peak 的注释分为两个部分——结构注释和功能注释  \n    结构注释会将 peak 所落在基因组上的区域结构注释出来，比如说启动子区域，UTR 区域，内含子区域等等。同时，也会将与 peak 最临近的基因注释出来，非常好用。  \n    功能注释其实并不是对 peak 进行注释的，而是对 peak 最临近的基因注释的，因此这部分就和传统的 GO/KEGG 等分析如出一辙啦。\n\n#### **5.1 结构注释**\n\n5.1.1 **准备工作**：导入包，没有的安装吧。另外需要使用 gff/gtf 构建一个 TxDb。因为[官网](http://www.bioconductor.org/packages/release/BiocViews.html%23___TxDb)上 TxDb 也不是每一个物种都有（目前共 43 个），因此我们自己手动构建。\n\n```\n#if (!requireNamespace(\"BiocManager\", quietly = TRUE))\n#    install.packages(\"BiocManager\")\n#BiocManager::install(\"clusterProfiler\")\n \nlibrary(clusterProfiler)\nlibrary(ChIPseeker)\nlibrary(GenomicFeatures)\ntxdb <- makeTxDbFromGFF(\"public/bioinfoYu/genome/tair10/TAIR10.gff\",\n                        format=\"gff\")    #也可以使用gtf\nkeytypes(txdb)    #感兴趣的话，可以用以下方法探索txdb都包含了什么内容\nkeys(txdb)\n\n```\n\n5.1.2 **单个文件的结构注释**（不推荐在这一步加 OrgDB 的内容，没用）\n\n```\n#读入单个summits文件\npeaks <- readPeakFile(\"SRR7512044_summits.bed\")\n#结构注释\npeakAnno <- annotatePeak(peaks,\n                         TxDb=txdb,\n                         tssRegion=c(-1000, 1000))\n\n```\n\n上面的 tssRegion 取值有说法的，因为判定 \"Promoter\", \"Exon\", \"Intron\", \"Intergenic\" 等结构的依据就是根据范围来的。比如定义 1000 以内的，则在 1kbp 之内规定为 \"Promoter (<=1kb)\"，而 1k-2k 内定义为 \"Downstream (1-2kb)\"。但你定义 2000 以内呢，则在 1kbp 之内规定为 \"Promoter (<=1kb)\"，而 1k-2k 内定义为 \"Promoter (1-2kb)\"。虽然，ChIPseeker 会标记出来区域，但还是三思后再取范围。\n\n```\n#注释完，进行可视化，多种图可供选择\nplotAnnoBar(peakAnno)\nplotDistToTSS(peakAnno)\nvennpie(peakAnno)\nplotAnnoPie(peakAnno)\n#install.packages(\"ggupset\")\nlibrary(ggupset)\nupsetplot(peakAnno)\n#install.packages(\"ggimage\")\nlibrary(ggimage)\nupsetplot(peakAnno, vennpie=TRUE)\n \n#最后将我们的注释结果转为数据框，便于查看\ndf <- as.data.frame(peakAnno)\n#将注释到的基因提取出来（第14列），用于后续功能分析\ngene <- df[,14]\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950016-700x323.png)\n\n提供可视化的方法\n\n5.1.3 **多个文件的结构注释**\n\n```\n#一次也可以读入多个summits文件，使用list存储，然后使用lapply注释\nfiles = list(peak1 = \"peaks.bed\", peak2 = (\"peak.bed\"))\npeakAnnoList <- lapply(files, \n                       annotatePeak,\n                       TxDb=txdb,\n                       tssRegion=c(-2000, 2000))\nplotAnnoBar(peakAnnoList)\nplotDistToTSS(peakAnnoList)\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950019-700x220.png)\n\n读入多个 summits 文件的可视化\n\n#### **5.2 功能注释**\n\n5.2.1 **可选支线**  \n由于这里需要物种的 OrgDb 注释库。如果你足够幸运，研究的物种正好在[官网](http://www.bioconductor.org/packages/release/BiocViews.html%23___OrgDb)仅提供的 20 个物种中存在，那就拿来用吧。除了以上这些都好说，还有是 id 转换，后面再说。  \n5.2.2 **OrgDb 下载**  \n本次测试是用拟南芥的样本，我推荐在[官网](http://www.bioconductor.org/packages/release/BiocViews.html%23___OrgDb)中直接将所需要的的 OrgDb 库下载到服务器上，这样就不用在 R 里面重复在网上获取浪费时间了。比如说拟南芥，就可以下载，这样就把【org.At.tair.db】下载到了服务器或者本地了。\n\n```\nwget http://www.bioconductor.org/packages/release/data/annotation/src/contrib/org.At.tair.db_3.13.0.tar.gz\ntar -zvxf org.At.tair.db_3.13.0.tar.gz\n\n```\n\n5.2.3 **导入 OrgDb**\n\n```\n#从本地下载OrgDb库（如果你直接下载到了R的lib里面，就直接library也可）\ninstall.packages(\"/public/bioinfoYu/genome/tair10/org.At.tair.db\", repos=NULL)\n#另外一种方法\n#if (!requireNamespace(\"BiocManager\", quietly = TRUE))install.packages(\"BiocManager\")\n#BiocManager::install(\"org.At.tair.db\")\n#载入库\nlibrary(org.At.tair.db)\n#感兴趣的话，看看org.At.tair.db包含的都是些啥\n#查看包含的列名\nkeytypes(org.At.tair.db)\n#查看包含的基因ID\nkeys(org.At.tair.db)\n#随便选择一个基因和一些列名，看一看到第是什么东东，不过因为导入了其他包，下面命令报错，我至今还没有解决\nselect(org.At.tair.db,keys=\"AT1G01010\",columns = c(\"ENTREZID\",\"GO\",\"SYMBOL\"))\n\n```\n\n5.2.4 **ID 转换**（非必须）  \n上面`5.1.2`已经得到 peak 附近的基因集【gene】了，如果需要 ID 转换，就是用`clusterProfiler`中的`bitr`函数\n\n```\n#首先，去除版本号，如AT1G50040.1后面的.1，当然我们的测试集没有，因此不用做\n#gene_rm <- gsub(\".[0-9] $\",\"\",gene)\n#下面进行ID转换\nkeytypes(org.At.tair.db)\ngene_last <- bitr(geneID = gene, \n                    fromType = \"TAIR\",\n                    toType = c(\"ENTREZID\", \"SYMBOL\", \"GENENAME\"),\n                    OrgDb = org.At.tair.db)\n \n# geneID    需要转换的ID\n# fromType  当前ID类型\n# toType    转换成什么ID，使用keytypes()查看有哪些类型\n# OrgDb     注释数据库\n\n```\n\n5.2.5 **GO 功能注释**\n\n```\n# 因为keyType不接受数据框类型的数据，因此我们转换为字符型\ngenelist <- gene.symbol[,2]  #注意我这里把ENTREZID单独拿出来了，所以下面自然是keyType = \"ENTREZID\",\ngo_result <- enrichGO(genelist,\n                      keyType = \"ENTREZID\", \n                      OrgDb = org.At.tair.db, \n                      ont = \"BP\", #BP,MF,CC,ALL可选\n                      pAdjustMethod = \"BH\", \n                      qvalueCutoff = 0.05, \n                      readable = FALSE)\n#可视化，showCategory=20调整显示的条目多少\ndotplot(go_result, showCategory=20)\n#将结果转为数据框，可以选择导出\ngoresult <- as.data.frame(go_result)\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950021-700x685.png)\n\nGO 可视化\n\n5.2.6 **KEGG 通路注释**\n\n```\n#geneClusters必须是数据框类型，ID必须是ENTREZID类型\nclass(gene.symbol)\ncompKEGG <- compareCluster(geneClusters=gene.symbol, \n                           fun = \"enrichKEGG\",\n                           organism = \"ath\",    #在 http://www.genome.jp/kegg/catalog/org_list.html 上查看物种简写\n                           pvalueCutoff  = 0.05, \n                           pAdjustMethod = \"BH\")\ndotplot(compKEGG, showCategory = 20, title = \"KEGG Pathway Enrichment Analysis\")\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950022-700x342.png)\n\nKEGG 可视化\n\n### 6. homer 寻找 motif\n\n*   所需软件：[homer](https://anaconda.org/bioconda/homer)[【官方网站】](http://homer.ucsd.edu/homer/)\n\n```\n# 提取peaks的位置信息文件\nawk '{print $4\"t\"$1\"t\"$2\"t\"$3\"t \"}' \nSRR7512044_peaks.narrowPeak > SRR7512044.homer_peaks.tmp\n# 寻找motif\nfindMotifsGenome.pl SRR7512044.homer_peaks.tmp \n./TAIR10_genome.fa   #指定参考基因组\n./SRR7512044.motif   #输出文件夹的名字\n-size 200 -len 8,10,12\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950023-700x261.png)\n\n### 7. DiffBind 找差异 peak\n\n*   所需软件：[DiffBind](http://www.bioconductor.org/packages/release/bioc/html/DiffBind.html)\n\n首先根据我自己的理解将**找差异 peak 的原理**说一下：既然是找差异的 peak，那首先就要保证不同样本间 peak 所在的区间基本一致才可以。因此**第一步**就是找到多个样本相同的 peak 区间。**第二步**，基于这些相同区域的 peak 开始找差异，这个地方的差异和传统的 RNA-Seq 找差异基因的原理一模一样，都是**对落在峰区间的 reads 进行计数**，数量不同的话差异就由此而来。但软件都帮我们做了，就不用考虑那么多了\n\n*   我废话真多，其实最麻烦的就是**准备输入数据**，下面来看怎么做  \n    一般情况相下需要包括以下几列：`\"SampleID\"， \"Tissue\"， \"Factor\"， \"Condition\" ，\"Treatment\"，\"Replicate\"， \"bamReads\" ，\"ControlID\" ，\"bamControl\" ，\"Peaks\"和\"PeakCaller\"`\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950025-700x148.png)\n\n*   但我们做 ATAC-Seq 的哪里有什么`control，controlID，bamControl`，因此删掉，而`\"Tissue\"， \"Factor\"， \"Condition\" ，\"Treatment\"，\"Replicate\"，`表示的都是分组的意思，因此我保留了两个`\"Factor\"，\"Replicate\"`，最后 csv 文件的样子如下：![](https://static.plob.org/wp-content/uploads/2021/09/1632950026-700x127.png)\n\n`SampleID`：不能有重复  \n`Factor`：进行分组，后面要做差异分析的依据  \n`Replicate`：重复的编号  \n`bamReads`：最后生成的 bam 文件。全路径 bam 文件名  \n`Peaks`：macs2 生成的 narrowPeak 文件。全路径 narrowPeak 文件名  \n`PeakCaller`：说明 peak 类型，使用 narrowPeak 文件则为`narrow`。使用 xls 文件，则用`macs`。使用 bed 文件，则用`bed`\n\n*   开始正题\n\n```\n# 安装包\nif (!requireNamespace(\"BiocManager\", quietly = TRUE))install.packages(\"BiocManager\")\nBiocManager::install(\"DiffBind\")\nlibrary(DiffBind)\n#导入数据，dba函数会将会将bam文件一同导入，因此csv中的路径一定要准确\ntamoxifen <- dba(sampleSheet=\"atDiff.csv\")\n#查看样本间的相关性\nplot(tamoxifen)\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950027.png)\n\n```\n#计算每个样本中的reads数\ntamoxifen <- dba.count(tamoxifen)\n#简单查看计算结果\ninfo <- dba.show(tamoxifen)\nlibsizes <- cbind(LibReads=info$Reads, FRiP=info$FRiP, PeakReads=round(info$Reads * info$FRiP))\nrownames(libsizes) <- info$ID\nlibsizes\n\n```\n\n```\n#统计结果\n       LibReads FRiP PeakReads\ncmt2_1  6720462 0.29   1948934\ncmt2_2  7747491 0.33   2556672\nwild_1  7078309 0.36   2548191\nwild_2  8030752 0.34   2730456\nddcc_1  6370232 0.30   1911069\nddcc_2  6956429 0.35   2434750\n\n```\n\n<pre\"># 默认基于测序深度对数据进行标椎化 tamoxifen <- dba.normalize(tamoxifen) norm <- dba.normalize(tamoxifen, bRetrieve=TRUE) norm #查看进行标准化的文库大小 (library-size)，其实就是各样本文库大小总和的平均值，你可以计算验证一下 normlibs <- cbind(FullLibSize=norm$lib.sizes, NormFacs=norm$norm.factors, NormLibSize=round(norm$lib.sizes/norm$norm.factors)) rownames(normlibs) <- info$ID normlibs\n\n```\n#标椎化结果\n       FullLibSize  NormFacs NormLibSize\ncmt2_1     6720462 0.9398443     7150612\ncmt2_2     7747491 1.0834724     7150612\nwild_1     7078309 0.9898885     7150612\nwild_2     8030752 1.1230859     7150612\nddcc_1     6370232 0.8908652     7150612\nddcc_2     6956429 0.9728438     7150612\n\n```\n\n```\n#分组，格式是表头在最前面，要分的组依次写在后面，只能两两比较，因此后面只能写两组，但可以多执行几次，都会追加到tamoxifen 中\n#分组1，后面使用contrast=1单独查看\ntamoxifen <- dba.contrast(tamoxifen, contrast=c(\"Factor\",\"ddcc\",\"wild\"))\n#分组2，后面使用contrast=2单独查看\ntamoxifen <- dba.contrast(tamoxifen, contrast=c(\"Factor\",\"cmt2\",\"wild\"))\n#当然还可有分组3,4,5等，均可以使用contrast=number单独查看\ntamoxifen\n#按照分组分别进行差异分析，默认使用DESeq2进行计算，可以选择method = DBA_EDGER(edgR)，或者两个都要method = DBA_ALL_METHODS\ntamoxifen <- dba.analyze(tamoxifen)\ndba.show(tamoxifen, bContrasts=TRUE)\n#查看差异分析的结果与导出为csv文件\n#查看第1组差异分析的结果\ntamoxifen.DB_1 <- dba.report(tamoxifen,contrast=1)\ntamoxifen.DB_1\nwrite.csv(tamoxifen.DB_1, file=\"diffBind_result.csv\")\n \n#查看第2组差异分析的结果\ntamoxifen.DB_2 <- dba.report(tamoxifen,contrast=2) tamoxifen.DB_2 write.csv(tamoxifen.DB_2, file=\"diffBind_result.csv\") ##传统的上下调在找差异peak中称为“Gain”或“Loss” #查看第1组的差异peak数量“Fold>0或<0”控制是“Gain”或“Loss” sum(tamoxifen.DB$Fold>0,contrast=1)\nsum(tamoxifen.DB$Fold<0,contrast=1) #查看第2组的差异peak数量“Fold>0或<0”控制是“Gain”或“Loss” sum(tamoxifen.DB$Fold>0,contrast=2)\nsum(tamoxifen.DB$Fold<0,contrast=2)\n\n```\n\n*   由于我是使用两组进行测试的，所以可以使用 contrast=1 或 contrast=2 分别查看，由于都是相同的代码，下面进行可视化的时候，**只选择 contrast=1 进行可视化**\n\n```\n#韦恩图可视化\ndba.plotVenn(tamoxifen, contrast=1, bDB=TRUE, bGain=TRUE, bLoss=TRUE, bAll=FALSE)\n \n#PCA\ndba.plotPCA(tamoxifen) #这里可以使用所有样本进行PCA\ndba.plotPCA(tamoxifen, contrast=1, label=DBA_FACTOR)#单独对分组1进行PCA\n \n#MA plots\ndba.plotMA(tamoxifen, contrast=1)\n \n#Volcano plots\ndba.plotVolcano(tamoxifen, contrast=1)\n \n#Box plots\ndba.plotBox(tamoxifen, contrast=1)\n \n#Heatmap\nhmap <- colorRampPalette(c(\"red\", \"black\", \"green\"))(n = 13)\n#对所有样本的所有的差异peak画热图\ndba.plotHeatmap(tamoxifen,correlations=FALSE,scale=\"row\",colScheme = hmap)\n#单独对分组1中所有的差异peak画热图\ndba.plotHeatmap(tamoxifen, contrast=1, correlations=FALSE, scale=\"row\", colScheme = hmap)\ndba.plotHeatmap(tamoxifen,correlations=FALSE,scale=\"row\",colScheme = hmap)\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950027-1-700x349.png)\n\n*   想画下面的图，可是一直提示 could not find function dba.plotProfile，因此还没有成功，用官方提供的图展示一下吧，大家能画出来可以和我说一声哦。这是[【官方文档】](https://content.cruk.cam.ac.uk/bioinformatics/software/DiffBind/plotProfileDemo.html)可以参考\n\n```\n#Profiling and Profile Heatmaps\ndba.plotProfile(tamoxifen)\n\n```\n\n![](https://static.plob.org/wp-content/uploads/2021/09/1632950029-700x643.png)\n\n### 8. footprint 分析\n\n目前我还没有找到使用于所有物种的软件，HINT-ATAC 用来做 footprint 分析的话，应该只支持不几个物种，比较鸡肋。[ATACseqQC](https://bioconductor.org/packages/release/bioc/manuals/ATACseqQC/man/ATACseqQC.pdf) 应该是一款不错的软件，最近还在探索\n\n### 三、ATAC-seq 与多组学数据联合分析\n\n**转录因子 ChIP-seq**：由于大部分转录因子结合的是染色质开放区域，所以 ATAC-seq 的 Peak 可能和转录因子 ChIP-seq 的 Peak 存在部分重叠的情况，而且 ATAC-seq 得到的 Peak 长度往往更长，因此 ATAC-seq 数据和转录因子 ChIP-seq 数据可以相互验证。转录因子在 ChIP-seq 中独有的 Peak 暗示这个转录因子可能是结合在异染色质区域的驱动型转录因子（Pioneer TFs），驱动型转录因子随后招募染色质重塑复合体以及其它转录因子开始转录。另外，联合分析已经报道的 ChIP-seq 数据可以更准确地分析转录因子的足迹。  \n**组蛋白修饰 ChIP-seq**：ATAC-seq 数据同样可以和组蛋白修饰 ChIP-seq 数据进行联合分析，其中转录激活性修饰（H3K4me3，H3K4me1 和 H3K27ac 等）与染色质开放程度呈正相关，转录抑制性修饰（H3K27me3）与染色质开放程度呈负相关。联合已知的增强子和启动子之间的相互作用数据也可以帮助构建调控网络。  \n**RNA-seq**：ATAC-seq 数据可以通过联合分析 RNA-seq 数据来发现哪些差异表达的基因是受染色质可及性调控的，进一步可以推测这些差异表达的基因哪些是受开放染色质中具有 motif 和 footprint 的转录因子调控的，因此 ATAC-seq 与 RNA-seq 的联合分析有助于破译基因调控网络和细胞异质性。\n","slug":"ATAC分析流程","published":1,"updated":"2023-05-19T09:34:50.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm4peu6mx0003dbzr8jzr2wz8","content":"<blockquote>\n<p>转载于网络，原文地址 <a href=\"https://www.plob.org/article/24719.html\">www.plob.org</a></p>\n</blockquote>\n<h3 id=\"一-基础知识\"><a class=\"markdownIt-Anchor\" href=\"#一-基础知识\"></a> 一、基础知识</h3>\n<h4 id=\"1-解密表观遗传学的三个方向与测序方法\"><a class=\"markdownIt-Anchor\" href=\"#1-解密表观遗传学的三个方向与测序方法\"></a> 1. 解密表观遗传学的三个方向与测序方法</h4>\n<ul>\n<li><strong>1. 探索染色质的开放性</strong>（chromatin accessibility）<br />\n<code>ATAC-seq</code>: Assay of Transposase Accessible Chromatin sequencing<br />\n<code>DNase-seq</code>: DNase I hypersensitive sites sequencing<br />\n<code>FAIRE-seq</code>: Formaldehyde-Assisted Isolation of Regulatory Elements sequencing</li>\n<li><strong>2. 探索转录因子的绑定与组蛋白修饰</strong>（TF binding and histone modifications）<br />\n<code>ChIP-seq</code>: Chromatin Immuno-Precipitation sequencing</li>\n<li><strong>3. 探索核小体占位</strong>（nucleosome positioning and occupancy）<br />\n<code>MNase-seq</code>: Micrococcal Nuclease sequencing</li>\n</ul>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632949992-700x506.png\" alt=\"\" /></p>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632949994-700x844.png\" alt=\"\" /></p>\n<h4 id=\"2-名词解释\"><a class=\"markdownIt-Anchor\" href=\"#2-名词解释\"></a> 2. 名词解释</h4>\n<ul>\n<li><code>epigenetics</code>：表观遗传学。表观遗传学修饰在不改变 DNA 序列的情况下控制着基因的表达，包括染色质重塑、组蛋白修饰、DNA 甲基化和 microRNA 通路等</li>\n<li><code>peaks</code>: 峰。常用来表示染色质的开放程度，因为是测序的 reads 落在了染色质的开放区，堆叠后被可视化的一种丰度的体现。</li>\n</ul>\n<p>但 peaks 到底代表什么？莫非 peaks 所在区域要么是启动子要么是增强子？再或者就是笼统定义为调控元件？（我目前的观点是，只能把他理解为酶切的位点，如果非要定义是否是特定分调控元件，只能进行后续分析。）</p>\n<ul>\n<li>\n<p><code>THSs</code>: 转座酶超敏感位点（transposase hypersensitive sites）。</p>\n</li>\n<li>\n<p><code>CREs</code>: 顺式调控元件（cis-regulatory elements）。即 DNA 分子中具有转录调节功能的特异 DNA 序列。按功能特性，真核基因顺式作用元件分为启动子、增强子及沉默子。</p>\n</li>\n<li>\n<p><code>ACRs</code>: 染色质开放区域（accessible chromatin regions）。即正常或核小体被酶切裸露出来的 DNA 片段所在的区域。这篇<a href=\"https://www.nature.com/articles/s41477-019-0548-z\">【NP | 2019】</a>根据 ACRs 距离最近基因的距离将 ACRs 分为三种类型：genic (gACRs; overlapping a gene), proximal (pACRs; within 2kb of a gene) or distal (dACRs; &gt;2 kb from a gene)，分别是跨越基因的，近端的，远端的染色质开放区。</p>\n</li>\n<li>\n<p><code>transposon</code>: 转座子。一段可以从原位上单独复制或断裂下来，环化后插入另一位点，并对其后的基因起调控作用的 DNA 序列。</p>\n</li>\n<li>\n<p><code>promoter</code>: 启动子。启动子是位于结构基因 5’端上游的 DNA 序列，能活化 RNA 聚合酶，使之与模板 DNA 准确的结合并具有转录起始的特异性。每个启动子包括至少一个转录起始点以及一个以上的功能组件（典型的如 TATA 盒子）</p>\n</li>\n<li>\n<p><code>proximal promoters</code>: 近端启动子。是 DNA 上位于基因开始之前的一个区域，在那里蛋白质和其他分子结合在一起准备读取该基因。</p>\n</li>\n<li>\n<p><code>enhancer</code>: 增强子。增强子是远离转录起始点、决定基因的时间、空间特异性表达、增强启动子转录活性的 DNA 序列，其发挥作用的方式通常与方向、距离<strong>无关</strong>，可位于转录起始点的上游或下游。从功能上讲，没有增强子存在，启动子通常不能表现活性；没有启动子时，增强子也无法发挥作用。根据南京大学陈迪俊老师的研究表明增强子比启动子能结合更多的转录因子 <a href=\"https://www.nature.com/articles/s41467-019-09513-2\">(Nature Communications)</a></p>\n</li>\n<li>\n<p><code>TFs</code>: 转录因子（transcription factors）是保证目的基因以特定的强度在特定的时间与空间表达的蛋白质分子。与 RNA 聚合酶 Ⅱ 形成转录起始复合体，共同参与转录起始的过程。</p>\n</li>\n<li>\n<p><code>TSS</code>: 转录起始位点（transcription start site）。在一个典型的基因内部，排列顺序为转录起始位点 (TSS，一个碱基)- 起始密码子编码序列 (ATG)- 终止密码子编码序列 (TGA)- 转录终止位点 (TTS)，即 TSS-ATG-TGA-TTS</p>\n</li>\n<li>\n<p><code>histone</code>：组蛋白。通常含有 H1，H2A，H2B，H3，H4 等 5 种成分，其中 H1 与 H3 极度富含赖氨酸（lysine），H1 不保守，其他组蛋白的基因非常保守。除 H1 外，其他 4 种组蛋白均分别以二聚体 (共八聚体）相结合，形成核小体核心。DNA 便缠绕在核小体的核心上。而 H1 则与核小体间的 DNA 结合</p>\n</li>\n<li>\n<p><code>nucleosome</code>: 核小体。是由 DNA 和组蛋白形成的染色质基本结构单位。每个核小体由 146bp 的 DNA 缠绕组蛋白八聚体 1.75 圈形成。核小体核心颗粒之间通过 50bp 左右的连接 DNA 相连，暴露在核小体表面的 DNA 能被特定的核酸酶接近并切割</p>\n</li>\n<li>\n<p><code>H3K4me1</code>: 组蛋白 H3 上的第 4 位赖氨酸发生单甲基化（mono-methylation of H3 at lysine 4） <a href=\"https://www.nature.com/articles/s41588-017-0018-3\">（NG | H3K4me1 与增强子的关系）</a></p>\n</li>\n<li>\n<p><code>H3K9ac</code>：组蛋白 H3 上的第 9 位赖氨酸发生乙酰化（H3 acetylation marks at lysine 9）关于 H3K4me1 与 H3K9ac 的不同，依旧可以参考这篇文献<a href=\"https://www.nature.com/articles/s41477-019-0548-z\">【NP | 2019】</a>或<a href=\"https://www.nature.com/articles/s41467-019-09513-2\">【NC | 2019】</a></p>\n</li>\n<li>\n<p><code>组蛋白甲基化</code>：甲基化可发生在组蛋白的赖氨酸和精氨酸残基上，而且赖氨酸残基能够发生单、双、三甲基化，而精氨酸残基能够单、双甲基化，这些不同程度的甲基化极大地增加了组蛋白修饰和调节基因表达的复杂性</p>\n</li>\n<li>\n<p><code>组蛋白乙酰化</code>：四种类型的组蛋白相互作用，将细胞核里的 DNA 紧紧地包装起来。这样的紧密包装能够有效阻止酶读取 DNA 上的遗传信息。然而，乙酰基连到组蛋白上能削弱它们对 DNA 的占据。因此局部乙酰化能暴露出相应的基因，让它们更容易激活<img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632949997-700x318.png\" alt=\"\" /></p>\n<p>真核生物细胞核内染色质结构</p>\n</li>\n</ul>\n<h3 id=\"二-基础分析\"><a class=\"markdownIt-Anchor\" href=\"#二-基础分析\"></a> 二、基础分析</h3>\n<h3 id=\"1-分析前的准备\"><a class=\"markdownIt-Anchor\" href=\"#1-分析前的准备\"></a> 1. 分析前的准备</h3>\n<p>1.1 下载 ATAC 测序数据（或者用你自己的数据也行）</p>\n<ul>\n<li>所需软件：<a href=\"https://www.ibm.com/aspera/connect/\">Aspera Connect</a></li>\n<li>软件安装与使用：参考<a href=\"https://www.plob.org/tag/aspera\">这系列文章</a></li>\n<li>数据下载：项目 ID<a href=\"https://www.ncbi.nlm.nih.gov/bioproject/PRJNA480717/\">【PRJNA480717】</a><a href=\"https://academic.oup.com/jxb/article/70/15/3867/5481770\">【文章原文】</a>，SRR 序列号如下图，下载方法和上文相同。由于数据量大，测试浪费时间，所以我在每个文件中取了 100w 条 reads，由于百度网盘太慢了，你可以去扣扣群 559758504 里面随便下载一个用于测试。</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fastqc -t 8 -o ./ *.fastq.gz</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950000-700x238.png\" alt=\"\" /></p>\n<p>image.png</p>\n<p>1.2 下载 tair10 基因组与 gff3 注释文件</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bwa index -p /路径/bwaIndexTair /路径/TAIR10_genome.fa</span><br></pre></td></tr></table></figure>\n<p>1.3 安装 miniconda</p>\n<ul>\n<li>由于后续分析大多数软件都是来源于 conda，因此你必须知道怎么使用。参考<a href=\"https://www.plob.org/article/13100.html\">【conda 的安装与使用】</a></li>\n</ul>\n<p>1.4 所需软件安装（分析中所用到的软件都汇集于此，下文不再介绍如何下载）</p>\n<p>请先激活 conda 环境在安装！</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda install -c bioconda -y fastqc</span><br><span class=\"line\">conda install -c bioconda -y trimmomatic</span><br><span class=\"line\">conda install -c bioconda -y bwa</span><br><span class=\"line\">conda install -c bioconda -y samtools</span><br><span class=\"line\">conda install -c bioconda -y picard</span><br><span class=\"line\">conda install -c bioconda -y macs2</span><br><span class=\"line\">conda install -c bioconda -y bedtools</span><br><span class=\"line\">conda install -c bioconda -y deeptools</span><br><span class=\"line\">conda install -c bioconda -y homer</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>后续分析是使用 SRR7512044 作为测试数据，但是思路和方法都可以借鉴。</p>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950000-1.png\" alt=\"\" /></p>\n<p>测试数据</p>\n<h3 id=\"2-测序质量检测\"><a class=\"markdownIt-Anchor\" href=\"#2-测序质量检测\"></a> 2. 测序质量检测</h3>\n<ul>\n<li>所需软件：<a href=\"https://anaconda.org/bioconda/fastqc\">FastQC</a><a href=\"https://www.bioinformatics.babraham.ac.uk/projects/fastqc/\">【官方网站】</a></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fastqc -t 8 -o ./ *.fastq.gz</span><br></pre></td></tr></table></figure>\n<p><code>-t</code>: 线程<br />\n<code>-o</code>: 存放路径，不用指定前缀，默认为. fastq.gz 前面的字段<br />\n<code>*.fastq.gz</code>: fastqc 可以同时接受多个 fastq.gz 文件，因此采用正则表达式【*】表示全部</p>\n<ul>\n<li>结果解读<br />\n由于开始测序时不准确，因此前 15bp 左右的 ATGC 含量有波动，需要在后面截掉。而最长 reads 为 76bp，则暗示着我最后至少要保留多长的序列。<br />\n一般我的计算思路是：保留的序列长度 =（最长的的 reads 长度 - 前面波动的碱基长度）× 40%</li>\n</ul>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950001-700x514.png\" alt=\"\" /></p>\n<h3 id=\"2-测序质量检控制\"><a class=\"markdownIt-Anchor\" href=\"#2-测序质量检控制\"></a> 2. 测序质量检控制</h3>\n<ul>\n<li>所需软件：<a href=\"https://anaconda.org/bioconda/trimmomatic\">Trimmomatic</a><a href=\"https://links.jianshu.com/go?to=%255Bhttp%3A//www.usadellab.org/cms/%3Fpage%3Dtrimmomatic%255D%28http%3A//www.usadellab.org/cms/%3Fpage%3Dtrimmomatic%29\">【官方网站】</a><a href=\"https://www.plob.org/article/6258.html\">【中文介绍】</a><br />\n其实这批数据已经做过质控了，如何判断的呢？QC 的为一个范围且短于提供给 NCBI 上的数据。因此我们没必要质控，但为了流程的完整性，还是假装质控一下。质控之后，还要进行质检，如此循环，直到合格。</li>\n</ul>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950001-1-700x296.png\" alt=\"\" /></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 定义一些变量，后面修改起来方便</span><br><span class=\"line\">filename=SRR7512044</span><br><span class=\"line\"> </span><br><span class=\"line\">trimmomatic PE -threads 10 </span><br><span class=\"line\">./$&#123;filename&#125;_1.fastq.gz ./$&#123;filename&#125;_2.fastq.gz </span><br><span class=\"line\">./$&#123;filename&#125;_1.clean.fq.gz ./$&#123;filename&#125;_1.drop.fq.gz </span><br><span class=\"line\">./$&#123;filename&#125;_2.clean.fq.gz ./$&#123;filename&#125;_2.drop.fq.gz </span><br><span class=\"line\">HEADCROP:15 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:24</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><code>PE</code>: 双端模式。需要两个输入文件，正向测序序列和反向测序序列：<code>sample_R1.fastq.gz</code>和<code>sample_R2.fastq.gz</code>；<br />\n以及四个输出文件：<code>sample_1.clean.fq.gz</code>和<code>sample_1.drop.fq.gz</code>；<code>sample_2.clean.fq.gz</code>和<code>sample_2.drop.fq.gz</code><br />\n<code>-threads</code>: 线程数<br />\n<code>HEADCROP</code>: 从 reads 的开头切掉指定数量的碱基，即从 fastqc 中看的<br />\n<code>LEADING</code>: 从 reads 的开头切除质量值低于阈值的碱基<br />\n<code>TRAILING</code>: 从 reads 的末尾开始切除质量值低于阈值的碱基<br />\n<code>SLIDINGWINDOW</code>: 从 reads 的 5’ 端开始，进行滑窗质量过滤，切掉碱基质量平均值低于阈值的滑窗<br />\n<code>MINLEN</code>: 如果经过剪切后 reads 的长度低于阈值则丢弃这条 reads，即上面的计算方法：（76-15）×40%≈24</p>\n<h3 id=\"3-建立索引与序列比对\"><a class=\"markdownIt-Anchor\" href=\"#3-建立索引与序列比对\"></a> 3. 建立索引与序列比对</h3>\n<ul>\n<li>所需软件：<a href=\"https://www.plob.org/tag/bwa\">bwa</a> 和 <a href=\"https://www.plob.org/tag/samtools\">samtools</a></li>\n<li>建立基因组索引。需要的时间挺长的，建议放后台。建好之后以后就可以跳过这一步了，且在经典的比对软件 STAR、hisat2、bowtie2 和 bwa-mem 中我更喜欢使用 STAR 和 bwa-mem。本次使用 bwa-mem 操作演示</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bwa index -p /路径/bwaIndexTair /路径/TAIR10_genome.fa</span><br></pre></td></tr></table></figure>\n<p><code>-p</code>: 索引前缀，后缀自动补充<br />\n<code>TAIR10_genome.fa</code>: 基因组文件</p>\n<ul>\n<li>序列比对<br />\n由于 sam 文件较大，因此我们直接跳过 sam，使用 samtools 转换为排序后的 bam 文件，注意【|】不要漏掉，且排序是依据 reads 比对到基因组的位置排的</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 定义一些变量，后面用</span><br><span class=\"line\">filename=SRR7512044</span><br><span class=\"line\">index=/路径/bwaIndexTair</span><br><span class=\"line\"> </span><br><span class=\"line\">bwa mem -M -t 8 </span><br><span class=\"line\">-R &quot;@RGtID:$&#123;filename&#125;tSM:$&#123;filename&#125;tLB:WXStPL:Illumina&quot; </span><br><span class=\"line\">$index </span><br><span class=\"line\">$&#123;filename&#125;_1.clean.fq.gz </span><br><span class=\"line\">$&#123;filename&#125;_2.clean.fq.gz </span><br><span class=\"line\">| samtools sort -O bam -@ 10 -o ./$&#123;filename&#125;.raw.bam</span><br><span class=\"line\">#无论干啥，生成bam文件后就要建立bam索引，并检查比对情况</span><br><span class=\"line\">samtools index -@ 10 -b ./$&#123;filename&#125;.raw.bam</span><br><span class=\"line\">samtools flagstat ./$&#123;filename&#125;.raw.bam &gt; ./$&#123;filename&#125;.raw.stat</span><br><span class=\"line\">cat $&#123;filename&#125;.raw.stat</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><code>-M</code>: 将 shorter split hits 标记为次优，以兼容 Picard’s markDuplicates 软件<br />\n<code>-R</code>: STR 完整的 read group 的头部，可以用’t’ 作为分隔符， 在输出的 SAM 文件中被解释为制表符 TAB. read group 的 ID，会被添加到输出文件的每一个 read 的头部，<br />\n<code>-O</code>: 表示输出的 bam 文件<br />\n<code>-o</code>: 输出的 bam 文件名<br />\n<code>-t</code>与<code>@</code>: 线程数</p>\n<ul>\n<li>关于 stat 中内容的解释如下</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">14608455   0 in total (QC-passed reads   QC-failed reads) reads总数</span><br><span class=\"line\">37967   0 secondary                                       出现比对到参考基因组多个位置的reads数</span><br><span class=\"line\">0   0 supplementary                                       可能存在嵌合的reads数</span><br><span class=\"line\">0   0 duplicates                                          重复的reads数</span><br><span class=\"line\">14590894   0 mapped (99.88% : N/A)                        比对到参考基因组上的reads数</span><br><span class=\"line\">14570488   0 paired in sequencing                         属于PE read的reads总数。</span><br><span class=\"line\">7285244   0 read1                                         PE read中Read 1 的reads 总数。</span><br><span class=\"line\">7285244   0 read2                                         PE read中Read 2 的reads 总数。</span><br><span class=\"line\">14507068   0 properly paired (99.56% : N/A)               完美比对的reads总数。PE两端reads比对到同一条序列，且根据比对结果推断的插入片段大小符合设置的阈值。</span><br><span class=\"line\">14551500   0 with itself and mate mapped                  PE两端reads都比对上参考序列的reads总数。</span><br><span class=\"line\">1427   0 singletons (0.01% : N/A)                         PE两端reads，其中一端比上，另一端没比上的reads总数。</span><br><span class=\"line\">26260   0 with mate mapped to a different chr             PE read中，两端分别比对到两条不同的序列的reads总数。</span><br><span class=\"line\">17346   0 with mate mapped to a different chr (mapQ&gt;=5)   PE read中，两端分别比对到两条不同</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"4-去除-pcr-重复并再次进行质控\"><a class=\"markdownIt-Anchor\" href=\"#4-去除-pcr-重复并再次进行质控\"></a> 4. 去除 PCR 重复并再次进行质控</h3>\n<ul>\n<li>所需软件：picard 与 <a href=\"https://www.plob.org/tag/samtools\">samtools</a><br />\n不建议使用 sambamba，虽然快，但是毛病多，尤其是在你不知情的情况下，软件卡死或者在最后输出文件时提示输出文件夹过多等。</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">picard MarkDuplicates </span><br><span class=\"line\">REMOVE_DUPLICATES=true </span><br><span class=\"line\">I=$&#123;filename&#125;.raw.bam </span><br><span class=\"line\">O=$&#123;filename&#125;.rmdup.bam </span><br><span class=\"line\">M=$&#123;filename&#125;.rmdup.log</span><br><span class=\"line\"># 实时监测我们的数据发生了什么变化</span><br><span class=\"line\">samtools index $&#123;filename&#125;.rmdup.bam</span><br><span class=\"line\">samtools flagstat $&#123;filename&#125;.rmdup.bam &gt; ./$&#123;filename&#125;.rmdup.stat</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><code>REMOVE_DUPLICATES=true</code>: 表示将检测出的 PCR duplication 直接去除；<br />\n<code>I</code>: 或者 INPUT 指定输入的 bam 文件；<br />\n<code>O</code>: 或者 OUTPUT 指定输出去除 PCR duplication 的 bam 文件；<br />\n<code>M</code>: 或者 METRICS_FILE 指定输出的 matrix log 文件。</p>\n<ul>\n<li>下面是再次进行质控</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">samtools view -h -f 2 -q 30 $&#123;filename&#125;.rmdup.bam </span><br><span class=\"line\">| grep -v -e &quot;mitochondria&quot; -e &quot;*&quot; -e &quot;chloroplast&quot; </span><br><span class=\"line\">| samtools sort -O bam -@ 10 -o - &gt; $&#123;filename&#125;.last.bam</span><br><span class=\"line\"># 实时监测我们的数据发生了什么变化</span><br><span class=\"line\">samtools index $&#123;filename&#125;.last.bam</span><br><span class=\"line\">samtools flagstat $&#123;filename&#125;.last.bam &gt; ./$&#123;filename&#125;.last.stat</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><code>-h</code>: 输出的 sam 文件带 header，默认不带<br />\n<code>-f</code>: 输出含有所有 flag 的 reads<br />\n<code>-q</code> 比对的最低质量值，一般 20/30 都可以<br />\n其他参数介绍看 <a href=\"https://www.plob.org/tag/samtools\">samtools 使用简述</a>，需要说明的是由于比对到线粒体和叶绿体的 reads 不是我们关注的重点，因此使用<code>grep</code>剔除掉，当然了，做动物的话需要剔除什么视情况而定了。</p>\n<ul>\n<li>好了，下面来看看我们的数据从 raw data -&gt; rmdup -&gt; last 到底发生了那些变化<img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950002-700x344.png\" alt=\"\" /></li>\n<li>然后，从 IGV 看看发生了什么变化<br />\n关于使用 IGV 查看 bam 文件中 reads 呈现不同颜色的说明</li>\n</ul>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950005-700x773.png\" alt=\"\" /></p>\n<h3 id=\"5-统计过滤后的结果中-insertsize-长度分布\"><a class=\"markdownIt-Anchor\" href=\"#5-统计过滤后的结果中-insertsize-长度分布\"></a> 5. 统计过滤后的结果中 Insertsize 长度分布</h3>\n<ul>\n<li>所需软件：picard<br />\nInsertsize =（read2 的比对位点 - read1 的比对位点） read2 的长度。也可以随便点击上图 IGV 中任一一条 reads 查看插入片段的大小</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">picard CollectInsertSizeMetrics </span><br><span class=\"line\">I=./$&#123;filename&#125;.last.bam </span><br><span class=\"line\">O=./$&#123;filename&#125;.last.insertsize </span><br><span class=\"line\">H=./$&#123;filename&#125;.last.hist.pdf</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950006-700x683.png\" alt=\"\" /></p>\n<h3 id=\"5-peak-calling-与-frip_scorespot_score-的计算\"><a class=\"markdownIt-Anchor\" href=\"#5-peak-calling-与-frip_scorespot_score-的计算\"></a> 5. peak calling 与 FRiP_score/SPOT_score 的计算</h3>\n<ul>\n<li>所需软件：<a href=\"https://www.plob.org/article/7118.html\">macs2</a> 和 <a href=\"https://www.plob.org/tag/bedtools\">bedtools</a><br />\n因为 macs2 需要用到基因组的有效大小，而软件本身就提供了 4 个物种的有效基因组大小。</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">effective_genome_size=119481543</span><br><span class=\"line\"> </span><br><span class=\"line\">bedtools bamtobed -i $&#123;filename&#125;.last.bam &gt; $&#123;filename&#125;.last.bed</span><br><span class=\"line\">macs2 callpeak </span><br><span class=\"line\">-t $&#123;filename&#125;.last.bed </span><br><span class=\"line\">-g $&#123;effective_genome_size&#125; </span><br><span class=\"line\">--nomodel --shift -100 --extsize 200 </span><br><span class=\"line\">-n $&#123;filename&#125;.last </span><br><span class=\"line\">-q 0.01 --outdir ./peaks</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<ul>\n<li>其实，这里面讨论最多的是<code>--nomodel --shift -100 --extsize 200</code>这些参数如何选择，下面的图很形象的展示了参数的作用。当然，我也是查阅了很多资料与文献，一般默认在<code>ATAC-seq，DNase-seq，FAIRE-seq</code>的时候将<code>shift</code>设置为<code>extsize</code>的一半，且参数固定为：<code>--nomodel --shift 100 --extsize 200</code>。而在<code>MNase-seq</code>的时候，参数固定为：<code>--nomodel --shift 37 --extsize 73</code>。在<code>ChiP-seq</code>的时候不用移峰，所以只使用<code>-nomodel</code>，当做组蛋白修饰的时候，由于 peak 并<a href=\"http://blog.sina.com.cn/s/blog_4bc742520102uy64.html\">不典型</a>，所以使用<code>–nomodel –shift 73</code>参数。另外如何使用<code>macs2 predictd</code>预测双峰模型，这里就不展开介绍了，可以私聊我，我把脚本发你。</li>\n</ul>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950007.png\" alt=\"\" /></p>\n<p>shift 与 extsize 到底在干啥？</p>\n<ul>\n<li>下面是我见过的图中解释<strong>移峰</strong>现象最清楚的了，可以参考</li>\n</ul>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950007-1-700x503.png\" alt=\"\" /></p>\n<p>移峰</p>\n<ul>\n<li>最后，就是输出文件的解读\n<ol>\n<li><strong>${filename}_peaks.xls</strong></li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">前几行是callpeak时的命令。后面是：</span><br><span class=\"line\">1.染色体号</span><br><span class=\"line\">2.peak起始位点</span><br><span class=\"line\">3.peak结束位点</span><br><span class=\"line\">4.peak区域长度</span><br><span class=\"line\">5.peak的峰值位点（summit position）</span><br><span class=\"line\">6.peak 峰值的高度（pileup height at peak summit, -log10(pvalue) for the peak summit）</span><br><span class=\"line\">7.peak的富集倍数（相对于random Poisson distribution with local lambda）</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<ol start=\"2\">\n<li><strong>${filename}_peaks.narrowPeak</strong></li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">narrowPeak文件是BED6 4格式，可以上传到IGV查看</span><br><span class=\"line\">1.染色体号</span><br><span class=\"line\">2.peak起始位点</span><br><span class=\"line\">3.peak结束位点</span><br><span class=\"line\">4.peak name（样本名 _peak_1的后缀之类的）</span><br><span class=\"line\">5.-10*log10qvalue</span><br><span class=\"line\">6.正负链</span><br><span class=\"line\">7.fold change</span><br><span class=\"line\">8.-log10pvalue</span><br><span class=\"line\">9.-log10qvalue</span><br><span class=\"line\">10.相对于峰的峰顶位置（relative summit position to peak start）</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<ul>\n<li>注意：excel 里的起始坐标需要减 1 才与 narrowPeak 的坐标一致，见下图。<br />\n3.  <strong>${filename}_summits.bed</strong></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">BED格式的文件，包含peak的summits（峰顶）位置</span><br><span class=\"line\">1.染色体号</span><br><span class=\"line\">2.峰的峰顶起始位点（注意是峰顶，不是峰，他只是一个点）</span><br><span class=\"line\">3.峰的峰顶起始位点（因此二者就差一个碱基的位置）</span><br><span class=\"line\">4.峰顶（样本名 _peak_1的后缀之类的）</span><br><span class=\"line\">5.-log10pvalue</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<p>注意：excel 里的起始坐标需要减 1 才与 narrowPeak 的坐标一致，见下图。</p>\n</li>\n<li>\n<p><strong>另外，需要告诉你的是，bed 文件中第 2 列中的峰顶起始位点是如何计算的？</strong><br />\nbed 文件中第 2 列（峰的峰顶起始位点） = xls 第二列 xls 第十列 -1。或者↓↓↓↓<br />\nbed 文件中第 2 列（峰的峰顶起始位点） = narrowPeak 第二列 narrowPeak 第十列</p>\n</li>\n<li>\n<p>总览比较：<img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950008-700x407.png\" alt=\"\" /></p>\n<p>bed，narrowPeak，bdg，xls 四种类型输出文件的比较</p>\n</li>\n<li>\n<p>FRiP_score 的计算<a href=\"https://www.encodeproject.org/atac-seq/\">【官方介绍】</a><br />\n简单来说，FRiP_score 说的就是统计落在 Peaks 里面的 reads 数量与所有比对到基因组上 reads 数量的比值。可以作为判定样本测序质量的一个指标。</p>\n</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Reads=$(bedtools intersect -a $&#123;filename&#125;.last.bed -b $&#123;filename&#125;_peaks.narrowPeak |wc -l|awk &#x27;&#123;print $1&#125;&#x27;)</span><br><span class=\"line\">totalReads=$(wc -l $&#123;filename&#125;.last.bed|awk &#x27;&#123;print $1&#125;&#x27;) </span><br><span class=\"line\">echo $&#123;Reads&#125; $&#123;totalReads&#125; $&#123;filename&#125; &#x27;FRiP_score:&#x27; $(echo &quot;scale=2;100*$&#123;Reads&#125;/$&#123;totalReads&#125;&quot;|bc)&#x27;%&#x27;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<ul>\n<li>官网上说 ATAC-Seq 的 FRiP score should be &gt;30%（<a href=\"https://www.encodeproject.org/atac-seq/\">https://www.encodeproject.org/atac-seq/</a>）我猜是如果大多数 reads 都不在 peaks 区域，说明测序质量或者实验效果不是太好，因为酶切切开的就是 peaks 区域，太少不是就偏离实验目的了嘛</li>\n<li>SPOT_score 的计算<a href=\"https://www.encodeproject.org/data-standards/terms/\">【官方介绍】</a><a href=\"https://www.encodeproject.org/software/hotspot/\">【软件安装】</a><br />\n简单来说，SPOT_score 就是在 FRiP_score 的基础上增加了测序深度的条件限制，比如 FRiP 是统计全局的 reads，而 SPOT 只统计测序深度为 30× 的 reads，大于 30× 的 reads 不再参与统计。目前我还在探索中如何计算。</li>\n</ul>\n<h3 id=\"二-高级分析\"><a class=\"markdownIt-Anchor\" href=\"#二-高级分析\"></a> 二、高级分析</h3>\n<p>所谓的高级并不高大上，做了有可能也不能让你的文章提升档次，望周知！</p>\n<h3 id=\"1-igv-可视化\"><a class=\"markdownIt-Anchor\" href=\"#1-igv-可视化\"></a> 1. IGV 可视化</h3>\n<ul>\n<li>前面的 bam 文件，narrowPeak 文件，bed 文件都有了，现在还差一个 bw 文件，因此我们先跑下面的代码，然后在 IGV 里面统一看一下</li>\n<li>所需软件：<a href=\"https://anaconda.org/bioconda/deeptools\">deeptools</a> 和 <a href=\"https://software.broadinstitute.org/software/igv/download\">IGV</a><br />\n主要是为生成 bw 文件用于 IGV 展示</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bamCoverage --bam $&#123;filename&#125;.last.bam -o $&#123;filename&#125;.last.bw </span><br><span class=\"line\">    --binSize 10 </span><br><span class=\"line\">    --normalizeUsing RPGC </span><br><span class=\"line\">    --effectiveGenomeSize $&#123;effective_genome_size&#125; </span><br><span class=\"line\">    --ignoreForNormalization chrX </span><br><span class=\"line\">    --extendReads</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>注：如果发现没有这个包 pysam.libchtslib，直接安装<code>pip install numpydoc</code><br />\n<code>-o</code>: 生成 bw 文件<br />\n<code>binSize</code>: 自行设定覆盖度计算的窗口大小 (bin)<br />\n<code>normalizeUsing</code>: 数据准化方法，有三种 RPGC，RPKM，CPM，BPM<br />\n<code>ignoreForNormalization</code>: 设置你想忽略的染色体名称<br />\n<code>extendReads</code>: 让 reads 扩展至 fragment 的大小</p>\n<ul>\n<li>IGV 一览</li>\n</ul>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950009-700x436.png\" alt=\"\" /></p>\n<p>IGV 可视化 bw、narrowpeak，bed，bam，gff 文件</p>\n<h3 id=\"2-tsstes-可视化\"><a class=\"markdownIt-Anchor\" href=\"#2-tsstes-可视化\"></a> 2. TSS/TES 可视化</h3>\n<ul>\n<li>\n<p>所需软件：<a href=\"https://anaconda.org/bioconda/deeptools\">deeptools</a><br />\n主要是如何生成 <a href=\"http://www.bio-info-trainee.com/2494.html\">Refseq 文件</a>，虽然官网上提供了一些，但总归是不能覆盖所有物种，因此，我们可以从 gff/gtf 文件中自己创造。</p>\n</li>\n<li>\n<p>先提取<strong>基因</strong>的位置信息（不是 cds 或者 exon），根据不同的 gff 进行修改，但格式始终是<code>`chrom/chromStart/chromEnd/name/score/strand`</code></p>\n  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">awk -vFS=&#x27;[\\t=;]&#x27; -vOFS=&quot;\\t&quot; \\</span><br><span class=\"line\">&#x27;&#123;if ($3==&quot;gene&quot;) print $1,$4,$5,$10,$6,$7&#125;&#x27; \\</span><br><span class=\"line\">TAIR10.gff|sed &#x27;s/Chr//g&#x27; &gt; refseq.bed  </span><br><span class=\"line\">#由于tair官网上提供的基因组文件中染色人命名没有Chr，为保持一致，这里去掉</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>然后进行 TSS 可视化</p>\n</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">computeMatrix reference-point --referencePoint TSS  -p 15 </span><br><span class=\"line\">    -b 2000 -a 2000 </span><br><span class=\"line\">    -R ./refseq.bed </span><br><span class=\"line\">    -S *.bw </span><br><span class=\"line\">    -o TSS.gz </span><br><span class=\"line\">    --skipZeros </span><br><span class=\"line\">    --outFileSortedRegions Heatmap1sortedRegions.bed</span><br><span class=\"line\">plotHeatmap -m TSS.gz -out TSS.Heatmap.pdf --plotFileFormat pdf</span><br><span class=\"line\">plotProfile -m TSS.gz -out TSS.Profile.pdf --plotFileFormat pdf --perGroup</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950010-700x629.png\" alt=\"\" /></p>\n<ul>\n<li>然后进行 TES 可视化</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">computeMatrix scale-regions  -p 15  </span><br><span class=\"line\">    -b 2000 -a 2000 </span><br><span class=\"line\">    -R ./refseq.bed </span><br><span class=\"line\">    -S *.bw </span><br><span class=\"line\">    --skipZeros -o body.gz</span><br><span class=\"line\">plotHeatmap -m body.gz -out body.Heatmap.pdf --plotFileFormat pdf</span><br><span class=\"line\">plotProfile -m body.gz -out body.Profile.pdf --plotFileFormat pdf --perGroup</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950011-700x630.png\" alt=\"\" /></p>\n<ul>\n<li>另外，参考下面这个图，看每个参数控制的哪里，如何同时绘制多个等。这是我好久之前总结的，清晰度堪忧</li>\n</ul>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950013-700x649.png\" alt=\"\" /></p>\n<h3 id=\"3-相关性可视化依旧是使用-deeptools\"><a class=\"markdownIt-Anchor\" href=\"#3-相关性可视化依旧是使用-deeptools\"></a> 3. 相关性可视化（依旧是使用 deeptools）</h3>\n<ul>\n<li>因为我测试样本少，所以就使用<a href=\"https://deeptools.readthedocs.io/en/latest/content/tools/plotCorrelation.html\">官网的图</a>了哈，但代码是能跑通的，放心使用。</li>\n<li>先使用 [bw] 文件生成 [npz] 文件。所有样本做相关性，用 [*.last.bw]，多个单列出来也行</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">multiBigwigSummary bins -b *.last.bw -o number.of.bins.npz</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<ul>\n<li>画相关性热图</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plotCorrelation -in number.of.bins.npz </span><br><span class=\"line\">--corMethod pearson </span><br><span class=\"line\">--skipZeros </span><br><span class=\"line\">--plotTitle &quot;Pearson Correlation of Average Scores Per Transcript&quot; </span><br><span class=\"line\">--plotFileFormat pdf </span><br><span class=\"line\">--whatToPlot heatmap --colorMap RdYlBu --plotNumbers </span><br><span class=\"line\">-o heatmap_PearsonCorr_bigwigScores.pdf </span><br><span class=\"line\">--outFileCorMatrix PearsonCorr_bigwigScores.tab</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950014-700x605.png\" alt=\"\" /></p>\n<p>heatmap</p>\n<ul>\n<li>画相关性点图</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plotCorrelation -in number.of.bins.npz </span><br><span class=\"line\">--corMethod pearson </span><br><span class=\"line\">--skipZeros </span><br><span class=\"line\">--plotTitle &quot;Pearson Correlation of Average Scores Per Transcript&quot; </span><br><span class=\"line\">--plotFileFormat pdf </span><br><span class=\"line\">--whatToPlot scatterplot </span><br><span class=\"line\">-o scatterplot_PearsonCorr_bigwigScores.pdf </span><br><span class=\"line\">--outFileCorMatrix PearsonCorr_bigwigScores.tab</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950015-700x734.png\" alt=\"\" /></p>\n<p>相关性点图</p>\n<h3 id=\"5-chipseeker-对-peaks-进行注释和可视化\"><a class=\"markdownIt-Anchor\" href=\"#5-chipseeker-对-peaks-进行注释和可视化\"></a> 5. ChIPseeker 对 peaks 进行注释和可视化</h3>\n<ul>\n<li>对 peak 的注释分为两个部分——结构注释和功能注释<br />\n结构注释会将 peak 所落在基因组上的区域结构注释出来，比如说启动子区域，UTR 区域，内含子区域等等。同时，也会将与 peak 最临近的基因注释出来，非常好用。<br />\n功能注释其实并不是对 peak 进行注释的，而是对 peak 最临近的基因注释的，因此这部分就和传统的 GO/KEGG 等分析如出一辙啦。</li>\n</ul>\n<h4 id=\"51-结构注释\"><a class=\"markdownIt-Anchor\" href=\"#51-结构注释\"></a> <strong>5.1 结构注释</strong></h4>\n<p>5.1.1 <strong>准备工作</strong>：导入包，没有的安装吧。另外需要使用 gff/gtf 构建一个 TxDb。因为<a href=\"http://www.bioconductor.org/packages/release/BiocViews.html%23___TxDb\">官网</a>上 TxDb 也不是每一个物种都有（目前共 43 个），因此我们自己手动构建。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#if (!requireNamespace(&quot;BiocManager&quot;, quietly = TRUE))</span><br><span class=\"line\">#    install.packages(&quot;BiocManager&quot;)</span><br><span class=\"line\">#BiocManager::install(&quot;clusterProfiler&quot;)</span><br><span class=\"line\"> </span><br><span class=\"line\">library(clusterProfiler)</span><br><span class=\"line\">library(ChIPseeker)</span><br><span class=\"line\">library(GenomicFeatures)</span><br><span class=\"line\">txdb &lt;- makeTxDbFromGFF(&quot;public/bioinfoYu/genome/tair10/TAIR10.gff&quot;,</span><br><span class=\"line\">                        format=&quot;gff&quot;)    #也可以使用gtf</span><br><span class=\"line\">keytypes(txdb)    #感兴趣的话，可以用以下方法探索txdb都包含了什么内容</span><br><span class=\"line\">keys(txdb)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>5.1.2 <strong>单个文件的结构注释</strong>（不推荐在这一步加 OrgDB 的内容，没用）</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#读入单个summits文件</span><br><span class=\"line\">peaks &lt;- readPeakFile(&quot;SRR7512044_summits.bed&quot;)</span><br><span class=\"line\">#结构注释</span><br><span class=\"line\">peakAnno &lt;- annotatePeak(peaks,</span><br><span class=\"line\">                         TxDb=txdb,</span><br><span class=\"line\">                         tssRegion=c(-1000, 1000))</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>上面的 tssRegion 取值有说法的，因为判定 “Promoter”, “Exon”, “Intron”, “Intergenic” 等结构的依据就是根据范围来的。比如定义 1000 以内的，则在 1kbp 之内规定为 “Promoter (&lt;=1kb)”，而 1k-2k 内定义为 “Downstream (1-2kb)”。但你定义 2000 以内呢，则在 1kbp 之内规定为 “Promoter (&lt;=1kb)”，而 1k-2k 内定义为 “Promoter (1-2kb)”。虽然，ChIPseeker 会标记出来区域，但还是三思后再取范围。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#注释完，进行可视化，多种图可供选择</span><br><span class=\"line\">plotAnnoBar(peakAnno)</span><br><span class=\"line\">plotDistToTSS(peakAnno)</span><br><span class=\"line\">vennpie(peakAnno)</span><br><span class=\"line\">plotAnnoPie(peakAnno)</span><br><span class=\"line\">#install.packages(&quot;ggupset&quot;)</span><br><span class=\"line\">library(ggupset)</span><br><span class=\"line\">upsetplot(peakAnno)</span><br><span class=\"line\">#install.packages(&quot;ggimage&quot;)</span><br><span class=\"line\">library(ggimage)</span><br><span class=\"line\">upsetplot(peakAnno, vennpie=TRUE)</span><br><span class=\"line\"> </span><br><span class=\"line\">#最后将我们的注释结果转为数据框，便于查看</span><br><span class=\"line\">df &lt;- as.data.frame(peakAnno)</span><br><span class=\"line\">#将注释到的基因提取出来（第14列），用于后续功能分析</span><br><span class=\"line\">gene &lt;- df[,14]</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950016-700x323.png\" alt=\"\" /></p>\n<p>提供可视化的方法</p>\n<p>5.1.3 <strong>多个文件的结构注释</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#一次也可以读入多个summits文件，使用list存储，然后使用lapply注释</span><br><span class=\"line\">files = list(peak1 = &quot;peaks.bed&quot;, peak2 = (&quot;peak.bed&quot;))</span><br><span class=\"line\">peakAnnoList &lt;- lapply(files, </span><br><span class=\"line\">                       annotatePeak,</span><br><span class=\"line\">                       TxDb=txdb,</span><br><span class=\"line\">                       tssRegion=c(-2000, 2000))</span><br><span class=\"line\">plotAnnoBar(peakAnnoList)</span><br><span class=\"line\">plotDistToTSS(peakAnnoList)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950019-700x220.png\" alt=\"\" /></p>\n<p>读入多个 summits 文件的可视化</p>\n<h4 id=\"52-功能注释\"><a class=\"markdownIt-Anchor\" href=\"#52-功能注释\"></a> <strong>5.2 功能注释</strong></h4>\n<p>5.2.1 <strong>可选支线</strong><br />\n由于这里需要物种的 OrgDb 注释库。如果你足够幸运，研究的物种正好在<a href=\"http://www.bioconductor.org/packages/release/BiocViews.html%23___OrgDb\">官网</a>仅提供的 20 个物种中存在，那就拿来用吧。除了以上这些都好说，还有是 id 转换，后面再说。<br />\n5.2.2 <strong>OrgDb 下载</strong><br />\n本次测试是用拟南芥的样本，我推荐在<a href=\"http://www.bioconductor.org/packages/release/BiocViews.html%23___OrgDb\">官网</a>中直接将所需要的的 OrgDb 库下载到服务器上，这样就不用在 R 里面重复在网上获取浪费时间了。比如说拟南芥，就可以下载，这样就把【org.At.tair.db】下载到了服务器或者本地了。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://www.bioconductor.org/packages/release/data/annotation/src/contrib/org.At.tair.db_3.13.0.tar.gz</span><br><span class=\"line\">tar -zvxf org.At.tair.db_3.13.0.tar.gz</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>5.2.3 <strong>导入 OrgDb</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#从本地下载OrgDb库（如果你直接下载到了R的lib里面，就直接library也可）</span><br><span class=\"line\">install.packages(&quot;/public/bioinfoYu/genome/tair10/org.At.tair.db&quot;, repos=NULL)</span><br><span class=\"line\">#另外一种方法</span><br><span class=\"line\">#if (!requireNamespace(&quot;BiocManager&quot;, quietly = TRUE))install.packages(&quot;BiocManager&quot;)</span><br><span class=\"line\">#BiocManager::install(&quot;org.At.tair.db&quot;)</span><br><span class=\"line\">#载入库</span><br><span class=\"line\">library(org.At.tair.db)</span><br><span class=\"line\">#感兴趣的话，看看org.At.tair.db包含的都是些啥</span><br><span class=\"line\">#查看包含的列名</span><br><span class=\"line\">keytypes(org.At.tair.db)</span><br><span class=\"line\">#查看包含的基因ID</span><br><span class=\"line\">keys(org.At.tair.db)</span><br><span class=\"line\">#随便选择一个基因和一些列名，看一看到第是什么东东，不过因为导入了其他包，下面命令报错，我至今还没有解决</span><br><span class=\"line\">select(org.At.tair.db,keys=&quot;AT1G01010&quot;,columns = c(&quot;ENTREZID&quot;,&quot;GO&quot;,&quot;SYMBOL&quot;))</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>5.2.4 <strong>ID 转换</strong>（非必须）<br />\n上面<code>5.1.2</code>已经得到 peak 附近的基因集【gene】了，如果需要 ID 转换，就是用<code>clusterProfiler</code>中的<code>bitr</code>函数</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#首先，去除版本号，如AT1G50040.1后面的.1，当然我们的测试集没有，因此不用做</span><br><span class=\"line\">#gene_rm &lt;- gsub(&quot;.[0-9] $&quot;,&quot;&quot;,gene)</span><br><span class=\"line\">#下面进行ID转换</span><br><span class=\"line\">keytypes(org.At.tair.db)</span><br><span class=\"line\">gene_last &lt;- bitr(geneID = gene, </span><br><span class=\"line\">                    fromType = &quot;TAIR&quot;,</span><br><span class=\"line\">                    toType = c(&quot;ENTREZID&quot;, &quot;SYMBOL&quot;, &quot;GENENAME&quot;),</span><br><span class=\"line\">                    OrgDb = org.At.tair.db)</span><br><span class=\"line\"> </span><br><span class=\"line\"># geneID    需要转换的ID</span><br><span class=\"line\"># fromType  当前ID类型</span><br><span class=\"line\"># toType    转换成什么ID，使用keytypes()查看有哪些类型</span><br><span class=\"line\"># OrgDb     注释数据库</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>5.2.5 <strong>GO 功能注释</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 因为keyType不接受数据框类型的数据，因此我们转换为字符型</span><br><span class=\"line\">genelist &lt;- gene.symbol[,2]  #注意我这里把ENTREZID单独拿出来了，所以下面自然是keyType = &quot;ENTREZID&quot;,</span><br><span class=\"line\">go_result &lt;- enrichGO(genelist,</span><br><span class=\"line\">                      keyType = &quot;ENTREZID&quot;, </span><br><span class=\"line\">                      OrgDb = org.At.tair.db, </span><br><span class=\"line\">                      ont = &quot;BP&quot;, #BP,MF,CC,ALL可选</span><br><span class=\"line\">                      pAdjustMethod = &quot;BH&quot;, </span><br><span class=\"line\">                      qvalueCutoff = 0.05, </span><br><span class=\"line\">                      readable = FALSE)</span><br><span class=\"line\">#可视化，showCategory=20调整显示的条目多少</span><br><span class=\"line\">dotplot(go_result, showCategory=20)</span><br><span class=\"line\">#将结果转为数据框，可以选择导出</span><br><span class=\"line\">goresult &lt;- as.data.frame(go_result)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950021-700x685.png\" alt=\"\" /></p>\n<p>GO 可视化</p>\n<p>5.2.6 <strong>KEGG 通路注释</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#geneClusters必须是数据框类型，ID必须是ENTREZID类型</span><br><span class=\"line\">class(gene.symbol)</span><br><span class=\"line\">compKEGG &lt;- compareCluster(geneClusters=gene.symbol, </span><br><span class=\"line\">                           fun = &quot;enrichKEGG&quot;,</span><br><span class=\"line\">                           organism = &quot;ath&quot;,    #在 http://www.genome.jp/kegg/catalog/org_list.html 上查看物种简写</span><br><span class=\"line\">                           pvalueCutoff  = 0.05, </span><br><span class=\"line\">                           pAdjustMethod = &quot;BH&quot;)</span><br><span class=\"line\">dotplot(compKEGG, showCategory = 20, title = &quot;KEGG Pathway Enrichment Analysis&quot;)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950022-700x342.png\" alt=\"\" /></p>\n<p>KEGG 可视化</p>\n<h3 id=\"6-homer-寻找-motif\"><a class=\"markdownIt-Anchor\" href=\"#6-homer-寻找-motif\"></a> 6. homer 寻找 motif</h3>\n<ul>\n<li>所需软件：<a href=\"https://anaconda.org/bioconda/homer\">homer</a><a href=\"http://homer.ucsd.edu/homer/\">【官方网站】</a></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 提取peaks的位置信息文件</span><br><span class=\"line\">awk &#x27;&#123;print $4&quot;t&quot;$1&quot;t&quot;$2&quot;t&quot;$3&quot;t &quot;&#125;&#x27; </span><br><span class=\"line\">SRR7512044_peaks.narrowPeak &gt; SRR7512044.homer_peaks.tmp</span><br><span class=\"line\"># 寻找motif</span><br><span class=\"line\">findMotifsGenome.pl SRR7512044.homer_peaks.tmp </span><br><span class=\"line\">./TAIR10_genome.fa   #指定参考基因组</span><br><span class=\"line\">./SRR7512044.motif   #输出文件夹的名字</span><br><span class=\"line\">-size 200 -len 8,10,12</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950023-700x261.png\" alt=\"\" /></p>\n<h3 id=\"7-diffbind-找差异-peak\"><a class=\"markdownIt-Anchor\" href=\"#7-diffbind-找差异-peak\"></a> 7. DiffBind 找差异 peak</h3>\n<ul>\n<li>所需软件：<a href=\"http://www.bioconductor.org/packages/release/bioc/html/DiffBind.html\">DiffBind</a></li>\n</ul>\n<p>首先根据我自己的理解将<strong>找差异 peak 的原理</strong>说一下：既然是找差异的 peak，那首先就要保证不同样本间 peak 所在的区间基本一致才可以。因此<strong>第一步</strong>就是找到多个样本相同的 peak 区间。<strong>第二步</strong>，基于这些相同区域的 peak 开始找差异，这个地方的差异和传统的 RNA-Seq 找差异基因的原理一模一样，都是<strong>对落在峰区间的 reads 进行计数</strong>，数量不同的话差异就由此而来。但软件都帮我们做了，就不用考虑那么多了</p>\n<ul>\n<li>我废话真多，其实最麻烦的就是<strong>准备输入数据</strong>，下面来看怎么做<br />\n一般情况相下需要包括以下几列：<code>&quot;SampleID&quot;， &quot;Tissue&quot;， &quot;Factor&quot;， &quot;Condition&quot; ，&quot;Treatment&quot;，&quot;Replicate&quot;， &quot;bamReads&quot; ，&quot;ControlID&quot; ，&quot;bamControl&quot; ，&quot;Peaks&quot;和&quot;PeakCaller&quot;</code></li>\n</ul>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950025-700x148.png\" alt=\"\" /></p>\n<ul>\n<li>但我们做 ATAC-Seq 的哪里有什么<code>control，controlID，bamControl</code>，因此删掉，而<code>&quot;Tissue&quot;， &quot;Factor&quot;， &quot;Condition&quot; ，&quot;Treatment&quot;，&quot;Replicate&quot;，</code>表示的都是分组的意思，因此我保留了两个<code>&quot;Factor&quot;，&quot;Replicate&quot;</code>，最后 csv 文件的样子如下：<img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950026-700x127.png\" alt=\"\" /></li>\n</ul>\n<p><code>SampleID</code>：不能有重复<br />\n<code>Factor</code>：进行分组，后面要做差异分析的依据<br />\n<code>Replicate</code>：重复的编号<br />\n<code>bamReads</code>：最后生成的 bam 文件。全路径 bam 文件名<br />\n<code>Peaks</code>：macs2 生成的 narrowPeak 文件。全路径 narrowPeak 文件名<br />\n<code>PeakCaller</code>：说明 peak 类型，使用 narrowPeak 文件则为<code>narrow</code>。使用 xls 文件，则用<code>macs</code>。使用 bed 文件，则用<code>bed</code></p>\n<ul>\n<li>开始正题</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 安装包</span><br><span class=\"line\">if (!requireNamespace(&quot;BiocManager&quot;, quietly = TRUE))install.packages(&quot;BiocManager&quot;)</span><br><span class=\"line\">BiocManager::install(&quot;DiffBind&quot;)</span><br><span class=\"line\">library(DiffBind)</span><br><span class=\"line\">#导入数据，dba函数会将会将bam文件一同导入，因此csv中的路径一定要准确</span><br><span class=\"line\">tamoxifen &lt;- dba(sampleSheet=&quot;atDiff.csv&quot;)</span><br><span class=\"line\">#查看样本间的相关性</span><br><span class=\"line\">plot(tamoxifen)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950027.png\" alt=\"\" /></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#计算每个样本中的reads数</span><br><span class=\"line\">tamoxifen &lt;- dba.count(tamoxifen)</span><br><span class=\"line\">#简单查看计算结果</span><br><span class=\"line\">info &lt;- dba.show(tamoxifen)</span><br><span class=\"line\">libsizes &lt;- cbind(LibReads=info$Reads, FRiP=info$FRiP, PeakReads=round(info$Reads * info$FRiP))</span><br><span class=\"line\">rownames(libsizes) &lt;- info$ID</span><br><span class=\"line\">libsizes</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#统计结果</span><br><span class=\"line\">       LibReads FRiP PeakReads</span><br><span class=\"line\">cmt2_1  6720462 0.29   1948934</span><br><span class=\"line\">cmt2_2  7747491 0.33   2556672</span><br><span class=\"line\">wild_1  7078309 0.36   2548191</span><br><span class=\"line\">wild_2  8030752 0.34   2730456</span><br><span class=\"line\">ddcc_1  6370232 0.30   1911069</span><br><span class=\"line\">ddcc_2  6956429 0.35   2434750</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>&lt;pre&quot;&gt;# 默认基于测序深度对数据进行标椎化 tamoxifen &lt;- dba.normalize(tamoxifen) norm &lt;- dba.normalize(tamoxifen, bRetrieve=TRUE) norm #查看进行标准化的文库大小 (library-size)，其实就是各样本文库大小总和的平均值，你可以计算验证一下 normlibs &lt;- cbind(FullLibSize=norm<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>i</mi><mi>b</mi><mi mathvariant=\"normal\">.</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mi>s</mi><mo separator=\"true\">,</mo><mi>N</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>F</mi><mi>a</mi><mi>c</mi><mi>s</mi><mo>=</mo><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">lib.sizes, NormFacs=norm</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">b</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">m</span></span></span></span>norm.factors, NormLibSize=round(norm<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>i</mi><mi>b</mi><mi mathvariant=\"normal\">.</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mi>s</mi><mi mathvariant=\"normal\">/</mi><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">lib.sizes/norm</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">b</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">s</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">m</span></span></span></span>norm.factors)) rownames(normlibs) &lt;- info$ID normlibs</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#标椎化结果</span><br><span class=\"line\">       FullLibSize  NormFacs NormLibSize</span><br><span class=\"line\">cmt2_1     6720462 0.9398443     7150612</span><br><span class=\"line\">cmt2_2     7747491 1.0834724     7150612</span><br><span class=\"line\">wild_1     7078309 0.9898885     7150612</span><br><span class=\"line\">wild_2     8030752 1.1230859     7150612</span><br><span class=\"line\">ddcc_1     6370232 0.8908652     7150612</span><br><span class=\"line\">ddcc_2     6956429 0.9728438     7150612</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#分组，格式是表头在最前面，要分的组依次写在后面，只能两两比较，因此后面只能写两组，但可以多执行几次，都会追加到tamoxifen 中</span><br><span class=\"line\">#分组1，后面使用contrast=1单独查看</span><br><span class=\"line\">tamoxifen &lt;- dba.contrast(tamoxifen, contrast=c(&quot;Factor&quot;,&quot;ddcc&quot;,&quot;wild&quot;))</span><br><span class=\"line\">#分组2，后面使用contrast=2单独查看</span><br><span class=\"line\">tamoxifen &lt;- dba.contrast(tamoxifen, contrast=c(&quot;Factor&quot;,&quot;cmt2&quot;,&quot;wild&quot;))</span><br><span class=\"line\">#当然还可有分组3,4,5等，均可以使用contrast=number单独查看</span><br><span class=\"line\">tamoxifen</span><br><span class=\"line\">#按照分组分别进行差异分析，默认使用DESeq2进行计算，可以选择method = DBA_EDGER(edgR)，或者两个都要method = DBA_ALL_METHODS</span><br><span class=\"line\">tamoxifen &lt;- dba.analyze(tamoxifen)</span><br><span class=\"line\">dba.show(tamoxifen, bContrasts=TRUE)</span><br><span class=\"line\">#查看差异分析的结果与导出为csv文件</span><br><span class=\"line\">#查看第1组差异分析的结果</span><br><span class=\"line\">tamoxifen.DB_1 &lt;- dba.report(tamoxifen,contrast=1)</span><br><span class=\"line\">tamoxifen.DB_1</span><br><span class=\"line\">write.csv(tamoxifen.DB_1, file=&quot;diffBind_result.csv&quot;)</span><br><span class=\"line\"> </span><br><span class=\"line\">#查看第2组差异分析的结果</span><br><span class=\"line\">tamoxifen.DB_2 &lt;- dba.report(tamoxifen,contrast=2) tamoxifen.DB_2 write.csv(tamoxifen.DB_2, file=&quot;diffBind_result.csv&quot;) ##传统的上下调在找差异peak中称为“Gain”或“Loss” #查看第1组的差异peak数量“Fold&gt;0或&lt;0”控制是“Gain”或“Loss” sum(tamoxifen.DB$Fold&gt;0,contrast=1)</span><br><span class=\"line\">sum(tamoxifen.DB$Fold&lt;0,contrast=1) #查看第2组的差异peak数量“Fold&gt;0或&lt;0”控制是“Gain”或“Loss” sum(tamoxifen.DB$Fold&gt;0,contrast=2)</span><br><span class=\"line\">sum(tamoxifen.DB$Fold&lt;0,contrast=2)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<ul>\n<li>由于我是使用两组进行测试的，所以可以使用 contrast=1 或 contrast=2 分别查看，由于都是相同的代码，下面进行可视化的时候，<strong>只选择 contrast=1 进行可视化</strong></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#韦恩图可视化</span><br><span class=\"line\">dba.plotVenn(tamoxifen, contrast=1, bDB=TRUE, bGain=TRUE, bLoss=TRUE, bAll=FALSE)</span><br><span class=\"line\"> </span><br><span class=\"line\">#PCA</span><br><span class=\"line\">dba.plotPCA(tamoxifen) #这里可以使用所有样本进行PCA</span><br><span class=\"line\">dba.plotPCA(tamoxifen, contrast=1, label=DBA_FACTOR)#单独对分组1进行PCA</span><br><span class=\"line\"> </span><br><span class=\"line\">#MA plots</span><br><span class=\"line\">dba.plotMA(tamoxifen, contrast=1)</span><br><span class=\"line\"> </span><br><span class=\"line\">#Volcano plots</span><br><span class=\"line\">dba.plotVolcano(tamoxifen, contrast=1)</span><br><span class=\"line\"> </span><br><span class=\"line\">#Box plots</span><br><span class=\"line\">dba.plotBox(tamoxifen, contrast=1)</span><br><span class=\"line\"> </span><br><span class=\"line\">#Heatmap</span><br><span class=\"line\">hmap &lt;- colorRampPalette(c(&quot;red&quot;, &quot;black&quot;, &quot;green&quot;))(n = 13)</span><br><span class=\"line\">#对所有样本的所有的差异peak画热图</span><br><span class=\"line\">dba.plotHeatmap(tamoxifen,correlations=FALSE,scale=&quot;row&quot;,colScheme = hmap)</span><br><span class=\"line\">#单独对分组1中所有的差异peak画热图</span><br><span class=\"line\">dba.plotHeatmap(tamoxifen, contrast=1, correlations=FALSE, scale=&quot;row&quot;, colScheme = hmap)</span><br><span class=\"line\">dba.plotHeatmap(tamoxifen,correlations=FALSE,scale=&quot;row&quot;,colScheme = hmap)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950027-1-700x349.png\" alt=\"\" /></p>\n<ul>\n<li>想画下面的图，可是一直提示 could not find function dba.plotProfile，因此还没有成功，用官方提供的图展示一下吧，大家能画出来可以和我说一声哦。这是<a href=\"https://content.cruk.cam.ac.uk/bioinformatics/software/DiffBind/plotProfileDemo.html\">【官方文档】</a>可以参考</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#Profiling and Profile Heatmaps</span><br><span class=\"line\">dba.plotProfile(tamoxifen)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950029-700x643.png\" alt=\"\" /></p>\n<h3 id=\"8-footprint-分析\"><a class=\"markdownIt-Anchor\" href=\"#8-footprint-分析\"></a> 8. footprint 分析</h3>\n<p>目前我还没有找到使用于所有物种的软件，HINT-ATAC 用来做 footprint 分析的话，应该只支持不几个物种，比较鸡肋。<a href=\"https://bioconductor.org/packages/release/bioc/manuals/ATACseqQC/man/ATACseqQC.pdf\">ATACseqQC</a> 应该是一款不错的软件，最近还在探索</p>\n<h3 id=\"三-atac-seq-与多组学数据联合分析\"><a class=\"markdownIt-Anchor\" href=\"#三-atac-seq-与多组学数据联合分析\"></a> 三、ATAC-seq 与多组学数据联合分析</h3>\n<p><strong>转录因子 ChIP-seq</strong>：由于大部分转录因子结合的是染色质开放区域，所以 ATAC-seq 的 Peak 可能和转录因子 ChIP-seq 的 Peak 存在部分重叠的情况，而且 ATAC-seq 得到的 Peak 长度往往更长，因此 ATAC-seq 数据和转录因子 ChIP-seq 数据可以相互验证。转录因子在 ChIP-seq 中独有的 Peak 暗示这个转录因子可能是结合在异染色质区域的驱动型转录因子（Pioneer TFs），驱动型转录因子随后招募染色质重塑复合体以及其它转录因子开始转录。另外，联合分析已经报道的 ChIP-seq 数据可以更准确地分析转录因子的足迹。<br />\n<strong>组蛋白修饰 ChIP-seq</strong>：ATAC-seq 数据同样可以和组蛋白修饰 ChIP-seq 数据进行联合分析，其中转录激活性修饰（H3K4me3，H3K4me1 和 H3K27ac 等）与染色质开放程度呈正相关，转录抑制性修饰（H3K27me3）与染色质开放程度呈负相关。联合已知的增强子和启动子之间的相互作用数据也可以帮助构建调控网络。<br />\n<strong>RNA-seq</strong>：ATAC-seq 数据可以通过联合分析 RNA-seq 数据来发现哪些差异表达的基因是受染色质可及性调控的，进一步可以推测这些差异表达的基因哪些是受开放染色质中具有 motif 和 footprint 的转录因子调控的，因此 ATAC-seq 与 RNA-seq 的联合分析有助于破译基因调控网络和细胞异质性。</p>\n","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":7818,"excerpt":"","more":"<blockquote>\n<p>转载于网络，原文地址 <a href=\"https://www.plob.org/article/24719.html\">www.plob.org</a></p>\n</blockquote>\n<h3 id=\"一-基础知识\"><a class=\"markdownIt-Anchor\" href=\"#一-基础知识\"></a> 一、基础知识</h3>\n<h4 id=\"1-解密表观遗传学的三个方向与测序方法\"><a class=\"markdownIt-Anchor\" href=\"#1-解密表观遗传学的三个方向与测序方法\"></a> 1. 解密表观遗传学的三个方向与测序方法</h4>\n<ul>\n<li><strong>1. 探索染色质的开放性</strong>（chromatin accessibility）<br />\n<code>ATAC-seq</code>: Assay of Transposase Accessible Chromatin sequencing<br />\n<code>DNase-seq</code>: DNase I hypersensitive sites sequencing<br />\n<code>FAIRE-seq</code>: Formaldehyde-Assisted Isolation of Regulatory Elements sequencing</li>\n<li><strong>2. 探索转录因子的绑定与组蛋白修饰</strong>（TF binding and histone modifications）<br />\n<code>ChIP-seq</code>: Chromatin Immuno-Precipitation sequencing</li>\n<li><strong>3. 探索核小体占位</strong>（nucleosome positioning and occupancy）<br />\n<code>MNase-seq</code>: Micrococcal Nuclease sequencing</li>\n</ul>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632949992-700x506.png\" alt=\"\" /></p>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632949994-700x844.png\" alt=\"\" /></p>\n<h4 id=\"2-名词解释\"><a class=\"markdownIt-Anchor\" href=\"#2-名词解释\"></a> 2. 名词解释</h4>\n<ul>\n<li><code>epigenetics</code>：表观遗传学。表观遗传学修饰在不改变 DNA 序列的情况下控制着基因的表达，包括染色质重塑、组蛋白修饰、DNA 甲基化和 microRNA 通路等</li>\n<li><code>peaks</code>: 峰。常用来表示染色质的开放程度，因为是测序的 reads 落在了染色质的开放区，堆叠后被可视化的一种丰度的体现。</li>\n</ul>\n<p>但 peaks 到底代表什么？莫非 peaks 所在区域要么是启动子要么是增强子？再或者就是笼统定义为调控元件？（我目前的观点是，只能把他理解为酶切的位点，如果非要定义是否是特定分调控元件，只能进行后续分析。）</p>\n<ul>\n<li>\n<p><code>THSs</code>: 转座酶超敏感位点（transposase hypersensitive sites）。</p>\n</li>\n<li>\n<p><code>CREs</code>: 顺式调控元件（cis-regulatory elements）。即 DNA 分子中具有转录调节功能的特异 DNA 序列。按功能特性，真核基因顺式作用元件分为启动子、增强子及沉默子。</p>\n</li>\n<li>\n<p><code>ACRs</code>: 染色质开放区域（accessible chromatin regions）。即正常或核小体被酶切裸露出来的 DNA 片段所在的区域。这篇<a href=\"https://www.nature.com/articles/s41477-019-0548-z\">【NP | 2019】</a>根据 ACRs 距离最近基因的距离将 ACRs 分为三种类型：genic (gACRs; overlapping a gene), proximal (pACRs; within 2kb of a gene) or distal (dACRs; &gt;2 kb from a gene)，分别是跨越基因的，近端的，远端的染色质开放区。</p>\n</li>\n<li>\n<p><code>transposon</code>: 转座子。一段可以从原位上单独复制或断裂下来，环化后插入另一位点，并对其后的基因起调控作用的 DNA 序列。</p>\n</li>\n<li>\n<p><code>promoter</code>: 启动子。启动子是位于结构基因 5’端上游的 DNA 序列，能活化 RNA 聚合酶，使之与模板 DNA 准确的结合并具有转录起始的特异性。每个启动子包括至少一个转录起始点以及一个以上的功能组件（典型的如 TATA 盒子）</p>\n</li>\n<li>\n<p><code>proximal promoters</code>: 近端启动子。是 DNA 上位于基因开始之前的一个区域，在那里蛋白质和其他分子结合在一起准备读取该基因。</p>\n</li>\n<li>\n<p><code>enhancer</code>: 增强子。增强子是远离转录起始点、决定基因的时间、空间特异性表达、增强启动子转录活性的 DNA 序列，其发挥作用的方式通常与方向、距离<strong>无关</strong>，可位于转录起始点的上游或下游。从功能上讲，没有增强子存在，启动子通常不能表现活性；没有启动子时，增强子也无法发挥作用。根据南京大学陈迪俊老师的研究表明增强子比启动子能结合更多的转录因子 <a href=\"https://www.nature.com/articles/s41467-019-09513-2\">(Nature Communications)</a></p>\n</li>\n<li>\n<p><code>TFs</code>: 转录因子（transcription factors）是保证目的基因以特定的强度在特定的时间与空间表达的蛋白质分子。与 RNA 聚合酶 Ⅱ 形成转录起始复合体，共同参与转录起始的过程。</p>\n</li>\n<li>\n<p><code>TSS</code>: 转录起始位点（transcription start site）。在一个典型的基因内部，排列顺序为转录起始位点 (TSS，一个碱基)- 起始密码子编码序列 (ATG)- 终止密码子编码序列 (TGA)- 转录终止位点 (TTS)，即 TSS-ATG-TGA-TTS</p>\n</li>\n<li>\n<p><code>histone</code>：组蛋白。通常含有 H1，H2A，H2B，H3，H4 等 5 种成分，其中 H1 与 H3 极度富含赖氨酸（lysine），H1 不保守，其他组蛋白的基因非常保守。除 H1 外，其他 4 种组蛋白均分别以二聚体 (共八聚体）相结合，形成核小体核心。DNA 便缠绕在核小体的核心上。而 H1 则与核小体间的 DNA 结合</p>\n</li>\n<li>\n<p><code>nucleosome</code>: 核小体。是由 DNA 和组蛋白形成的染色质基本结构单位。每个核小体由 146bp 的 DNA 缠绕组蛋白八聚体 1.75 圈形成。核小体核心颗粒之间通过 50bp 左右的连接 DNA 相连，暴露在核小体表面的 DNA 能被特定的核酸酶接近并切割</p>\n</li>\n<li>\n<p><code>H3K4me1</code>: 组蛋白 H3 上的第 4 位赖氨酸发生单甲基化（mono-methylation of H3 at lysine 4） <a href=\"https://www.nature.com/articles/s41588-017-0018-3\">（NG | H3K4me1 与增强子的关系）</a></p>\n</li>\n<li>\n<p><code>H3K9ac</code>：组蛋白 H3 上的第 9 位赖氨酸发生乙酰化（H3 acetylation marks at lysine 9）关于 H3K4me1 与 H3K9ac 的不同，依旧可以参考这篇文献<a href=\"https://www.nature.com/articles/s41477-019-0548-z\">【NP | 2019】</a>或<a href=\"https://www.nature.com/articles/s41467-019-09513-2\">【NC | 2019】</a></p>\n</li>\n<li>\n<p><code>组蛋白甲基化</code>：甲基化可发生在组蛋白的赖氨酸和精氨酸残基上，而且赖氨酸残基能够发生单、双、三甲基化，而精氨酸残基能够单、双甲基化，这些不同程度的甲基化极大地增加了组蛋白修饰和调节基因表达的复杂性</p>\n</li>\n<li>\n<p><code>组蛋白乙酰化</code>：四种类型的组蛋白相互作用，将细胞核里的 DNA 紧紧地包装起来。这样的紧密包装能够有效阻止酶读取 DNA 上的遗传信息。然而，乙酰基连到组蛋白上能削弱它们对 DNA 的占据。因此局部乙酰化能暴露出相应的基因，让它们更容易激活<img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632949997-700x318.png\" alt=\"\" /></p>\n<p>真核生物细胞核内染色质结构</p>\n</li>\n</ul>\n<h3 id=\"二-基础分析\"><a class=\"markdownIt-Anchor\" href=\"#二-基础分析\"></a> 二、基础分析</h3>\n<h3 id=\"1-分析前的准备\"><a class=\"markdownIt-Anchor\" href=\"#1-分析前的准备\"></a> 1. 分析前的准备</h3>\n<p>1.1 下载 ATAC 测序数据（或者用你自己的数据也行）</p>\n<ul>\n<li>所需软件：<a href=\"https://www.ibm.com/aspera/connect/\">Aspera Connect</a></li>\n<li>软件安装与使用：参考<a href=\"https://www.plob.org/tag/aspera\">这系列文章</a></li>\n<li>数据下载：项目 ID<a href=\"https://www.ncbi.nlm.nih.gov/bioproject/PRJNA480717/\">【PRJNA480717】</a><a href=\"https://academic.oup.com/jxb/article/70/15/3867/5481770\">【文章原文】</a>，SRR 序列号如下图，下载方法和上文相同。由于数据量大，测试浪费时间，所以我在每个文件中取了 100w 条 reads，由于百度网盘太慢了，你可以去扣扣群 559758504 里面随便下载一个用于测试。</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fastqc -t 8 -o ./ *.fastq.gz</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950000-700x238.png\" alt=\"\" /></p>\n<p>image.png</p>\n<p>1.2 下载 tair10 基因组与 gff3 注释文件</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bwa index -p /路径/bwaIndexTair /路径/TAIR10_genome.fa</span><br></pre></td></tr></table></figure>\n<p>1.3 安装 miniconda</p>\n<ul>\n<li>由于后续分析大多数软件都是来源于 conda，因此你必须知道怎么使用。参考<a href=\"https://www.plob.org/article/13100.html\">【conda 的安装与使用】</a></li>\n</ul>\n<p>1.4 所需软件安装（分析中所用到的软件都汇集于此，下文不再介绍如何下载）</p>\n<p>请先激活 conda 环境在安装！</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda install -c bioconda -y fastqc</span><br><span class=\"line\">conda install -c bioconda -y trimmomatic</span><br><span class=\"line\">conda install -c bioconda -y bwa</span><br><span class=\"line\">conda install -c bioconda -y samtools</span><br><span class=\"line\">conda install -c bioconda -y picard</span><br><span class=\"line\">conda install -c bioconda -y macs2</span><br><span class=\"line\">conda install -c bioconda -y bedtools</span><br><span class=\"line\">conda install -c bioconda -y deeptools</span><br><span class=\"line\">conda install -c bioconda -y homer</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>后续分析是使用 SRR7512044 作为测试数据，但是思路和方法都可以借鉴。</p>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950000-1.png\" alt=\"\" /></p>\n<p>测试数据</p>\n<h3 id=\"2-测序质量检测\"><a class=\"markdownIt-Anchor\" href=\"#2-测序质量检测\"></a> 2. 测序质量检测</h3>\n<ul>\n<li>所需软件：<a href=\"https://anaconda.org/bioconda/fastqc\">FastQC</a><a href=\"https://www.bioinformatics.babraham.ac.uk/projects/fastqc/\">【官方网站】</a></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fastqc -t 8 -o ./ *.fastq.gz</span><br></pre></td></tr></table></figure>\n<p><code>-t</code>: 线程<br />\n<code>-o</code>: 存放路径，不用指定前缀，默认为. fastq.gz 前面的字段<br />\n<code>*.fastq.gz</code>: fastqc 可以同时接受多个 fastq.gz 文件，因此采用正则表达式【*】表示全部</p>\n<ul>\n<li>结果解读<br />\n由于开始测序时不准确，因此前 15bp 左右的 ATGC 含量有波动，需要在后面截掉。而最长 reads 为 76bp，则暗示着我最后至少要保留多长的序列。<br />\n一般我的计算思路是：保留的序列长度 =（最长的的 reads 长度 - 前面波动的碱基长度）× 40%</li>\n</ul>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950001-700x514.png\" alt=\"\" /></p>\n<h3 id=\"2-测序质量检控制\"><a class=\"markdownIt-Anchor\" href=\"#2-测序质量检控制\"></a> 2. 测序质量检控制</h3>\n<ul>\n<li>所需软件：<a href=\"https://anaconda.org/bioconda/trimmomatic\">Trimmomatic</a><a href=\"https://links.jianshu.com/go?to=%255Bhttp%3A//www.usadellab.org/cms/%3Fpage%3Dtrimmomatic%255D%28http%3A//www.usadellab.org/cms/%3Fpage%3Dtrimmomatic%29\">【官方网站】</a><a href=\"https://www.plob.org/article/6258.html\">【中文介绍】</a><br />\n其实这批数据已经做过质控了，如何判断的呢？QC 的为一个范围且短于提供给 NCBI 上的数据。因此我们没必要质控，但为了流程的完整性，还是假装质控一下。质控之后，还要进行质检，如此循环，直到合格。</li>\n</ul>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950001-1-700x296.png\" alt=\"\" /></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 定义一些变量，后面修改起来方便</span><br><span class=\"line\">filename=SRR7512044</span><br><span class=\"line\"> </span><br><span class=\"line\">trimmomatic PE -threads 10 </span><br><span class=\"line\">./$&#123;filename&#125;_1.fastq.gz ./$&#123;filename&#125;_2.fastq.gz </span><br><span class=\"line\">./$&#123;filename&#125;_1.clean.fq.gz ./$&#123;filename&#125;_1.drop.fq.gz </span><br><span class=\"line\">./$&#123;filename&#125;_2.clean.fq.gz ./$&#123;filename&#125;_2.drop.fq.gz </span><br><span class=\"line\">HEADCROP:15 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:24</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><code>PE</code>: 双端模式。需要两个输入文件，正向测序序列和反向测序序列：<code>sample_R1.fastq.gz</code>和<code>sample_R2.fastq.gz</code>；<br />\n以及四个输出文件：<code>sample_1.clean.fq.gz</code>和<code>sample_1.drop.fq.gz</code>；<code>sample_2.clean.fq.gz</code>和<code>sample_2.drop.fq.gz</code><br />\n<code>-threads</code>: 线程数<br />\n<code>HEADCROP</code>: 从 reads 的开头切掉指定数量的碱基，即从 fastqc 中看的<br />\n<code>LEADING</code>: 从 reads 的开头切除质量值低于阈值的碱基<br />\n<code>TRAILING</code>: 从 reads 的末尾开始切除质量值低于阈值的碱基<br />\n<code>SLIDINGWINDOW</code>: 从 reads 的 5’ 端开始，进行滑窗质量过滤，切掉碱基质量平均值低于阈值的滑窗<br />\n<code>MINLEN</code>: 如果经过剪切后 reads 的长度低于阈值则丢弃这条 reads，即上面的计算方法：（76-15）×40%≈24</p>\n<h3 id=\"3-建立索引与序列比对\"><a class=\"markdownIt-Anchor\" href=\"#3-建立索引与序列比对\"></a> 3. 建立索引与序列比对</h3>\n<ul>\n<li>所需软件：<a href=\"https://www.plob.org/tag/bwa\">bwa</a> 和 <a href=\"https://www.plob.org/tag/samtools\">samtools</a></li>\n<li>建立基因组索引。需要的时间挺长的，建议放后台。建好之后以后就可以跳过这一步了，且在经典的比对软件 STAR、hisat2、bowtie2 和 bwa-mem 中我更喜欢使用 STAR 和 bwa-mem。本次使用 bwa-mem 操作演示</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bwa index -p /路径/bwaIndexTair /路径/TAIR10_genome.fa</span><br></pre></td></tr></table></figure>\n<p><code>-p</code>: 索引前缀，后缀自动补充<br />\n<code>TAIR10_genome.fa</code>: 基因组文件</p>\n<ul>\n<li>序列比对<br />\n由于 sam 文件较大，因此我们直接跳过 sam，使用 samtools 转换为排序后的 bam 文件，注意【|】不要漏掉，且排序是依据 reads 比对到基因组的位置排的</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 定义一些变量，后面用</span><br><span class=\"line\">filename=SRR7512044</span><br><span class=\"line\">index=/路径/bwaIndexTair</span><br><span class=\"line\"> </span><br><span class=\"line\">bwa mem -M -t 8 </span><br><span class=\"line\">-R &quot;@RGtID:$&#123;filename&#125;tSM:$&#123;filename&#125;tLB:WXStPL:Illumina&quot; </span><br><span class=\"line\">$index </span><br><span class=\"line\">$&#123;filename&#125;_1.clean.fq.gz </span><br><span class=\"line\">$&#123;filename&#125;_2.clean.fq.gz </span><br><span class=\"line\">| samtools sort -O bam -@ 10 -o ./$&#123;filename&#125;.raw.bam</span><br><span class=\"line\">#无论干啥，生成bam文件后就要建立bam索引，并检查比对情况</span><br><span class=\"line\">samtools index -@ 10 -b ./$&#123;filename&#125;.raw.bam</span><br><span class=\"line\">samtools flagstat ./$&#123;filename&#125;.raw.bam &gt; ./$&#123;filename&#125;.raw.stat</span><br><span class=\"line\">cat $&#123;filename&#125;.raw.stat</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><code>-M</code>: 将 shorter split hits 标记为次优，以兼容 Picard’s markDuplicates 软件<br />\n<code>-R</code>: STR 完整的 read group 的头部，可以用’t’ 作为分隔符， 在输出的 SAM 文件中被解释为制表符 TAB. read group 的 ID，会被添加到输出文件的每一个 read 的头部，<br />\n<code>-O</code>: 表示输出的 bam 文件<br />\n<code>-o</code>: 输出的 bam 文件名<br />\n<code>-t</code>与<code>@</code>: 线程数</p>\n<ul>\n<li>关于 stat 中内容的解释如下</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">14608455   0 in total (QC-passed reads   QC-failed reads) reads总数</span><br><span class=\"line\">37967   0 secondary                                       出现比对到参考基因组多个位置的reads数</span><br><span class=\"line\">0   0 supplementary                                       可能存在嵌合的reads数</span><br><span class=\"line\">0   0 duplicates                                          重复的reads数</span><br><span class=\"line\">14590894   0 mapped (99.88% : N/A)                        比对到参考基因组上的reads数</span><br><span class=\"line\">14570488   0 paired in sequencing                         属于PE read的reads总数。</span><br><span class=\"line\">7285244   0 read1                                         PE read中Read 1 的reads 总数。</span><br><span class=\"line\">7285244   0 read2                                         PE read中Read 2 的reads 总数。</span><br><span class=\"line\">14507068   0 properly paired (99.56% : N/A)               完美比对的reads总数。PE两端reads比对到同一条序列，且根据比对结果推断的插入片段大小符合设置的阈值。</span><br><span class=\"line\">14551500   0 with itself and mate mapped                  PE两端reads都比对上参考序列的reads总数。</span><br><span class=\"line\">1427   0 singletons (0.01% : N/A)                         PE两端reads，其中一端比上，另一端没比上的reads总数。</span><br><span class=\"line\">26260   0 with mate mapped to a different chr             PE read中，两端分别比对到两条不同的序列的reads总数。</span><br><span class=\"line\">17346   0 with mate mapped to a different chr (mapQ&gt;=5)   PE read中，两端分别比对到两条不同</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"4-去除-pcr-重复并再次进行质控\"><a class=\"markdownIt-Anchor\" href=\"#4-去除-pcr-重复并再次进行质控\"></a> 4. 去除 PCR 重复并再次进行质控</h3>\n<ul>\n<li>所需软件：picard 与 <a href=\"https://www.plob.org/tag/samtools\">samtools</a><br />\n不建议使用 sambamba，虽然快，但是毛病多，尤其是在你不知情的情况下，软件卡死或者在最后输出文件时提示输出文件夹过多等。</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">picard MarkDuplicates </span><br><span class=\"line\">REMOVE_DUPLICATES=true </span><br><span class=\"line\">I=$&#123;filename&#125;.raw.bam </span><br><span class=\"line\">O=$&#123;filename&#125;.rmdup.bam </span><br><span class=\"line\">M=$&#123;filename&#125;.rmdup.log</span><br><span class=\"line\"># 实时监测我们的数据发生了什么变化</span><br><span class=\"line\">samtools index $&#123;filename&#125;.rmdup.bam</span><br><span class=\"line\">samtools flagstat $&#123;filename&#125;.rmdup.bam &gt; ./$&#123;filename&#125;.rmdup.stat</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><code>REMOVE_DUPLICATES=true</code>: 表示将检测出的 PCR duplication 直接去除；<br />\n<code>I</code>: 或者 INPUT 指定输入的 bam 文件；<br />\n<code>O</code>: 或者 OUTPUT 指定输出去除 PCR duplication 的 bam 文件；<br />\n<code>M</code>: 或者 METRICS_FILE 指定输出的 matrix log 文件。</p>\n<ul>\n<li>下面是再次进行质控</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">samtools view -h -f 2 -q 30 $&#123;filename&#125;.rmdup.bam </span><br><span class=\"line\">| grep -v -e &quot;mitochondria&quot; -e &quot;*&quot; -e &quot;chloroplast&quot; </span><br><span class=\"line\">| samtools sort -O bam -@ 10 -o - &gt; $&#123;filename&#125;.last.bam</span><br><span class=\"line\"># 实时监测我们的数据发生了什么变化</span><br><span class=\"line\">samtools index $&#123;filename&#125;.last.bam</span><br><span class=\"line\">samtools flagstat $&#123;filename&#125;.last.bam &gt; ./$&#123;filename&#125;.last.stat</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><code>-h</code>: 输出的 sam 文件带 header，默认不带<br />\n<code>-f</code>: 输出含有所有 flag 的 reads<br />\n<code>-q</code> 比对的最低质量值，一般 20/30 都可以<br />\n其他参数介绍看 <a href=\"https://www.plob.org/tag/samtools\">samtools 使用简述</a>，需要说明的是由于比对到线粒体和叶绿体的 reads 不是我们关注的重点，因此使用<code>grep</code>剔除掉，当然了，做动物的话需要剔除什么视情况而定了。</p>\n<ul>\n<li>好了，下面来看看我们的数据从 raw data -&gt; rmdup -&gt; last 到底发生了那些变化<img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950002-700x344.png\" alt=\"\" /></li>\n<li>然后，从 IGV 看看发生了什么变化<br />\n关于使用 IGV 查看 bam 文件中 reads 呈现不同颜色的说明</li>\n</ul>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950005-700x773.png\" alt=\"\" /></p>\n<h3 id=\"5-统计过滤后的结果中-insertsize-长度分布\"><a class=\"markdownIt-Anchor\" href=\"#5-统计过滤后的结果中-insertsize-长度分布\"></a> 5. 统计过滤后的结果中 Insertsize 长度分布</h3>\n<ul>\n<li>所需软件：picard<br />\nInsertsize =（read2 的比对位点 - read1 的比对位点） read2 的长度。也可以随便点击上图 IGV 中任一一条 reads 查看插入片段的大小</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">picard CollectInsertSizeMetrics </span><br><span class=\"line\">I=./$&#123;filename&#125;.last.bam </span><br><span class=\"line\">O=./$&#123;filename&#125;.last.insertsize </span><br><span class=\"line\">H=./$&#123;filename&#125;.last.hist.pdf</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950006-700x683.png\" alt=\"\" /></p>\n<h3 id=\"5-peak-calling-与-frip_scorespot_score-的计算\"><a class=\"markdownIt-Anchor\" href=\"#5-peak-calling-与-frip_scorespot_score-的计算\"></a> 5. peak calling 与 FRiP_score/SPOT_score 的计算</h3>\n<ul>\n<li>所需软件：<a href=\"https://www.plob.org/article/7118.html\">macs2</a> 和 <a href=\"https://www.plob.org/tag/bedtools\">bedtools</a><br />\n因为 macs2 需要用到基因组的有效大小，而软件本身就提供了 4 个物种的有效基因组大小。</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">effective_genome_size=119481543</span><br><span class=\"line\"> </span><br><span class=\"line\">bedtools bamtobed -i $&#123;filename&#125;.last.bam &gt; $&#123;filename&#125;.last.bed</span><br><span class=\"line\">macs2 callpeak </span><br><span class=\"line\">-t $&#123;filename&#125;.last.bed </span><br><span class=\"line\">-g $&#123;effective_genome_size&#125; </span><br><span class=\"line\">--nomodel --shift -100 --extsize 200 </span><br><span class=\"line\">-n $&#123;filename&#125;.last </span><br><span class=\"line\">-q 0.01 --outdir ./peaks</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<ul>\n<li>其实，这里面讨论最多的是<code>--nomodel --shift -100 --extsize 200</code>这些参数如何选择，下面的图很形象的展示了参数的作用。当然，我也是查阅了很多资料与文献，一般默认在<code>ATAC-seq，DNase-seq，FAIRE-seq</code>的时候将<code>shift</code>设置为<code>extsize</code>的一半，且参数固定为：<code>--nomodel --shift 100 --extsize 200</code>。而在<code>MNase-seq</code>的时候，参数固定为：<code>--nomodel --shift 37 --extsize 73</code>。在<code>ChiP-seq</code>的时候不用移峰，所以只使用<code>-nomodel</code>，当做组蛋白修饰的时候，由于 peak 并<a href=\"http://blog.sina.com.cn/s/blog_4bc742520102uy64.html\">不典型</a>，所以使用<code>–nomodel –shift 73</code>参数。另外如何使用<code>macs2 predictd</code>预测双峰模型，这里就不展开介绍了，可以私聊我，我把脚本发你。</li>\n</ul>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950007.png\" alt=\"\" /></p>\n<p>shift 与 extsize 到底在干啥？</p>\n<ul>\n<li>下面是我见过的图中解释<strong>移峰</strong>现象最清楚的了，可以参考</li>\n</ul>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950007-1-700x503.png\" alt=\"\" /></p>\n<p>移峰</p>\n<ul>\n<li>最后，就是输出文件的解读\n<ol>\n<li><strong>${filename}_peaks.xls</strong></li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">前几行是callpeak时的命令。后面是：</span><br><span class=\"line\">1.染色体号</span><br><span class=\"line\">2.peak起始位点</span><br><span class=\"line\">3.peak结束位点</span><br><span class=\"line\">4.peak区域长度</span><br><span class=\"line\">5.peak的峰值位点（summit position）</span><br><span class=\"line\">6.peak 峰值的高度（pileup height at peak summit, -log10(pvalue) for the peak summit）</span><br><span class=\"line\">7.peak的富集倍数（相对于random Poisson distribution with local lambda）</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<ol start=\"2\">\n<li><strong>${filename}_peaks.narrowPeak</strong></li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">narrowPeak文件是BED6 4格式，可以上传到IGV查看</span><br><span class=\"line\">1.染色体号</span><br><span class=\"line\">2.peak起始位点</span><br><span class=\"line\">3.peak结束位点</span><br><span class=\"line\">4.peak name（样本名 _peak_1的后缀之类的）</span><br><span class=\"line\">5.-10*log10qvalue</span><br><span class=\"line\">6.正负链</span><br><span class=\"line\">7.fold change</span><br><span class=\"line\">8.-log10pvalue</span><br><span class=\"line\">9.-log10qvalue</span><br><span class=\"line\">10.相对于峰的峰顶位置（relative summit position to peak start）</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<ul>\n<li>注意：excel 里的起始坐标需要减 1 才与 narrowPeak 的坐标一致，见下图。<br />\n3.  <strong>${filename}_summits.bed</strong></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">BED格式的文件，包含peak的summits（峰顶）位置</span><br><span class=\"line\">1.染色体号</span><br><span class=\"line\">2.峰的峰顶起始位点（注意是峰顶，不是峰，他只是一个点）</span><br><span class=\"line\">3.峰的峰顶起始位点（因此二者就差一个碱基的位置）</span><br><span class=\"line\">4.峰顶（样本名 _peak_1的后缀之类的）</span><br><span class=\"line\">5.-log10pvalue</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<p>注意：excel 里的起始坐标需要减 1 才与 narrowPeak 的坐标一致，见下图。</p>\n</li>\n<li>\n<p><strong>另外，需要告诉你的是，bed 文件中第 2 列中的峰顶起始位点是如何计算的？</strong><br />\nbed 文件中第 2 列（峰的峰顶起始位点） = xls 第二列 xls 第十列 -1。或者↓↓↓↓<br />\nbed 文件中第 2 列（峰的峰顶起始位点） = narrowPeak 第二列 narrowPeak 第十列</p>\n</li>\n<li>\n<p>总览比较：<img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950008-700x407.png\" alt=\"\" /></p>\n<p>bed，narrowPeak，bdg，xls 四种类型输出文件的比较</p>\n</li>\n<li>\n<p>FRiP_score 的计算<a href=\"https://www.encodeproject.org/atac-seq/\">【官方介绍】</a><br />\n简单来说，FRiP_score 说的就是统计落在 Peaks 里面的 reads 数量与所有比对到基因组上 reads 数量的比值。可以作为判定样本测序质量的一个指标。</p>\n</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Reads=$(bedtools intersect -a $&#123;filename&#125;.last.bed -b $&#123;filename&#125;_peaks.narrowPeak |wc -l|awk &#x27;&#123;print $1&#125;&#x27;)</span><br><span class=\"line\">totalReads=$(wc -l $&#123;filename&#125;.last.bed|awk &#x27;&#123;print $1&#125;&#x27;) </span><br><span class=\"line\">echo $&#123;Reads&#125; $&#123;totalReads&#125; $&#123;filename&#125; &#x27;FRiP_score:&#x27; $(echo &quot;scale=2;100*$&#123;Reads&#125;/$&#123;totalReads&#125;&quot;|bc)&#x27;%&#x27;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<ul>\n<li>官网上说 ATAC-Seq 的 FRiP score should be &gt;30%（<a href=\"https://www.encodeproject.org/atac-seq/\">https://www.encodeproject.org/atac-seq/</a>）我猜是如果大多数 reads 都不在 peaks 区域，说明测序质量或者实验效果不是太好，因为酶切切开的就是 peaks 区域，太少不是就偏离实验目的了嘛</li>\n<li>SPOT_score 的计算<a href=\"https://www.encodeproject.org/data-standards/terms/\">【官方介绍】</a><a href=\"https://www.encodeproject.org/software/hotspot/\">【软件安装】</a><br />\n简单来说，SPOT_score 就是在 FRiP_score 的基础上增加了测序深度的条件限制，比如 FRiP 是统计全局的 reads，而 SPOT 只统计测序深度为 30× 的 reads，大于 30× 的 reads 不再参与统计。目前我还在探索中如何计算。</li>\n</ul>\n<h3 id=\"二-高级分析\"><a class=\"markdownIt-Anchor\" href=\"#二-高级分析\"></a> 二、高级分析</h3>\n<p>所谓的高级并不高大上，做了有可能也不能让你的文章提升档次，望周知！</p>\n<h3 id=\"1-igv-可视化\"><a class=\"markdownIt-Anchor\" href=\"#1-igv-可视化\"></a> 1. IGV 可视化</h3>\n<ul>\n<li>前面的 bam 文件，narrowPeak 文件，bed 文件都有了，现在还差一个 bw 文件，因此我们先跑下面的代码，然后在 IGV 里面统一看一下</li>\n<li>所需软件：<a href=\"https://anaconda.org/bioconda/deeptools\">deeptools</a> 和 <a href=\"https://software.broadinstitute.org/software/igv/download\">IGV</a><br />\n主要是为生成 bw 文件用于 IGV 展示</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bamCoverage --bam $&#123;filename&#125;.last.bam -o $&#123;filename&#125;.last.bw </span><br><span class=\"line\">    --binSize 10 </span><br><span class=\"line\">    --normalizeUsing RPGC </span><br><span class=\"line\">    --effectiveGenomeSize $&#123;effective_genome_size&#125; </span><br><span class=\"line\">    --ignoreForNormalization chrX </span><br><span class=\"line\">    --extendReads</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>注：如果发现没有这个包 pysam.libchtslib，直接安装<code>pip install numpydoc</code><br />\n<code>-o</code>: 生成 bw 文件<br />\n<code>binSize</code>: 自行设定覆盖度计算的窗口大小 (bin)<br />\n<code>normalizeUsing</code>: 数据准化方法，有三种 RPGC，RPKM，CPM，BPM<br />\n<code>ignoreForNormalization</code>: 设置你想忽略的染色体名称<br />\n<code>extendReads</code>: 让 reads 扩展至 fragment 的大小</p>\n<ul>\n<li>IGV 一览</li>\n</ul>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950009-700x436.png\" alt=\"\" /></p>\n<p>IGV 可视化 bw、narrowpeak，bed，bam，gff 文件</p>\n<h3 id=\"2-tsstes-可视化\"><a class=\"markdownIt-Anchor\" href=\"#2-tsstes-可视化\"></a> 2. TSS/TES 可视化</h3>\n<ul>\n<li>\n<p>所需软件：<a href=\"https://anaconda.org/bioconda/deeptools\">deeptools</a><br />\n主要是如何生成 <a href=\"http://www.bio-info-trainee.com/2494.html\">Refseq 文件</a>，虽然官网上提供了一些，但总归是不能覆盖所有物种，因此，我们可以从 gff/gtf 文件中自己创造。</p>\n</li>\n<li>\n<p>先提取<strong>基因</strong>的位置信息（不是 cds 或者 exon），根据不同的 gff 进行修改，但格式始终是<code>`chrom/chromStart/chromEnd/name/score/strand`</code></p>\n  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">awk -vFS=&#x27;[\\t=;]&#x27; -vOFS=&quot;\\t&quot; \\</span><br><span class=\"line\">&#x27;&#123;if ($3==&quot;gene&quot;) print $1,$4,$5,$10,$6,$7&#125;&#x27; \\</span><br><span class=\"line\">TAIR10.gff|sed &#x27;s/Chr//g&#x27; &gt; refseq.bed  </span><br><span class=\"line\">#由于tair官网上提供的基因组文件中染色人命名没有Chr，为保持一致，这里去掉</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>然后进行 TSS 可视化</p>\n</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">computeMatrix reference-point --referencePoint TSS  -p 15 </span><br><span class=\"line\">    -b 2000 -a 2000 </span><br><span class=\"line\">    -R ./refseq.bed </span><br><span class=\"line\">    -S *.bw </span><br><span class=\"line\">    -o TSS.gz </span><br><span class=\"line\">    --skipZeros </span><br><span class=\"line\">    --outFileSortedRegions Heatmap1sortedRegions.bed</span><br><span class=\"line\">plotHeatmap -m TSS.gz -out TSS.Heatmap.pdf --plotFileFormat pdf</span><br><span class=\"line\">plotProfile -m TSS.gz -out TSS.Profile.pdf --plotFileFormat pdf --perGroup</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950010-700x629.png\" alt=\"\" /></p>\n<ul>\n<li>然后进行 TES 可视化</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">computeMatrix scale-regions  -p 15  </span><br><span class=\"line\">    -b 2000 -a 2000 </span><br><span class=\"line\">    -R ./refseq.bed </span><br><span class=\"line\">    -S *.bw </span><br><span class=\"line\">    --skipZeros -o body.gz</span><br><span class=\"line\">plotHeatmap -m body.gz -out body.Heatmap.pdf --plotFileFormat pdf</span><br><span class=\"line\">plotProfile -m body.gz -out body.Profile.pdf --plotFileFormat pdf --perGroup</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950011-700x630.png\" alt=\"\" /></p>\n<ul>\n<li>另外，参考下面这个图，看每个参数控制的哪里，如何同时绘制多个等。这是我好久之前总结的，清晰度堪忧</li>\n</ul>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950013-700x649.png\" alt=\"\" /></p>\n<h3 id=\"3-相关性可视化依旧是使用-deeptools\"><a class=\"markdownIt-Anchor\" href=\"#3-相关性可视化依旧是使用-deeptools\"></a> 3. 相关性可视化（依旧是使用 deeptools）</h3>\n<ul>\n<li>因为我测试样本少，所以就使用<a href=\"https://deeptools.readthedocs.io/en/latest/content/tools/plotCorrelation.html\">官网的图</a>了哈，但代码是能跑通的，放心使用。</li>\n<li>先使用 [bw] 文件生成 [npz] 文件。所有样本做相关性，用 [*.last.bw]，多个单列出来也行</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">multiBigwigSummary bins -b *.last.bw -o number.of.bins.npz</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<ul>\n<li>画相关性热图</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plotCorrelation -in number.of.bins.npz </span><br><span class=\"line\">--corMethod pearson </span><br><span class=\"line\">--skipZeros </span><br><span class=\"line\">--plotTitle &quot;Pearson Correlation of Average Scores Per Transcript&quot; </span><br><span class=\"line\">--plotFileFormat pdf </span><br><span class=\"line\">--whatToPlot heatmap --colorMap RdYlBu --plotNumbers </span><br><span class=\"line\">-o heatmap_PearsonCorr_bigwigScores.pdf </span><br><span class=\"line\">--outFileCorMatrix PearsonCorr_bigwigScores.tab</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950014-700x605.png\" alt=\"\" /></p>\n<p>heatmap</p>\n<ul>\n<li>画相关性点图</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plotCorrelation -in number.of.bins.npz </span><br><span class=\"line\">--corMethod pearson </span><br><span class=\"line\">--skipZeros </span><br><span class=\"line\">--plotTitle &quot;Pearson Correlation of Average Scores Per Transcript&quot; </span><br><span class=\"line\">--plotFileFormat pdf </span><br><span class=\"line\">--whatToPlot scatterplot </span><br><span class=\"line\">-o scatterplot_PearsonCorr_bigwigScores.pdf </span><br><span class=\"line\">--outFileCorMatrix PearsonCorr_bigwigScores.tab</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950015-700x734.png\" alt=\"\" /></p>\n<p>相关性点图</p>\n<h3 id=\"5-chipseeker-对-peaks-进行注释和可视化\"><a class=\"markdownIt-Anchor\" href=\"#5-chipseeker-对-peaks-进行注释和可视化\"></a> 5. ChIPseeker 对 peaks 进行注释和可视化</h3>\n<ul>\n<li>对 peak 的注释分为两个部分——结构注释和功能注释<br />\n结构注释会将 peak 所落在基因组上的区域结构注释出来，比如说启动子区域，UTR 区域，内含子区域等等。同时，也会将与 peak 最临近的基因注释出来，非常好用。<br />\n功能注释其实并不是对 peak 进行注释的，而是对 peak 最临近的基因注释的，因此这部分就和传统的 GO/KEGG 等分析如出一辙啦。</li>\n</ul>\n<h4 id=\"51-结构注释\"><a class=\"markdownIt-Anchor\" href=\"#51-结构注释\"></a> <strong>5.1 结构注释</strong></h4>\n<p>5.1.1 <strong>准备工作</strong>：导入包，没有的安装吧。另外需要使用 gff/gtf 构建一个 TxDb。因为<a href=\"http://www.bioconductor.org/packages/release/BiocViews.html%23___TxDb\">官网</a>上 TxDb 也不是每一个物种都有（目前共 43 个），因此我们自己手动构建。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#if (!requireNamespace(&quot;BiocManager&quot;, quietly = TRUE))</span><br><span class=\"line\">#    install.packages(&quot;BiocManager&quot;)</span><br><span class=\"line\">#BiocManager::install(&quot;clusterProfiler&quot;)</span><br><span class=\"line\"> </span><br><span class=\"line\">library(clusterProfiler)</span><br><span class=\"line\">library(ChIPseeker)</span><br><span class=\"line\">library(GenomicFeatures)</span><br><span class=\"line\">txdb &lt;- makeTxDbFromGFF(&quot;public/bioinfoYu/genome/tair10/TAIR10.gff&quot;,</span><br><span class=\"line\">                        format=&quot;gff&quot;)    #也可以使用gtf</span><br><span class=\"line\">keytypes(txdb)    #感兴趣的话，可以用以下方法探索txdb都包含了什么内容</span><br><span class=\"line\">keys(txdb)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>5.1.2 <strong>单个文件的结构注释</strong>（不推荐在这一步加 OrgDB 的内容，没用）</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#读入单个summits文件</span><br><span class=\"line\">peaks &lt;- readPeakFile(&quot;SRR7512044_summits.bed&quot;)</span><br><span class=\"line\">#结构注释</span><br><span class=\"line\">peakAnno &lt;- annotatePeak(peaks,</span><br><span class=\"line\">                         TxDb=txdb,</span><br><span class=\"line\">                         tssRegion=c(-1000, 1000))</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>上面的 tssRegion 取值有说法的，因为判定 “Promoter”, “Exon”, “Intron”, “Intergenic” 等结构的依据就是根据范围来的。比如定义 1000 以内的，则在 1kbp 之内规定为 “Promoter (&lt;=1kb)”，而 1k-2k 内定义为 “Downstream (1-2kb)”。但你定义 2000 以内呢，则在 1kbp 之内规定为 “Promoter (&lt;=1kb)”，而 1k-2k 内定义为 “Promoter (1-2kb)”。虽然，ChIPseeker 会标记出来区域，但还是三思后再取范围。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#注释完，进行可视化，多种图可供选择</span><br><span class=\"line\">plotAnnoBar(peakAnno)</span><br><span class=\"line\">plotDistToTSS(peakAnno)</span><br><span class=\"line\">vennpie(peakAnno)</span><br><span class=\"line\">plotAnnoPie(peakAnno)</span><br><span class=\"line\">#install.packages(&quot;ggupset&quot;)</span><br><span class=\"line\">library(ggupset)</span><br><span class=\"line\">upsetplot(peakAnno)</span><br><span class=\"line\">#install.packages(&quot;ggimage&quot;)</span><br><span class=\"line\">library(ggimage)</span><br><span class=\"line\">upsetplot(peakAnno, vennpie=TRUE)</span><br><span class=\"line\"> </span><br><span class=\"line\">#最后将我们的注释结果转为数据框，便于查看</span><br><span class=\"line\">df &lt;- as.data.frame(peakAnno)</span><br><span class=\"line\">#将注释到的基因提取出来（第14列），用于后续功能分析</span><br><span class=\"line\">gene &lt;- df[,14]</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950016-700x323.png\" alt=\"\" /></p>\n<p>提供可视化的方法</p>\n<p>5.1.3 <strong>多个文件的结构注释</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#一次也可以读入多个summits文件，使用list存储，然后使用lapply注释</span><br><span class=\"line\">files = list(peak1 = &quot;peaks.bed&quot;, peak2 = (&quot;peak.bed&quot;))</span><br><span class=\"line\">peakAnnoList &lt;- lapply(files, </span><br><span class=\"line\">                       annotatePeak,</span><br><span class=\"line\">                       TxDb=txdb,</span><br><span class=\"line\">                       tssRegion=c(-2000, 2000))</span><br><span class=\"line\">plotAnnoBar(peakAnnoList)</span><br><span class=\"line\">plotDistToTSS(peakAnnoList)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950019-700x220.png\" alt=\"\" /></p>\n<p>读入多个 summits 文件的可视化</p>\n<h4 id=\"52-功能注释\"><a class=\"markdownIt-Anchor\" href=\"#52-功能注释\"></a> <strong>5.2 功能注释</strong></h4>\n<p>5.2.1 <strong>可选支线</strong><br />\n由于这里需要物种的 OrgDb 注释库。如果你足够幸运，研究的物种正好在<a href=\"http://www.bioconductor.org/packages/release/BiocViews.html%23___OrgDb\">官网</a>仅提供的 20 个物种中存在，那就拿来用吧。除了以上这些都好说，还有是 id 转换，后面再说。<br />\n5.2.2 <strong>OrgDb 下载</strong><br />\n本次测试是用拟南芥的样本，我推荐在<a href=\"http://www.bioconductor.org/packages/release/BiocViews.html%23___OrgDb\">官网</a>中直接将所需要的的 OrgDb 库下载到服务器上，这样就不用在 R 里面重复在网上获取浪费时间了。比如说拟南芥，就可以下载，这样就把【org.At.tair.db】下载到了服务器或者本地了。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://www.bioconductor.org/packages/release/data/annotation/src/contrib/org.At.tair.db_3.13.0.tar.gz</span><br><span class=\"line\">tar -zvxf org.At.tair.db_3.13.0.tar.gz</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>5.2.3 <strong>导入 OrgDb</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#从本地下载OrgDb库（如果你直接下载到了R的lib里面，就直接library也可）</span><br><span class=\"line\">install.packages(&quot;/public/bioinfoYu/genome/tair10/org.At.tair.db&quot;, repos=NULL)</span><br><span class=\"line\">#另外一种方法</span><br><span class=\"line\">#if (!requireNamespace(&quot;BiocManager&quot;, quietly = TRUE))install.packages(&quot;BiocManager&quot;)</span><br><span class=\"line\">#BiocManager::install(&quot;org.At.tair.db&quot;)</span><br><span class=\"line\">#载入库</span><br><span class=\"line\">library(org.At.tair.db)</span><br><span class=\"line\">#感兴趣的话，看看org.At.tair.db包含的都是些啥</span><br><span class=\"line\">#查看包含的列名</span><br><span class=\"line\">keytypes(org.At.tair.db)</span><br><span class=\"line\">#查看包含的基因ID</span><br><span class=\"line\">keys(org.At.tair.db)</span><br><span class=\"line\">#随便选择一个基因和一些列名，看一看到第是什么东东，不过因为导入了其他包，下面命令报错，我至今还没有解决</span><br><span class=\"line\">select(org.At.tair.db,keys=&quot;AT1G01010&quot;,columns = c(&quot;ENTREZID&quot;,&quot;GO&quot;,&quot;SYMBOL&quot;))</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>5.2.4 <strong>ID 转换</strong>（非必须）<br />\n上面<code>5.1.2</code>已经得到 peak 附近的基因集【gene】了，如果需要 ID 转换，就是用<code>clusterProfiler</code>中的<code>bitr</code>函数</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#首先，去除版本号，如AT1G50040.1后面的.1，当然我们的测试集没有，因此不用做</span><br><span class=\"line\">#gene_rm &lt;- gsub(&quot;.[0-9] $&quot;,&quot;&quot;,gene)</span><br><span class=\"line\">#下面进行ID转换</span><br><span class=\"line\">keytypes(org.At.tair.db)</span><br><span class=\"line\">gene_last &lt;- bitr(geneID = gene, </span><br><span class=\"line\">                    fromType = &quot;TAIR&quot;,</span><br><span class=\"line\">                    toType = c(&quot;ENTREZID&quot;, &quot;SYMBOL&quot;, &quot;GENENAME&quot;),</span><br><span class=\"line\">                    OrgDb = org.At.tair.db)</span><br><span class=\"line\"> </span><br><span class=\"line\"># geneID    需要转换的ID</span><br><span class=\"line\"># fromType  当前ID类型</span><br><span class=\"line\"># toType    转换成什么ID，使用keytypes()查看有哪些类型</span><br><span class=\"line\"># OrgDb     注释数据库</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>5.2.5 <strong>GO 功能注释</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 因为keyType不接受数据框类型的数据，因此我们转换为字符型</span><br><span class=\"line\">genelist &lt;- gene.symbol[,2]  #注意我这里把ENTREZID单独拿出来了，所以下面自然是keyType = &quot;ENTREZID&quot;,</span><br><span class=\"line\">go_result &lt;- enrichGO(genelist,</span><br><span class=\"line\">                      keyType = &quot;ENTREZID&quot;, </span><br><span class=\"line\">                      OrgDb = org.At.tair.db, </span><br><span class=\"line\">                      ont = &quot;BP&quot;, #BP,MF,CC,ALL可选</span><br><span class=\"line\">                      pAdjustMethod = &quot;BH&quot;, </span><br><span class=\"line\">                      qvalueCutoff = 0.05, </span><br><span class=\"line\">                      readable = FALSE)</span><br><span class=\"line\">#可视化，showCategory=20调整显示的条目多少</span><br><span class=\"line\">dotplot(go_result, showCategory=20)</span><br><span class=\"line\">#将结果转为数据框，可以选择导出</span><br><span class=\"line\">goresult &lt;- as.data.frame(go_result)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950021-700x685.png\" alt=\"\" /></p>\n<p>GO 可视化</p>\n<p>5.2.6 <strong>KEGG 通路注释</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#geneClusters必须是数据框类型，ID必须是ENTREZID类型</span><br><span class=\"line\">class(gene.symbol)</span><br><span class=\"line\">compKEGG &lt;- compareCluster(geneClusters=gene.symbol, </span><br><span class=\"line\">                           fun = &quot;enrichKEGG&quot;,</span><br><span class=\"line\">                           organism = &quot;ath&quot;,    #在 http://www.genome.jp/kegg/catalog/org_list.html 上查看物种简写</span><br><span class=\"line\">                           pvalueCutoff  = 0.05, </span><br><span class=\"line\">                           pAdjustMethod = &quot;BH&quot;)</span><br><span class=\"line\">dotplot(compKEGG, showCategory = 20, title = &quot;KEGG Pathway Enrichment Analysis&quot;)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950022-700x342.png\" alt=\"\" /></p>\n<p>KEGG 可视化</p>\n<h3 id=\"6-homer-寻找-motif\"><a class=\"markdownIt-Anchor\" href=\"#6-homer-寻找-motif\"></a> 6. homer 寻找 motif</h3>\n<ul>\n<li>所需软件：<a href=\"https://anaconda.org/bioconda/homer\">homer</a><a href=\"http://homer.ucsd.edu/homer/\">【官方网站】</a></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 提取peaks的位置信息文件</span><br><span class=\"line\">awk &#x27;&#123;print $4&quot;t&quot;$1&quot;t&quot;$2&quot;t&quot;$3&quot;t &quot;&#125;&#x27; </span><br><span class=\"line\">SRR7512044_peaks.narrowPeak &gt; SRR7512044.homer_peaks.tmp</span><br><span class=\"line\"># 寻找motif</span><br><span class=\"line\">findMotifsGenome.pl SRR7512044.homer_peaks.tmp </span><br><span class=\"line\">./TAIR10_genome.fa   #指定参考基因组</span><br><span class=\"line\">./SRR7512044.motif   #输出文件夹的名字</span><br><span class=\"line\">-size 200 -len 8,10,12</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950023-700x261.png\" alt=\"\" /></p>\n<h3 id=\"7-diffbind-找差异-peak\"><a class=\"markdownIt-Anchor\" href=\"#7-diffbind-找差异-peak\"></a> 7. DiffBind 找差异 peak</h3>\n<ul>\n<li>所需软件：<a href=\"http://www.bioconductor.org/packages/release/bioc/html/DiffBind.html\">DiffBind</a></li>\n</ul>\n<p>首先根据我自己的理解将<strong>找差异 peak 的原理</strong>说一下：既然是找差异的 peak，那首先就要保证不同样本间 peak 所在的区间基本一致才可以。因此<strong>第一步</strong>就是找到多个样本相同的 peak 区间。<strong>第二步</strong>，基于这些相同区域的 peak 开始找差异，这个地方的差异和传统的 RNA-Seq 找差异基因的原理一模一样，都是<strong>对落在峰区间的 reads 进行计数</strong>，数量不同的话差异就由此而来。但软件都帮我们做了，就不用考虑那么多了</p>\n<ul>\n<li>我废话真多，其实最麻烦的就是<strong>准备输入数据</strong>，下面来看怎么做<br />\n一般情况相下需要包括以下几列：<code>&quot;SampleID&quot;， &quot;Tissue&quot;， &quot;Factor&quot;， &quot;Condition&quot; ，&quot;Treatment&quot;，&quot;Replicate&quot;， &quot;bamReads&quot; ，&quot;ControlID&quot; ，&quot;bamControl&quot; ，&quot;Peaks&quot;和&quot;PeakCaller&quot;</code></li>\n</ul>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950025-700x148.png\" alt=\"\" /></p>\n<ul>\n<li>但我们做 ATAC-Seq 的哪里有什么<code>control，controlID，bamControl</code>，因此删掉，而<code>&quot;Tissue&quot;， &quot;Factor&quot;， &quot;Condition&quot; ，&quot;Treatment&quot;，&quot;Replicate&quot;，</code>表示的都是分组的意思，因此我保留了两个<code>&quot;Factor&quot;，&quot;Replicate&quot;</code>，最后 csv 文件的样子如下：<img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950026-700x127.png\" alt=\"\" /></li>\n</ul>\n<p><code>SampleID</code>：不能有重复<br />\n<code>Factor</code>：进行分组，后面要做差异分析的依据<br />\n<code>Replicate</code>：重复的编号<br />\n<code>bamReads</code>：最后生成的 bam 文件。全路径 bam 文件名<br />\n<code>Peaks</code>：macs2 生成的 narrowPeak 文件。全路径 narrowPeak 文件名<br />\n<code>PeakCaller</code>：说明 peak 类型，使用 narrowPeak 文件则为<code>narrow</code>。使用 xls 文件，则用<code>macs</code>。使用 bed 文件，则用<code>bed</code></p>\n<ul>\n<li>开始正题</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 安装包</span><br><span class=\"line\">if (!requireNamespace(&quot;BiocManager&quot;, quietly = TRUE))install.packages(&quot;BiocManager&quot;)</span><br><span class=\"line\">BiocManager::install(&quot;DiffBind&quot;)</span><br><span class=\"line\">library(DiffBind)</span><br><span class=\"line\">#导入数据，dba函数会将会将bam文件一同导入，因此csv中的路径一定要准确</span><br><span class=\"line\">tamoxifen &lt;- dba(sampleSheet=&quot;atDiff.csv&quot;)</span><br><span class=\"line\">#查看样本间的相关性</span><br><span class=\"line\">plot(tamoxifen)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950027.png\" alt=\"\" /></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#计算每个样本中的reads数</span><br><span class=\"line\">tamoxifen &lt;- dba.count(tamoxifen)</span><br><span class=\"line\">#简单查看计算结果</span><br><span class=\"line\">info &lt;- dba.show(tamoxifen)</span><br><span class=\"line\">libsizes &lt;- cbind(LibReads=info$Reads, FRiP=info$FRiP, PeakReads=round(info$Reads * info$FRiP))</span><br><span class=\"line\">rownames(libsizes) &lt;- info$ID</span><br><span class=\"line\">libsizes</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#统计结果</span><br><span class=\"line\">       LibReads FRiP PeakReads</span><br><span class=\"line\">cmt2_1  6720462 0.29   1948934</span><br><span class=\"line\">cmt2_2  7747491 0.33   2556672</span><br><span class=\"line\">wild_1  7078309 0.36   2548191</span><br><span class=\"line\">wild_2  8030752 0.34   2730456</span><br><span class=\"line\">ddcc_1  6370232 0.30   1911069</span><br><span class=\"line\">ddcc_2  6956429 0.35   2434750</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>&lt;pre&quot;&gt;# 默认基于测序深度对数据进行标椎化 tamoxifen &lt;- dba.normalize(tamoxifen) norm &lt;- dba.normalize(tamoxifen, bRetrieve=TRUE) norm #查看进行标准化的文库大小 (library-size)，其实就是各样本文库大小总和的平均值，你可以计算验证一下 normlibs &lt;- cbind(FullLibSize=norm<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>i</mi><mi>b</mi><mi mathvariant=\"normal\">.</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mi>s</mi><mo separator=\"true\">,</mo><mi>N</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>F</mi><mi>a</mi><mi>c</mi><mi>s</mi><mo>=</mo><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">lib.sizes, NormFacs=norm</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">b</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">m</span></span></span></span>norm.factors, NormLibSize=round(norm<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>i</mi><mi>b</mi><mi mathvariant=\"normal\">.</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mi>s</mi><mi mathvariant=\"normal\">/</mi><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">lib.sizes/norm</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">b</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">s</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">m</span></span></span></span>norm.factors)) rownames(normlibs) &lt;- info$ID normlibs</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#标椎化结果</span><br><span class=\"line\">       FullLibSize  NormFacs NormLibSize</span><br><span class=\"line\">cmt2_1     6720462 0.9398443     7150612</span><br><span class=\"line\">cmt2_2     7747491 1.0834724     7150612</span><br><span class=\"line\">wild_1     7078309 0.9898885     7150612</span><br><span class=\"line\">wild_2     8030752 1.1230859     7150612</span><br><span class=\"line\">ddcc_1     6370232 0.8908652     7150612</span><br><span class=\"line\">ddcc_2     6956429 0.9728438     7150612</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#分组，格式是表头在最前面，要分的组依次写在后面，只能两两比较，因此后面只能写两组，但可以多执行几次，都会追加到tamoxifen 中</span><br><span class=\"line\">#分组1，后面使用contrast=1单独查看</span><br><span class=\"line\">tamoxifen &lt;- dba.contrast(tamoxifen, contrast=c(&quot;Factor&quot;,&quot;ddcc&quot;,&quot;wild&quot;))</span><br><span class=\"line\">#分组2，后面使用contrast=2单独查看</span><br><span class=\"line\">tamoxifen &lt;- dba.contrast(tamoxifen, contrast=c(&quot;Factor&quot;,&quot;cmt2&quot;,&quot;wild&quot;))</span><br><span class=\"line\">#当然还可有分组3,4,5等，均可以使用contrast=number单独查看</span><br><span class=\"line\">tamoxifen</span><br><span class=\"line\">#按照分组分别进行差异分析，默认使用DESeq2进行计算，可以选择method = DBA_EDGER(edgR)，或者两个都要method = DBA_ALL_METHODS</span><br><span class=\"line\">tamoxifen &lt;- dba.analyze(tamoxifen)</span><br><span class=\"line\">dba.show(tamoxifen, bContrasts=TRUE)</span><br><span class=\"line\">#查看差异分析的结果与导出为csv文件</span><br><span class=\"line\">#查看第1组差异分析的结果</span><br><span class=\"line\">tamoxifen.DB_1 &lt;- dba.report(tamoxifen,contrast=1)</span><br><span class=\"line\">tamoxifen.DB_1</span><br><span class=\"line\">write.csv(tamoxifen.DB_1, file=&quot;diffBind_result.csv&quot;)</span><br><span class=\"line\"> </span><br><span class=\"line\">#查看第2组差异分析的结果</span><br><span class=\"line\">tamoxifen.DB_2 &lt;- dba.report(tamoxifen,contrast=2) tamoxifen.DB_2 write.csv(tamoxifen.DB_2, file=&quot;diffBind_result.csv&quot;) ##传统的上下调在找差异peak中称为“Gain”或“Loss” #查看第1组的差异peak数量“Fold&gt;0或&lt;0”控制是“Gain”或“Loss” sum(tamoxifen.DB$Fold&gt;0,contrast=1)</span><br><span class=\"line\">sum(tamoxifen.DB$Fold&lt;0,contrast=1) #查看第2组的差异peak数量“Fold&gt;0或&lt;0”控制是“Gain”或“Loss” sum(tamoxifen.DB$Fold&gt;0,contrast=2)</span><br><span class=\"line\">sum(tamoxifen.DB$Fold&lt;0,contrast=2)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<ul>\n<li>由于我是使用两组进行测试的，所以可以使用 contrast=1 或 contrast=2 分别查看，由于都是相同的代码，下面进行可视化的时候，<strong>只选择 contrast=1 进行可视化</strong></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#韦恩图可视化</span><br><span class=\"line\">dba.plotVenn(tamoxifen, contrast=1, bDB=TRUE, bGain=TRUE, bLoss=TRUE, bAll=FALSE)</span><br><span class=\"line\"> </span><br><span class=\"line\">#PCA</span><br><span class=\"line\">dba.plotPCA(tamoxifen) #这里可以使用所有样本进行PCA</span><br><span class=\"line\">dba.plotPCA(tamoxifen, contrast=1, label=DBA_FACTOR)#单独对分组1进行PCA</span><br><span class=\"line\"> </span><br><span class=\"line\">#MA plots</span><br><span class=\"line\">dba.plotMA(tamoxifen, contrast=1)</span><br><span class=\"line\"> </span><br><span class=\"line\">#Volcano plots</span><br><span class=\"line\">dba.plotVolcano(tamoxifen, contrast=1)</span><br><span class=\"line\"> </span><br><span class=\"line\">#Box plots</span><br><span class=\"line\">dba.plotBox(tamoxifen, contrast=1)</span><br><span class=\"line\"> </span><br><span class=\"line\">#Heatmap</span><br><span class=\"line\">hmap &lt;- colorRampPalette(c(&quot;red&quot;, &quot;black&quot;, &quot;green&quot;))(n = 13)</span><br><span class=\"line\">#对所有样本的所有的差异peak画热图</span><br><span class=\"line\">dba.plotHeatmap(tamoxifen,correlations=FALSE,scale=&quot;row&quot;,colScheme = hmap)</span><br><span class=\"line\">#单独对分组1中所有的差异peak画热图</span><br><span class=\"line\">dba.plotHeatmap(tamoxifen, contrast=1, correlations=FALSE, scale=&quot;row&quot;, colScheme = hmap)</span><br><span class=\"line\">dba.plotHeatmap(tamoxifen,correlations=FALSE,scale=&quot;row&quot;,colScheme = hmap)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950027-1-700x349.png\" alt=\"\" /></p>\n<ul>\n<li>想画下面的图，可是一直提示 could not find function dba.plotProfile，因此还没有成功，用官方提供的图展示一下吧，大家能画出来可以和我说一声哦。这是<a href=\"https://content.cruk.cam.ac.uk/bioinformatics/software/DiffBind/plotProfileDemo.html\">【官方文档】</a>可以参考</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#Profiling and Profile Heatmaps</span><br><span class=\"line\">dba.plotProfile(tamoxifen)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://static.plob.org/wp-content/uploads/2021/09/1632950029-700x643.png\" alt=\"\" /></p>\n<h3 id=\"8-footprint-分析\"><a class=\"markdownIt-Anchor\" href=\"#8-footprint-分析\"></a> 8. footprint 分析</h3>\n<p>目前我还没有找到使用于所有物种的软件，HINT-ATAC 用来做 footprint 分析的话，应该只支持不几个物种，比较鸡肋。<a href=\"https://bioconductor.org/packages/release/bioc/manuals/ATACseqQC/man/ATACseqQC.pdf\">ATACseqQC</a> 应该是一款不错的软件，最近还在探索</p>\n<h3 id=\"三-atac-seq-与多组学数据联合分析\"><a class=\"markdownIt-Anchor\" href=\"#三-atac-seq-与多组学数据联合分析\"></a> 三、ATAC-seq 与多组学数据联合分析</h3>\n<p><strong>转录因子 ChIP-seq</strong>：由于大部分转录因子结合的是染色质开放区域，所以 ATAC-seq 的 Peak 可能和转录因子 ChIP-seq 的 Peak 存在部分重叠的情况，而且 ATAC-seq 得到的 Peak 长度往往更长，因此 ATAC-seq 数据和转录因子 ChIP-seq 数据可以相互验证。转录因子在 ChIP-seq 中独有的 Peak 暗示这个转录因子可能是结合在异染色质区域的驱动型转录因子（Pioneer TFs），驱动型转录因子随后招募染色质重塑复合体以及其它转录因子开始转录。另外，联合分析已经报道的 ChIP-seq 数据可以更准确地分析转录因子的足迹。<br />\n<strong>组蛋白修饰 ChIP-seq</strong>：ATAC-seq 数据同样可以和组蛋白修饰 ChIP-seq 数据进行联合分析，其中转录激活性修饰（H3K4me3，H3K4me1 和 H3K27ac 等）与染色质开放程度呈正相关，转录抑制性修饰（H3K27me3）与染色质开放程度呈负相关。联合已知的增强子和启动子之间的相互作用数据也可以帮助构建调控网络。<br />\n<strong>RNA-seq</strong>：ATAC-seq 数据可以通过联合分析 RNA-seq 数据来发现哪些差异表达的基因是受染色质可及性调控的，进一步可以推测这些差异表达的基因哪些是受开放染色质中具有 motif 和 footprint 的转录因子调控的，因此 ATAC-seq 与 RNA-seq 的联合分析有助于破译基因调控网络和细胞异质性。</p>\n"},{"title":"通路(挑选)点图","abbrlink":"d1d177a0","date":"2023-05-22T10:16:22.000Z","_content":"\n##  挑选通路画DotPlot\n\n<!--more-->\n\n```R\nindir <- \"/path\"\nenrich <- \"deg_Enrich.23522.xlsx\"\nsel <- \"deg_Enrich.select.230522.txt\"\nid <- \"deg_Enrich_Select\"\nday <- \"230522\"\n\n### 加载R包\nlibrary(ggplot2)\nlibrary(readxl)\nsetwd(indir)\n\n### 导入数据, 合并所有的sheet\ntab <- read_xlsx(enrich,sheet=1,col_names = TRUE)\nfor (i in 2:4) {\n    temp <- read_xlsx(enrich,sheet=i,col_names = TRUE)\n    tab <- rbind(tab,temp) \n}\n\n### 筛选出一些通路\nselect <- read.delim(sel,sep=\"\\t\",header=TRUE,check.names=FALSE)\ntab <- tab[tab$ID %in% select$ID,]\n\n\n# 替换列名中的.\nnames(tab) <- gsub(\"\\\\.\",\"_\",names(tab))\n# 将基因集的名称中的KEGG和Hallmark去掉，并将短杠替换为空格\ntab$Description <- gsub(\"_\",\" \",gsub(\"HALLMARK_\",\"H:\",tab$Description))\ntab$Description <- ifelse(grepl(\"hsa\",tab$ID),paste0(\"K:\",tab$Description),tab$Description)\ntab$Description <- ifelse(grepl(\"R-HSA\",tab$ID),paste0(\"R:\",tab$Description),tab$Description)\n### 计算基因比例\ntab$gene.s <- as.numeric(sapply(stringr::str_split(tab$GeneRatio,pattern = \"/\",n = 2),\"[\",1))\ntab$gene.a <- as.numeric(sapply(stringr::str_split(tab$GeneRatio,pattern = \"/\",n = 2),\"[\",2))\ntab$GRatio <- tab$gene.s/tab$gene.a\ntab$Description <- factor(tab$Description,levels = rev(unique(tab$Description[order(tab$Cluster,-tab$GRatio)])))\n\n\n### 进行画图\npdf(paste0(id,\"_\",day,\".pdf\"),5,7)\nggplot(tab,aes(x=Cluster,y=Description,size=GRatio,color=qvalue))+\n    geom_point(stat=\"identity\")+ylab(\"\")+xlab(\"\")+\n    scale_y_discrete(labels = function(x) stringr::str_wrap(x, width = 70))+\n    scale_color_gradientn(colors=c(\"#d93f09\",\"blue\"))+\n    theme(panel.grid.major=element_line(colour = \"gray90\"),\n          panel.background=element_rect(fill='transparent',color =\"black\"),\n          axis.text.y = element_text(face = \"bold\",color =\"black\",size = 8))+\n    scale_size_continuous(range = c(3,7)) #控制点的大小,防止极值过大\ndev.off()\n\n```\n\n","source":"_posts/Passway-dotplot.md","raw":"---\ntitle: 通路(挑选)点图\ncategories:\n  - code\n  - R\ntags:\n  - R\nabbrlink: d1d177a0\ndate: 2023-05-22 18:16:22\n---\n\n##  挑选通路画DotPlot\n\n<!--more-->\n\n```R\nindir <- \"/path\"\nenrich <- \"deg_Enrich.23522.xlsx\"\nsel <- \"deg_Enrich.select.230522.txt\"\nid <- \"deg_Enrich_Select\"\nday <- \"230522\"\n\n### 加载R包\nlibrary(ggplot2)\nlibrary(readxl)\nsetwd(indir)\n\n### 导入数据, 合并所有的sheet\ntab <- read_xlsx(enrich,sheet=1,col_names = TRUE)\nfor (i in 2:4) {\n    temp <- read_xlsx(enrich,sheet=i,col_names = TRUE)\n    tab <- rbind(tab,temp) \n}\n\n### 筛选出一些通路\nselect <- read.delim(sel,sep=\"\\t\",header=TRUE,check.names=FALSE)\ntab <- tab[tab$ID %in% select$ID,]\n\n\n# 替换列名中的.\nnames(tab) <- gsub(\"\\\\.\",\"_\",names(tab))\n# 将基因集的名称中的KEGG和Hallmark去掉，并将短杠替换为空格\ntab$Description <- gsub(\"_\",\" \",gsub(\"HALLMARK_\",\"H:\",tab$Description))\ntab$Description <- ifelse(grepl(\"hsa\",tab$ID),paste0(\"K:\",tab$Description),tab$Description)\ntab$Description <- ifelse(grepl(\"R-HSA\",tab$ID),paste0(\"R:\",tab$Description),tab$Description)\n### 计算基因比例\ntab$gene.s <- as.numeric(sapply(stringr::str_split(tab$GeneRatio,pattern = \"/\",n = 2),\"[\",1))\ntab$gene.a <- as.numeric(sapply(stringr::str_split(tab$GeneRatio,pattern = \"/\",n = 2),\"[\",2))\ntab$GRatio <- tab$gene.s/tab$gene.a\ntab$Description <- factor(tab$Description,levels = rev(unique(tab$Description[order(tab$Cluster,-tab$GRatio)])))\n\n\n### 进行画图\npdf(paste0(id,\"_\",day,\".pdf\"),5,7)\nggplot(tab,aes(x=Cluster,y=Description,size=GRatio,color=qvalue))+\n    geom_point(stat=\"identity\")+ylab(\"\")+xlab(\"\")+\n    scale_y_discrete(labels = function(x) stringr::str_wrap(x, width = 70))+\n    scale_color_gradientn(colors=c(\"#d93f09\",\"blue\"))+\n    theme(panel.grid.major=element_line(colour = \"gray90\"),\n          panel.background=element_rect(fill='transparent',color =\"black\"),\n          axis.text.y = element_text(face = \"bold\",color =\"black\",size = 8))+\n    scale_size_continuous(range = c(3,7)) #控制点的大小,防止极值过大\ndev.off()\n\n```\n\n","slug":"Passway-dotplot","published":1,"updated":"2023-05-22T10:22:16.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm4peu6my0007dbzr8bjv3oil","content":"<h2 id=\"挑选通路画dotplot\"><a class=\"markdownIt-Anchor\" href=\"#挑选通路画dotplot\"></a> 挑选通路画DotPlot</h2>\n<span id=\"more\"></span>\n<figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">indir <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;/path&quot;</span></span><br><span class=\"line\">enrich <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;deg_Enrich.23522.xlsx&quot;</span></span><br><span class=\"line\">sel <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;deg_Enrich.select.230522.txt&quot;</span></span><br><span class=\"line\">id <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;deg_Enrich_Select&quot;</span></span><br><span class=\"line\">day <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;230522&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 加载R包</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>ggplot2<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>readxl<span class=\"punctuation\">)</span></span><br><span class=\"line\">setwd<span class=\"punctuation\">(</span>indir<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 导入数据, 合并所有的sheet</span></span><br><span class=\"line\">tab <span class=\"operator\">&lt;-</span> read_xlsx<span class=\"punctuation\">(</span>enrich<span class=\"punctuation\">,</span>sheet<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span>col_names <span class=\"operator\">=</span> <span class=\"literal\">TRUE</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"punctuation\">(</span>i <span class=\"keyword\">in</span> <span class=\"number\">2</span><span class=\"operator\">:</span><span class=\"number\">4</span><span class=\"punctuation\">)</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    temp <span class=\"operator\">&lt;-</span> read_xlsx<span class=\"punctuation\">(</span>enrich<span class=\"punctuation\">,</span>sheet<span class=\"operator\">=</span>i<span class=\"punctuation\">,</span>col_names <span class=\"operator\">=</span> <span class=\"literal\">TRUE</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">    tab <span class=\"operator\">&lt;-</span> rbind<span class=\"punctuation\">(</span>tab<span class=\"punctuation\">,</span>temp<span class=\"punctuation\">)</span> </span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 筛选出一些通路</span></span><br><span class=\"line\">select <span class=\"operator\">&lt;-</span> read.delim<span class=\"punctuation\">(</span>sel<span class=\"punctuation\">,</span>sep<span class=\"operator\">=</span><span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">,</span>header<span class=\"operator\">=</span><span class=\"literal\">TRUE</span><span class=\"punctuation\">,</span>check.names<span class=\"operator\">=</span><span class=\"literal\">FALSE</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">tab <span class=\"operator\">&lt;-</span> tab<span class=\"punctuation\">[</span>tab<span class=\"operator\">$</span>ID <span class=\"operator\">%in%</span> select<span class=\"operator\">$</span>ID<span class=\"punctuation\">,</span><span class=\"punctuation\">]</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 替换列名中的.</span></span><br><span class=\"line\"><span class=\"built_in\">names</span><span class=\"punctuation\">(</span>tab<span class=\"punctuation\">)</span> <span class=\"operator\">&lt;-</span> gsub<span class=\"punctuation\">(</span><span class=\"string\">&quot;\\\\.&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;_&quot;</span><span class=\"punctuation\">,</span><span class=\"built_in\">names</span><span class=\"punctuation\">(</span>tab<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"comment\"># 将基因集的名称中的KEGG和Hallmark去掉，并将短杠替换为空格</span></span><br><span class=\"line\">tab<span class=\"operator\">$</span>Description <span class=\"operator\">&lt;-</span> gsub<span class=\"punctuation\">(</span><span class=\"string\">&quot;_&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot; &quot;</span><span class=\"punctuation\">,</span>gsub<span class=\"punctuation\">(</span><span class=\"string\">&quot;HALLMARK_&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;H:&quot;</span><span class=\"punctuation\">,</span>tab<span class=\"operator\">$</span>Description<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">tab<span class=\"operator\">$</span>Description <span class=\"operator\">&lt;-</span> ifelse<span class=\"punctuation\">(</span>grepl<span class=\"punctuation\">(</span><span class=\"string\">&quot;hsa&quot;</span><span class=\"punctuation\">,</span>tab<span class=\"operator\">$</span>ID<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>paste0<span class=\"punctuation\">(</span><span class=\"string\">&quot;K:&quot;</span><span class=\"punctuation\">,</span>tab<span class=\"operator\">$</span>Description<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>tab<span class=\"operator\">$</span>Description<span class=\"punctuation\">)</span></span><br><span class=\"line\">tab<span class=\"operator\">$</span>Description <span class=\"operator\">&lt;-</span> ifelse<span class=\"punctuation\">(</span>grepl<span class=\"punctuation\">(</span><span class=\"string\">&quot;R-HSA&quot;</span><span class=\"punctuation\">,</span>tab<span class=\"operator\">$</span>ID<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>paste0<span class=\"punctuation\">(</span><span class=\"string\">&quot;R:&quot;</span><span class=\"punctuation\">,</span>tab<span class=\"operator\">$</span>Description<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>tab<span class=\"operator\">$</span>Description<span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"comment\">### 计算基因比例</span></span><br><span class=\"line\">tab<span class=\"operator\">$</span>gene.s <span class=\"operator\">&lt;-</span> <span class=\"built_in\">as.numeric</span><span class=\"punctuation\">(</span>sapply<span class=\"punctuation\">(</span>stringr<span class=\"operator\">::</span>str_split<span class=\"punctuation\">(</span>tab<span class=\"operator\">$</span>GeneRatio<span class=\"punctuation\">,</span>pattern <span class=\"operator\">=</span> <span class=\"string\">&quot;/&quot;</span><span class=\"punctuation\">,</span>n <span class=\"operator\">=</span> <span class=\"number\">2</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;[&quot;</span><span class=\"punctuation\">,</span><span class=\"number\">1</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">tab<span class=\"operator\">$</span>gene.a <span class=\"operator\">&lt;-</span> <span class=\"built_in\">as.numeric</span><span class=\"punctuation\">(</span>sapply<span class=\"punctuation\">(</span>stringr<span class=\"operator\">::</span>str_split<span class=\"punctuation\">(</span>tab<span class=\"operator\">$</span>GeneRatio<span class=\"punctuation\">,</span>pattern <span class=\"operator\">=</span> <span class=\"string\">&quot;/&quot;</span><span class=\"punctuation\">,</span>n <span class=\"operator\">=</span> <span class=\"number\">2</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;[&quot;</span><span class=\"punctuation\">,</span><span class=\"number\">2</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">tab<span class=\"operator\">$</span>GRatio <span class=\"operator\">&lt;-</span> tab<span class=\"operator\">$</span>gene.s<span class=\"operator\">/</span>tab<span class=\"operator\">$</span>gene.a</span><br><span class=\"line\">tab<span class=\"operator\">$</span>Description <span class=\"operator\">&lt;-</span> factor<span class=\"punctuation\">(</span>tab<span class=\"operator\">$</span>Description<span class=\"punctuation\">,</span>levels <span class=\"operator\">=</span> rev<span class=\"punctuation\">(</span>unique<span class=\"punctuation\">(</span>tab<span class=\"operator\">$</span>Description<span class=\"punctuation\">[</span>order<span class=\"punctuation\">(</span>tab<span class=\"operator\">$</span>Cluster<span class=\"punctuation\">,</span><span class=\"operator\">-</span>tab<span class=\"operator\">$</span>GRatio<span class=\"punctuation\">)</span><span class=\"punctuation\">]</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 进行画图</span></span><br><span class=\"line\">pdf<span class=\"punctuation\">(</span>paste0<span class=\"punctuation\">(</span>id<span class=\"punctuation\">,</span><span class=\"string\">&quot;_&quot;</span><span class=\"punctuation\">,</span>day<span class=\"punctuation\">,</span><span class=\"string\">&quot;.pdf&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span><span class=\"number\">5</span><span class=\"punctuation\">,</span><span class=\"number\">7</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">ggplot<span class=\"punctuation\">(</span>tab<span class=\"punctuation\">,</span>aes<span class=\"punctuation\">(</span>x<span class=\"operator\">=</span>Cluster<span class=\"punctuation\">,</span>y<span class=\"operator\">=</span>Description<span class=\"punctuation\">,</span>size<span class=\"operator\">=</span>GRatio<span class=\"punctuation\">,</span>color<span class=\"operator\">=</span>qvalue<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span></span><br><span class=\"line\">    geom_point<span class=\"punctuation\">(</span>stat<span class=\"operator\">=</span><span class=\"string\">&quot;identity&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>ylab<span class=\"punctuation\">(</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>xlab<span class=\"punctuation\">(</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span></span><br><span class=\"line\">    scale_y_discrete<span class=\"punctuation\">(</span>labels <span class=\"operator\">=</span> <span class=\"keyword\">function</span><span class=\"punctuation\">(</span>x<span class=\"punctuation\">)</span> stringr<span class=\"operator\">::</span>str_wrap<span class=\"punctuation\">(</span>x<span class=\"punctuation\">,</span> width <span class=\"operator\">=</span> <span class=\"number\">70</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span></span><br><span class=\"line\">    scale_color_gradientn<span class=\"punctuation\">(</span>colors<span class=\"operator\">=</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#d93f09&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;blue&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span></span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>panel.grid.major<span class=\"operator\">=</span>element_line<span class=\"punctuation\">(</span>colour <span class=\"operator\">=</span> <span class=\"string\">&quot;gray90&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">          panel.background<span class=\"operator\">=</span>element_rect<span class=\"punctuation\">(</span>fill<span class=\"operator\">=</span><span class=\"string\">&#x27;transparent&#x27;</span><span class=\"punctuation\">,</span>color <span class=\"operator\">=</span><span class=\"string\">&quot;black&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">          axis.text.y <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>face <span class=\"operator\">=</span> <span class=\"string\">&quot;bold&quot;</span><span class=\"punctuation\">,</span>color <span class=\"operator\">=</span><span class=\"string\">&quot;black&quot;</span><span class=\"punctuation\">,</span>size <span class=\"operator\">=</span> <span class=\"number\">8</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span></span><br><span class=\"line\">    scale_size_continuous<span class=\"punctuation\">(</span><span class=\"built_in\">range</span> <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"number\">3</span><span class=\"punctuation\">,</span><span class=\"number\">7</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"comment\">#控制点的大小,防止极值过大</span></span><br><span class=\"line\">dev.off<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":284,"excerpt":"<h2 id=\"挑选通路画dotplot\"><a class=\"markdownIt-Anchor\" href=\"#挑选通路画dotplot\"></a> 挑选通路画DotPlot</h2>","more":"<figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">indir <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;/path&quot;</span></span><br><span class=\"line\">enrich <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;deg_Enrich.23522.xlsx&quot;</span></span><br><span class=\"line\">sel <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;deg_Enrich.select.230522.txt&quot;</span></span><br><span class=\"line\">id <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;deg_Enrich_Select&quot;</span></span><br><span class=\"line\">day <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;230522&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 加载R包</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>ggplot2<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>readxl<span class=\"punctuation\">)</span></span><br><span class=\"line\">setwd<span class=\"punctuation\">(</span>indir<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 导入数据, 合并所有的sheet</span></span><br><span class=\"line\">tab <span class=\"operator\">&lt;-</span> read_xlsx<span class=\"punctuation\">(</span>enrich<span class=\"punctuation\">,</span>sheet<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span>col_names <span class=\"operator\">=</span> <span class=\"literal\">TRUE</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"punctuation\">(</span>i <span class=\"keyword\">in</span> <span class=\"number\">2</span><span class=\"operator\">:</span><span class=\"number\">4</span><span class=\"punctuation\">)</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    temp <span class=\"operator\">&lt;-</span> read_xlsx<span class=\"punctuation\">(</span>enrich<span class=\"punctuation\">,</span>sheet<span class=\"operator\">=</span>i<span class=\"punctuation\">,</span>col_names <span class=\"operator\">=</span> <span class=\"literal\">TRUE</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">    tab <span class=\"operator\">&lt;-</span> rbind<span class=\"punctuation\">(</span>tab<span class=\"punctuation\">,</span>temp<span class=\"punctuation\">)</span> </span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 筛选出一些通路</span></span><br><span class=\"line\">select <span class=\"operator\">&lt;-</span> read.delim<span class=\"punctuation\">(</span>sel<span class=\"punctuation\">,</span>sep<span class=\"operator\">=</span><span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">,</span>header<span class=\"operator\">=</span><span class=\"literal\">TRUE</span><span class=\"punctuation\">,</span>check.names<span class=\"operator\">=</span><span class=\"literal\">FALSE</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">tab <span class=\"operator\">&lt;-</span> tab<span class=\"punctuation\">[</span>tab<span class=\"operator\">$</span>ID <span class=\"operator\">%in%</span> select<span class=\"operator\">$</span>ID<span class=\"punctuation\">,</span><span class=\"punctuation\">]</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 替换列名中的.</span></span><br><span class=\"line\"><span class=\"built_in\">names</span><span class=\"punctuation\">(</span>tab<span class=\"punctuation\">)</span> <span class=\"operator\">&lt;-</span> gsub<span class=\"punctuation\">(</span><span class=\"string\">&quot;\\\\.&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;_&quot;</span><span class=\"punctuation\">,</span><span class=\"built_in\">names</span><span class=\"punctuation\">(</span>tab<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"comment\"># 将基因集的名称中的KEGG和Hallmark去掉，并将短杠替换为空格</span></span><br><span class=\"line\">tab<span class=\"operator\">$</span>Description <span class=\"operator\">&lt;-</span> gsub<span class=\"punctuation\">(</span><span class=\"string\">&quot;_&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot; &quot;</span><span class=\"punctuation\">,</span>gsub<span class=\"punctuation\">(</span><span class=\"string\">&quot;HALLMARK_&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;H:&quot;</span><span class=\"punctuation\">,</span>tab<span class=\"operator\">$</span>Description<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">tab<span class=\"operator\">$</span>Description <span class=\"operator\">&lt;-</span> ifelse<span class=\"punctuation\">(</span>grepl<span class=\"punctuation\">(</span><span class=\"string\">&quot;hsa&quot;</span><span class=\"punctuation\">,</span>tab<span class=\"operator\">$</span>ID<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>paste0<span class=\"punctuation\">(</span><span class=\"string\">&quot;K:&quot;</span><span class=\"punctuation\">,</span>tab<span class=\"operator\">$</span>Description<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>tab<span class=\"operator\">$</span>Description<span class=\"punctuation\">)</span></span><br><span class=\"line\">tab<span class=\"operator\">$</span>Description <span class=\"operator\">&lt;-</span> ifelse<span class=\"punctuation\">(</span>grepl<span class=\"punctuation\">(</span><span class=\"string\">&quot;R-HSA&quot;</span><span class=\"punctuation\">,</span>tab<span class=\"operator\">$</span>ID<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>paste0<span class=\"punctuation\">(</span><span class=\"string\">&quot;R:&quot;</span><span class=\"punctuation\">,</span>tab<span class=\"operator\">$</span>Description<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span>tab<span class=\"operator\">$</span>Description<span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"comment\">### 计算基因比例</span></span><br><span class=\"line\">tab<span class=\"operator\">$</span>gene.s <span class=\"operator\">&lt;-</span> <span class=\"built_in\">as.numeric</span><span class=\"punctuation\">(</span>sapply<span class=\"punctuation\">(</span>stringr<span class=\"operator\">::</span>str_split<span class=\"punctuation\">(</span>tab<span class=\"operator\">$</span>GeneRatio<span class=\"punctuation\">,</span>pattern <span class=\"operator\">=</span> <span class=\"string\">&quot;/&quot;</span><span class=\"punctuation\">,</span>n <span class=\"operator\">=</span> <span class=\"number\">2</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;[&quot;</span><span class=\"punctuation\">,</span><span class=\"number\">1</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">tab<span class=\"operator\">$</span>gene.a <span class=\"operator\">&lt;-</span> <span class=\"built_in\">as.numeric</span><span class=\"punctuation\">(</span>sapply<span class=\"punctuation\">(</span>stringr<span class=\"operator\">::</span>str_split<span class=\"punctuation\">(</span>tab<span class=\"operator\">$</span>GeneRatio<span class=\"punctuation\">,</span>pattern <span class=\"operator\">=</span> <span class=\"string\">&quot;/&quot;</span><span class=\"punctuation\">,</span>n <span class=\"operator\">=</span> <span class=\"number\">2</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;[&quot;</span><span class=\"punctuation\">,</span><span class=\"number\">2</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">tab<span class=\"operator\">$</span>GRatio <span class=\"operator\">&lt;-</span> tab<span class=\"operator\">$</span>gene.s<span class=\"operator\">/</span>tab<span class=\"operator\">$</span>gene.a</span><br><span class=\"line\">tab<span class=\"operator\">$</span>Description <span class=\"operator\">&lt;-</span> factor<span class=\"punctuation\">(</span>tab<span class=\"operator\">$</span>Description<span class=\"punctuation\">,</span>levels <span class=\"operator\">=</span> rev<span class=\"punctuation\">(</span>unique<span class=\"punctuation\">(</span>tab<span class=\"operator\">$</span>Description<span class=\"punctuation\">[</span>order<span class=\"punctuation\">(</span>tab<span class=\"operator\">$</span>Cluster<span class=\"punctuation\">,</span><span class=\"operator\">-</span>tab<span class=\"operator\">$</span>GRatio<span class=\"punctuation\">)</span><span class=\"punctuation\">]</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 进行画图</span></span><br><span class=\"line\">pdf<span class=\"punctuation\">(</span>paste0<span class=\"punctuation\">(</span>id<span class=\"punctuation\">,</span><span class=\"string\">&quot;_&quot;</span><span class=\"punctuation\">,</span>day<span class=\"punctuation\">,</span><span class=\"string\">&quot;.pdf&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span><span class=\"number\">5</span><span class=\"punctuation\">,</span><span class=\"number\">7</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">ggplot<span class=\"punctuation\">(</span>tab<span class=\"punctuation\">,</span>aes<span class=\"punctuation\">(</span>x<span class=\"operator\">=</span>Cluster<span class=\"punctuation\">,</span>y<span class=\"operator\">=</span>Description<span class=\"punctuation\">,</span>size<span class=\"operator\">=</span>GRatio<span class=\"punctuation\">,</span>color<span class=\"operator\">=</span>qvalue<span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span></span><br><span class=\"line\">    geom_point<span class=\"punctuation\">(</span>stat<span class=\"operator\">=</span><span class=\"string\">&quot;identity&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>ylab<span class=\"punctuation\">(</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>xlab<span class=\"punctuation\">(</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span></span><br><span class=\"line\">    scale_y_discrete<span class=\"punctuation\">(</span>labels <span class=\"operator\">=</span> <span class=\"keyword\">function</span><span class=\"punctuation\">(</span>x<span class=\"punctuation\">)</span> stringr<span class=\"operator\">::</span>str_wrap<span class=\"punctuation\">(</span>x<span class=\"punctuation\">,</span> width <span class=\"operator\">=</span> <span class=\"number\">70</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span></span><br><span class=\"line\">    scale_color_gradientn<span class=\"punctuation\">(</span>colors<span class=\"operator\">=</span><span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"string\">&quot;#d93f09&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;blue&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span></span><br><span class=\"line\">    theme<span class=\"punctuation\">(</span>panel.grid.major<span class=\"operator\">=</span>element_line<span class=\"punctuation\">(</span>colour <span class=\"operator\">=</span> <span class=\"string\">&quot;gray90&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">          panel.background<span class=\"operator\">=</span>element_rect<span class=\"punctuation\">(</span>fill<span class=\"operator\">=</span><span class=\"string\">&#x27;transparent&#x27;</span><span class=\"punctuation\">,</span>color <span class=\"operator\">=</span><span class=\"string\">&quot;black&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">          axis.text.y <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>face <span class=\"operator\">=</span> <span class=\"string\">&quot;bold&quot;</span><span class=\"punctuation\">,</span>color <span class=\"operator\">=</span><span class=\"string\">&quot;black&quot;</span><span class=\"punctuation\">,</span>size <span class=\"operator\">=</span> <span class=\"number\">8</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span></span><br><span class=\"line\">    scale_size_continuous<span class=\"punctuation\">(</span><span class=\"built_in\">range</span> <span class=\"operator\">=</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"number\">3</span><span class=\"punctuation\">,</span><span class=\"number\">7</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span> <span class=\"comment\">#控制点的大小,防止极值过大</span></span><br><span class=\"line\">dev.off<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>"},{"title":"通路富集","abbrlink":"c093987d","date":"2023-05-22T09:58:06.000Z","_content":"\n##  通路富集\n\n<!--more-->\n\n```R\nindir <- \"/path\"\ngenelist <- \"deg.txt\"\npre <- \"deg\"\nday <- \"230522\"\n\n### load R packages\nlibrary(dplyr)\nlibrary(Seurat)\nlibrary(clusterProfiler)\nlibrary(enrichplot)\nlibrary(ggplot2)\nlibrary(org.Hs.eg.db)\nlibrary(reactome.db)\nlibrary(ReactomePA)\nlibrary(msigdbr)\nlibrary(openxlsx)\nsetwd(indir)\n\n### 提取H库\nm_t2g <- msigdbr(species = \"Homo sapiens\", category = \"H\") %>% \n    dplyr::select(gs_name, entrez_gene) #两列：gs_name,entrez_gene\n\n### extract Top200 gene\ndeg <- read.delim(genelist,sep=\"\\t\",header = T)\ndeg <- deg %>% dplyr::group_by(cluster) %>% \n    dplyr::top_n(200,wt = avg_log2FC) %>% \n    dplyr::select(cluster,gene) %>% \n    as.data.frame()\n# colnames(deg) <- c(\"cluster\",\"gene\")\nrownames(deg) <- c()\n\n### id transform\nentrez <- bitr(as.character(deg$gene), fromType=\"SYMBOL\", toType=\"ENTREZID\", OrgDb=\"org.Hs.eg.db\")\ndeg <- merge(deg, entrez, by.x = \"gene\", by.y = \"SYMBOL\")\n\n### enrich \n# KEGG\nEKEGG <- compareCluster(ENTREZID~cluster, data=deg, fun=\"enrichKEGG\", organism=\"hsa\", pvalueCutoff=0.05, qvalueCutoff  = 0.5)\nEKEGG=setReadable(EKEGG,'org.Hs.eg.db', 'ENTREZID')\n# GO\nEGO_BP <- compareCluster(ENTREZID~cluster, data=deg, fun=\"enrichGO\", OrgDb = org.Hs.eg.db, ont = \"BP\", pAdjustMethod = \"BH\", pvalueCutoff=0.05, qvalueCutoff  = 0.5, readable = TRUE)\n# Reactome\nEReact <- compareCluster(ENTREZID~cluster, data=deg, fun=\"enrichPathway\")\n# hallmarkers\nEHM <- compareCluster(ENTREZID~cluster,data = deg,enricher, TERM2GENE=m_t2g)\nEHM = setReadable(EHM,'org.Hs.eg.db', 'ENTREZID')\n\n\n### plot result\npdf(paste0(indir,\"/\",pre,\"_enrich.\",day,\".pdf\"), 10, 15)\ndotplot(EKEGG, showCategory=5, color=\"qvalue\",title=\"KEGG\")+theme(axis.text.x = element_text(vjust=1,hjust=1,size=8,angle = 45))\ndotplot(EGO_BP, showCategory=5, color=\"qvalue\",title=\"GO_BP\")+theme(axis.text.x = element_text(vjust=1,hjust=1,size=8,angle = 45))\ndotplot(EReact,showCategory=5,color=\"qvalue\",title=\"Reactome\")+theme(axis.text.x = element_text(vjust=1,hjust=1,size=8,angle = 45))\ndotplot(EHM,title=\"Hallmark gene sets\")+theme(axis.text.x = element_text(vjust=1,hjust=1,size=8,angle = 45))\ndev.off()\n\n\n### output result\nwrite.xlsx(list(GO = EGO_BP@compareClusterResult, KEGG = EKEGG@compareClusterResult, Reactome=EReact@compareClusterResult,HallMarker=EHM), paste0(pre,\"_Enrich.\",day,\".xlsx\"))\n```\n\n","source":"_posts/Passway-Enrich.md","raw":"---\ntitle: 通路富集\ncategories:\n  - code\n  - R\ntags:\n  - R\nabbrlink: c093987d\ndate: 2023-05-22 17:58:06\n---\n\n##  通路富集\n\n<!--more-->\n\n```R\nindir <- \"/path\"\ngenelist <- \"deg.txt\"\npre <- \"deg\"\nday <- \"230522\"\n\n### load R packages\nlibrary(dplyr)\nlibrary(Seurat)\nlibrary(clusterProfiler)\nlibrary(enrichplot)\nlibrary(ggplot2)\nlibrary(org.Hs.eg.db)\nlibrary(reactome.db)\nlibrary(ReactomePA)\nlibrary(msigdbr)\nlibrary(openxlsx)\nsetwd(indir)\n\n### 提取H库\nm_t2g <- msigdbr(species = \"Homo sapiens\", category = \"H\") %>% \n    dplyr::select(gs_name, entrez_gene) #两列：gs_name,entrez_gene\n\n### extract Top200 gene\ndeg <- read.delim(genelist,sep=\"\\t\",header = T)\ndeg <- deg %>% dplyr::group_by(cluster) %>% \n    dplyr::top_n(200,wt = avg_log2FC) %>% \n    dplyr::select(cluster,gene) %>% \n    as.data.frame()\n# colnames(deg) <- c(\"cluster\",\"gene\")\nrownames(deg) <- c()\n\n### id transform\nentrez <- bitr(as.character(deg$gene), fromType=\"SYMBOL\", toType=\"ENTREZID\", OrgDb=\"org.Hs.eg.db\")\ndeg <- merge(deg, entrez, by.x = \"gene\", by.y = \"SYMBOL\")\n\n### enrich \n# KEGG\nEKEGG <- compareCluster(ENTREZID~cluster, data=deg, fun=\"enrichKEGG\", organism=\"hsa\", pvalueCutoff=0.05, qvalueCutoff  = 0.5)\nEKEGG=setReadable(EKEGG,'org.Hs.eg.db', 'ENTREZID')\n# GO\nEGO_BP <- compareCluster(ENTREZID~cluster, data=deg, fun=\"enrichGO\", OrgDb = org.Hs.eg.db, ont = \"BP\", pAdjustMethod = \"BH\", pvalueCutoff=0.05, qvalueCutoff  = 0.5, readable = TRUE)\n# Reactome\nEReact <- compareCluster(ENTREZID~cluster, data=deg, fun=\"enrichPathway\")\n# hallmarkers\nEHM <- compareCluster(ENTREZID~cluster,data = deg,enricher, TERM2GENE=m_t2g)\nEHM = setReadable(EHM,'org.Hs.eg.db', 'ENTREZID')\n\n\n### plot result\npdf(paste0(indir,\"/\",pre,\"_enrich.\",day,\".pdf\"), 10, 15)\ndotplot(EKEGG, showCategory=5, color=\"qvalue\",title=\"KEGG\")+theme(axis.text.x = element_text(vjust=1,hjust=1,size=8,angle = 45))\ndotplot(EGO_BP, showCategory=5, color=\"qvalue\",title=\"GO_BP\")+theme(axis.text.x = element_text(vjust=1,hjust=1,size=8,angle = 45))\ndotplot(EReact,showCategory=5,color=\"qvalue\",title=\"Reactome\")+theme(axis.text.x = element_text(vjust=1,hjust=1,size=8,angle = 45))\ndotplot(EHM,title=\"Hallmark gene sets\")+theme(axis.text.x = element_text(vjust=1,hjust=1,size=8,angle = 45))\ndev.off()\n\n\n### output result\nwrite.xlsx(list(GO = EGO_BP@compareClusterResult, KEGG = EKEGG@compareClusterResult, Reactome=EReact@compareClusterResult,HallMarker=EHM), paste0(pre,\"_Enrich.\",day,\".xlsx\"))\n```\n\n","slug":"Passway-Enrich","published":1,"updated":"2023-05-22T10:22:18.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm4peu6mz0009dbzr1w2kcg5u","content":"<h2 id=\"通路富集\"><a class=\"markdownIt-Anchor\" href=\"#通路富集\"></a> 通路富集</h2>\n<span id=\"more\"></span>\n<figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">indir <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;/path&quot;</span></span><br><span class=\"line\">genelist <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;deg.txt&quot;</span></span><br><span class=\"line\">pre <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;deg&quot;</span></span><br><span class=\"line\">day <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;230522&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### load R packages</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>dplyr<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>Seurat<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>clusterProfiler<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>enrichplot<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>ggplot2<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>org.Hs.eg.db<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>reactome.db<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>ReactomePA<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>msigdbr<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>openxlsx<span class=\"punctuation\">)</span></span><br><span class=\"line\">setwd<span class=\"punctuation\">(</span>indir<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 提取H库</span></span><br><span class=\"line\">m_t2g <span class=\"operator\">&lt;-</span> msigdbr<span class=\"punctuation\">(</span>species <span class=\"operator\">=</span> <span class=\"string\">&quot;Homo sapiens&quot;</span><span class=\"punctuation\">,</span> category <span class=\"operator\">=</span> <span class=\"string\">&quot;H&quot;</span><span class=\"punctuation\">)</span> <span class=\"operator\">%&gt;%</span> </span><br><span class=\"line\">    dplyr<span class=\"operator\">::</span>select<span class=\"punctuation\">(</span>gs_name<span class=\"punctuation\">,</span> entrez_gene<span class=\"punctuation\">)</span> <span class=\"comment\">#两列：gs_name,entrez_gene</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### extract Top200 gene</span></span><br><span class=\"line\">deg <span class=\"operator\">&lt;-</span> read.delim<span class=\"punctuation\">(</span>genelist<span class=\"punctuation\">,</span>sep<span class=\"operator\">=</span><span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">,</span>header <span class=\"operator\">=</span> <span class=\"built_in\">T</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">deg <span class=\"operator\">&lt;-</span> deg <span class=\"operator\">%&gt;%</span> dplyr<span class=\"operator\">::</span>group_by<span class=\"punctuation\">(</span>cluster<span class=\"punctuation\">)</span> <span class=\"operator\">%&gt;%</span> </span><br><span class=\"line\">    dplyr<span class=\"operator\">::</span>top_n<span class=\"punctuation\">(</span><span class=\"number\">200</span><span class=\"punctuation\">,</span>wt <span class=\"operator\">=</span> avg_log2FC<span class=\"punctuation\">)</span> <span class=\"operator\">%&gt;%</span> </span><br><span class=\"line\">    dplyr<span class=\"operator\">::</span>select<span class=\"punctuation\">(</span>cluster<span class=\"punctuation\">,</span>gene<span class=\"punctuation\">)</span> <span class=\"operator\">%&gt;%</span> </span><br><span class=\"line\">    as.data.frame<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"comment\"># colnames(deg) &lt;- c(&quot;cluster&quot;,&quot;gene&quot;)</span></span><br><span class=\"line\">rownames<span class=\"punctuation\">(</span>deg<span class=\"punctuation\">)</span> <span class=\"operator\">&lt;-</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### id transform</span></span><br><span class=\"line\">entrez <span class=\"operator\">&lt;-</span> bitr<span class=\"punctuation\">(</span><span class=\"built_in\">as.character</span><span class=\"punctuation\">(</span>deg<span class=\"operator\">$</span>gene<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> fromType<span class=\"operator\">=</span><span class=\"string\">&quot;SYMBOL&quot;</span><span class=\"punctuation\">,</span> toType<span class=\"operator\">=</span><span class=\"string\">&quot;ENTREZID&quot;</span><span class=\"punctuation\">,</span> OrgDb<span class=\"operator\">=</span><span class=\"string\">&quot;org.Hs.eg.db&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">deg <span class=\"operator\">&lt;-</span> merge<span class=\"punctuation\">(</span>deg<span class=\"punctuation\">,</span> entrez<span class=\"punctuation\">,</span> by.x <span class=\"operator\">=</span> <span class=\"string\">&quot;gene&quot;</span><span class=\"punctuation\">,</span> by.y <span class=\"operator\">=</span> <span class=\"string\">&quot;SYMBOL&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### enrich </span></span><br><span class=\"line\"><span class=\"comment\"># KEGG</span></span><br><span class=\"line\">EKEGG <span class=\"operator\">&lt;-</span> compareCluster<span class=\"punctuation\">(</span>ENTREZID<span class=\"operator\">~</span>cluster<span class=\"punctuation\">,</span> data<span class=\"operator\">=</span>deg<span class=\"punctuation\">,</span> fun<span class=\"operator\">=</span><span class=\"string\">&quot;enrichKEGG&quot;</span><span class=\"punctuation\">,</span> organism<span class=\"operator\">=</span><span class=\"string\">&quot;hsa&quot;</span><span class=\"punctuation\">,</span> pvalueCutoff<span class=\"operator\">=</span><span class=\"number\">0.05</span><span class=\"punctuation\">,</span> qvalueCutoff  <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">EKEGG<span class=\"operator\">=</span>setReadable<span class=\"punctuation\">(</span>EKEGG<span class=\"punctuation\">,</span><span class=\"string\">&#x27;org.Hs.eg.db&#x27;</span><span class=\"punctuation\">,</span> <span class=\"string\">&#x27;ENTREZID&#x27;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"comment\"># GO</span></span><br><span class=\"line\">EGO_BP <span class=\"operator\">&lt;-</span> compareCluster<span class=\"punctuation\">(</span>ENTREZID<span class=\"operator\">~</span>cluster<span class=\"punctuation\">,</span> data<span class=\"operator\">=</span>deg<span class=\"punctuation\">,</span> fun<span class=\"operator\">=</span><span class=\"string\">&quot;enrichGO&quot;</span><span class=\"punctuation\">,</span> OrgDb <span class=\"operator\">=</span> org.Hs.eg.db<span class=\"punctuation\">,</span> ont <span class=\"operator\">=</span> <span class=\"string\">&quot;BP&quot;</span><span class=\"punctuation\">,</span> pAdjustMethod <span class=\"operator\">=</span> <span class=\"string\">&quot;BH&quot;</span><span class=\"punctuation\">,</span> pvalueCutoff<span class=\"operator\">=</span><span class=\"number\">0.05</span><span class=\"punctuation\">,</span> qvalueCutoff  <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> readable <span class=\"operator\">=</span> <span class=\"literal\">TRUE</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"comment\"># Reactome</span></span><br><span class=\"line\">EReact <span class=\"operator\">&lt;-</span> compareCluster<span class=\"punctuation\">(</span>ENTREZID<span class=\"operator\">~</span>cluster<span class=\"punctuation\">,</span> data<span class=\"operator\">=</span>deg<span class=\"punctuation\">,</span> fun<span class=\"operator\">=</span><span class=\"string\">&quot;enrichPathway&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"comment\"># hallmarkers</span></span><br><span class=\"line\">EHM <span class=\"operator\">&lt;-</span> compareCluster<span class=\"punctuation\">(</span>ENTREZID<span class=\"operator\">~</span>cluster<span class=\"punctuation\">,</span>data <span class=\"operator\">=</span> deg<span class=\"punctuation\">,</span>enricher<span class=\"punctuation\">,</span> TERM2GENE<span class=\"operator\">=</span>m_t2g<span class=\"punctuation\">)</span></span><br><span class=\"line\">EHM <span class=\"operator\">=</span> setReadable<span class=\"punctuation\">(</span>EHM<span class=\"punctuation\">,</span><span class=\"string\">&#x27;org.Hs.eg.db&#x27;</span><span class=\"punctuation\">,</span> <span class=\"string\">&#x27;ENTREZID&#x27;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### plot result</span></span><br><span class=\"line\">pdf<span class=\"punctuation\">(</span>paste0<span class=\"punctuation\">(</span>indir<span class=\"punctuation\">,</span><span class=\"string\">&quot;/&quot;</span><span class=\"punctuation\">,</span>pre<span class=\"punctuation\">,</span><span class=\"string\">&quot;_enrich.&quot;</span><span class=\"punctuation\">,</span>day<span class=\"punctuation\">,</span><span class=\"string\">&quot;.pdf&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> <span class=\"number\">10</span><span class=\"punctuation\">,</span> <span class=\"number\">15</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">dotplot<span class=\"punctuation\">(</span>EKEGG<span class=\"punctuation\">,</span> showCategory<span class=\"operator\">=</span><span class=\"number\">5</span><span class=\"punctuation\">,</span> color<span class=\"operator\">=</span><span class=\"string\">&quot;qvalue&quot;</span><span class=\"punctuation\">,</span>title<span class=\"operator\">=</span><span class=\"string\">&quot;KEGG&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>vjust<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span>hjust<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span>size<span class=\"operator\">=</span><span class=\"number\">8</span><span class=\"punctuation\">,</span>angle <span class=\"operator\">=</span> <span class=\"number\">45</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">dotplot<span class=\"punctuation\">(</span>EGO_BP<span class=\"punctuation\">,</span> showCategory<span class=\"operator\">=</span><span class=\"number\">5</span><span class=\"punctuation\">,</span> color<span class=\"operator\">=</span><span class=\"string\">&quot;qvalue&quot;</span><span class=\"punctuation\">,</span>title<span class=\"operator\">=</span><span class=\"string\">&quot;GO_BP&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>vjust<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span>hjust<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span>size<span class=\"operator\">=</span><span class=\"number\">8</span><span class=\"punctuation\">,</span>angle <span class=\"operator\">=</span> <span class=\"number\">45</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">dotplot<span class=\"punctuation\">(</span>EReact<span class=\"punctuation\">,</span>showCategory<span class=\"operator\">=</span><span class=\"number\">5</span><span class=\"punctuation\">,</span>color<span class=\"operator\">=</span><span class=\"string\">&quot;qvalue&quot;</span><span class=\"punctuation\">,</span>title<span class=\"operator\">=</span><span class=\"string\">&quot;Reactome&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>vjust<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span>hjust<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span>size<span class=\"operator\">=</span><span class=\"number\">8</span><span class=\"punctuation\">,</span>angle <span class=\"operator\">=</span> <span class=\"number\">45</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">dotplot<span class=\"punctuation\">(</span>EHM<span class=\"punctuation\">,</span>title<span class=\"operator\">=</span><span class=\"string\">&quot;Hallmark gene sets&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>vjust<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span>hjust<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span>size<span class=\"operator\">=</span><span class=\"number\">8</span><span class=\"punctuation\">,</span>angle <span class=\"operator\">=</span> <span class=\"number\">45</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">dev.off<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### output result</span></span><br><span class=\"line\">write.xlsx<span class=\"punctuation\">(</span><span class=\"built_in\">list</span><span class=\"punctuation\">(</span>GO <span class=\"operator\">=</span> EGO_BP<span class=\"operator\">@</span>compareClusterResult<span class=\"punctuation\">,</span> KEGG <span class=\"operator\">=</span> EKEGG<span class=\"operator\">@</span>compareClusterResult<span class=\"punctuation\">,</span> Reactome<span class=\"operator\">=</span>EReact<span class=\"operator\">@</span>compareClusterResult<span class=\"punctuation\">,</span>HallMarker<span class=\"operator\">=</span>EHM<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> paste0<span class=\"punctuation\">(</span>pre<span class=\"punctuation\">,</span><span class=\"string\">&quot;_Enrich.&quot;</span><span class=\"punctuation\">,</span>day<span class=\"punctuation\">,</span><span class=\"string\">&quot;.xlsx&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br></pre></td></tr></table></figure>\n","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":284,"excerpt":"<h2 id=\"通路富集\"><a class=\"markdownIt-Anchor\" href=\"#通路富集\"></a> 通路富集</h2>","more":"<figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">indir <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;/path&quot;</span></span><br><span class=\"line\">genelist <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;deg.txt&quot;</span></span><br><span class=\"line\">pre <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;deg&quot;</span></span><br><span class=\"line\">day <span class=\"operator\">&lt;-</span> <span class=\"string\">&quot;230522&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### load R packages</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>dplyr<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>Seurat<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>clusterProfiler<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>enrichplot<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>ggplot2<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>org.Hs.eg.db<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>reactome.db<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>ReactomePA<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>msigdbr<span class=\"punctuation\">)</span></span><br><span class=\"line\">library<span class=\"punctuation\">(</span>openxlsx<span class=\"punctuation\">)</span></span><br><span class=\"line\">setwd<span class=\"punctuation\">(</span>indir<span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 提取H库</span></span><br><span class=\"line\">m_t2g <span class=\"operator\">&lt;-</span> msigdbr<span class=\"punctuation\">(</span>species <span class=\"operator\">=</span> <span class=\"string\">&quot;Homo sapiens&quot;</span><span class=\"punctuation\">,</span> category <span class=\"operator\">=</span> <span class=\"string\">&quot;H&quot;</span><span class=\"punctuation\">)</span> <span class=\"operator\">%&gt;%</span> </span><br><span class=\"line\">    dplyr<span class=\"operator\">::</span>select<span class=\"punctuation\">(</span>gs_name<span class=\"punctuation\">,</span> entrez_gene<span class=\"punctuation\">)</span> <span class=\"comment\">#两列：gs_name,entrez_gene</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### extract Top200 gene</span></span><br><span class=\"line\">deg <span class=\"operator\">&lt;-</span> read.delim<span class=\"punctuation\">(</span>genelist<span class=\"punctuation\">,</span>sep<span class=\"operator\">=</span><span class=\"string\">&quot;\\t&quot;</span><span class=\"punctuation\">,</span>header <span class=\"operator\">=</span> <span class=\"built_in\">T</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">deg <span class=\"operator\">&lt;-</span> deg <span class=\"operator\">%&gt;%</span> dplyr<span class=\"operator\">::</span>group_by<span class=\"punctuation\">(</span>cluster<span class=\"punctuation\">)</span> <span class=\"operator\">%&gt;%</span> </span><br><span class=\"line\">    dplyr<span class=\"operator\">::</span>top_n<span class=\"punctuation\">(</span><span class=\"number\">200</span><span class=\"punctuation\">,</span>wt <span class=\"operator\">=</span> avg_log2FC<span class=\"punctuation\">)</span> <span class=\"operator\">%&gt;%</span> </span><br><span class=\"line\">    dplyr<span class=\"operator\">::</span>select<span class=\"punctuation\">(</span>cluster<span class=\"punctuation\">,</span>gene<span class=\"punctuation\">)</span> <span class=\"operator\">%&gt;%</span> </span><br><span class=\"line\">    as.data.frame<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"comment\"># colnames(deg) &lt;- c(&quot;cluster&quot;,&quot;gene&quot;)</span></span><br><span class=\"line\">rownames<span class=\"punctuation\">(</span>deg<span class=\"punctuation\">)</span> <span class=\"operator\">&lt;-</span> <span class=\"built_in\">c</span><span class=\"punctuation\">(</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### id transform</span></span><br><span class=\"line\">entrez <span class=\"operator\">&lt;-</span> bitr<span class=\"punctuation\">(</span><span class=\"built_in\">as.character</span><span class=\"punctuation\">(</span>deg<span class=\"operator\">$</span>gene<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> fromType<span class=\"operator\">=</span><span class=\"string\">&quot;SYMBOL&quot;</span><span class=\"punctuation\">,</span> toType<span class=\"operator\">=</span><span class=\"string\">&quot;ENTREZID&quot;</span><span class=\"punctuation\">,</span> OrgDb<span class=\"operator\">=</span><span class=\"string\">&quot;org.Hs.eg.db&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">deg <span class=\"operator\">&lt;-</span> merge<span class=\"punctuation\">(</span>deg<span class=\"punctuation\">,</span> entrez<span class=\"punctuation\">,</span> by.x <span class=\"operator\">=</span> <span class=\"string\">&quot;gene&quot;</span><span class=\"punctuation\">,</span> by.y <span class=\"operator\">=</span> <span class=\"string\">&quot;SYMBOL&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### enrich </span></span><br><span class=\"line\"><span class=\"comment\"># KEGG</span></span><br><span class=\"line\">EKEGG <span class=\"operator\">&lt;-</span> compareCluster<span class=\"punctuation\">(</span>ENTREZID<span class=\"operator\">~</span>cluster<span class=\"punctuation\">,</span> data<span class=\"operator\">=</span>deg<span class=\"punctuation\">,</span> fun<span class=\"operator\">=</span><span class=\"string\">&quot;enrichKEGG&quot;</span><span class=\"punctuation\">,</span> organism<span class=\"operator\">=</span><span class=\"string\">&quot;hsa&quot;</span><span class=\"punctuation\">,</span> pvalueCutoff<span class=\"operator\">=</span><span class=\"number\">0.05</span><span class=\"punctuation\">,</span> qvalueCutoff  <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">EKEGG<span class=\"operator\">=</span>setReadable<span class=\"punctuation\">(</span>EKEGG<span class=\"punctuation\">,</span><span class=\"string\">&#x27;org.Hs.eg.db&#x27;</span><span class=\"punctuation\">,</span> <span class=\"string\">&#x27;ENTREZID&#x27;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"comment\"># GO</span></span><br><span class=\"line\">EGO_BP <span class=\"operator\">&lt;-</span> compareCluster<span class=\"punctuation\">(</span>ENTREZID<span class=\"operator\">~</span>cluster<span class=\"punctuation\">,</span> data<span class=\"operator\">=</span>deg<span class=\"punctuation\">,</span> fun<span class=\"operator\">=</span><span class=\"string\">&quot;enrichGO&quot;</span><span class=\"punctuation\">,</span> OrgDb <span class=\"operator\">=</span> org.Hs.eg.db<span class=\"punctuation\">,</span> ont <span class=\"operator\">=</span> <span class=\"string\">&quot;BP&quot;</span><span class=\"punctuation\">,</span> pAdjustMethod <span class=\"operator\">=</span> <span class=\"string\">&quot;BH&quot;</span><span class=\"punctuation\">,</span> pvalueCutoff<span class=\"operator\">=</span><span class=\"number\">0.05</span><span class=\"punctuation\">,</span> qvalueCutoff  <span class=\"operator\">=</span> <span class=\"number\">0.5</span><span class=\"punctuation\">,</span> readable <span class=\"operator\">=</span> <span class=\"literal\">TRUE</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"comment\"># Reactome</span></span><br><span class=\"line\">EReact <span class=\"operator\">&lt;-</span> compareCluster<span class=\"punctuation\">(</span>ENTREZID<span class=\"operator\">~</span>cluster<span class=\"punctuation\">,</span> data<span class=\"operator\">=</span>deg<span class=\"punctuation\">,</span> fun<span class=\"operator\">=</span><span class=\"string\">&quot;enrichPathway&quot;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"><span class=\"comment\"># hallmarkers</span></span><br><span class=\"line\">EHM <span class=\"operator\">&lt;-</span> compareCluster<span class=\"punctuation\">(</span>ENTREZID<span class=\"operator\">~</span>cluster<span class=\"punctuation\">,</span>data <span class=\"operator\">=</span> deg<span class=\"punctuation\">,</span>enricher<span class=\"punctuation\">,</span> TERM2GENE<span class=\"operator\">=</span>m_t2g<span class=\"punctuation\">)</span></span><br><span class=\"line\">EHM <span class=\"operator\">=</span> setReadable<span class=\"punctuation\">(</span>EHM<span class=\"punctuation\">,</span><span class=\"string\">&#x27;org.Hs.eg.db&#x27;</span><span class=\"punctuation\">,</span> <span class=\"string\">&#x27;ENTREZID&#x27;</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### plot result</span></span><br><span class=\"line\">pdf<span class=\"punctuation\">(</span>paste0<span class=\"punctuation\">(</span>indir<span class=\"punctuation\">,</span><span class=\"string\">&quot;/&quot;</span><span class=\"punctuation\">,</span>pre<span class=\"punctuation\">,</span><span class=\"string\">&quot;_enrich.&quot;</span><span class=\"punctuation\">,</span>day<span class=\"punctuation\">,</span><span class=\"string\">&quot;.pdf&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> <span class=\"number\">10</span><span class=\"punctuation\">,</span> <span class=\"number\">15</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">dotplot<span class=\"punctuation\">(</span>EKEGG<span class=\"punctuation\">,</span> showCategory<span class=\"operator\">=</span><span class=\"number\">5</span><span class=\"punctuation\">,</span> color<span class=\"operator\">=</span><span class=\"string\">&quot;qvalue&quot;</span><span class=\"punctuation\">,</span>title<span class=\"operator\">=</span><span class=\"string\">&quot;KEGG&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>vjust<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span>hjust<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span>size<span class=\"operator\">=</span><span class=\"number\">8</span><span class=\"punctuation\">,</span>angle <span class=\"operator\">=</span> <span class=\"number\">45</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">dotplot<span class=\"punctuation\">(</span>EGO_BP<span class=\"punctuation\">,</span> showCategory<span class=\"operator\">=</span><span class=\"number\">5</span><span class=\"punctuation\">,</span> color<span class=\"operator\">=</span><span class=\"string\">&quot;qvalue&quot;</span><span class=\"punctuation\">,</span>title<span class=\"operator\">=</span><span class=\"string\">&quot;GO_BP&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>vjust<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span>hjust<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span>size<span class=\"operator\">=</span><span class=\"number\">8</span><span class=\"punctuation\">,</span>angle <span class=\"operator\">=</span> <span class=\"number\">45</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">dotplot<span class=\"punctuation\">(</span>EReact<span class=\"punctuation\">,</span>showCategory<span class=\"operator\">=</span><span class=\"number\">5</span><span class=\"punctuation\">,</span>color<span class=\"operator\">=</span><span class=\"string\">&quot;qvalue&quot;</span><span class=\"punctuation\">,</span>title<span class=\"operator\">=</span><span class=\"string\">&quot;Reactome&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>vjust<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span>hjust<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span>size<span class=\"operator\">=</span><span class=\"number\">8</span><span class=\"punctuation\">,</span>angle <span class=\"operator\">=</span> <span class=\"number\">45</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">dotplot<span class=\"punctuation\">(</span>EHM<span class=\"punctuation\">,</span>title<span class=\"operator\">=</span><span class=\"string\">&quot;Hallmark gene sets&quot;</span><span class=\"punctuation\">)</span><span class=\"operator\">+</span>theme<span class=\"punctuation\">(</span>axis.text.x <span class=\"operator\">=</span> element_text<span class=\"punctuation\">(</span>vjust<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span>hjust<span class=\"operator\">=</span><span class=\"number\">1</span><span class=\"punctuation\">,</span>size<span class=\"operator\">=</span><span class=\"number\">8</span><span class=\"punctuation\">,</span>angle <span class=\"operator\">=</span> <span class=\"number\">45</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br><span class=\"line\">dev.off<span class=\"punctuation\">(</span><span class=\"punctuation\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### output result</span></span><br><span class=\"line\">write.xlsx<span class=\"punctuation\">(</span><span class=\"built_in\">list</span><span class=\"punctuation\">(</span>GO <span class=\"operator\">=</span> EGO_BP<span class=\"operator\">@</span>compareClusterResult<span class=\"punctuation\">,</span> KEGG <span class=\"operator\">=</span> EKEGG<span class=\"operator\">@</span>compareClusterResult<span class=\"punctuation\">,</span> Reactome<span class=\"operator\">=</span>EReact<span class=\"operator\">@</span>compareClusterResult<span class=\"punctuation\">,</span>HallMarker<span class=\"operator\">=</span>EHM<span class=\"punctuation\">)</span><span class=\"punctuation\">,</span> paste0<span class=\"punctuation\">(</span>pre<span class=\"punctuation\">,</span><span class=\"string\">&quot;_Enrich.&quot;</span><span class=\"punctuation\">,</span>day<span class=\"punctuation\">,</span><span class=\"string\">&quot;.xlsx&quot;</span><span class=\"punctuation\">)</span><span class=\"punctuation\">)</span></span><br></pre></td></tr></table></figure>"},{"title":"Tfh Summary","abbrlink":"fd2daa16","date":"2023-05-22T09:57:23.000Z","_content":"\n# Tfh总结1\n\n### <span style=\"color: #1b5e20\"><span style=\"background-color: #f1f8e9\">💡 Meta Data</span></span>\n\n**<span style=\"color: #1b5e20\">Title: </span>** <span style=\"background-color: #dbeedd\">T Follicular Helper Cells</span>\n\n**<span style=\"color: #1b5e20\">Journal: </span>** <span style=\"color: #2e2e2e\"><span style=\"background-color: #dbeedd\">Encyclopedia of Cell Biology (Second Edition)</span></span>\n\n**<span style=\"color: #1b5e20\">Authors: </span>** <span style=\"background-color: #dbeedd\">Filipa Ribeiro; Michelle Linterman; Luis Graca</span>\n\n**<span style=\"color: #1b5e20\">Pub.date: </span>** <span style=\"background-color: #dbeedd\">2023</span>\n\n**<span style=\"color: #1b5e20\">DOI: </span>** <span style=\"background-color: #dbeedd\"><a href=\"https://doi.org/10.1016/B978-0-12-821618-7.00137-1\" rel=\"noopener noreferrer nofollow\">10.1016/B978-0-12-821618-7.00137-1</a></span>\n\n### <span style=\"color: #e65100\"><span style=\"background-color: #fff8e1\">📜 研究背景 &amp; 基础 &amp; 目的</span></span>\n\n---\n\n* **Tfh的功能**\n\n    <span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FETMP2AEB%22%2C%22annotationKey%22%3A%22KPBK4X4F%22%2C%22color%22%3A%22%23ff6666%22%2C%22pageLabel%22%3A%22367%22%2C%22position%22%3A%7B%22pageIndex%22%3A0%2C%22rects%22%3A%5B%5B108.227%2C460.678%2C539.058%2C468.648%5D%2C%5B67.465%2C450.757%2C149.336%2C460.249%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FRZCM877F%22%5D%2C%22locator%22%3A%22367%22%7D%7D\"><span style=\"background-color: #ff666680\">“These T-B interactions are critical for the isotype switching and affinity maturation of B cells leading to the production of high-affinity antibodies.”</span></span>\n\n* **Bcell成熟的重要性，需要调控，防止产生自身免疫性的B细胞**\n\n    >   <span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FETMP2AEB%22%2C%22pageLabel%22%3A%22368%22%2C%22position%22%3A%7B%22pageIndex%22%3A1%2C%22rects%22%3A%5B%5B73.134%2C533.021%2C544.769%2C541.108%5D%2C%5B73.134%2C521.952%2C544.82%2C530.42%5D%2C%5B73.134%2C511.01%2C544.783%2C519.479%5D%2C%5B73.134%2C500.139%2C544.804%2C508.226%5D%2C%5B73.134%2C489.197%2C544.719%2C497.284%5D%2C%5B73.134%2C478.128%2C544.809%2C486.597%5D%2C%5B73.133%2C467.13%2C544.788%2C475.598%5D%2C%5B73.134%2C456.315%2C391.075%2C464.402%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FRZCM877F%22%5D%2C%22locator%22%3A%22368%22%7D%7D\">“The formation of germinal centers (GCs) within secondary lymphoid organs, in response to infection or immunization, is a crucial event for the production of T cell-dependent protective antibodies. Within GCs, mature B cells undergo <strong>affinity maturation</strong> and <strong>somatic hypermutation</strong> (SHM), leading to the production of antibodies that bind pathogens with high affinity. These antibodies can neutralize infectious agents providing protection against subsequent infection, leading to effective humoral responses and memory. Nevertheless, the <strong>unpredictability</strong> of the SHM can result in the generation of autoreactive B cell clones, thus contributing to a dysregulated humoral response that can lead to autoimmune diseases (Vinuesa et al., 2009). Consequently, the GC reaction requires strict regulation to ensure a <strong>balanced humoral immune response</strong> by guaranteeing the emergence of high-affinity B cell clones targeting pathogens while preventing the generation of autoreactive GC B cells.”</span>\n\n### <span style=\"color: #2e7d32\"><span style=\"background-color: #f1f8e9\">📊 研究内容</span></span>\n\n---\n\n* **Tfh的关键作用**\n\n    <span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FETMP2AEB%22%2C%22annotationKey%22%3A%225H7438C5%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%22368%22%2C%22position%22%3A%7B%22pageIndex%22%3A1%2C%22rects%22%3A%5B%5B387.374%2C434.432%2C544.807%2C444.397%5D%2C%5B73.134%2C423.306%2C491.858%2C431.775%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FRZCM877F%22%5D%2C%22locator%22%3A%22368%22%7D%7D\"><span style=\"background-color: #ffd40080\">“Tfh cells provide crucial signals to B cells to support GC development and function by mediating affinity maturation through the positive selection of GC B cells”</span></span>\n\n* **关键基因：<span style=\"color: #ff2020\">BCL6</span>、CXCR5、ICOS、PD-1、SLAM、SAP、PRDM1**\n\n* **CD4 Tfh Marker**\n\n    <img src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/4wzMW-xLihMN-20230313.png\" style=\"zoom:50%;\" />\n\n* **Tfh细胞分化**\n\n    <img src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/4tz6e-jW7aow-20230313.png\" style=\"zoom:35%;\" />\n\n    * DC刺激CD4 NaiveT\n\n        * MHC II呈递抗原\n        * CD80/86-CD28提供共刺激信号\n        * ICOS-ICOSL提供定位信号，将TFH定位于TB边界\n    * pre-Tfh与B细胞相互作用：获得迁移到 GC 并完成其发育为 GC Tfh 细胞的能力\n\n        * TCR-MHC II\n        * CD28-CD80/86\n        * ICOS-ICOSL\n        * CD40L-CD40\n        * SAP-SFR\n    * Tfh与B细胞的相互作用：Tfh 细胞产生 IL-4 和 IL-21，从而为 B 细胞提供支持\n\n        * TCR-MHC II\n        * CD28-CD80/86\n        * ICOS-ICOSL\n        * CD40L-CD40\n        * SAP-SFR\n        * PD-1-PD-L1\n\n### <span style=\"color: #4a148c\"><span style=\"background-color: #f5f5f5\">🚩 研究结论</span></span>\n\n---\n\n* <span style=\"color: rgb(46, 46, 46)\">帮助更有效疫苗的合理设计</span>\n* <span style=\"color: rgb(46, 46, 46)\">揭示用于诊断和患者分层的新生物标志物</span>\n* <span style=\"color: rgb(46, 46, 46)\">揭示治疗自身免疫的新治疗靶点</span>\n\n### <span style=\"color: #006064\"><span style=\"background-color: #e0f7fa\">📌 感想 &amp; 疑问</span></span>\n\n---\n\n### <span style=\"color: #1565c0\"><span style=\"background-color: #e1f5fe\">🔬 研究方法</span></span>\n\n---\n\nReferred in [主笔记](zotero://note/u/FNQNUGED/?ignore=1&line=-1)\n","source":"_posts/Tfh总结.md","raw":"---\ntitle: Tfh Summary\ncategories:\n  - paper\n  - review\n  - celltype\ntags:\n  - paper\n  - celltype\n  - Tfh\nabbrlink: fd2daa16\ndate: 2023-05-22 17:57:23\n---\n\n# Tfh总结1\n\n### <span style=\"color: #1b5e20\"><span style=\"background-color: #f1f8e9\">💡 Meta Data</span></span>\n\n**<span style=\"color: #1b5e20\">Title: </span>** <span style=\"background-color: #dbeedd\">T Follicular Helper Cells</span>\n\n**<span style=\"color: #1b5e20\">Journal: </span>** <span style=\"color: #2e2e2e\"><span style=\"background-color: #dbeedd\">Encyclopedia of Cell Biology (Second Edition)</span></span>\n\n**<span style=\"color: #1b5e20\">Authors: </span>** <span style=\"background-color: #dbeedd\">Filipa Ribeiro; Michelle Linterman; Luis Graca</span>\n\n**<span style=\"color: #1b5e20\">Pub.date: </span>** <span style=\"background-color: #dbeedd\">2023</span>\n\n**<span style=\"color: #1b5e20\">DOI: </span>** <span style=\"background-color: #dbeedd\"><a href=\"https://doi.org/10.1016/B978-0-12-821618-7.00137-1\" rel=\"noopener noreferrer nofollow\">10.1016/B978-0-12-821618-7.00137-1</a></span>\n\n### <span style=\"color: #e65100\"><span style=\"background-color: #fff8e1\">📜 研究背景 &amp; 基础 &amp; 目的</span></span>\n\n---\n\n* **Tfh的功能**\n\n    <span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FETMP2AEB%22%2C%22annotationKey%22%3A%22KPBK4X4F%22%2C%22color%22%3A%22%23ff6666%22%2C%22pageLabel%22%3A%22367%22%2C%22position%22%3A%7B%22pageIndex%22%3A0%2C%22rects%22%3A%5B%5B108.227%2C460.678%2C539.058%2C468.648%5D%2C%5B67.465%2C450.757%2C149.336%2C460.249%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FRZCM877F%22%5D%2C%22locator%22%3A%22367%22%7D%7D\"><span style=\"background-color: #ff666680\">“These T-B interactions are critical for the isotype switching and affinity maturation of B cells leading to the production of high-affinity antibodies.”</span></span>\n\n* **Bcell成熟的重要性，需要调控，防止产生自身免疫性的B细胞**\n\n    >   <span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FETMP2AEB%22%2C%22pageLabel%22%3A%22368%22%2C%22position%22%3A%7B%22pageIndex%22%3A1%2C%22rects%22%3A%5B%5B73.134%2C533.021%2C544.769%2C541.108%5D%2C%5B73.134%2C521.952%2C544.82%2C530.42%5D%2C%5B73.134%2C511.01%2C544.783%2C519.479%5D%2C%5B73.134%2C500.139%2C544.804%2C508.226%5D%2C%5B73.134%2C489.197%2C544.719%2C497.284%5D%2C%5B73.134%2C478.128%2C544.809%2C486.597%5D%2C%5B73.133%2C467.13%2C544.788%2C475.598%5D%2C%5B73.134%2C456.315%2C391.075%2C464.402%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FRZCM877F%22%5D%2C%22locator%22%3A%22368%22%7D%7D\">“The formation of germinal centers (GCs) within secondary lymphoid organs, in response to infection or immunization, is a crucial event for the production of T cell-dependent protective antibodies. Within GCs, mature B cells undergo <strong>affinity maturation</strong> and <strong>somatic hypermutation</strong> (SHM), leading to the production of antibodies that bind pathogens with high affinity. These antibodies can neutralize infectious agents providing protection against subsequent infection, leading to effective humoral responses and memory. Nevertheless, the <strong>unpredictability</strong> of the SHM can result in the generation of autoreactive B cell clones, thus contributing to a dysregulated humoral response that can lead to autoimmune diseases (Vinuesa et al., 2009). Consequently, the GC reaction requires strict regulation to ensure a <strong>balanced humoral immune response</strong> by guaranteeing the emergence of high-affinity B cell clones targeting pathogens while preventing the generation of autoreactive GC B cells.”</span>\n\n### <span style=\"color: #2e7d32\"><span style=\"background-color: #f1f8e9\">📊 研究内容</span></span>\n\n---\n\n* **Tfh的关键作用**\n\n    <span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FETMP2AEB%22%2C%22annotationKey%22%3A%225H7438C5%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%22368%22%2C%22position%22%3A%7B%22pageIndex%22%3A1%2C%22rects%22%3A%5B%5B387.374%2C434.432%2C544.807%2C444.397%5D%2C%5B73.134%2C423.306%2C491.858%2C431.775%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FRZCM877F%22%5D%2C%22locator%22%3A%22368%22%7D%7D\"><span style=\"background-color: #ffd40080\">“Tfh cells provide crucial signals to B cells to support GC development and function by mediating affinity maturation through the positive selection of GC B cells”</span></span>\n\n* **关键基因：<span style=\"color: #ff2020\">BCL6</span>、CXCR5、ICOS、PD-1、SLAM、SAP、PRDM1**\n\n* **CD4 Tfh Marker**\n\n    <img src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/4wzMW-xLihMN-20230313.png\" style=\"zoom:50%;\" />\n\n* **Tfh细胞分化**\n\n    <img src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/4tz6e-jW7aow-20230313.png\" style=\"zoom:35%;\" />\n\n    * DC刺激CD4 NaiveT\n\n        * MHC II呈递抗原\n        * CD80/86-CD28提供共刺激信号\n        * ICOS-ICOSL提供定位信号，将TFH定位于TB边界\n    * pre-Tfh与B细胞相互作用：获得迁移到 GC 并完成其发育为 GC Tfh 细胞的能力\n\n        * TCR-MHC II\n        * CD28-CD80/86\n        * ICOS-ICOSL\n        * CD40L-CD40\n        * SAP-SFR\n    * Tfh与B细胞的相互作用：Tfh 细胞产生 IL-4 和 IL-21，从而为 B 细胞提供支持\n\n        * TCR-MHC II\n        * CD28-CD80/86\n        * ICOS-ICOSL\n        * CD40L-CD40\n        * SAP-SFR\n        * PD-1-PD-L1\n\n### <span style=\"color: #4a148c\"><span style=\"background-color: #f5f5f5\">🚩 研究结论</span></span>\n\n---\n\n* <span style=\"color: rgb(46, 46, 46)\">帮助更有效疫苗的合理设计</span>\n* <span style=\"color: rgb(46, 46, 46)\">揭示用于诊断和患者分层的新生物标志物</span>\n* <span style=\"color: rgb(46, 46, 46)\">揭示治疗自身免疫的新治疗靶点</span>\n\n### <span style=\"color: #006064\"><span style=\"background-color: #e0f7fa\">📌 感想 &amp; 疑问</span></span>\n\n---\n\n### <span style=\"color: #1565c0\"><span style=\"background-color: #e1f5fe\">🔬 研究方法</span></span>\n\n---\n\nReferred in [主笔记](zotero://note/u/FNQNUGED/?ignore=1&line=-1)\n","slug":"Tfh总结","published":1,"updated":"2023-05-22T10:26:00.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm4peu6mz000bdbzr6a759x4u","content":"<h1 id=\"tfh总结1\"><a class=\"markdownIt-Anchor\" href=\"#tfh总结1\"></a> Tfh总结1</h1>\n<h3 id=\"span-stylecolor-1b5e20span-stylebackground-color-f1f8e9-meta-dataspanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-1b5e20span-stylebackground-color-f1f8e9-meta-dataspanspan\"></a> <span style=\"color: #1b5e20\"><span style=\"background-color: #f1f8e9\">💡 Meta Data</span></span></h3>\n<p><strong><span style=\"color: #1b5e20\">Title: </span></strong> <span style=\"background-color: #dbeedd\">T Follicular Helper Cells</span></p>\n<p><strong><span style=\"color: #1b5e20\">Journal: </span></strong> <span style=\"color: #2e2e2e\"><span style=\"background-color: #dbeedd\">Encyclopedia of Cell Biology (Second Edition)</span></span></p>\n<p><strong><span style=\"color: #1b5e20\">Authors: </span></strong> <span style=\"background-color: #dbeedd\">Filipa Ribeiro; Michelle Linterman; Luis Graca</span></p>\n<p><strong><span style=\"color: #1b5e20\">Pub.date: </span></strong> <span style=\"background-color: #dbeedd\">2023</span></p>\n<p><strong><span style=\"color: #1b5e20\">DOI: </span></strong> <span style=\"background-color: #dbeedd\"><a href=\"https://doi.org/10.1016/B978-0-12-821618-7.00137-1\" rel=\"noopener noreferrer nofollow\">10.1016/B978-0-12-821618-7.00137-1</a></span></p>\n<h3 id=\"span-stylecolor-e65100span-stylebackground-color-fff8e1-研究背景-基础-目的spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-e65100span-stylebackground-color-fff8e1-研究背景-基础-目的spanspan\"></a> <span style=\"color: #e65100\"><span style=\"background-color: #fff8e1\">📜 研究背景 &amp; 基础 &amp; 目的</span></span></h3>\n<hr />\n<ul>\n<li>\n<p><strong>Tfh的功能</strong></p>\n<p><span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FETMP2AEB%22%2C%22annotationKey%22%3A%22KPBK4X4F%22%2C%22color%22%3A%22%23ff6666%22%2C%22pageLabel%22%3A%22367%22%2C%22position%22%3A%7B%22pageIndex%22%3A0%2C%22rects%22%3A%5B%5B108.227%2C460.678%2C539.058%2C468.648%5D%2C%5B67.465%2C450.757%2C149.336%2C460.249%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FRZCM877F%22%5D%2C%22locator%22%3A%22367%22%7D%7D\"><span style=\"background-color: #ff666680\">“These T-B interactions are critical for the isotype switching and affinity maturation of B cells leading to the production of high-affinity antibodies.”</span></span></p>\n</li>\n<li>\n<p><strong>Bcell成熟的重要性，需要调控，防止产生自身免疫性的B细胞</strong></p>\n<blockquote>\n<p><span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FETMP2AEB%22%2C%22pageLabel%22%3A%22368%22%2C%22position%22%3A%7B%22pageIndex%22%3A1%2C%22rects%22%3A%5B%5B73.134%2C533.021%2C544.769%2C541.108%5D%2C%5B73.134%2C521.952%2C544.82%2C530.42%5D%2C%5B73.134%2C511.01%2C544.783%2C519.479%5D%2C%5B73.134%2C500.139%2C544.804%2C508.226%5D%2C%5B73.134%2C489.197%2C544.719%2C497.284%5D%2C%5B73.134%2C478.128%2C544.809%2C486.597%5D%2C%5B73.133%2C467.13%2C544.788%2C475.598%5D%2C%5B73.134%2C456.315%2C391.075%2C464.402%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FRZCM877F%22%5D%2C%22locator%22%3A%22368%22%7D%7D\">“The formation of germinal centers (GCs) within secondary lymphoid organs, in response to infection or immunization, is a crucial event for the production of T cell-dependent protective antibodies. Within GCs, mature B cells undergo <strong>affinity maturation</strong> and <strong>somatic hypermutation</strong> (SHM), leading to the production of antibodies that bind pathogens with high affinity. These antibodies can neutralize infectious agents providing protection against subsequent infection, leading to effective humoral responses and memory. Nevertheless, the <strong>unpredictability</strong> of the SHM can result in the generation of autoreactive B cell clones, thus contributing to a dysregulated humoral response that can lead to autoimmune diseases (Vinuesa et al., 2009). Consequently, the GC reaction requires strict regulation to ensure a <strong>balanced humoral immune response</strong> by guaranteeing the emergence of high-affinity B cell clones targeting pathogens while preventing the generation of autoreactive GC B cells.”</span></p>\n</blockquote>\n</li>\n</ul>\n<h3 id=\"span-stylecolor-2e7d32span-stylebackground-color-f1f8e9-研究内容spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-2e7d32span-stylebackground-color-f1f8e9-研究内容spanspan\"></a> <span style=\"color: #2e7d32\"><span style=\"background-color: #f1f8e9\">📊 研究内容</span></span></h3>\n<hr />\n<ul>\n<li>\n<p><strong>Tfh的关键作用</strong></p>\n<p><span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FETMP2AEB%22%2C%22annotationKey%22%3A%225H7438C5%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%22368%22%2C%22position%22%3A%7B%22pageIndex%22%3A1%2C%22rects%22%3A%5B%5B387.374%2C434.432%2C544.807%2C444.397%5D%2C%5B73.134%2C423.306%2C491.858%2C431.775%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FRZCM877F%22%5D%2C%22locator%22%3A%22368%22%7D%7D\"><span style=\"background-color: #ffd40080\">“Tfh cells provide crucial signals to B cells to support GC development and function by mediating affinity maturation through the positive selection of GC B cells”</span></span></p>\n</li>\n<li>\n<p><strong>关键基因：<span style=\"color: #ff2020\">BCL6</span>、CXCR5、ICOS、PD-1、SLAM、SAP、PRDM1</strong></p>\n</li>\n<li>\n<p><strong>CD4 Tfh Marker</strong></p>\n  <img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/4wzMW-xLihMN-20230313.png\" style=\"zoom:50%;\" />\n</li>\n<li>\n<p><strong>Tfh细胞分化</strong></p>\n  <img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/4tz6e-jW7aow-20230313.png\" style=\"zoom:35%;\" />\n<ul>\n<li>\n<p>DC刺激CD4 NaiveT</p>\n<ul>\n<li>MHC II呈递抗原</li>\n<li>CD80/86-CD28提供共刺激信号</li>\n<li>ICOS-ICOSL提供定位信号，将TFH定位于TB边界</li>\n</ul>\n</li>\n<li>\n<p>pre-Tfh与B细胞相互作用：获得迁移到 GC 并完成其发育为 GC Tfh 细胞的能力</p>\n<ul>\n<li>TCR-MHC II</li>\n<li>CD28-CD80/86</li>\n<li>ICOS-ICOSL</li>\n<li>CD40L-CD40</li>\n<li>SAP-SFR</li>\n</ul>\n</li>\n<li>\n<p>Tfh与B细胞的相互作用：Tfh 细胞产生 IL-4 和 IL-21，从而为 B 细胞提供支持</p>\n<ul>\n<li>TCR-MHC II</li>\n<li>CD28-CD80/86</li>\n<li>ICOS-ICOSL</li>\n<li>CD40L-CD40</li>\n<li>SAP-SFR</li>\n<li>PD-1-PD-L1</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"span-stylecolor-4a148cspan-stylebackground-color-f5f5f5-研究结论spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-4a148cspan-stylebackground-color-f5f5f5-研究结论spanspan\"></a> <span style=\"color: #4a148c\"><span style=\"background-color: #f5f5f5\">🚩 研究结论</span></span></h3>\n<hr />\n<ul>\n<li><span style=\"color: rgb(46, 46, 46)\">帮助更有效疫苗的合理设计</span></li>\n<li><span style=\"color: rgb(46, 46, 46)\">揭示用于诊断和患者分层的新生物标志物</span></li>\n<li><span style=\"color: rgb(46, 46, 46)\">揭示治疗自身免疫的新治疗靶点</span></li>\n</ul>\n<h3 id=\"span-stylecolor-006064span-stylebackground-color-e0f7fa-感想-疑问spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-006064span-stylebackground-color-e0f7fa-感想-疑问spanspan\"></a> <span style=\"color: #006064\"><span style=\"background-color: #e0f7fa\">📌 感想 &amp; 疑问</span></span></h3>\n<hr />\n<h3 id=\"span-stylecolor-1565c0span-stylebackground-color-e1f5fe-研究方法spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-1565c0span-stylebackground-color-e1f5fe-研究方法spanspan\"></a> <span style=\"color: #1565c0\"><span style=\"background-color: #e1f5fe\">🔬 研究方法</span></span></h3>\n<hr />\n<p>Referred in <a href=\"zotero://note/u/FNQNUGED/?ignore=1&amp;line=-1\">主笔记</a></p>\n","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":998,"excerpt":"","more":"<h1 id=\"tfh总结1\"><a class=\"markdownIt-Anchor\" href=\"#tfh总结1\"></a> Tfh总结1</h1>\n<h3 id=\"span-stylecolor-1b5e20span-stylebackground-color-f1f8e9-meta-dataspanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-1b5e20span-stylebackground-color-f1f8e9-meta-dataspanspan\"></a> <span style=\"color: #1b5e20\"><span style=\"background-color: #f1f8e9\">💡 Meta Data</span></span></h3>\n<p><strong><span style=\"color: #1b5e20\">Title: </span></strong> <span style=\"background-color: #dbeedd\">T Follicular Helper Cells</span></p>\n<p><strong><span style=\"color: #1b5e20\">Journal: </span></strong> <span style=\"color: #2e2e2e\"><span style=\"background-color: #dbeedd\">Encyclopedia of Cell Biology (Second Edition)</span></span></p>\n<p><strong><span style=\"color: #1b5e20\">Authors: </span></strong> <span style=\"background-color: #dbeedd\">Filipa Ribeiro; Michelle Linterman; Luis Graca</span></p>\n<p><strong><span style=\"color: #1b5e20\">Pub.date: </span></strong> <span style=\"background-color: #dbeedd\">2023</span></p>\n<p><strong><span style=\"color: #1b5e20\">DOI: </span></strong> <span style=\"background-color: #dbeedd\"><a href=\"https://doi.org/10.1016/B978-0-12-821618-7.00137-1\" rel=\"noopener noreferrer nofollow\">10.1016/B978-0-12-821618-7.00137-1</a></span></p>\n<h3 id=\"span-stylecolor-e65100span-stylebackground-color-fff8e1-研究背景-基础-目的spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-e65100span-stylebackground-color-fff8e1-研究背景-基础-目的spanspan\"></a> <span style=\"color: #e65100\"><span style=\"background-color: #fff8e1\">📜 研究背景 &amp; 基础 &amp; 目的</span></span></h3>\n<hr />\n<ul>\n<li>\n<p><strong>Tfh的功能</strong></p>\n<p><span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FETMP2AEB%22%2C%22annotationKey%22%3A%22KPBK4X4F%22%2C%22color%22%3A%22%23ff6666%22%2C%22pageLabel%22%3A%22367%22%2C%22position%22%3A%7B%22pageIndex%22%3A0%2C%22rects%22%3A%5B%5B108.227%2C460.678%2C539.058%2C468.648%5D%2C%5B67.465%2C450.757%2C149.336%2C460.249%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FRZCM877F%22%5D%2C%22locator%22%3A%22367%22%7D%7D\"><span style=\"background-color: #ff666680\">“These T-B interactions are critical for the isotype switching and affinity maturation of B cells leading to the production of high-affinity antibodies.”</span></span></p>\n</li>\n<li>\n<p><strong>Bcell成熟的重要性，需要调控，防止产生自身免疫性的B细胞</strong></p>\n<blockquote>\n<p><span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FETMP2AEB%22%2C%22pageLabel%22%3A%22368%22%2C%22position%22%3A%7B%22pageIndex%22%3A1%2C%22rects%22%3A%5B%5B73.134%2C533.021%2C544.769%2C541.108%5D%2C%5B73.134%2C521.952%2C544.82%2C530.42%5D%2C%5B73.134%2C511.01%2C544.783%2C519.479%5D%2C%5B73.134%2C500.139%2C544.804%2C508.226%5D%2C%5B73.134%2C489.197%2C544.719%2C497.284%5D%2C%5B73.134%2C478.128%2C544.809%2C486.597%5D%2C%5B73.133%2C467.13%2C544.788%2C475.598%5D%2C%5B73.134%2C456.315%2C391.075%2C464.402%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FRZCM877F%22%5D%2C%22locator%22%3A%22368%22%7D%7D\">“The formation of germinal centers (GCs) within secondary lymphoid organs, in response to infection or immunization, is a crucial event for the production of T cell-dependent protective antibodies. Within GCs, mature B cells undergo <strong>affinity maturation</strong> and <strong>somatic hypermutation</strong> (SHM), leading to the production of antibodies that bind pathogens with high affinity. These antibodies can neutralize infectious agents providing protection against subsequent infection, leading to effective humoral responses and memory. Nevertheless, the <strong>unpredictability</strong> of the SHM can result in the generation of autoreactive B cell clones, thus contributing to a dysregulated humoral response that can lead to autoimmune diseases (Vinuesa et al., 2009). Consequently, the GC reaction requires strict regulation to ensure a <strong>balanced humoral immune response</strong> by guaranteeing the emergence of high-affinity B cell clones targeting pathogens while preventing the generation of autoreactive GC B cells.”</span></p>\n</blockquote>\n</li>\n</ul>\n<h3 id=\"span-stylecolor-2e7d32span-stylebackground-color-f1f8e9-研究内容spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-2e7d32span-stylebackground-color-f1f8e9-研究内容spanspan\"></a> <span style=\"color: #2e7d32\"><span style=\"background-color: #f1f8e9\">📊 研究内容</span></span></h3>\n<hr />\n<ul>\n<li>\n<p><strong>Tfh的关键作用</strong></p>\n<p><span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FETMP2AEB%22%2C%22annotationKey%22%3A%225H7438C5%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%22368%22%2C%22position%22%3A%7B%22pageIndex%22%3A1%2C%22rects%22%3A%5B%5B387.374%2C434.432%2C544.807%2C444.397%5D%2C%5B73.134%2C423.306%2C491.858%2C431.775%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FRZCM877F%22%5D%2C%22locator%22%3A%22368%22%7D%7D\"><span style=\"background-color: #ffd40080\">“Tfh cells provide crucial signals to B cells to support GC development and function by mediating affinity maturation through the positive selection of GC B cells”</span></span></p>\n</li>\n<li>\n<p><strong>关键基因：<span style=\"color: #ff2020\">BCL6</span>、CXCR5、ICOS、PD-1、SLAM、SAP、PRDM1</strong></p>\n</li>\n<li>\n<p><strong>CD4 Tfh Marker</strong></p>\n  <img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/4wzMW-xLihMN-20230313.png\" style=\"zoom:50%;\" />\n</li>\n<li>\n<p><strong>Tfh细胞分化</strong></p>\n  <img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/4tz6e-jW7aow-20230313.png\" style=\"zoom:35%;\" />\n<ul>\n<li>\n<p>DC刺激CD4 NaiveT</p>\n<ul>\n<li>MHC II呈递抗原</li>\n<li>CD80/86-CD28提供共刺激信号</li>\n<li>ICOS-ICOSL提供定位信号，将TFH定位于TB边界</li>\n</ul>\n</li>\n<li>\n<p>pre-Tfh与B细胞相互作用：获得迁移到 GC 并完成其发育为 GC Tfh 细胞的能力</p>\n<ul>\n<li>TCR-MHC II</li>\n<li>CD28-CD80/86</li>\n<li>ICOS-ICOSL</li>\n<li>CD40L-CD40</li>\n<li>SAP-SFR</li>\n</ul>\n</li>\n<li>\n<p>Tfh与B细胞的相互作用：Tfh 细胞产生 IL-4 和 IL-21，从而为 B 细胞提供支持</p>\n<ul>\n<li>TCR-MHC II</li>\n<li>CD28-CD80/86</li>\n<li>ICOS-ICOSL</li>\n<li>CD40L-CD40</li>\n<li>SAP-SFR</li>\n<li>PD-1-PD-L1</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"span-stylecolor-4a148cspan-stylebackground-color-f5f5f5-研究结论spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-4a148cspan-stylebackground-color-f5f5f5-研究结论spanspan\"></a> <span style=\"color: #4a148c\"><span style=\"background-color: #f5f5f5\">🚩 研究结论</span></span></h3>\n<hr />\n<ul>\n<li><span style=\"color: rgb(46, 46, 46)\">帮助更有效疫苗的合理设计</span></li>\n<li><span style=\"color: rgb(46, 46, 46)\">揭示用于诊断和患者分层的新生物标志物</span></li>\n<li><span style=\"color: rgb(46, 46, 46)\">揭示治疗自身免疫的新治疗靶点</span></li>\n</ul>\n<h3 id=\"span-stylecolor-006064span-stylebackground-color-e0f7fa-感想-疑问spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-006064span-stylebackground-color-e0f7fa-感想-疑问spanspan\"></a> <span style=\"color: #006064\"><span style=\"background-color: #e0f7fa\">📌 感想 &amp; 疑问</span></span></h3>\n<hr />\n<h3 id=\"span-stylecolor-1565c0span-stylebackground-color-e1f5fe-研究方法spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-1565c0span-stylebackground-color-e1f5fe-研究方法spanspan\"></a> <span style=\"color: #1565c0\"><span style=\"background-color: #e1f5fe\">🔬 研究方法</span></span></h3>\n<hr />\n<p>Referred in <a href=\"zotero://note/u/FNQNUGED/?ignore=1&amp;line=-1\">主笔记</a></p>\n"},{"title":"code-server安装教程","abbrlink":"4c46dc20","date":"2023-05-18T02:12:33.000Z","_content":"\n## 下载\n\n\n* 官方的项目`Github`地址在这 [coder/code-server](https://github.com/coder/code-server)\n\n* 在`Releases`=>`Assets`里面找`linux-amd`包 ，可以本地下载再上传到服务器端\n\n* 在`Linux`终端输入命令下载\n\n    ```bash\n    wget https://github.com/coder/code-server/releases/download/v4.5.1/code-server-4.5.1-linux-amd64.tar.gz\n    ```\n\n## 安装\n\n```bash\n# 在终端安装，解压就行\ntar -xzvf code-server-4.5.1-linux-amd64.tar.gz\n```\n\n## 启动\n\n```bash\ncd bin\n./code-server\n```\n\n就会出现如下界面启动了\n\n```txt\n[2022-03-07T11:13:55.467Z] info  code-server 4.1.0 9e620e90f53fb91338a2ba1aaa2e556d42ae52d5\n[2022-03-07T11:13:55.468Z] info  Using user-data-dir ~/.local/share/code-server\n[2022-03-07T11:13:55.479Z] info  Using config file ~/.config/code-server/config.yaml\n[2022-03-07T11:13:55.479Z] info  HTTP server listening on http://127.0.0.1:888/ \n[2022-03-07T11:13:55.479Z] info    - Authentication is enabled\n[2022-03-07T11:13:55.479Z] info      - Using password from ~/.config/code-server/config.yaml\n[2022-03-07T11:13:55.479Z] info    - Not serving HTTPS\n```\n\n可以看到配置文件在`~/.config/code-server/config.yaml`这里  \n\n## 配置\n\n修改配置文件\n\n```bash\nvi ~/.config/code-server/config.yaml\n\n### config.yaml内容可以修改成如下(端口和密码需要自己改成其它)\nbind-addr: 0.0.0.0:8446\nauth: password\npassword: 12345678\ncert: false\n```\n\n## 穿透\n\n```bash\n### 端口可以随意修改\n### 在登陆节点执行下述命令\nssh -NfL localhost:8447:localhost:8446 yourname@测试节点名称\n### 在本地cmd中执行下述命令\nssh -L 8448:localhost:8447 yourname@登陆节点ip\n### 最后在浏览器打开对应网址\nhttp://localhost:8448/\n```\n\n## 运行\n\n如需持续运行，可以再安装[tmux](tmux.md)程序\n\n```bash\ntmux new -s vscode\n./code-server\n# 使用快捷键Ctrl+b, 再按d退出即可\n```\n","source":"_posts/code-server安装教程.md","raw":"---\ntitle: code-server安装教程\ncategories:\n  - - tool\n    - linux\ntags:\n  - tool\n  - linux\nabbrlink: 4c46dc20\ndate: 2023-05-18 10:12:33\n---\n\n## 下载\n\n\n* 官方的项目`Github`地址在这 [coder/code-server](https://github.com/coder/code-server)\n\n* 在`Releases`=>`Assets`里面找`linux-amd`包 ，可以本地下载再上传到服务器端\n\n* 在`Linux`终端输入命令下载\n\n    ```bash\n    wget https://github.com/coder/code-server/releases/download/v4.5.1/code-server-4.5.1-linux-amd64.tar.gz\n    ```\n\n## 安装\n\n```bash\n# 在终端安装，解压就行\ntar -xzvf code-server-4.5.1-linux-amd64.tar.gz\n```\n\n## 启动\n\n```bash\ncd bin\n./code-server\n```\n\n就会出现如下界面启动了\n\n```txt\n[2022-03-07T11:13:55.467Z] info  code-server 4.1.0 9e620e90f53fb91338a2ba1aaa2e556d42ae52d5\n[2022-03-07T11:13:55.468Z] info  Using user-data-dir ~/.local/share/code-server\n[2022-03-07T11:13:55.479Z] info  Using config file ~/.config/code-server/config.yaml\n[2022-03-07T11:13:55.479Z] info  HTTP server listening on http://127.0.0.1:888/ \n[2022-03-07T11:13:55.479Z] info    - Authentication is enabled\n[2022-03-07T11:13:55.479Z] info      - Using password from ~/.config/code-server/config.yaml\n[2022-03-07T11:13:55.479Z] info    - Not serving HTTPS\n```\n\n可以看到配置文件在`~/.config/code-server/config.yaml`这里  \n\n## 配置\n\n修改配置文件\n\n```bash\nvi ~/.config/code-server/config.yaml\n\n### config.yaml内容可以修改成如下(端口和密码需要自己改成其它)\nbind-addr: 0.0.0.0:8446\nauth: password\npassword: 12345678\ncert: false\n```\n\n## 穿透\n\n```bash\n### 端口可以随意修改\n### 在登陆节点执行下述命令\nssh -NfL localhost:8447:localhost:8446 yourname@测试节点名称\n### 在本地cmd中执行下述命令\nssh -L 8448:localhost:8447 yourname@登陆节点ip\n### 最后在浏览器打开对应网址\nhttp://localhost:8448/\n```\n\n## 运行\n\n如需持续运行，可以再安装[tmux](tmux.md)程序\n\n```bash\ntmux new -s vscode\n./code-server\n# 使用快捷键Ctrl+b, 再按d退出即可\n```\n","slug":"code-server安装教程","published":1,"updated":"2023-05-19T09:34:44.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm4peu6mz000gdbzr3v2j2agw","content":"<h2 id=\"下载\"><a class=\"markdownIt-Anchor\" href=\"#下载\"></a> 下载</h2>\n<ul>\n<li>\n<p>官方的项目<code>Github</code>地址在这 <a href=\"https://github.com/coder/code-server\">coder/code-server</a></p>\n</li>\n<li>\n<p>在<code>Releases</code>=&gt;<code>Assets</code>里面找<code>linux-amd</code>包 ，可以本地下载再上传到服务器端</p>\n</li>\n<li>\n<p>在<code>Linux</code>终端输入命令下载</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://github.com/coder/code-server/releases/download/v4.5.1/code-server-4.5.1-linux-amd64.tar.gz</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h2 id=\"安装\"><a class=\"markdownIt-Anchor\" href=\"#安装\"></a> 安装</h2>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 在终端安装，解压就行</span></span><br><span class=\"line\">tar -xzvf code-server-4.5.1-linux-amd64.tar.gz</span><br></pre></td></tr></table></figure>\n<h2 id=\"启动\"><a class=\"markdownIt-Anchor\" href=\"#启动\"></a> 启动</h2>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> bin</span><br><span class=\"line\">./code-server</span><br></pre></td></tr></table></figure>\n<p>就会出现如下界面启动了</p>\n<figure class=\"highlight txt\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[2022-03-07T11:13:55.467Z] info  code-server 4.1.0 9e620e90f53fb91338a2ba1aaa2e556d42ae52d5</span><br><span class=\"line\">[2022-03-07T11:13:55.468Z] info  Using user-data-dir ~/.local/share/code-server</span><br><span class=\"line\">[2022-03-07T11:13:55.479Z] info  Using config file ~/.config/code-server/config.yaml</span><br><span class=\"line\">[2022-03-07T11:13:55.479Z] info  HTTP server listening on http://127.0.0.1:888/ </span><br><span class=\"line\">[2022-03-07T11:13:55.479Z] info    - Authentication is enabled</span><br><span class=\"line\">[2022-03-07T11:13:55.479Z] info      - Using password from ~/.config/code-server/config.yaml</span><br><span class=\"line\">[2022-03-07T11:13:55.479Z] info    - Not serving HTTPS</span><br></pre></td></tr></table></figure>\n<p>可以看到配置文件在<code>~/.config/code-server/config.yaml</code>这里</p>\n<h2 id=\"配置\"><a class=\"markdownIt-Anchor\" href=\"#配置\"></a> 配置</h2>\n<p>修改配置文件</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi ~/.config/code-server/config.yaml</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### config.yaml内容可以修改成如下(端口和密码需要自己改成其它)</span></span><br><span class=\"line\">bind-addr: 0.0.0.0:8446</span><br><span class=\"line\">auth: password</span><br><span class=\"line\">password: 12345678</span><br><span class=\"line\">cert: <span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"穿透\"><a class=\"markdownIt-Anchor\" href=\"#穿透\"></a> 穿透</h2>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">### 端口可以随意修改</span></span><br><span class=\"line\"><span class=\"comment\">### 在登陆节点执行下述命令</span></span><br><span class=\"line\">ssh -NfL localhost:8447:localhost:8446 yourname@测试节点名称</span><br><span class=\"line\"><span class=\"comment\">### 在本地cmd中执行下述命令</span></span><br><span class=\"line\">ssh -L 8448:localhost:8447 yourname@登陆节点ip</span><br><span class=\"line\"><span class=\"comment\">### 最后在浏览器打开对应网址</span></span><br><span class=\"line\">http://localhost:8448/</span><br></pre></td></tr></table></figure>\n<h2 id=\"运行\"><a class=\"markdownIt-Anchor\" href=\"#运行\"></a> 运行</h2>\n<p>如需持续运行，可以再安装<a href=\"tmux.md\">tmux</a>程序</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tmux new -s vscode</span><br><span class=\"line\">./code-server</span><br><span class=\"line\"><span class=\"comment\"># 使用快捷键Ctrl+b, 再按d退出即可</span></span><br></pre></td></tr></table></figure>\n","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":355,"excerpt":"","more":"<h2 id=\"下载\"><a class=\"markdownIt-Anchor\" href=\"#下载\"></a> 下载</h2>\n<ul>\n<li>\n<p>官方的项目<code>Github</code>地址在这 <a href=\"https://github.com/coder/code-server\">coder/code-server</a></p>\n</li>\n<li>\n<p>在<code>Releases</code>=&gt;<code>Assets</code>里面找<code>linux-amd</code>包 ，可以本地下载再上传到服务器端</p>\n</li>\n<li>\n<p>在<code>Linux</code>终端输入命令下载</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://github.com/coder/code-server/releases/download/v4.5.1/code-server-4.5.1-linux-amd64.tar.gz</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h2 id=\"安装\"><a class=\"markdownIt-Anchor\" href=\"#安装\"></a> 安装</h2>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 在终端安装，解压就行</span></span><br><span class=\"line\">tar -xzvf code-server-4.5.1-linux-amd64.tar.gz</span><br></pre></td></tr></table></figure>\n<h2 id=\"启动\"><a class=\"markdownIt-Anchor\" href=\"#启动\"></a> 启动</h2>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> bin</span><br><span class=\"line\">./code-server</span><br></pre></td></tr></table></figure>\n<p>就会出现如下界面启动了</p>\n<figure class=\"highlight txt\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[2022-03-07T11:13:55.467Z] info  code-server 4.1.0 9e620e90f53fb91338a2ba1aaa2e556d42ae52d5</span><br><span class=\"line\">[2022-03-07T11:13:55.468Z] info  Using user-data-dir ~/.local/share/code-server</span><br><span class=\"line\">[2022-03-07T11:13:55.479Z] info  Using config file ~/.config/code-server/config.yaml</span><br><span class=\"line\">[2022-03-07T11:13:55.479Z] info  HTTP server listening on http://127.0.0.1:888/ </span><br><span class=\"line\">[2022-03-07T11:13:55.479Z] info    - Authentication is enabled</span><br><span class=\"line\">[2022-03-07T11:13:55.479Z] info      - Using password from ~/.config/code-server/config.yaml</span><br><span class=\"line\">[2022-03-07T11:13:55.479Z] info    - Not serving HTTPS</span><br></pre></td></tr></table></figure>\n<p>可以看到配置文件在<code>~/.config/code-server/config.yaml</code>这里</p>\n<h2 id=\"配置\"><a class=\"markdownIt-Anchor\" href=\"#配置\"></a> 配置</h2>\n<p>修改配置文件</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi ~/.config/code-server/config.yaml</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### config.yaml内容可以修改成如下(端口和密码需要自己改成其它)</span></span><br><span class=\"line\">bind-addr: 0.0.0.0:8446</span><br><span class=\"line\">auth: password</span><br><span class=\"line\">password: 12345678</span><br><span class=\"line\">cert: <span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"穿透\"><a class=\"markdownIt-Anchor\" href=\"#穿透\"></a> 穿透</h2>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">### 端口可以随意修改</span></span><br><span class=\"line\"><span class=\"comment\">### 在登陆节点执行下述命令</span></span><br><span class=\"line\">ssh -NfL localhost:8447:localhost:8446 yourname@测试节点名称</span><br><span class=\"line\"><span class=\"comment\">### 在本地cmd中执行下述命令</span></span><br><span class=\"line\">ssh -L 8448:localhost:8447 yourname@登陆节点ip</span><br><span class=\"line\"><span class=\"comment\">### 最后在浏览器打开对应网址</span></span><br><span class=\"line\">http://localhost:8448/</span><br></pre></td></tr></table></figure>\n<h2 id=\"运行\"><a class=\"markdownIt-Anchor\" href=\"#运行\"></a> 运行</h2>\n<p>如需持续运行，可以再安装<a href=\"tmux.md\">tmux</a>程序</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tmux new -s vscode</span><br><span class=\"line\">./code-server</span><br><span class=\"line\"><span class=\"comment\"># 使用快捷键Ctrl+b, 再按d退出即可</span></span><br></pre></td></tr></table></figure>\n"},{"title":"jupyter安装教程","abbrlink":"66d9cc71","date":"2023-05-18T02:12:59.000Z","_content":"\n### **安装jupyter。如果已经安装好，可忽略此步。**\n\n```\nconda create -n jupyter -y\nconda activate jupyter\nmamba install jupyter -y\n\n```\n\n### **集群终端运行以下命令，生成默认的配置文件，文件在/home/username/.jupyter目录下**\n\n```\njupyter notebook --generate-config\n\n```\n\n### **打开python IDE，并运行以下代码，用于设置jupyter访问密码。记录生成的密钥。**\n\n```\nfrom notebook.auth import passwd\npasswd()\n\n```\n\n### **修改配置文件/home/username/.jupyter/jupyter_notebook_config.py**\n\n```\nc.NotebookApp.allow_remote_access = True\nc.NotebookApp.ip = '0.0.0.0'\nc.NotebookApp.notebook_dir='/path/jupyter ' # 这里的路径是指在浏览器上进入的路径即是jupyter在服务器上的工作路径，在该路径中自己拥有读写权限。\nc.NotebookApp.open_browser = False\nc.NotebookApp.password='argon2:$argon2id$v=19$m=10240,t=10,p=8$fr1n0n9bTPZZHyriNaVecQ$hIzmU2S5SeJuoPUq7MLCag '  # 这个对应的是jupyter访问密码12345678的密码串，需要写入配置文件\nc.NotebookApp.port = 8110 # 可自行指定一个端口，表示jupyter运行的输入输出流都导向此端口。\n\n```\n\n### **在集群登陆节点和测试节点之间进行桥连接。在登陆节点输入如下命令。**\n\n```\nssh -NfL localhost:8135:localhost:8110 yournames@测试节点名称 #修改为自己的用户名和主机名\n-N 告诉SSH没有命令要被远程执行；\n-f   告诉SSH在后台执行；\n-L  是指定port forwarding的配置，远端的端口是第二个localhost后面接的port 8110，本地的端口是第一个localhost后面接的port 8135；\n\n```\n\n### **进入测试节点启动jupyter notebook 并保证该命令不会中断**\n\n```\njupyter notebook\n```\n\n### **在本地启动SSH。如果是windows，则先启动cmd**\n\n```\nssh -L 8190:localhost:8135 yournames@登陆节点ip\n192.168.61.1表示测试节点的ip\n8135表示登录节点用于侦听测试节点所用的端口。\n8190表示本地用于侦听登陆节点所用的端口。\n\nssh -L 8190:localhost:8135 yournames@登陆节点ip\n```\n\n### **最后打开浏览器，访问http://localhost:8190/, 之后输入密码（即是指第三步中配置文件中的密码串对应的密码12345678）即可登录。**\n","source":"_posts/jupyter安装教程.md","raw":"---\ntitle: jupyter安装教程\ncategories:\n  - - tool\n    - linux\ntags:\n  - tool\n  - linux\nabbrlink: 66d9cc71\ndate: 2023-05-18 10:12:59\n---\n\n### **安装jupyter。如果已经安装好，可忽略此步。**\n\n```\nconda create -n jupyter -y\nconda activate jupyter\nmamba install jupyter -y\n\n```\n\n### **集群终端运行以下命令，生成默认的配置文件，文件在/home/username/.jupyter目录下**\n\n```\njupyter notebook --generate-config\n\n```\n\n### **打开python IDE，并运行以下代码，用于设置jupyter访问密码。记录生成的密钥。**\n\n```\nfrom notebook.auth import passwd\npasswd()\n\n```\n\n### **修改配置文件/home/username/.jupyter/jupyter_notebook_config.py**\n\n```\nc.NotebookApp.allow_remote_access = True\nc.NotebookApp.ip = '0.0.0.0'\nc.NotebookApp.notebook_dir='/path/jupyter ' # 这里的路径是指在浏览器上进入的路径即是jupyter在服务器上的工作路径，在该路径中自己拥有读写权限。\nc.NotebookApp.open_browser = False\nc.NotebookApp.password='argon2:$argon2id$v=19$m=10240,t=10,p=8$fr1n0n9bTPZZHyriNaVecQ$hIzmU2S5SeJuoPUq7MLCag '  # 这个对应的是jupyter访问密码12345678的密码串，需要写入配置文件\nc.NotebookApp.port = 8110 # 可自行指定一个端口，表示jupyter运行的输入输出流都导向此端口。\n\n```\n\n### **在集群登陆节点和测试节点之间进行桥连接。在登陆节点输入如下命令。**\n\n```\nssh -NfL localhost:8135:localhost:8110 yournames@测试节点名称 #修改为自己的用户名和主机名\n-N 告诉SSH没有命令要被远程执行；\n-f   告诉SSH在后台执行；\n-L  是指定port forwarding的配置，远端的端口是第二个localhost后面接的port 8110，本地的端口是第一个localhost后面接的port 8135；\n\n```\n\n### **进入测试节点启动jupyter notebook 并保证该命令不会中断**\n\n```\njupyter notebook\n```\n\n### **在本地启动SSH。如果是windows，则先启动cmd**\n\n```\nssh -L 8190:localhost:8135 yournames@登陆节点ip\n192.168.61.1表示测试节点的ip\n8135表示登录节点用于侦听测试节点所用的端口。\n8190表示本地用于侦听登陆节点所用的端口。\n\nssh -L 8190:localhost:8135 yournames@登陆节点ip\n```\n\n### **最后打开浏览器，访问http://localhost:8190/, 之后输入密码（即是指第三步中配置文件中的密码串对应的密码12345678）即可登录。**\n","slug":"jupyter安装教程","published":1,"updated":"2023-05-19T09:34:40.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm4peu6mz000idbzr05uo8ddt","content":"<h3 id=\"安装jupyter-如果已经安装好可忽略此步\"><a class=\"markdownIt-Anchor\" href=\"#安装jupyter-如果已经安装好可忽略此步\"></a> <strong>安装jupyter。如果已经安装好，可忽略此步。</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda create -n jupyter -y</span><br><span class=\"line\">conda activate jupyter</span><br><span class=\"line\">mamba install jupyter -y</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"集群终端运行以下命令生成默认的配置文件文件在homeusernamejupyter目录下\"><a class=\"markdownIt-Anchor\" href=\"#集群终端运行以下命令生成默认的配置文件文件在homeusernamejupyter目录下\"></a> <strong>集群终端运行以下命令，生成默认的配置文件，文件在/home/username/.jupyter目录下</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">jupyter notebook --generate-config</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"打开python-ide并运行以下代码用于设置jupyter访问密码-记录生成的密钥\"><a class=\"markdownIt-Anchor\" href=\"#打开python-ide并运行以下代码用于设置jupyter访问密码-记录生成的密钥\"></a> <strong>打开python IDE，并运行以下代码，用于设置jupyter访问密码。记录生成的密钥。</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from notebook.auth import passwd</span><br><span class=\"line\">passwd()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"修改配置文件homeusernamejupyterjupyter_notebook_configpy\"><a class=\"markdownIt-Anchor\" href=\"#修改配置文件homeusernamejupyterjupyter_notebook_configpy\"></a> <strong>修改配置文件/home/username/.jupyter/jupyter_notebook_config.py</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">c.NotebookApp.allow_remote_access = True</span><br><span class=\"line\">c.NotebookApp.ip = &#x27;0.0.0.0&#x27;</span><br><span class=\"line\">c.NotebookApp.notebook_dir=&#x27;/path/jupyter &#x27; # 这里的路径是指在浏览器上进入的路径即是jupyter在服务器上的工作路径，在该路径中自己拥有读写权限。</span><br><span class=\"line\">c.NotebookApp.open_browser = False</span><br><span class=\"line\">c.NotebookApp.password=&#x27;argon2:$argon2id$v=19$m=10240,t=10,p=8$fr1n0n9bTPZZHyriNaVecQ$hIzmU2S5SeJuoPUq7MLCag &#x27;  # 这个对应的是jupyter访问密码12345678的密码串，需要写入配置文件</span><br><span class=\"line\">c.NotebookApp.port = 8110 # 可自行指定一个端口，表示jupyter运行的输入输出流都导向此端口。</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"在集群登陆节点和测试节点之间进行桥连接-在登陆节点输入如下命令\"><a class=\"markdownIt-Anchor\" href=\"#在集群登陆节点和测试节点之间进行桥连接-在登陆节点输入如下命令\"></a> <strong>在集群登陆节点和测试节点之间进行桥连接。在登陆节点输入如下命令。</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -NfL localhost:8135:localhost:8110 yournames@测试节点名称 #修改为自己的用户名和主机名</span><br><span class=\"line\">-N 告诉SSH没有命令要被远程执行；</span><br><span class=\"line\">-f   告诉SSH在后台执行；</span><br><span class=\"line\">-L  是指定port forwarding的配置，远端的端口是第二个localhost后面接的port 8110，本地的端口是第一个localhost后面接的port 8135；</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"进入测试节点启动jupyter-notebook-并保证该命令不会中断\"><a class=\"markdownIt-Anchor\" href=\"#进入测试节点启动jupyter-notebook-并保证该命令不会中断\"></a> <strong>进入测试节点启动jupyter notebook 并保证该命令不会中断</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">jupyter notebook</span><br></pre></td></tr></table></figure>\n<h3 id=\"在本地启动ssh-如果是windows则先启动cmd\"><a class=\"markdownIt-Anchor\" href=\"#在本地启动ssh-如果是windows则先启动cmd\"></a> <strong>在本地启动SSH。如果是windows，则先启动cmd</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -L 8190:localhost:8135 yournames@登陆节点ip</span><br><span class=\"line\">192.168.61.1表示测试节点的ip</span><br><span class=\"line\">8135表示登录节点用于侦听测试节点所用的端口。</span><br><span class=\"line\">8190表示本地用于侦听登陆节点所用的端口。</span><br><span class=\"line\"></span><br><span class=\"line\">ssh -L 8190:localhost:8135 yournames@登陆节点ip</span><br></pre></td></tr></table></figure>\n<h3 id=\"最后打开浏览器访问httplocalhost8190-之后输入密码即是指第三步中配置文件中的密码串对应的密码12345678即可登录\"><a class=\"markdownIt-Anchor\" href=\"#最后打开浏览器访问httplocalhost8190-之后输入密码即是指第三步中配置文件中的密码串对应的密码12345678即可登录\"></a> <strong>最后打开浏览器，访问<a href=\"http://localhost:8190/\">http://localhost:8190/</a>, 之后输入密码（即是指第三步中配置文件中的密码串对应的密码12345678）即可登录。</strong></h3>\n","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":488,"excerpt":"","more":"<h3 id=\"安装jupyter-如果已经安装好可忽略此步\"><a class=\"markdownIt-Anchor\" href=\"#安装jupyter-如果已经安装好可忽略此步\"></a> <strong>安装jupyter。如果已经安装好，可忽略此步。</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda create -n jupyter -y</span><br><span class=\"line\">conda activate jupyter</span><br><span class=\"line\">mamba install jupyter -y</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"集群终端运行以下命令生成默认的配置文件文件在homeusernamejupyter目录下\"><a class=\"markdownIt-Anchor\" href=\"#集群终端运行以下命令生成默认的配置文件文件在homeusernamejupyter目录下\"></a> <strong>集群终端运行以下命令，生成默认的配置文件，文件在/home/username/.jupyter目录下</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">jupyter notebook --generate-config</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"打开python-ide并运行以下代码用于设置jupyter访问密码-记录生成的密钥\"><a class=\"markdownIt-Anchor\" href=\"#打开python-ide并运行以下代码用于设置jupyter访问密码-记录生成的密钥\"></a> <strong>打开python IDE，并运行以下代码，用于设置jupyter访问密码。记录生成的密钥。</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from notebook.auth import passwd</span><br><span class=\"line\">passwd()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"修改配置文件homeusernamejupyterjupyter_notebook_configpy\"><a class=\"markdownIt-Anchor\" href=\"#修改配置文件homeusernamejupyterjupyter_notebook_configpy\"></a> <strong>修改配置文件/home/username/.jupyter/jupyter_notebook_config.py</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">c.NotebookApp.allow_remote_access = True</span><br><span class=\"line\">c.NotebookApp.ip = &#x27;0.0.0.0&#x27;</span><br><span class=\"line\">c.NotebookApp.notebook_dir=&#x27;/path/jupyter &#x27; # 这里的路径是指在浏览器上进入的路径即是jupyter在服务器上的工作路径，在该路径中自己拥有读写权限。</span><br><span class=\"line\">c.NotebookApp.open_browser = False</span><br><span class=\"line\">c.NotebookApp.password=&#x27;argon2:$argon2id$v=19$m=10240,t=10,p=8$fr1n0n9bTPZZHyriNaVecQ$hIzmU2S5SeJuoPUq7MLCag &#x27;  # 这个对应的是jupyter访问密码12345678的密码串，需要写入配置文件</span><br><span class=\"line\">c.NotebookApp.port = 8110 # 可自行指定一个端口，表示jupyter运行的输入输出流都导向此端口。</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"在集群登陆节点和测试节点之间进行桥连接-在登陆节点输入如下命令\"><a class=\"markdownIt-Anchor\" href=\"#在集群登陆节点和测试节点之间进行桥连接-在登陆节点输入如下命令\"></a> <strong>在集群登陆节点和测试节点之间进行桥连接。在登陆节点输入如下命令。</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -NfL localhost:8135:localhost:8110 yournames@测试节点名称 #修改为自己的用户名和主机名</span><br><span class=\"line\">-N 告诉SSH没有命令要被远程执行；</span><br><span class=\"line\">-f   告诉SSH在后台执行；</span><br><span class=\"line\">-L  是指定port forwarding的配置，远端的端口是第二个localhost后面接的port 8110，本地的端口是第一个localhost后面接的port 8135；</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"进入测试节点启动jupyter-notebook-并保证该命令不会中断\"><a class=\"markdownIt-Anchor\" href=\"#进入测试节点启动jupyter-notebook-并保证该命令不会中断\"></a> <strong>进入测试节点启动jupyter notebook 并保证该命令不会中断</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">jupyter notebook</span><br></pre></td></tr></table></figure>\n<h3 id=\"在本地启动ssh-如果是windows则先启动cmd\"><a class=\"markdownIt-Anchor\" href=\"#在本地启动ssh-如果是windows则先启动cmd\"></a> <strong>在本地启动SSH。如果是windows，则先启动cmd</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -L 8190:localhost:8135 yournames@登陆节点ip</span><br><span class=\"line\">192.168.61.1表示测试节点的ip</span><br><span class=\"line\">8135表示登录节点用于侦听测试节点所用的端口。</span><br><span class=\"line\">8190表示本地用于侦听登陆节点所用的端口。</span><br><span class=\"line\"></span><br><span class=\"line\">ssh -L 8190:localhost:8135 yournames@登陆节点ip</span><br></pre></td></tr></table></figure>\n<h3 id=\"最后打开浏览器访问httplocalhost8190-之后输入密码即是指第三步中配置文件中的密码串对应的密码12345678即可登录\"><a class=\"markdownIt-Anchor\" href=\"#最后打开浏览器访问httplocalhost8190-之后输入密码即是指第三步中配置文件中的密码串对应的密码12345678即可登录\"></a> <strong>最后打开浏览器，访问<a href=\"http://localhost:8190/\">http://localhost:8190/</a>, 之后输入密码（即是指第三步中配置文件中的密码串对应的密码12345678）即可登录。</strong></h3>\n"},{"title":"免疫基础知识","abbrlink":"b40e0536","date":"2023-05-18T09:39:17.000Z","_content":"\n## 免疫细胞\n\n### Treg的分类和功能\n\nTreg是T细胞的一个子集， 占**CD4+T细胞**总数的5-10%，具有<span style=\"background:#FF9999;\">维持体内平衡</span>和<span style=\"background:#FF9999;\">预防自身免疫</span>的功能，其特征是**CD4**、**CD25**、**FOXP3**和低水平**CD127**的共同表达。高水平的FOXP3和特异性去甲基化区域（TSDR）的去甲基化是Treg的显著特征，TSDR是FOXP3基因中的一个保守区域。\n\nTregs可分为两类：<u>天然调节性T细胞（nTregs）</u>和<u>诱导调节性T细胞（iTregs）</u>。两种类型的Tregs都普遍表达 Foxp3。\n\n* nTregs在胸腺中自然发育，其抑制作用是通过细胞间接触实现的，它们的主要功能是维持正常的免疫耐受和控制炎症反应。\n\n* iTregs来源于肿瘤微环境信号诱导的外周原始T细胞，包括肿瘤抗原、细胞因子（如IL-10, TGF-β）和其他可溶性分子。iTregs通过多种促进肿瘤进展的机制抑制效应T细胞（Teff）、NK细胞和DC的抗肿瘤免疫作用。\n\nTregs主要有以下五种功能机制：\n\n* Tregs分泌抑制性细胞因子，包括 IL-10、TGF-β 和 IL-35。\n\n* Tregs 通过颗粒酶和穿孔素杀死效应细胞。\n\n* Tregs 影响效应细胞的功能：Treg 与效应T细胞竞争消耗 IL-2，从而抑制效应T细胞的生长；Tregs通过产生胞外酶CD39和CD73 促进TME中腺苷的产生，诱效应细胞导的抑制和抗增殖作用；Tregs通过缝隙连接将大量 cAMP 转移到效应T细胞，干扰其代谢。\n\n* Tregs通过刺激性和抑制性受体（CTLA-4 或 LAG3）诱导DC耐受，后者通过IDO进一步抑制T细胞的能力。\n* MDSCs和Tregs 产生的因子形成正反馈环，促进增殖，增强抑制环境。  \n\n## 免疫分子\n\n### 趋化因子\n\n趋化因子是一组低分子量（约8~12kDa）的细胞因子，调节免疫细胞的运输与分化，是免疫系统功能行使的核心。基于其主要蛋白质结构的前两个半胱氨酸残基的位置，可分为4个不同的亚家族：**C、CC、CXC、CX3C**。基于其功能，可分为<u>内稳态趋化因子</u>和<u>炎症趋化因子</u>。\n\n主要功能\n\n* 器官发育：在器官发育和血管生成过程中引导干细胞迁移到适当的位置；介导细胞增殖；介导淋巴细胞的成熟。\n\n* 免疫监视：介导免疫细胞在健康外周组织中的稳态，维持免疫耐受。\n\n* 组织更新再生：引导干细胞和祖细胞迁移，以促进损伤后的组织更新或再生；促进愈合过程中的血管生成；促进上皮、内皮、间充质的愈合。\n* 宿主防御：促进先天免疫细胞募集至感染部位，防止微生物传播；调节适应性免疫反应，包括免疫激活和免疫记忆；调控效应细胞功能和在外周组织的存活。\n","source":"_posts/免疫基础知识.md","raw":"---\ntitle: 免疫基础知识\ncategories:\n  - notes\n  - immune\ntags:\n  - note\n  - immune\nabbrlink: b40e0536\ndate: 2023-05-18 17:39:17\n---\n\n## 免疫细胞\n\n### Treg的分类和功能\n\nTreg是T细胞的一个子集， 占**CD4+T细胞**总数的5-10%，具有<span style=\"background:#FF9999;\">维持体内平衡</span>和<span style=\"background:#FF9999;\">预防自身免疫</span>的功能，其特征是**CD4**、**CD25**、**FOXP3**和低水平**CD127**的共同表达。高水平的FOXP3和特异性去甲基化区域（TSDR）的去甲基化是Treg的显著特征，TSDR是FOXP3基因中的一个保守区域。\n\nTregs可分为两类：<u>天然调节性T细胞（nTregs）</u>和<u>诱导调节性T细胞（iTregs）</u>。两种类型的Tregs都普遍表达 Foxp3。\n\n* nTregs在胸腺中自然发育，其抑制作用是通过细胞间接触实现的，它们的主要功能是维持正常的免疫耐受和控制炎症反应。\n\n* iTregs来源于肿瘤微环境信号诱导的外周原始T细胞，包括肿瘤抗原、细胞因子（如IL-10, TGF-β）和其他可溶性分子。iTregs通过多种促进肿瘤进展的机制抑制效应T细胞（Teff）、NK细胞和DC的抗肿瘤免疫作用。\n\nTregs主要有以下五种功能机制：\n\n* Tregs分泌抑制性细胞因子，包括 IL-10、TGF-β 和 IL-35。\n\n* Tregs 通过颗粒酶和穿孔素杀死效应细胞。\n\n* Tregs 影响效应细胞的功能：Treg 与效应T细胞竞争消耗 IL-2，从而抑制效应T细胞的生长；Tregs通过产生胞外酶CD39和CD73 促进TME中腺苷的产生，诱效应细胞导的抑制和抗增殖作用；Tregs通过缝隙连接将大量 cAMP 转移到效应T细胞，干扰其代谢。\n\n* Tregs通过刺激性和抑制性受体（CTLA-4 或 LAG3）诱导DC耐受，后者通过IDO进一步抑制T细胞的能力。\n* MDSCs和Tregs 产生的因子形成正反馈环，促进增殖，增强抑制环境。  \n\n## 免疫分子\n\n### 趋化因子\n\n趋化因子是一组低分子量（约8~12kDa）的细胞因子，调节免疫细胞的运输与分化，是免疫系统功能行使的核心。基于其主要蛋白质结构的前两个半胱氨酸残基的位置，可分为4个不同的亚家族：**C、CC、CXC、CX3C**。基于其功能，可分为<u>内稳态趋化因子</u>和<u>炎症趋化因子</u>。\n\n主要功能\n\n* 器官发育：在器官发育和血管生成过程中引导干细胞迁移到适当的位置；介导细胞增殖；介导淋巴细胞的成熟。\n\n* 免疫监视：介导免疫细胞在健康外周组织中的稳态，维持免疫耐受。\n\n* 组织更新再生：引导干细胞和祖细胞迁移，以促进损伤后的组织更新或再生；促进愈合过程中的血管生成；促进上皮、内皮、间充质的愈合。\n* 宿主防御：促进先天免疫细胞募集至感染部位，防止微生物传播；调节适应性免疫反应，包括免疫激活和免疫记忆；调控效应细胞功能和在外周组织的存活。\n","slug":"免疫基础知识","published":1,"updated":"2023-05-20T06:31:16.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm4peu6n0000ldbzr66wdh28k","content":"<h2 id=\"免疫细胞\"><a class=\"markdownIt-Anchor\" href=\"#免疫细胞\"></a> 免疫细胞</h2>\n<h3 id=\"treg的分类和功能\"><a class=\"markdownIt-Anchor\" href=\"#treg的分类和功能\"></a> Treg的分类和功能</h3>\n<p>Treg是T细胞的一个子集， 占<strong>CD4+T细胞</strong>总数的5-10%，具有<span style=\"background:#FF9999;\">维持体内平衡</span>和<span style=\"background:#FF9999;\">预防自身免疫</span>的功能，其特征是<strong>CD4</strong>、<strong>CD25</strong>、<strong>FOXP3</strong>和低水平<strong>CD127</strong>的共同表达。高水平的FOXP3和特异性去甲基化区域（TSDR）的去甲基化是Treg的显著特征，TSDR是FOXP3基因中的一个保守区域。</p>\n<p>Tregs可分为两类：<u>天然调节性T细胞（nTregs）</u>和<u>诱导调节性T细胞（iTregs）</u>。两种类型的Tregs都普遍表达 Foxp3。</p>\n<ul>\n<li>\n<p>nTregs在胸腺中自然发育，其抑制作用是通过细胞间接触实现的，它们的主要功能是维持正常的免疫耐受和控制炎症反应。</p>\n</li>\n<li>\n<p>iTregs来源于肿瘤微环境信号诱导的外周原始T细胞，包括肿瘤抗原、细胞因子（如IL-10, TGF-β）和其他可溶性分子。iTregs通过多种促进肿瘤进展的机制抑制效应T细胞（Teff）、NK细胞和DC的抗肿瘤免疫作用。</p>\n</li>\n</ul>\n<p>Tregs主要有以下五种功能机制：</p>\n<ul>\n<li>\n<p>Tregs分泌抑制性细胞因子，包括 IL-10、TGF-β 和 IL-35。</p>\n</li>\n<li>\n<p>Tregs 通过颗粒酶和穿孔素杀死效应细胞。</p>\n</li>\n<li>\n<p>Tregs 影响效应细胞的功能：Treg 与效应T细胞竞争消耗 IL-2，从而抑制效应T细胞的生长；Tregs通过产生胞外酶CD39和CD73 促进TME中腺苷的产生，诱效应细胞导的抑制和抗增殖作用；Tregs通过缝隙连接将大量 cAMP 转移到效应T细胞，干扰其代谢。</p>\n</li>\n<li>\n<p>Tregs通过刺激性和抑制性受体（CTLA-4 或 LAG3）诱导DC耐受，后者通过IDO进一步抑制T细胞的能力。</p>\n</li>\n<li>\n<p>MDSCs和Tregs 产生的因子形成正反馈环，促进增殖，增强抑制环境。</p>\n</li>\n</ul>\n<h2 id=\"免疫分子\"><a class=\"markdownIt-Anchor\" href=\"#免疫分子\"></a> 免疫分子</h2>\n<h3 id=\"趋化因子\"><a class=\"markdownIt-Anchor\" href=\"#趋化因子\"></a> 趋化因子</h3>\n<p>趋化因子是一组低分子量（约8~12kDa）的细胞因子，调节免疫细胞的运输与分化，是免疫系统功能行使的核心。基于其主要蛋白质结构的前两个半胱氨酸残基的位置，可分为4个不同的亚家族：<strong>C、CC、CXC、CX3C</strong>。基于其功能，可分为<u>内稳态趋化因子</u>和<u>炎症趋化因子</u>。</p>\n<p>主要功能</p>\n<ul>\n<li>\n<p>器官发育：在器官发育和血管生成过程中引导干细胞迁移到适当的位置；介导细胞增殖；介导淋巴细胞的成熟。</p>\n</li>\n<li>\n<p>免疫监视：介导免疫细胞在健康外周组织中的稳态，维持免疫耐受。</p>\n</li>\n<li>\n<p>组织更新再生：引导干细胞和祖细胞迁移，以促进损伤后的组织更新或再生；促进愈合过程中的血管生成；促进上皮、内皮、间充质的愈合。</p>\n</li>\n<li>\n<p>宿主防御：促进先天免疫细胞募集至感染部位，防止微生物传播；调节适应性免疫反应，包括免疫激活和免疫记忆；调控效应细胞功能和在外周组织的存活。</p>\n</li>\n</ul>\n","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":797,"excerpt":"","more":"<h2 id=\"免疫细胞\"><a class=\"markdownIt-Anchor\" href=\"#免疫细胞\"></a> 免疫细胞</h2>\n<h3 id=\"treg的分类和功能\"><a class=\"markdownIt-Anchor\" href=\"#treg的分类和功能\"></a> Treg的分类和功能</h3>\n<p>Treg是T细胞的一个子集， 占<strong>CD4+T细胞</strong>总数的5-10%，具有<span style=\"background:#FF9999;\">维持体内平衡</span>和<span style=\"background:#FF9999;\">预防自身免疫</span>的功能，其特征是<strong>CD4</strong>、<strong>CD25</strong>、<strong>FOXP3</strong>和低水平<strong>CD127</strong>的共同表达。高水平的FOXP3和特异性去甲基化区域（TSDR）的去甲基化是Treg的显著特征，TSDR是FOXP3基因中的一个保守区域。</p>\n<p>Tregs可分为两类：<u>天然调节性T细胞（nTregs）</u>和<u>诱导调节性T细胞（iTregs）</u>。两种类型的Tregs都普遍表达 Foxp3。</p>\n<ul>\n<li>\n<p>nTregs在胸腺中自然发育，其抑制作用是通过细胞间接触实现的，它们的主要功能是维持正常的免疫耐受和控制炎症反应。</p>\n</li>\n<li>\n<p>iTregs来源于肿瘤微环境信号诱导的外周原始T细胞，包括肿瘤抗原、细胞因子（如IL-10, TGF-β）和其他可溶性分子。iTregs通过多种促进肿瘤进展的机制抑制效应T细胞（Teff）、NK细胞和DC的抗肿瘤免疫作用。</p>\n</li>\n</ul>\n<p>Tregs主要有以下五种功能机制：</p>\n<ul>\n<li>\n<p>Tregs分泌抑制性细胞因子，包括 IL-10、TGF-β 和 IL-35。</p>\n</li>\n<li>\n<p>Tregs 通过颗粒酶和穿孔素杀死效应细胞。</p>\n</li>\n<li>\n<p>Tregs 影响效应细胞的功能：Treg 与效应T细胞竞争消耗 IL-2，从而抑制效应T细胞的生长；Tregs通过产生胞外酶CD39和CD73 促进TME中腺苷的产生，诱效应细胞导的抑制和抗增殖作用；Tregs通过缝隙连接将大量 cAMP 转移到效应T细胞，干扰其代谢。</p>\n</li>\n<li>\n<p>Tregs通过刺激性和抑制性受体（CTLA-4 或 LAG3）诱导DC耐受，后者通过IDO进一步抑制T细胞的能力。</p>\n</li>\n<li>\n<p>MDSCs和Tregs 产生的因子形成正反馈环，促进增殖，增强抑制环境。</p>\n</li>\n</ul>\n<h2 id=\"免疫分子\"><a class=\"markdownIt-Anchor\" href=\"#免疫分子\"></a> 免疫分子</h2>\n<h3 id=\"趋化因子\"><a class=\"markdownIt-Anchor\" href=\"#趋化因子\"></a> 趋化因子</h3>\n<p>趋化因子是一组低分子量（约8~12kDa）的细胞因子，调节免疫细胞的运输与分化，是免疫系统功能行使的核心。基于其主要蛋白质结构的前两个半胱氨酸残基的位置，可分为4个不同的亚家族：<strong>C、CC、CXC、CX3C</strong>。基于其功能，可分为<u>内稳态趋化因子</u>和<u>炎症趋化因子</u>。</p>\n<p>主要功能</p>\n<ul>\n<li>\n<p>器官发育：在器官发育和血管生成过程中引导干细胞迁移到适当的位置；介导细胞增殖；介导淋巴细胞的成熟。</p>\n</li>\n<li>\n<p>免疫监视：介导免疫细胞在健康外周组织中的稳态，维持免疫耐受。</p>\n</li>\n<li>\n<p>组织更新再生：引导干细胞和祖细胞迁移，以促进损伤后的组织更新或再生；促进愈合过程中的血管生成；促进上皮、内皮、间充质的愈合。</p>\n</li>\n<li>\n<p>宿主防御：促进先天免疫细胞募集至感染部位，防止微生物传播；调节适应性免疫反应，包括免疫激活和免疫记忆；调控效应细胞功能和在外周组织的存活。</p>\n</li>\n</ul>\n"},{"title":"tmux安装教程","abbrlink":"686264ec","date":"2023-05-18T02:13:10.000Z","_content":"\n## tmux 简介\n\ntmux 是一个 terminal multiplexer（终端复用器），它可以启动一系列终端会话。\n简单来说，安装 tmux 之前，一旦**与服务器断开连接**或者**关闭 xhell 或其他 shell 终端**，我们的服务器上运行的程序就会终止，而且输入的历史消息全部消失。因此如果我们希望整晚在服务器上跑代码，我们的电脑也要整晚一直连接着服务器。而安装了 tmux 之后，即使我们关闭了 shell 终端或者不幸与服务器断开连接，我们在服务器上的程序**依然在运行**。\n\n## tmux 安装\n\n* root 用户安装一行命令\n\n    ```bash\n    sodu apt-get install tmux\n    ```\n\n* 非 root 用户需要下载源码安装\n\n    * **下载**：\n\n        ```bash\n        ### 下载 tmux 及其依赖软件\n        wget -c https://github.com/tmux/tmux/releases/download/3.0a/tmux-3.0a.tar.gz\n        wget -c https://github.com/libevent/libevent/releases/download/release-2.1.11-stable/libevent-2.1.11-stable.tar.gz\n        wget -c https://ftp.gnu.org/gnu/ncurses/ncurses-6.2.tar.gz\n        ```\n\n    * **解压**\n\n        ```bash\n        tar -xzvf tmux-3.0a.tar.gz\n        tar -xzvf libevent-2.1.11-stable.tar.gz\n        tar -xzvf ncurses-6.2.tar.gz\n        ```\n\n    * **分别源码安装，先安装两个依赖包**\n\n        * libevent 会安在 /tmux_depend / lib\n\n            ```bash\n            cd  libevent-2.1.11-stable\n            #$HOME/tmux_depend是我的安装路径，大家可以修改\n            ./configure --prefix=/path/Tmux/tmux_depend --disable-shared\n            make && make install\n            ```\n\n        * ncurses 会安在 /tmux_depend / include\n\n            ```bash\n            cd  ncurses-6.2\n            ./configure --prefix=/path/Tmux/tmux_depend --disable-shared\n            make && make install\n            ```\n\n    * **安装 tmux**\n\n        ```bash\n        cd  tmux-3.3a\n        ./configure CFLAGS=\"-I/path/Tmux/tmux_depend/include -I/path/Tmux/tmux_depend/include/ncurses\" LDFLAGS=\"-L/path/Tmux/tmux_depend/lib -L/path/Tmux/tmux_depend/include/ncurses -L/path/Tmux/tmux_depend/include\"\n        make\n        cp tmux  /path/Tmux/tmux_depend/bin\n        ```\n\n## 设置环境变量\n\n```bash\nexport PATH=$HOME/tmux_depend/bin:$PATH\nsource ~/.bashrc\n```\n\n## tmux 常用命令\n\n```bash\n### 新建会话，比如新创建一个会话以\"ccc\"命名 tmn\ntmux new -s ccc\n加上参数-d，表示在后台新建会话\ntmux new -s shibo -d\n\n###　查看创建得所有会话 tml\ntmux ls\n\n### 登录一个已知会话,即从终端环境进入会话,第一个参数a也可以写成attach。后面的aaa是会话名称。tma\ntmux a -t aaa \n\n### 退出会话不是关闭：\n登到某一个会话后，先按键ctrl+b启动快捷键，再按d，这样就会退出该会话，但不会关闭会话。\n如果直接ctrl + d，就会在退出会话的通话也关闭了该会话！\n \n### 关闭会话（销毁会话） tmk\ntmux kill-session -t bbb\n\n### 重命名会话\ntmux rename -t wangshibo kevin\n```\n","source":"_posts/tmux安装教程.md","raw":"---\ntitle: tmux安装教程\ncategories:\n  - - tool\n    - linux\ntags:\n  - tool\n  - linux\nabbrlink: 686264ec\ndate: 2023-05-18 10:13:10\n---\n\n## tmux 简介\n\ntmux 是一个 terminal multiplexer（终端复用器），它可以启动一系列终端会话。\n简单来说，安装 tmux 之前，一旦**与服务器断开连接**或者**关闭 xhell 或其他 shell 终端**，我们的服务器上运行的程序就会终止，而且输入的历史消息全部消失。因此如果我们希望整晚在服务器上跑代码，我们的电脑也要整晚一直连接着服务器。而安装了 tmux 之后，即使我们关闭了 shell 终端或者不幸与服务器断开连接，我们在服务器上的程序**依然在运行**。\n\n## tmux 安装\n\n* root 用户安装一行命令\n\n    ```bash\n    sodu apt-get install tmux\n    ```\n\n* 非 root 用户需要下载源码安装\n\n    * **下载**：\n\n        ```bash\n        ### 下载 tmux 及其依赖软件\n        wget -c https://github.com/tmux/tmux/releases/download/3.0a/tmux-3.0a.tar.gz\n        wget -c https://github.com/libevent/libevent/releases/download/release-2.1.11-stable/libevent-2.1.11-stable.tar.gz\n        wget -c https://ftp.gnu.org/gnu/ncurses/ncurses-6.2.tar.gz\n        ```\n\n    * **解压**\n\n        ```bash\n        tar -xzvf tmux-3.0a.tar.gz\n        tar -xzvf libevent-2.1.11-stable.tar.gz\n        tar -xzvf ncurses-6.2.tar.gz\n        ```\n\n    * **分别源码安装，先安装两个依赖包**\n\n        * libevent 会安在 /tmux_depend / lib\n\n            ```bash\n            cd  libevent-2.1.11-stable\n            #$HOME/tmux_depend是我的安装路径，大家可以修改\n            ./configure --prefix=/path/Tmux/tmux_depend --disable-shared\n            make && make install\n            ```\n\n        * ncurses 会安在 /tmux_depend / include\n\n            ```bash\n            cd  ncurses-6.2\n            ./configure --prefix=/path/Tmux/tmux_depend --disable-shared\n            make && make install\n            ```\n\n    * **安装 tmux**\n\n        ```bash\n        cd  tmux-3.3a\n        ./configure CFLAGS=\"-I/path/Tmux/tmux_depend/include -I/path/Tmux/tmux_depend/include/ncurses\" LDFLAGS=\"-L/path/Tmux/tmux_depend/lib -L/path/Tmux/tmux_depend/include/ncurses -L/path/Tmux/tmux_depend/include\"\n        make\n        cp tmux  /path/Tmux/tmux_depend/bin\n        ```\n\n## 设置环境变量\n\n```bash\nexport PATH=$HOME/tmux_depend/bin:$PATH\nsource ~/.bashrc\n```\n\n## tmux 常用命令\n\n```bash\n### 新建会话，比如新创建一个会话以\"ccc\"命名 tmn\ntmux new -s ccc\n加上参数-d，表示在后台新建会话\ntmux new -s shibo -d\n\n###　查看创建得所有会话 tml\ntmux ls\n\n### 登录一个已知会话,即从终端环境进入会话,第一个参数a也可以写成attach。后面的aaa是会话名称。tma\ntmux a -t aaa \n\n### 退出会话不是关闭：\n登到某一个会话后，先按键ctrl+b启动快捷键，再按d，这样就会退出该会话，但不会关闭会话。\n如果直接ctrl + d，就会在退出会话的通话也关闭了该会话！\n \n### 关闭会话（销毁会话） tmk\ntmux kill-session -t bbb\n\n### 重命名会话\ntmux rename -t wangshibo kevin\n```\n","slug":"tmux安装教程","published":1,"updated":"2023-05-19T09:34:36.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm4peu6n0000mdbzr752x5417","content":"<h2 id=\"tmux-简介\"><a class=\"markdownIt-Anchor\" href=\"#tmux-简介\"></a> tmux 简介</h2>\n<p>tmux 是一个 terminal multiplexer（终端复用器），它可以启动一系列终端会话。<br />\n简单来说，安装 tmux 之前，一旦<strong>与服务器断开连接</strong>或者<strong>关闭 xhell 或其他 shell 终端</strong>，我们的服务器上运行的程序就会终止，而且输入的历史消息全部消失。因此如果我们希望整晚在服务器上跑代码，我们的电脑也要整晚一直连接着服务器。而安装了 tmux 之后，即使我们关闭了 shell 终端或者不幸与服务器断开连接，我们在服务器上的程序<strong>依然在运行</strong>。</p>\n<h2 id=\"tmux-安装\"><a class=\"markdownIt-Anchor\" href=\"#tmux-安装\"></a> tmux 安装</h2>\n<ul>\n<li>\n<p>root 用户安装一行命令</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sodu apt-get install tmux</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>非 root 用户需要下载源码安装</p>\n<ul>\n<li>\n<p><strong>下载</strong>：</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">### 下载 tmux 及其依赖软件</span></span><br><span class=\"line\">wget -c https://github.com/tmux/tmux/releases/download/3.0a/tmux-3.0a.tar.gz</span><br><span class=\"line\">wget -c https://github.com/libevent/libevent/releases/download/release-2.1.11-stable/libevent-2.1.11-stable.tar.gz</span><br><span class=\"line\">wget -c https://ftp.gnu.org/gnu/ncurses/ncurses-6.2.tar.gz</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p><strong>解压</strong></p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -xzvf tmux-3.0a.tar.gz</span><br><span class=\"line\">tar -xzvf libevent-2.1.11-stable.tar.gz</span><br><span class=\"line\">tar -xzvf ncurses-6.2.tar.gz</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p><strong>分别源码安装，先安装两个依赖包</strong></p>\n<ul>\n<li>\n<p>libevent 会安在 /tmux_depend / lib</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span>  libevent-2.1.11-stable</span><br><span class=\"line\"><span class=\"comment\">#$HOME/tmux_depend是我的安装路径，大家可以修改</span></span><br><span class=\"line\">./configure --prefix=/path/Tmux/tmux_depend --disable-shared</span><br><span class=\"line\">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>ncurses 会安在 /tmux_depend / include</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span>  ncurses-6.2</span><br><span class=\"line\">./configure --prefix=/path/Tmux/tmux_depend --disable-shared</span><br><span class=\"line\">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>安装 tmux</strong></p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span>  tmux-3.3a</span><br><span class=\"line\">./configure CFLAGS=<span class=\"string\">&quot;-I/path/Tmux/tmux_depend/include -I/path/Tmux/tmux_depend/include/ncurses&quot;</span> LDFLAGS=<span class=\"string\">&quot;-L/path/Tmux/tmux_depend/lib -L/path/Tmux/tmux_depend/include/ncurses -L/path/Tmux/tmux_depend/include&quot;</span></span><br><span class=\"line\">make</span><br><span class=\"line\"><span class=\"built_in\">cp</span> tmux  /path/Tmux/tmux_depend/bin</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"设置环境变量\"><a class=\"markdownIt-Anchor\" href=\"#设置环境变量\"></a> 设置环境变量</h2>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$HOME</span>/tmux_depend/bin:<span class=\"variable\">$PATH</span></span><br><span class=\"line\"><span class=\"built_in\">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>\n<h2 id=\"tmux-常用命令\"><a class=\"markdownIt-Anchor\" href=\"#tmux-常用命令\"></a> tmux 常用命令</h2>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">### 新建会话，比如新创建一个会话以&quot;ccc&quot;命名 tmn</span></span><br><span class=\"line\">tmux new -s ccc</span><br><span class=\"line\">加上参数-d，表示在后台新建会话</span><br><span class=\"line\">tmux new -s shibo -d</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">###　查看创建得所有会话 tml</span></span><br><span class=\"line\">tmux <span class=\"built_in\">ls</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 登录一个已知会话,即从终端环境进入会话,第一个参数a也可以写成attach。后面的aaa是会话名称。tma</span></span><br><span class=\"line\">tmux a -t aaa </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 退出会话不是关闭：</span></span><br><span class=\"line\">登到某一个会话后，先按键ctrl+b启动快捷键，再按d，这样就会退出该会话，但不会关闭会话。</span><br><span class=\"line\">如果直接ctrl + d，就会在退出会话的通话也关闭了该会话！</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">### 关闭会话（销毁会话） tmk</span></span><br><span class=\"line\">tmux kill-session -t bbb</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 重命名会话</span></span><br><span class=\"line\">tmux rename -t wangshibo kevin</span><br></pre></td></tr></table></figure>\n","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":581,"excerpt":"","more":"<h2 id=\"tmux-简介\"><a class=\"markdownIt-Anchor\" href=\"#tmux-简介\"></a> tmux 简介</h2>\n<p>tmux 是一个 terminal multiplexer（终端复用器），它可以启动一系列终端会话。<br />\n简单来说，安装 tmux 之前，一旦<strong>与服务器断开连接</strong>或者<strong>关闭 xhell 或其他 shell 终端</strong>，我们的服务器上运行的程序就会终止，而且输入的历史消息全部消失。因此如果我们希望整晚在服务器上跑代码，我们的电脑也要整晚一直连接着服务器。而安装了 tmux 之后，即使我们关闭了 shell 终端或者不幸与服务器断开连接，我们在服务器上的程序<strong>依然在运行</strong>。</p>\n<h2 id=\"tmux-安装\"><a class=\"markdownIt-Anchor\" href=\"#tmux-安装\"></a> tmux 安装</h2>\n<ul>\n<li>\n<p>root 用户安装一行命令</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sodu apt-get install tmux</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>非 root 用户需要下载源码安装</p>\n<ul>\n<li>\n<p><strong>下载</strong>：</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">### 下载 tmux 及其依赖软件</span></span><br><span class=\"line\">wget -c https://github.com/tmux/tmux/releases/download/3.0a/tmux-3.0a.tar.gz</span><br><span class=\"line\">wget -c https://github.com/libevent/libevent/releases/download/release-2.1.11-stable/libevent-2.1.11-stable.tar.gz</span><br><span class=\"line\">wget -c https://ftp.gnu.org/gnu/ncurses/ncurses-6.2.tar.gz</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p><strong>解压</strong></p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -xzvf tmux-3.0a.tar.gz</span><br><span class=\"line\">tar -xzvf libevent-2.1.11-stable.tar.gz</span><br><span class=\"line\">tar -xzvf ncurses-6.2.tar.gz</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p><strong>分别源码安装，先安装两个依赖包</strong></p>\n<ul>\n<li>\n<p>libevent 会安在 /tmux_depend / lib</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span>  libevent-2.1.11-stable</span><br><span class=\"line\"><span class=\"comment\">#$HOME/tmux_depend是我的安装路径，大家可以修改</span></span><br><span class=\"line\">./configure --prefix=/path/Tmux/tmux_depend --disable-shared</span><br><span class=\"line\">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>ncurses 会安在 /tmux_depend / include</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span>  ncurses-6.2</span><br><span class=\"line\">./configure --prefix=/path/Tmux/tmux_depend --disable-shared</span><br><span class=\"line\">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>安装 tmux</strong></p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span>  tmux-3.3a</span><br><span class=\"line\">./configure CFLAGS=<span class=\"string\">&quot;-I/path/Tmux/tmux_depend/include -I/path/Tmux/tmux_depend/include/ncurses&quot;</span> LDFLAGS=<span class=\"string\">&quot;-L/path/Tmux/tmux_depend/lib -L/path/Tmux/tmux_depend/include/ncurses -L/path/Tmux/tmux_depend/include&quot;</span></span><br><span class=\"line\">make</span><br><span class=\"line\"><span class=\"built_in\">cp</span> tmux  /path/Tmux/tmux_depend/bin</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"设置环境变量\"><a class=\"markdownIt-Anchor\" href=\"#设置环境变量\"></a> 设置环境变量</h2>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$HOME</span>/tmux_depend/bin:<span class=\"variable\">$PATH</span></span><br><span class=\"line\"><span class=\"built_in\">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>\n<h2 id=\"tmux-常用命令\"><a class=\"markdownIt-Anchor\" href=\"#tmux-常用命令\"></a> tmux 常用命令</h2>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">### 新建会话，比如新创建一个会话以&quot;ccc&quot;命名 tmn</span></span><br><span class=\"line\">tmux new -s ccc</span><br><span class=\"line\">加上参数-d，表示在后台新建会话</span><br><span class=\"line\">tmux new -s shibo -d</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">###　查看创建得所有会话 tml</span></span><br><span class=\"line\">tmux <span class=\"built_in\">ls</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 登录一个已知会话,即从终端环境进入会话,第一个参数a也可以写成attach。后面的aaa是会话名称。tma</span></span><br><span class=\"line\">tmux a -t aaa </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 退出会话不是关闭：</span></span><br><span class=\"line\">登到某一个会话后，先按键ctrl+b启动快捷键，再按d，这样就会退出该会话，但不会关闭会话。</span><br><span class=\"line\">如果直接ctrl + d，就会在退出会话的通话也关闭了该会话！</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">### 关闭会话（销毁会话） tmk</span></span><br><span class=\"line\">tmux kill-session -t bbb</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 重命名会话</span></span><br><span class=\"line\">tmux rename -t wangshibo kevin</span><br></pre></td></tr></table></figure>\n"},{"title":"如何通俗地理解Family-wise error rate(FWER)和False discovery rate(FDR)","katex":true,"abbrlink":"c61694ea","date":"2023-12-05T09:35:47.000Z","_content":"\n> 本文转载于网络， 原文地址：[如何通俗地理解Family-wise error rate(FWER)和False discovery rate(FDR)](https://blog.csdn.net/shengchaohua163/article/details/86738462)\n\n### 如何通俗地理解Family-wise error rate(FWER)和False discovery rate(FDR)\n\nFamily-wise error rate (FWER)，暂时还不了解比较通俗易懂的翻译。False discovery rate(FDR)，一般翻译为错误发现率。在研究使用假设检验解决机器学习中的分类问题时，我遇到了多重假设检验问题。FWER 和 FDR 正是解决这一问题的两种方法。经过老师和师兄师姐的指导，我能够将 FDR 应用于自己的问题当中，并且实验结果也有所改善。但是，应用之后，我仍然存在一些困惑，比如 FWER 和 FDR 到底是什么，FWER 和 FDR 怎么计算，为什么 FWER 和 FDR 能够降低错误率以及如何通俗地理解二者。\n\n为了搞清楚上述问题，我仔细研究了维基百科和网络上的一些资料，认为通俗地理解 FWER 和 FDR 不是一件容易的事。研究者首先需要有一定的统计学假设检验的基础，而且还能够将 FWER 和 FDR 应用于实际的问题。所以，我会从假设检验谈起，然后结合自己的问题进行探讨。\n\n#### 假设检验\n\n假设检验是用于检验统计假设的一种方法。它的基本思想是小概率思想，小概率思想是指小概率事件在一次试验中基本上不会发生。\n\n假设检验的基本方法是提出一个空假设（null hypothesis），也叫做原假设，记作 $H_0$​；然后得出感兴趣的备择假设（alternative hypothesis），记作 $H_1$​ 或 $H_A$​。空假设和备择假设的指导原则是空假设是不感兴趣对研究不重要的结论，而备择假设是我们感兴趣想要证明的结论。举个例子，给定人的一些身体指标数据，判断其是否存在某种疾病（比如肺炎）。\n\n $H_0$​：某人没病（我们不感兴趣）； $H_1$​​：某人有病（我们感兴趣）。将这些身体指标数据和已确定的或健康或有病的一些人的身体数据等样本信息比较，计算 p 值，一般指定显著性水平 α = 0.05 ，如果 p 值小于 0.05，表示这是一个小概率事件。根据小概率思想，我们与其相信这个小概率事件的发生，不如认为更为合理的选择是拒绝原假设，认为该人有病；否则无法拒绝原假设，即接受原假设，表示没有足够的证据认为该人有病。\n\n注：  \n\n1. 统计显著性：空假设为真的情况下拒绝零假设所要承担的风险水平，又叫概率水平。  \n2. p 值：假定空假设为真的情况下，得到相同样本结果或更极端结果的概率，是一个用来衡量统计显著性的重要指标。  \n3. 显著性水平 α ：空假设为真时，错误地拒绝空假设的概率。另外，也可以把这种概率理解成在假设检验中决策所面临的风险。  \n4. 比起计算 p 值，也可以计算统计量，根据显著性水平判断统计量是否落入拒绝域，进而决定是否拒绝原假设。统计量没有 p 值直观，所以采用 p 值进行表述。\n\n#### 使用假设检验解决分类问题\n\n沿用上一个例子，我们发现假设检验可以很自然地对应机器学习中的二分类问题：空假设为真对应着没病，空假设为假（备择假设为真）对应着有病。\n\n一次假设检验只能检验一个人，如果得到的 p 值小于显著性水平 α 就拒绝空假设，相当于把该人分为有病一类，而且可以称该次检验是显著的（significant）。如果得到的 p 值大于显著性水平 α 就不能拒绝空假设，相当于把该人分为没病一类。类似地，可以称该次检验是不显著的（non-significant）。一般把备择假设中的类别称为正类或阳性（positive），另一个类别称为反类或阴性（negative）。\n\n事实上，一个人可能没病（空假设为真）也可能有病（空假设为假，备择假设为真），一次检验可能被拒绝（显著）也可能不能被拒绝（不显著）。所以，一次检验有四种可能的结果，用下面的表格表示：\n\n<table><thead><tr><th></th><th> H0​​ is true</th><th> H0​​ is false ( H1​​ is true)</th></tr></thead><tbody><tr><td>Reject  H0​​(Test is declared significant)</td><td>Type I error (FP) (probability= α)</td><td>Correct inference (TP) (probability=1- β)</td></tr><tr><td>Fail to reject  H0​​(Test is declared non-significant)</td><td>Correct inference (TN) (probability=1- α)</td><td>Type II error (FN) (probability= β)</td></tr></tbody></table>\n\n*   Type I error，I 类错误，也叫做 α 错误\n*   Type II error，II 类错误，也叫做 β 错误\n*   FP: false positive，假正例，I 类错误\n*   FN: false negative，假反例，II 类错误\n*   TP: true positive，真正例\n*   TN: true negative，真反例\n\nI 类错误是指空假设为真却被我们拒绝的情况，犯这种错误的概率用 α 表示，所以也称为 α 错误或**弃真错误**；II 类错误是指空假设为假但我们没有拒绝的情况，犯这种错误的概率用 β 表示，所以也称为 β 错误或**取伪错误**。所以，空假设为真并且我们没有拒绝的概率用 1 − α 表示，空假设为假并被我们拒绝的概率用 1 − β 表示。\n\n> 自然，人们希望犯这两类错误的概率越小越好。但对于一定的样本量 n，不能同时做到犯这两类错误的概率都很小。如果减小 α 错误，就会增大犯 β 错误的机会；若减小 β 错误，就会增大犯 α 错误的机会。当然，使 α 和 β 同时减小的办法也有，那就是增大样本量。但样本量不可能没有限制，否则就会使抽样调查失去意义。因此，在假设检验中就有一个对两类错误进行控制的问题。  \n>\n> 一般来说，哪一类错误所带来的后果严重，危害越大，在假设检验中就应当把哪一类错误作为首要的控制目标。但在假设检验中，大家都在执行这样一个原则，那就是首先控制 α 错误。主要原因有两点，一方面，大家都遵循一个统一的原则，讨论问题比较方便。更主要的原因是，原假设一般是比较明确的，而备择假设常常是模糊的。对于一个含义清楚的假设和一个含义模糊的假设，我们更愿意接受前者。正是在这个背景下，我们就更关心如果原假设为真，而我们却把它拒绝了，犯这种错误的概率有多大。而这正是 α 错误的内容。 \n>\n> ——《统计学 - 贾俊平》第六版\n\n注：对于机器学习中的二分类问题，其分类结果也可以用类似的表格表示，一般被称为混淆矩阵，而且和上面的表格有些不同。\n\n<table><thead><tr><th></th><th>预测为正类</th><th>预测为反类</th></tr></thead><tbody><tr><td>实际是正类</td><td>真正例（TP）</td><td>假反例（FN）</td></tr><tr><td>实际是反类</td><td>假正例（FP）</td><td>真反例（TN）</td></tr></tbody></table>\n\n#### 多重假设检验和 FWER, FDR\n\n顾名思义，多重假设检验就是多个假设检验。如果有 m 个人需要检查是否有病，那么就需要进行 m 个假设检验。 m 个假设检验的结果可以表示为：\n\n<table><thead><tr><th></th><th> H0​ is true</th><th> H0​ is false ( H1​ is true)</th><th>Total</th></tr></thead><tbody><tr><td>Reject H0​(Test is declared significant)</td><td>V</td><td>S</td><td>R</td></tr><tr><td>Fail to reject H0​(Test is declared non-significant)</td><td>U</td><td>T</td><td>m−R</td></tr><tr><td>Total</td><td>m0​</td><td>m−m0​</td><td>m</td></tr></tbody></table>\n\n*   m 表示假设检验的个数\n*   m0​ 表示空假设为真的个数\n*   m−m0​ 表示备择假设为真的个数\n*   V  表示假正例的个数\n*   S 表示真正例的个数\n*   U 表示真反例的个数\n*   T 表示假反例的个数\n*   R = V + S 表示拒绝空假设的个数\n\n如果某次假设检验得到的 p 值小于显著性水平 α ，则拒绝空假设，主观上认为发现了一个有病的人（无论该人实际上真有病还是假有病），这种情况记为一次发现（discovery）。所以 R = V + S 表示发现的个数， V 表示错误发现（false discovery）的个数， S 表示正确发现（true discovery）的个数。用 Q 表示发现中错误发现的比例，即 Q = V / R = V / ( V + S ) 。 FWER 定义为 V 大于等于 1 的概率，即 FWER = Pr{ V ≥ 1 } = 1 − Pr{ V = 0 } 。FDR 定义为 Q 的期望，即 FDR = E[Q]。\n\n因为在 m 个检验中， V,S,U,T 都是随机变量，所以 FDR 需要用期望的形式来表示。另外，如果R=0，认为Q=0。为了包含这种情况，FDR=E[V/R∣R>0]⋅P{R>0}。通俗地理解，可以认为 FDR=Q=V/R=V/(V+S)。\n\nFWER 和 FDR 表示一种概念或一种方法，FWER 定义为多重假设检验中发现至少一个 I 类错误的概率，FDR 定义为多重假设检验中错误发现占所有发现的比例。另外，对应地，还存在 FWER 校正方法和 FDR 校正方法（也称为控制方法）。两类校正方法都是用来控制多重假设检验中犯 I 类错误的概率，使其低于显著性水平 α 。FWER 校正有多种实现，其中最经典的是 Bonferroni correction；FDR 校正也有多种实现，其中最经典的就是 Benjamini–Hochberg procedure。\n\n#### 为什么要使用 FWER 和 FDR 校正\n\n在一次假设检验中，我们使用显著性水平 α 和 p 值得出结论。显著性水平 α 一般取 0.05 或 0.01，可以保证一次假设检验中犯 I 类错误的概率和决策错误的风险小于 α 。\n\n但是在 m 次假设检验中，假设 m=100 和 α = 0.01 ，假设检验之间相互独立，不犯错误的概率为  $(1-0.01)^{100}$=36.6% ，而至少犯一次错误的概率高达$P=1-(1-0.01)^{100}$=1-0.366=63.4% 。举个实际的例子，假如有一种诊断艾滋病的试剂，试验验证其准确性为 99%（每 100 次诊断就有一次 false positive）。对于一个被检测的人来说（single test），这种准确性足够了。但对于医院来说（multiple test），这种准确性远远不够，因为每诊断 10000 个人，就会有 100 个非艾滋病病人被误诊为艾滋病。这显然是不能接受的。所以，对于多重检验，如果不进行任何控制，犯一类错误的概率便会随着假设检验的个数迅速增加。\n\nFWER 和 FDR 校正都可以使多重假设检验整体犯 I 类错误的概率低于预先设定的显著性水平 α 。FWER 显得较为保守，它主要是依靠减少假阳性的个数，同时也会减少 TDR(true discovery rate)。而 FDR 方法是一种更加新颖靠谱的方法，它会对每个测试用例使用校正后的 p 值（ q  值），达到了更好的效果：在检验出尽可能多的阳性结果的同时将错误发现率控制在可以接受的范围。\n\n#### 如何使用 FWER 和 FDR 校正\n\n注：FWER 校正和 FDR 校正均有多种实现，这里只介绍两类方法的经典实现。\n\n条件：在m次多重假设检验中，每一次的空假设记为$H_1$,$H_2$​,...,$H_m$​，对应 p 值记为$p_1$,$p_2$​,...,$p_m$​，设定显著性水平α。\n\nBonferroni correction，一般翻译为邦费罗尼校正。只要  $p_i$ ≤ $\\frac{α}{m}$，就拒绝 $H_i$。可以看出，Bonferroni correction 通过把显著性水平降低到$\\frac{α}{m}$。FWER 为发现至少一个 I 类错误的概率，即FWER=Pr{V≥1}，可证:\n\n$$\nFWER=Pr\\{\\bigcup_{i=1}^{m_0}(p_i\\leq\\frac{\\alpha}{m})\\}\\leq\\sum_{i=1}^{m_0}\\{Pr(p_i\\leq\\frac{\\alpha}{m})\\}=m_0\\frac{\\alpha}{m}\\leq m\\frac{\\alpha}{m}=\\alpha.\n$$\n这样就能控制多重假设检验整体犯 I 类错误的概率低于预先设定的显著性水平 α 。另外，FWER 控制不需要假设所有假设彼此之间相互独立，也不需要对空假设为真的个数有要求。\n\nBenjamini–Hochberg procedure，简称为 BH。首先对所有的 p 值从小到大排序，并记作$p_1$,$p_2$,...,$p_m$，其对应的空假设为$H_1$,$H_2$,...,$H_m$。若想控制 FDR 不超过 α ，需要找到最大的正整数 k，使得$P_{(k)}≤\\frac{k \\ast \\alpha}{m}$【公式 1】。然后，拒绝 1≤i≤k 时的所有空假设$H_1$,$H_2$,...,$H_k$。可以看出，BH 相当于对排序后的假设提供了不同的显著性水平。FDR 为 Q 的期望，即 FDR=E[Q]，可证：\n$$FDR=E[Q]\\leq\\frac{m_0}{m}α\\leqα$$\n这样就能从统计学上保证 FDR 不超过 α ，保证多重假设检验整体犯 I 类错误的概率低于预先设定的显著性水平 α 。另外，BH 是有效的条件是要求 m 个检验是相互独立的。\n\n最后再说一下 q  值 ( q -value)， $q=\\frac{P_{(k)} \\ast m}{K}$，相当于对【公式 1】进行变换，一般把 q  值叫做校正后的 p 值。至于 q  值有什么好处，我还没太搞明白。我自己研究的东西已经不需要更深入了，所以写到这里就结束了。\n\n参考资料：\n\n*   [False discovery rate - Wikipedia](https://en.wikipedia.org/wiki/False_discovery_rate)\n*   [Family-wise error rate - Wikipedia](https://en.wikipedia.org/wiki/Family-wise_error_rate)\n*   [如何通俗地解释错误发现率 FDR(false discovery rate)？](https://www.zhihu.com/question/35606197)\n*   [多重检验中的 FDR(false discovery rate, 错误发现率) 是什么？](http://sofasofa.io/forum_main_post.php?postid=1000461&)\n*   [生物信息学中多重检验问题的一个例子（FDR、p 值、q 值）](http://wap.sciencenet.cn/home.php?mod=space&uid=2827057&do=blog&id=968037)\n*   [p-value&FPR 以及 q-value&FDR](https://blog.csdn.net/sixu_9days/article/details/78992642)\n*   [多重假设检验校正为什么有效？](https://blog.csdn.net/a353833082/article/details/45530061)\n*   [《统计学 - 贾俊平》第六版](https://book.douban.com/subject/26375999/)\n","source":"_posts/如何通俗地理解Family-wise error rate(FWER)和False discovery rate(FDR).md","raw":"---\ntitle: 如何通俗地理解Family-wise error rate(FWER)和False discovery rate(FDR)\ncategories:\n  - Statistics\ntags:\n  - statistics\n  - knowledge\nkatex: true\nabbrlink: c61694ea\ndate: 2023-12-05 17:35:47\n---\n\n> 本文转载于网络， 原文地址：[如何通俗地理解Family-wise error rate(FWER)和False discovery rate(FDR)](https://blog.csdn.net/shengchaohua163/article/details/86738462)\n\n### 如何通俗地理解Family-wise error rate(FWER)和False discovery rate(FDR)\n\nFamily-wise error rate (FWER)，暂时还不了解比较通俗易懂的翻译。False discovery rate(FDR)，一般翻译为错误发现率。在研究使用假设检验解决机器学习中的分类问题时，我遇到了多重假设检验问题。FWER 和 FDR 正是解决这一问题的两种方法。经过老师和师兄师姐的指导，我能够将 FDR 应用于自己的问题当中，并且实验结果也有所改善。但是，应用之后，我仍然存在一些困惑，比如 FWER 和 FDR 到底是什么，FWER 和 FDR 怎么计算，为什么 FWER 和 FDR 能够降低错误率以及如何通俗地理解二者。\n\n为了搞清楚上述问题，我仔细研究了维基百科和网络上的一些资料，认为通俗地理解 FWER 和 FDR 不是一件容易的事。研究者首先需要有一定的统计学假设检验的基础，而且还能够将 FWER 和 FDR 应用于实际的问题。所以，我会从假设检验谈起，然后结合自己的问题进行探讨。\n\n#### 假设检验\n\n假设检验是用于检验统计假设的一种方法。它的基本思想是小概率思想，小概率思想是指小概率事件在一次试验中基本上不会发生。\n\n假设检验的基本方法是提出一个空假设（null hypothesis），也叫做原假设，记作 $H_0$​；然后得出感兴趣的备择假设（alternative hypothesis），记作 $H_1$​ 或 $H_A$​。空假设和备择假设的指导原则是空假设是不感兴趣对研究不重要的结论，而备择假设是我们感兴趣想要证明的结论。举个例子，给定人的一些身体指标数据，判断其是否存在某种疾病（比如肺炎）。\n\n $H_0$​：某人没病（我们不感兴趣）； $H_1$​​：某人有病（我们感兴趣）。将这些身体指标数据和已确定的或健康或有病的一些人的身体数据等样本信息比较，计算 p 值，一般指定显著性水平 α = 0.05 ，如果 p 值小于 0.05，表示这是一个小概率事件。根据小概率思想，我们与其相信这个小概率事件的发生，不如认为更为合理的选择是拒绝原假设，认为该人有病；否则无法拒绝原假设，即接受原假设，表示没有足够的证据认为该人有病。\n\n注：  \n\n1. 统计显著性：空假设为真的情况下拒绝零假设所要承担的风险水平，又叫概率水平。  \n2. p 值：假定空假设为真的情况下，得到相同样本结果或更极端结果的概率，是一个用来衡量统计显著性的重要指标。  \n3. 显著性水平 α ：空假设为真时，错误地拒绝空假设的概率。另外，也可以把这种概率理解成在假设检验中决策所面临的风险。  \n4. 比起计算 p 值，也可以计算统计量，根据显著性水平判断统计量是否落入拒绝域，进而决定是否拒绝原假设。统计量没有 p 值直观，所以采用 p 值进行表述。\n\n#### 使用假设检验解决分类问题\n\n沿用上一个例子，我们发现假设检验可以很自然地对应机器学习中的二分类问题：空假设为真对应着没病，空假设为假（备择假设为真）对应着有病。\n\n一次假设检验只能检验一个人，如果得到的 p 值小于显著性水平 α 就拒绝空假设，相当于把该人分为有病一类，而且可以称该次检验是显著的（significant）。如果得到的 p 值大于显著性水平 α 就不能拒绝空假设，相当于把该人分为没病一类。类似地，可以称该次检验是不显著的（non-significant）。一般把备择假设中的类别称为正类或阳性（positive），另一个类别称为反类或阴性（negative）。\n\n事实上，一个人可能没病（空假设为真）也可能有病（空假设为假，备择假设为真），一次检验可能被拒绝（显著）也可能不能被拒绝（不显著）。所以，一次检验有四种可能的结果，用下面的表格表示：\n\n<table><thead><tr><th></th><th> H0​​ is true</th><th> H0​​ is false ( H1​​ is true)</th></tr></thead><tbody><tr><td>Reject  H0​​(Test is declared significant)</td><td>Type I error (FP) (probability= α)</td><td>Correct inference (TP) (probability=1- β)</td></tr><tr><td>Fail to reject  H0​​(Test is declared non-significant)</td><td>Correct inference (TN) (probability=1- α)</td><td>Type II error (FN) (probability= β)</td></tr></tbody></table>\n\n*   Type I error，I 类错误，也叫做 α 错误\n*   Type II error，II 类错误，也叫做 β 错误\n*   FP: false positive，假正例，I 类错误\n*   FN: false negative，假反例，II 类错误\n*   TP: true positive，真正例\n*   TN: true negative，真反例\n\nI 类错误是指空假设为真却被我们拒绝的情况，犯这种错误的概率用 α 表示，所以也称为 α 错误或**弃真错误**；II 类错误是指空假设为假但我们没有拒绝的情况，犯这种错误的概率用 β 表示，所以也称为 β 错误或**取伪错误**。所以，空假设为真并且我们没有拒绝的概率用 1 − α 表示，空假设为假并被我们拒绝的概率用 1 − β 表示。\n\n> 自然，人们希望犯这两类错误的概率越小越好。但对于一定的样本量 n，不能同时做到犯这两类错误的概率都很小。如果减小 α 错误，就会增大犯 β 错误的机会；若减小 β 错误，就会增大犯 α 错误的机会。当然，使 α 和 β 同时减小的办法也有，那就是增大样本量。但样本量不可能没有限制，否则就会使抽样调查失去意义。因此，在假设检验中就有一个对两类错误进行控制的问题。  \n>\n> 一般来说，哪一类错误所带来的后果严重，危害越大，在假设检验中就应当把哪一类错误作为首要的控制目标。但在假设检验中，大家都在执行这样一个原则，那就是首先控制 α 错误。主要原因有两点，一方面，大家都遵循一个统一的原则，讨论问题比较方便。更主要的原因是，原假设一般是比较明确的，而备择假设常常是模糊的。对于一个含义清楚的假设和一个含义模糊的假设，我们更愿意接受前者。正是在这个背景下，我们就更关心如果原假设为真，而我们却把它拒绝了，犯这种错误的概率有多大。而这正是 α 错误的内容。 \n>\n> ——《统计学 - 贾俊平》第六版\n\n注：对于机器学习中的二分类问题，其分类结果也可以用类似的表格表示，一般被称为混淆矩阵，而且和上面的表格有些不同。\n\n<table><thead><tr><th></th><th>预测为正类</th><th>预测为反类</th></tr></thead><tbody><tr><td>实际是正类</td><td>真正例（TP）</td><td>假反例（FN）</td></tr><tr><td>实际是反类</td><td>假正例（FP）</td><td>真反例（TN）</td></tr></tbody></table>\n\n#### 多重假设检验和 FWER, FDR\n\n顾名思义，多重假设检验就是多个假设检验。如果有 m 个人需要检查是否有病，那么就需要进行 m 个假设检验。 m 个假设检验的结果可以表示为：\n\n<table><thead><tr><th></th><th> H0​ is true</th><th> H0​ is false ( H1​ is true)</th><th>Total</th></tr></thead><tbody><tr><td>Reject H0​(Test is declared significant)</td><td>V</td><td>S</td><td>R</td></tr><tr><td>Fail to reject H0​(Test is declared non-significant)</td><td>U</td><td>T</td><td>m−R</td></tr><tr><td>Total</td><td>m0​</td><td>m−m0​</td><td>m</td></tr></tbody></table>\n\n*   m 表示假设检验的个数\n*   m0​ 表示空假设为真的个数\n*   m−m0​ 表示备择假设为真的个数\n*   V  表示假正例的个数\n*   S 表示真正例的个数\n*   U 表示真反例的个数\n*   T 表示假反例的个数\n*   R = V + S 表示拒绝空假设的个数\n\n如果某次假设检验得到的 p 值小于显著性水平 α ，则拒绝空假设，主观上认为发现了一个有病的人（无论该人实际上真有病还是假有病），这种情况记为一次发现（discovery）。所以 R = V + S 表示发现的个数， V 表示错误发现（false discovery）的个数， S 表示正确发现（true discovery）的个数。用 Q 表示发现中错误发现的比例，即 Q = V / R = V / ( V + S ) 。 FWER 定义为 V 大于等于 1 的概率，即 FWER = Pr{ V ≥ 1 } = 1 − Pr{ V = 0 } 。FDR 定义为 Q 的期望，即 FDR = E[Q]。\n\n因为在 m 个检验中， V,S,U,T 都是随机变量，所以 FDR 需要用期望的形式来表示。另外，如果R=0，认为Q=0。为了包含这种情况，FDR=E[V/R∣R>0]⋅P{R>0}。通俗地理解，可以认为 FDR=Q=V/R=V/(V+S)。\n\nFWER 和 FDR 表示一种概念或一种方法，FWER 定义为多重假设检验中发现至少一个 I 类错误的概率，FDR 定义为多重假设检验中错误发现占所有发现的比例。另外，对应地，还存在 FWER 校正方法和 FDR 校正方法（也称为控制方法）。两类校正方法都是用来控制多重假设检验中犯 I 类错误的概率，使其低于显著性水平 α 。FWER 校正有多种实现，其中最经典的是 Bonferroni correction；FDR 校正也有多种实现，其中最经典的就是 Benjamini–Hochberg procedure。\n\n#### 为什么要使用 FWER 和 FDR 校正\n\n在一次假设检验中，我们使用显著性水平 α 和 p 值得出结论。显著性水平 α 一般取 0.05 或 0.01，可以保证一次假设检验中犯 I 类错误的概率和决策错误的风险小于 α 。\n\n但是在 m 次假设检验中，假设 m=100 和 α = 0.01 ，假设检验之间相互独立，不犯错误的概率为  $(1-0.01)^{100}$=36.6% ，而至少犯一次错误的概率高达$P=1-(1-0.01)^{100}$=1-0.366=63.4% 。举个实际的例子，假如有一种诊断艾滋病的试剂，试验验证其准确性为 99%（每 100 次诊断就有一次 false positive）。对于一个被检测的人来说（single test），这种准确性足够了。但对于医院来说（multiple test），这种准确性远远不够，因为每诊断 10000 个人，就会有 100 个非艾滋病病人被误诊为艾滋病。这显然是不能接受的。所以，对于多重检验，如果不进行任何控制，犯一类错误的概率便会随着假设检验的个数迅速增加。\n\nFWER 和 FDR 校正都可以使多重假设检验整体犯 I 类错误的概率低于预先设定的显著性水平 α 。FWER 显得较为保守，它主要是依靠减少假阳性的个数，同时也会减少 TDR(true discovery rate)。而 FDR 方法是一种更加新颖靠谱的方法，它会对每个测试用例使用校正后的 p 值（ q  值），达到了更好的效果：在检验出尽可能多的阳性结果的同时将错误发现率控制在可以接受的范围。\n\n#### 如何使用 FWER 和 FDR 校正\n\n注：FWER 校正和 FDR 校正均有多种实现，这里只介绍两类方法的经典实现。\n\n条件：在m次多重假设检验中，每一次的空假设记为$H_1$,$H_2$​,...,$H_m$​，对应 p 值记为$p_1$,$p_2$​,...,$p_m$​，设定显著性水平α。\n\nBonferroni correction，一般翻译为邦费罗尼校正。只要  $p_i$ ≤ $\\frac{α}{m}$，就拒绝 $H_i$。可以看出，Bonferroni correction 通过把显著性水平降低到$\\frac{α}{m}$。FWER 为发现至少一个 I 类错误的概率，即FWER=Pr{V≥1}，可证:\n\n$$\nFWER=Pr\\{\\bigcup_{i=1}^{m_0}(p_i\\leq\\frac{\\alpha}{m})\\}\\leq\\sum_{i=1}^{m_0}\\{Pr(p_i\\leq\\frac{\\alpha}{m})\\}=m_0\\frac{\\alpha}{m}\\leq m\\frac{\\alpha}{m}=\\alpha.\n$$\n这样就能控制多重假设检验整体犯 I 类错误的概率低于预先设定的显著性水平 α 。另外，FWER 控制不需要假设所有假设彼此之间相互独立，也不需要对空假设为真的个数有要求。\n\nBenjamini–Hochberg procedure，简称为 BH。首先对所有的 p 值从小到大排序，并记作$p_1$,$p_2$,...,$p_m$，其对应的空假设为$H_1$,$H_2$,...,$H_m$。若想控制 FDR 不超过 α ，需要找到最大的正整数 k，使得$P_{(k)}≤\\frac{k \\ast \\alpha}{m}$【公式 1】。然后，拒绝 1≤i≤k 时的所有空假设$H_1$,$H_2$,...,$H_k$。可以看出，BH 相当于对排序后的假设提供了不同的显著性水平。FDR 为 Q 的期望，即 FDR=E[Q]，可证：\n$$FDR=E[Q]\\leq\\frac{m_0}{m}α\\leqα$$\n这样就能从统计学上保证 FDR 不超过 α ，保证多重假设检验整体犯 I 类错误的概率低于预先设定的显著性水平 α 。另外，BH 是有效的条件是要求 m 个检验是相互独立的。\n\n最后再说一下 q  值 ( q -value)， $q=\\frac{P_{(k)} \\ast m}{K}$，相当于对【公式 1】进行变换，一般把 q  值叫做校正后的 p 值。至于 q  值有什么好处，我还没太搞明白。我自己研究的东西已经不需要更深入了，所以写到这里就结束了。\n\n参考资料：\n\n*   [False discovery rate - Wikipedia](https://en.wikipedia.org/wiki/False_discovery_rate)\n*   [Family-wise error rate - Wikipedia](https://en.wikipedia.org/wiki/Family-wise_error_rate)\n*   [如何通俗地解释错误发现率 FDR(false discovery rate)？](https://www.zhihu.com/question/35606197)\n*   [多重检验中的 FDR(false discovery rate, 错误发现率) 是什么？](http://sofasofa.io/forum_main_post.php?postid=1000461&)\n*   [生物信息学中多重检验问题的一个例子（FDR、p 值、q 值）](http://wap.sciencenet.cn/home.php?mod=space&uid=2827057&do=blog&id=968037)\n*   [p-value&FPR 以及 q-value&FDR](https://blog.csdn.net/sixu_9days/article/details/78992642)\n*   [多重假设检验校正为什么有效？](https://blog.csdn.net/a353833082/article/details/45530061)\n*   [《统计学 - 贾俊平》第六版](https://book.douban.com/subject/26375999/)\n","slug":"如何通俗地理解Family-wise error rate(FWER)和False discovery rate(FDR)","published":1,"updated":"2023-12-05T10:38:26.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm4peu6n0000pdbzr1j7c5uzz","content":"<blockquote>\n<p>本文转载于网络， 原文地址：<a href=\"https://blog.csdn.net/shengchaohua163/article/details/86738462\">如何通俗地理解Family-wise error rate(FWER)和False discovery rate(FDR)</a></p>\n</blockquote>\n<h3 id=\"如何通俗地理解family-wise-error-ratefwer和false-discovery-ratefdr\"><a class=\"markdownIt-Anchor\" href=\"#如何通俗地理解family-wise-error-ratefwer和false-discovery-ratefdr\"></a> 如何通俗地理解Family-wise error rate(FWER)和False discovery rate(FDR)</h3>\n<p>Family-wise error rate (FWER)，暂时还不了解比较通俗易懂的翻译。False discovery rate(FDR)，一般翻译为错误发现率。在研究使用假设检验解决机器学习中的分类问题时，我遇到了多重假设检验问题。FWER 和 FDR 正是解决这一问题的两种方法。经过老师和师兄师姐的指导，我能够将 FDR 应用于自己的问题当中，并且实验结果也有所改善。但是，应用之后，我仍然存在一些困惑，比如 FWER 和 FDR 到底是什么，FWER 和 FDR 怎么计算，为什么 FWER 和 FDR 能够降低错误率以及如何通俗地理解二者。</p>\n<p>为了搞清楚上述问题，我仔细研究了维基百科和网络上的一些资料，认为通俗地理解 FWER 和 FDR 不是一件容易的事。研究者首先需要有一定的统计学假设检验的基础，而且还能够将 FWER 和 FDR 应用于实际的问题。所以，我会从假设检验谈起，然后结合自己的问题进行探讨。</p>\n<h4 id=\"假设检验\"><a class=\"markdownIt-Anchor\" href=\"#假设检验\"></a> 假设检验</h4>\n<p>假设检验是用于检验统计假设的一种方法。它的基本思想是小概率思想，小概率思想是指小概率事件在一次试验中基本上不会发生。</p>\n<p>假设检验的基本方法是提出一个空假设（null hypothesis），也叫做原假设，记作 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>​；然后得出感兴趣的备择假设（alternative hypothesis），记作 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>​ 或 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mi>A</mi></msub></mrow><annotation encoding=\"application/x-tex\">H_A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>​。空假设和备择假设的指导原则是空假设是不感兴趣对研究不重要的结论，而备择假设是我们感兴趣想要证明的结论。举个例子，给定人的一些身体指标数据，判断其是否存在某种疾病（比如肺炎）。</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>​：某人没病（我们不感兴趣）； <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>​​：某人有病（我们感兴趣）。将这些身体指标数据和已确定的或健康或有病的一些人的身体数据等样本信息比较，计算 p 值，一般指定显著性水平 α = 0.05 ，如果 p 值小于 0.05，表示这是一个小概率事件。根据小概率思想，我们与其相信这个小概率事件的发生，不如认为更为合理的选择是拒绝原假设，认为该人有病；否则无法拒绝原假设，即接受原假设，表示没有足够的证据认为该人有病。</p>\n<p>注：</p>\n<ol>\n<li>统计显著性：空假设为真的情况下拒绝零假设所要承担的风险水平，又叫概率水平。</li>\n<li>p 值：假定空假设为真的情况下，得到相同样本结果或更极端结果的概率，是一个用来衡量统计显著性的重要指标。</li>\n<li>显著性水平 α ：空假设为真时，错误地拒绝空假设的概率。另外，也可以把这种概率理解成在假设检验中决策所面临的风险。</li>\n<li>比起计算 p 值，也可以计算统计量，根据显著性水平判断统计量是否落入拒绝域，进而决定是否拒绝原假设。统计量没有 p 值直观，所以采用 p 值进行表述。</li>\n</ol>\n<h4 id=\"使用假设检验解决分类问题\"><a class=\"markdownIt-Anchor\" href=\"#使用假设检验解决分类问题\"></a> 使用假设检验解决分类问题</h4>\n<p>沿用上一个例子，我们发现假设检验可以很自然地对应机器学习中的二分类问题：空假设为真对应着没病，空假设为假（备择假设为真）对应着有病。</p>\n<p>一次假设检验只能检验一个人，如果得到的 p 值小于显著性水平 α 就拒绝空假设，相当于把该人分为有病一类，而且可以称该次检验是显著的（significant）。如果得到的 p 值大于显著性水平 α 就不能拒绝空假设，相当于把该人分为没病一类。类似地，可以称该次检验是不显著的（non-significant）。一般把备择假设中的类别称为正类或阳性（positive），另一个类别称为反类或阴性（negative）。</p>\n<p>事实上，一个人可能没病（空假设为真）也可能有病（空假设为假，备择假设为真），一次检验可能被拒绝（显著）也可能不能被拒绝（不显著）。所以，一次检验有四种可能的结果，用下面的表格表示：</p>\n<table><thead><tr><th></th><th> H0​​ is true</th><th> H0​​ is false ( H1​​ is true)</th></tr></thead><tbody><tr><td>Reject  H0​​(Test is declared significant)</td><td>Type I error (FP) (probability= α)</td><td>Correct inference (TP) (probability=1- β)</td></tr><tr><td>Fail to reject  H0​​(Test is declared non-significant)</td><td>Correct inference (TN) (probability=1- α)</td><td>Type II error (FN) (probability= β)</td></tr></tbody></table>\n<ul>\n<li>Type I error，I 类错误，也叫做 α 错误</li>\n<li>Type II error，II 类错误，也叫做 β 错误</li>\n<li>FP: false positive，假正例，I 类错误</li>\n<li>FN: false negative，假反例，II 类错误</li>\n<li>TP: true positive，真正例</li>\n<li>TN: true negative，真反例</li>\n</ul>\n<p>I 类错误是指空假设为真却被我们拒绝的情况，犯这种错误的概率用 α 表示，所以也称为 α 错误或<strong>弃真错误</strong>；II 类错误是指空假设为假但我们没有拒绝的情况，犯这种错误的概率用 β 表示，所以也称为 β 错误或<strong>取伪错误</strong>。所以，空假设为真并且我们没有拒绝的概率用 1 − α 表示，空假设为假并被我们拒绝的概率用 1 − β 表示。</p>\n<blockquote>\n<p>自然，人们希望犯这两类错误的概率越小越好。但对于一定的样本量 n，不能同时做到犯这两类错误的概率都很小。如果减小 α 错误，就会增大犯 β 错误的机会；若减小 β 错误，就会增大犯 α 错误的机会。当然，使 α 和 β 同时减小的办法也有，那就是增大样本量。但样本量不可能没有限制，否则就会使抽样调查失去意义。因此，在假设检验中就有一个对两类错误进行控制的问题。</p>\n<p>一般来说，哪一类错误所带来的后果严重，危害越大，在假设检验中就应当把哪一类错误作为首要的控制目标。但在假设检验中，大家都在执行这样一个原则，那就是首先控制 α 错误。主要原因有两点，一方面，大家都遵循一个统一的原则，讨论问题比较方便。更主要的原因是，原假设一般是比较明确的，而备择假设常常是模糊的。对于一个含义清楚的假设和一个含义模糊的假设，我们更愿意接受前者。正是在这个背景下，我们就更关心如果原假设为真，而我们却把它拒绝了，犯这种错误的概率有多大。而这正是 α 错误的内容。</p>\n<p>——《统计学 - 贾俊平》第六版</p>\n</blockquote>\n<p>注：对于机器学习中的二分类问题，其分类结果也可以用类似的表格表示，一般被称为混淆矩阵，而且和上面的表格有些不同。</p>\n<table><thead><tr><th></th><th>预测为正类</th><th>预测为反类</th></tr></thead><tbody><tr><td>实际是正类</td><td>真正例（TP）</td><td>假反例（FN）</td></tr><tr><td>实际是反类</td><td>假正例（FP）</td><td>真反例（TN）</td></tr></tbody></table>\n<h4 id=\"多重假设检验和-fwer-fdr\"><a class=\"markdownIt-Anchor\" href=\"#多重假设检验和-fwer-fdr\"></a> 多重假设检验和 FWER, FDR</h4>\n<p>顾名思义，多重假设检验就是多个假设检验。如果有 m 个人需要检查是否有病，那么就需要进行 m 个假设检验。 m 个假设检验的结果可以表示为：</p>\n<table><thead><tr><th></th><th> H0​ is true</th><th> H0​ is false ( H1​ is true)</th><th>Total</th></tr></thead><tbody><tr><td>Reject H0​(Test is declared significant)</td><td>V</td><td>S</td><td>R</td></tr><tr><td>Fail to reject H0​(Test is declared non-significant)</td><td>U</td><td>T</td><td>m−R</td></tr><tr><td>Total</td><td>m0​</td><td>m−m0​</td><td>m</td></tr></tbody></table>\n<ul>\n<li>m 表示假设检验的个数</li>\n<li>m0​ 表示空假设为真的个数</li>\n<li>m−m0​ 表示备择假设为真的个数</li>\n<li>V  表示假正例的个数</li>\n<li>S 表示真正例的个数</li>\n<li>U 表示真反例的个数</li>\n<li>T 表示假反例的个数</li>\n<li>R = V + S 表示拒绝空假设的个数</li>\n</ul>\n<p>如果某次假设检验得到的 p 值小于显著性水平 α ，则拒绝空假设，主观上认为发现了一个有病的人（无论该人实际上真有病还是假有病），这种情况记为一次发现（discovery）。所以 R = V + S 表示发现的个数， V 表示错误发现（false discovery）的个数， S 表示正确发现（true discovery）的个数。用 Q 表示发现中错误发现的比例，即 Q = V / R = V / ( V + S ) 。 FWER 定义为 V 大于等于 1 的概率，即 FWER = Pr{ V ≥ 1 } = 1 − Pr{ V = 0 } 。FDR 定义为 Q 的期望，即 FDR = E[Q]。</p>\n<p>因为在 m 个检验中， V,S,U,T 都是随机变量，所以 FDR 需要用期望的形式来表示。另外，如果R=0，认为Q=0。为了包含这种情况，FDR=E[V/R∣R&gt;0]⋅P{R&gt;0}。通俗地理解，可以认为 FDR=Q=V/R=V/(V+S)。</p>\n<p>FWER 和 FDR 表示一种概念或一种方法，FWER 定义为多重假设检验中发现至少一个 I 类错误的概率，FDR 定义为多重假设检验中错误发现占所有发现的比例。另外，对应地，还存在 FWER 校正方法和 FDR 校正方法（也称为控制方法）。两类校正方法都是用来控制多重假设检验中犯 I 类错误的概率，使其低于显著性水平 α 。FWER 校正有多种实现，其中最经典的是 Bonferroni correction；FDR 校正也有多种实现，其中最经典的就是 Benjamini–Hochberg procedure。</p>\n<h4 id=\"为什么要使用-fwer-和-fdr-校正\"><a class=\"markdownIt-Anchor\" href=\"#为什么要使用-fwer-和-fdr-校正\"></a> 为什么要使用 FWER 和 FDR 校正</h4>\n<p>在一次假设检验中，我们使用显著性水平 α 和 p 值得出结论。显著性水平 α 一般取 0.05 或 0.01，可以保证一次假设检验中犯 I 类错误的概率和决策错误的风险小于 α 。</p>\n<p>但是在 m 次假设检验中，假设 m=100 和 α = 0.01 ，假设检验之间相互独立，不犯错误的概率为  <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mn>0.01</mn><msup><mo stretchy=\"false\">)</mo><mn>100</mn></msup></mrow><annotation encoding=\"application/x-tex\">(1-0.01)^{100}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">0</span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span></span></span></span></span>=36.6% ，而至少犯一次错误的概率高达<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo>=</mo><mn>1</mn><mo>−</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mn>0.01</mn><msup><mo stretchy=\"false\">)</mo><mn>100</mn></msup></mrow><annotation encoding=\"application/x-tex\">P=1-(1-0.01)^{100}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">0</span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span></span></span></span></span>=1-0.366=63.4% 。举个实际的例子，假如有一种诊断艾滋病的试剂，试验验证其准确性为 99%（每 100 次诊断就有一次 false positive）。对于一个被检测的人来说（single test），这种准确性足够了。但对于医院来说（multiple test），这种准确性远远不够，因为每诊断 10000 个人，就会有 100 个非艾滋病病人被误诊为艾滋病。这显然是不能接受的。所以，对于多重检验，如果不进行任何控制，犯一类错误的概率便会随着假设检验的个数迅速增加。</p>\n<p>FWER 和 FDR 校正都可以使多重假设检验整体犯 I 类错误的概率低于预先设定的显著性水平 α 。FWER 显得较为保守，它主要是依靠减少假阳性的个数，同时也会减少 TDR(true discovery rate)。而 FDR 方法是一种更加新颖靠谱的方法，它会对每个测试用例使用校正后的 p 值（ q  值），达到了更好的效果：在检验出尽可能多的阳性结果的同时将错误发现率控制在可以接受的范围。</p>\n<h4 id=\"如何使用-fwer-和-fdr-校正\"><a class=\"markdownIt-Anchor\" href=\"#如何使用-fwer-和-fdr-校正\"></a> 如何使用 FWER 和 FDR 校正</h4>\n<p>注：FWER 校正和 FDR 校正均有多种实现，这里只介绍两类方法的经典实现。</p>\n<p>条件：在m次多重假设检验中，每一次的空假设记为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>​,…,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">H_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>​，对应 p 值记为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">p_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">p_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>​,…,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">p_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>​，设定显著性水平α。</p>\n<p>Bonferroni correction，一般翻译为邦费罗尼校正。只要  <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">p_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ≤ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mi>α</mi><mi>m</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{α}{m}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.040392em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.695392em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.0037em;\">α</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>，就拒绝 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">H_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>。可以看出，Bonferroni correction 通过把显著性水平降低到<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mi>α</mi><mi>m</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{α}{m}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.040392em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.695392em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.0037em;\">α</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>。FWER 为发现至少一个 I 类错误的概率，即FWER=Pr{V≥1}，可证:</p>\n<p class='katex-block'><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>F</mi><mi>W</mi><mi>E</mi><mi>R</mi><mo>=</mo><mi>P</mi><mi>r</mi><mo stretchy=\"false\">{</mo><munderover><mo>⋃</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>m</mi><mn>0</mn></msub></munderover><mo stretchy=\"false\">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo>≤</mo><mfrac><mi>α</mi><mi>m</mi></mfrac><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">}</mo><mo>≤</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>m</mi><mn>0</mn></msub></munderover><mo stretchy=\"false\">{</mo><mi>P</mi><mi>r</mi><mo stretchy=\"false\">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo>≤</mo><mfrac><mi>α</mi><mi>m</mi></mfrac><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">}</mo><mo>=</mo><msub><mi>m</mi><mn>0</mn></msub><mfrac><mi>α</mi><mi>m</mi></mfrac><mo>≤</mo><mi>m</mi><mfrac><mi>α</mi><mi>m</mi></mfrac><mo>=</mo><mi>α</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">FWER=Pr\\{\\bigcup_{i=1}^{m_0}(p_i\\leq\\frac{\\alpha}{m})\\}\\leq\\sum_{i=1}^{m_0}\\{Pr(p_i\\leq\\frac{\\alpha}{m})\\}=m_0\\frac{\\alpha}{m}\\leq m\\frac{\\alpha}{m}=\\alpha.\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.9401660000000005em;vertical-align:-1.277669em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mopen\">{</span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6624970000000003em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">⋃</span></span></span><span style=\"top:-4.311105em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7935600000000003em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span><span class=\"mclose\">}</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.9401660000000005em;vertical-align:-1.277669em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6624970000000003em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.311105em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mopen\">{</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7935600000000003em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span><span class=\"mclose\">}</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7935600000000003em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7935600000000003em;vertical-align:-0.686em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mord\">.</span></span></span></span></span></p>\n<p>这样就能控制多重假设检验整体犯 I 类错误的概率低于预先设定的显著性水平 α 。另外，FWER 控制不需要假设所有假设彼此之间相互独立，也不需要对空假设为真的个数有要求。</p>\n<p>Benjamini–Hochberg procedure，简称为 BH。首先对所有的 p 值从小到大排序，并记作<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">p_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">p_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>,…,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">p_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，其对应的空假设为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>,…,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">H_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>。若想控制 FDR 不超过 α ，需要找到最大的正整数 k，使得<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo>≤</mo><mfrac><mrow><mi>k</mi><mo>∗</mo><mi>α</mi></mrow><mi>m</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">P_{(k)}≤\\frac{k \\ast \\alpha}{m}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.03853em;vertical-align:-0.3551999999999999em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2251079999999999em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8801079999999999em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">∗</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.0037em;\">α</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>【公式 1】。然后，拒绝 1≤i≤k 时的所有空假设<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>,…,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">H_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>。可以看出，BH 相当于对排序后的假设提供了不同的显著性水平。FDR 为 Q 的期望，即 FDR=E[Q]，可证：</p>\n<p class='katex-block'><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>F</mi><mi>D</mi><mi>R</mi><mo>=</mo><mi>E</mi><mo stretchy=\"false\">[</mo><mi>Q</mi><mo stretchy=\"false\">]</mo><mo>≤</mo><mfrac><msub><mi>m</mi><mn>0</mn></msub><mi>m</mi></mfrac><mi>α</mi><mo>≤</mo><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">FDR=E[Q]\\leq\\frac{m_0}{m}α\\leqα\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">Q</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7935599999999998em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1075599999999999em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span></span></p>\n<p>这样就能从统计学上保证 FDR 不超过 α ，保证多重假设检验整体犯 I 类错误的概率低于预先设定的显著性水平 α 。另外，BH 是有效的条件是要求 m 个检验是相互独立的。</p>\n<p>最后再说一下 q  值 ( q -value)， <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi><mo>=</mo><mfrac><mrow><msub><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo>∗</mo><mi>m</mi></mrow><mi>K</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">q=\\frac{P_{(k)} \\ast m}{K}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.391971em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.046971em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.5686400000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3447999999999998em;margin-left:-0.13889em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5357142857142856em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3694857142857143em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">∗</span><span class=\"mord mathnormal mtight\">m</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>，相当于对【公式 1】进行变换，一般把 q  值叫做校正后的 p 值。至于 q  值有什么好处，我还没太搞明白。我自己研究的东西已经不需要更深入了，所以写到这里就结束了。</p>\n<p>参考资料：</p>\n<ul>\n<li><a href=\"https://en.wikipedia.org/wiki/False_discovery_rate\">False discovery rate - Wikipedia</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Family-wise_error_rate\">Family-wise error rate - Wikipedia</a></li>\n<li><a href=\"https://www.zhihu.com/question/35606197\">如何通俗地解释错误发现率 FDR(false discovery rate)？</a></li>\n<li><a href=\"http://sofasofa.io/forum_main_post.php?postid=1000461&amp;\">多重检验中的 FDR(false discovery rate, 错误发现率) 是什么？</a></li>\n<li><a href=\"http://wap.sciencenet.cn/home.php?mod=space&amp;uid=2827057&amp;do=blog&amp;id=968037\">生物信息学中多重检验问题的一个例子（FDR、p 值、q 值）</a></li>\n<li><a href=\"https://blog.csdn.net/sixu_9days/article/details/78992642\">p-value&amp;FPR 以及 q-value&amp;FDR</a></li>\n<li><a href=\"https://blog.csdn.net/a353833082/article/details/45530061\">多重假设检验校正为什么有效？</a></li>\n<li><a href=\"https://book.douban.com/subject/26375999/\">《统计学 - 贾俊平》第六版</a></li>\n</ul>\n","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":3634,"excerpt":"","more":"<blockquote>\n<p>本文转载于网络， 原文地址：<a href=\"https://blog.csdn.net/shengchaohua163/article/details/86738462\">如何通俗地理解Family-wise error rate(FWER)和False discovery rate(FDR)</a></p>\n</blockquote>\n<h3 id=\"如何通俗地理解family-wise-error-ratefwer和false-discovery-ratefdr\"><a class=\"markdownIt-Anchor\" href=\"#如何通俗地理解family-wise-error-ratefwer和false-discovery-ratefdr\"></a> 如何通俗地理解Family-wise error rate(FWER)和False discovery rate(FDR)</h3>\n<p>Family-wise error rate (FWER)，暂时还不了解比较通俗易懂的翻译。False discovery rate(FDR)，一般翻译为错误发现率。在研究使用假设检验解决机器学习中的分类问题时，我遇到了多重假设检验问题。FWER 和 FDR 正是解决这一问题的两种方法。经过老师和师兄师姐的指导，我能够将 FDR 应用于自己的问题当中，并且实验结果也有所改善。但是，应用之后，我仍然存在一些困惑，比如 FWER 和 FDR 到底是什么，FWER 和 FDR 怎么计算，为什么 FWER 和 FDR 能够降低错误率以及如何通俗地理解二者。</p>\n<p>为了搞清楚上述问题，我仔细研究了维基百科和网络上的一些资料，认为通俗地理解 FWER 和 FDR 不是一件容易的事。研究者首先需要有一定的统计学假设检验的基础，而且还能够将 FWER 和 FDR 应用于实际的问题。所以，我会从假设检验谈起，然后结合自己的问题进行探讨。</p>\n<h4 id=\"假设检验\"><a class=\"markdownIt-Anchor\" href=\"#假设检验\"></a> 假设检验</h4>\n<p>假设检验是用于检验统计假设的一种方法。它的基本思想是小概率思想，小概率思想是指小概率事件在一次试验中基本上不会发生。</p>\n<p>假设检验的基本方法是提出一个空假设（null hypothesis），也叫做原假设，记作 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>​；然后得出感兴趣的备择假设（alternative hypothesis），记作 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>​ 或 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mi>A</mi></msub></mrow><annotation encoding=\"application/x-tex\">H_A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>​。空假设和备择假设的指导原则是空假设是不感兴趣对研究不重要的结论，而备择假设是我们感兴趣想要证明的结论。举个例子，给定人的一些身体指标数据，判断其是否存在某种疾病（比如肺炎）。</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>​：某人没病（我们不感兴趣）； <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>​​：某人有病（我们感兴趣）。将这些身体指标数据和已确定的或健康或有病的一些人的身体数据等样本信息比较，计算 p 值，一般指定显著性水平 α = 0.05 ，如果 p 值小于 0.05，表示这是一个小概率事件。根据小概率思想，我们与其相信这个小概率事件的发生，不如认为更为合理的选择是拒绝原假设，认为该人有病；否则无法拒绝原假设，即接受原假设，表示没有足够的证据认为该人有病。</p>\n<p>注：</p>\n<ol>\n<li>统计显著性：空假设为真的情况下拒绝零假设所要承担的风险水平，又叫概率水平。</li>\n<li>p 值：假定空假设为真的情况下，得到相同样本结果或更极端结果的概率，是一个用来衡量统计显著性的重要指标。</li>\n<li>显著性水平 α ：空假设为真时，错误地拒绝空假设的概率。另外，也可以把这种概率理解成在假设检验中决策所面临的风险。</li>\n<li>比起计算 p 值，也可以计算统计量，根据显著性水平判断统计量是否落入拒绝域，进而决定是否拒绝原假设。统计量没有 p 值直观，所以采用 p 值进行表述。</li>\n</ol>\n<h4 id=\"使用假设检验解决分类问题\"><a class=\"markdownIt-Anchor\" href=\"#使用假设检验解决分类问题\"></a> 使用假设检验解决分类问题</h4>\n<p>沿用上一个例子，我们发现假设检验可以很自然地对应机器学习中的二分类问题：空假设为真对应着没病，空假设为假（备择假设为真）对应着有病。</p>\n<p>一次假设检验只能检验一个人，如果得到的 p 值小于显著性水平 α 就拒绝空假设，相当于把该人分为有病一类，而且可以称该次检验是显著的（significant）。如果得到的 p 值大于显著性水平 α 就不能拒绝空假设，相当于把该人分为没病一类。类似地，可以称该次检验是不显著的（non-significant）。一般把备择假设中的类别称为正类或阳性（positive），另一个类别称为反类或阴性（negative）。</p>\n<p>事实上，一个人可能没病（空假设为真）也可能有病（空假设为假，备择假设为真），一次检验可能被拒绝（显著）也可能不能被拒绝（不显著）。所以，一次检验有四种可能的结果，用下面的表格表示：</p>\n<table><thead><tr><th></th><th> H0​​ is true</th><th> H0​​ is false ( H1​​ is true)</th></tr></thead><tbody><tr><td>Reject  H0​​(Test is declared significant)</td><td>Type I error (FP) (probability= α)</td><td>Correct inference (TP) (probability=1- β)</td></tr><tr><td>Fail to reject  H0​​(Test is declared non-significant)</td><td>Correct inference (TN) (probability=1- α)</td><td>Type II error (FN) (probability= β)</td></tr></tbody></table>\n<ul>\n<li>Type I error，I 类错误，也叫做 α 错误</li>\n<li>Type II error，II 类错误，也叫做 β 错误</li>\n<li>FP: false positive，假正例，I 类错误</li>\n<li>FN: false negative，假反例，II 类错误</li>\n<li>TP: true positive，真正例</li>\n<li>TN: true negative，真反例</li>\n</ul>\n<p>I 类错误是指空假设为真却被我们拒绝的情况，犯这种错误的概率用 α 表示，所以也称为 α 错误或<strong>弃真错误</strong>；II 类错误是指空假设为假但我们没有拒绝的情况，犯这种错误的概率用 β 表示，所以也称为 β 错误或<strong>取伪错误</strong>。所以，空假设为真并且我们没有拒绝的概率用 1 − α 表示，空假设为假并被我们拒绝的概率用 1 − β 表示。</p>\n<blockquote>\n<p>自然，人们希望犯这两类错误的概率越小越好。但对于一定的样本量 n，不能同时做到犯这两类错误的概率都很小。如果减小 α 错误，就会增大犯 β 错误的机会；若减小 β 错误，就会增大犯 α 错误的机会。当然，使 α 和 β 同时减小的办法也有，那就是增大样本量。但样本量不可能没有限制，否则就会使抽样调查失去意义。因此，在假设检验中就有一个对两类错误进行控制的问题。</p>\n<p>一般来说，哪一类错误所带来的后果严重，危害越大，在假设检验中就应当把哪一类错误作为首要的控制目标。但在假设检验中，大家都在执行这样一个原则，那就是首先控制 α 错误。主要原因有两点，一方面，大家都遵循一个统一的原则，讨论问题比较方便。更主要的原因是，原假设一般是比较明确的，而备择假设常常是模糊的。对于一个含义清楚的假设和一个含义模糊的假设，我们更愿意接受前者。正是在这个背景下，我们就更关心如果原假设为真，而我们却把它拒绝了，犯这种错误的概率有多大。而这正是 α 错误的内容。</p>\n<p>——《统计学 - 贾俊平》第六版</p>\n</blockquote>\n<p>注：对于机器学习中的二分类问题，其分类结果也可以用类似的表格表示，一般被称为混淆矩阵，而且和上面的表格有些不同。</p>\n<table><thead><tr><th></th><th>预测为正类</th><th>预测为反类</th></tr></thead><tbody><tr><td>实际是正类</td><td>真正例（TP）</td><td>假反例（FN）</td></tr><tr><td>实际是反类</td><td>假正例（FP）</td><td>真反例（TN）</td></tr></tbody></table>\n<h4 id=\"多重假设检验和-fwer-fdr\"><a class=\"markdownIt-Anchor\" href=\"#多重假设检验和-fwer-fdr\"></a> 多重假设检验和 FWER, FDR</h4>\n<p>顾名思义，多重假设检验就是多个假设检验。如果有 m 个人需要检查是否有病，那么就需要进行 m 个假设检验。 m 个假设检验的结果可以表示为：</p>\n<table><thead><tr><th></th><th> H0​ is true</th><th> H0​ is false ( H1​ is true)</th><th>Total</th></tr></thead><tbody><tr><td>Reject H0​(Test is declared significant)</td><td>V</td><td>S</td><td>R</td></tr><tr><td>Fail to reject H0​(Test is declared non-significant)</td><td>U</td><td>T</td><td>m−R</td></tr><tr><td>Total</td><td>m0​</td><td>m−m0​</td><td>m</td></tr></tbody></table>\n<ul>\n<li>m 表示假设检验的个数</li>\n<li>m0​ 表示空假设为真的个数</li>\n<li>m−m0​ 表示备择假设为真的个数</li>\n<li>V  表示假正例的个数</li>\n<li>S 表示真正例的个数</li>\n<li>U 表示真反例的个数</li>\n<li>T 表示假反例的个数</li>\n<li>R = V + S 表示拒绝空假设的个数</li>\n</ul>\n<p>如果某次假设检验得到的 p 值小于显著性水平 α ，则拒绝空假设，主观上认为发现了一个有病的人（无论该人实际上真有病还是假有病），这种情况记为一次发现（discovery）。所以 R = V + S 表示发现的个数， V 表示错误发现（false discovery）的个数， S 表示正确发现（true discovery）的个数。用 Q 表示发现中错误发现的比例，即 Q = V / R = V / ( V + S ) 。 FWER 定义为 V 大于等于 1 的概率，即 FWER = Pr{ V ≥ 1 } = 1 − Pr{ V = 0 } 。FDR 定义为 Q 的期望，即 FDR = E[Q]。</p>\n<p>因为在 m 个检验中， V,S,U,T 都是随机变量，所以 FDR 需要用期望的形式来表示。另外，如果R=0，认为Q=0。为了包含这种情况，FDR=E[V/R∣R&gt;0]⋅P{R&gt;0}。通俗地理解，可以认为 FDR=Q=V/R=V/(V+S)。</p>\n<p>FWER 和 FDR 表示一种概念或一种方法，FWER 定义为多重假设检验中发现至少一个 I 类错误的概率，FDR 定义为多重假设检验中错误发现占所有发现的比例。另外，对应地，还存在 FWER 校正方法和 FDR 校正方法（也称为控制方法）。两类校正方法都是用来控制多重假设检验中犯 I 类错误的概率，使其低于显著性水平 α 。FWER 校正有多种实现，其中最经典的是 Bonferroni correction；FDR 校正也有多种实现，其中最经典的就是 Benjamini–Hochberg procedure。</p>\n<h4 id=\"为什么要使用-fwer-和-fdr-校正\"><a class=\"markdownIt-Anchor\" href=\"#为什么要使用-fwer-和-fdr-校正\"></a> 为什么要使用 FWER 和 FDR 校正</h4>\n<p>在一次假设检验中，我们使用显著性水平 α 和 p 值得出结论。显著性水平 α 一般取 0.05 或 0.01，可以保证一次假设检验中犯 I 类错误的概率和决策错误的风险小于 α 。</p>\n<p>但是在 m 次假设检验中，假设 m=100 和 α = 0.01 ，假设检验之间相互独立，不犯错误的概率为  <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mn>0.01</mn><msup><mo stretchy=\"false\">)</mo><mn>100</mn></msup></mrow><annotation encoding=\"application/x-tex\">(1-0.01)^{100}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">0</span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span></span></span></span></span>=36.6% ，而至少犯一次错误的概率高达<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo>=</mo><mn>1</mn><mo>−</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mn>0.01</mn><msup><mo stretchy=\"false\">)</mo><mn>100</mn></msup></mrow><annotation encoding=\"application/x-tex\">P=1-(1-0.01)^{100}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">0</span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span></span></span></span></span>=1-0.366=63.4% 。举个实际的例子，假如有一种诊断艾滋病的试剂，试验验证其准确性为 99%（每 100 次诊断就有一次 false positive）。对于一个被检测的人来说（single test），这种准确性足够了。但对于医院来说（multiple test），这种准确性远远不够，因为每诊断 10000 个人，就会有 100 个非艾滋病病人被误诊为艾滋病。这显然是不能接受的。所以，对于多重检验，如果不进行任何控制，犯一类错误的概率便会随着假设检验的个数迅速增加。</p>\n<p>FWER 和 FDR 校正都可以使多重假设检验整体犯 I 类错误的概率低于预先设定的显著性水平 α 。FWER 显得较为保守，它主要是依靠减少假阳性的个数，同时也会减少 TDR(true discovery rate)。而 FDR 方法是一种更加新颖靠谱的方法，它会对每个测试用例使用校正后的 p 值（ q  值），达到了更好的效果：在检验出尽可能多的阳性结果的同时将错误发现率控制在可以接受的范围。</p>\n<h4 id=\"如何使用-fwer-和-fdr-校正\"><a class=\"markdownIt-Anchor\" href=\"#如何使用-fwer-和-fdr-校正\"></a> 如何使用 FWER 和 FDR 校正</h4>\n<p>注：FWER 校正和 FDR 校正均有多种实现，这里只介绍两类方法的经典实现。</p>\n<p>条件：在m次多重假设检验中，每一次的空假设记为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>​,…,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">H_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>​，对应 p 值记为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">p_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">p_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>​,…,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">p_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>​，设定显著性水平α。</p>\n<p>Bonferroni correction，一般翻译为邦费罗尼校正。只要  <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">p_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ≤ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mi>α</mi><mi>m</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{α}{m}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.040392em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.695392em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.0037em;\">α</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>，就拒绝 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">H_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>。可以看出，Bonferroni correction 通过把显著性水平降低到<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mi>α</mi><mi>m</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{α}{m}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.040392em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.695392em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.0037em;\">α</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>。FWER 为发现至少一个 I 类错误的概率，即FWER=Pr{V≥1}，可证:</p>\n<p class='katex-block'><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>F</mi><mi>W</mi><mi>E</mi><mi>R</mi><mo>=</mo><mi>P</mi><mi>r</mi><mo stretchy=\"false\">{</mo><munderover><mo>⋃</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>m</mi><mn>0</mn></msub></munderover><mo stretchy=\"false\">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo>≤</mo><mfrac><mi>α</mi><mi>m</mi></mfrac><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">}</mo><mo>≤</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>m</mi><mn>0</mn></msub></munderover><mo stretchy=\"false\">{</mo><mi>P</mi><mi>r</mi><mo stretchy=\"false\">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo>≤</mo><mfrac><mi>α</mi><mi>m</mi></mfrac><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">}</mo><mo>=</mo><msub><mi>m</mi><mn>0</mn></msub><mfrac><mi>α</mi><mi>m</mi></mfrac><mo>≤</mo><mi>m</mi><mfrac><mi>α</mi><mi>m</mi></mfrac><mo>=</mo><mi>α</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">FWER=Pr\\{\\bigcup_{i=1}^{m_0}(p_i\\leq\\frac{\\alpha}{m})\\}\\leq\\sum_{i=1}^{m_0}\\{Pr(p_i\\leq\\frac{\\alpha}{m})\\}=m_0\\frac{\\alpha}{m}\\leq m\\frac{\\alpha}{m}=\\alpha.\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.9401660000000005em;vertical-align:-1.277669em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mopen\">{</span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6624970000000003em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">⋃</span></span></span><span style=\"top:-4.311105em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7935600000000003em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span><span class=\"mclose\">}</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.9401660000000005em;vertical-align:-1.277669em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6624970000000003em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.311105em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mopen\">{</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7935600000000003em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span><span class=\"mclose\">}</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7935600000000003em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7935600000000003em;vertical-align:-0.686em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mord\">.</span></span></span></span></span></p>\n<p>这样就能控制多重假设检验整体犯 I 类错误的概率低于预先设定的显著性水平 α 。另外，FWER 控制不需要假设所有假设彼此之间相互独立，也不需要对空假设为真的个数有要求。</p>\n<p>Benjamini–Hochberg procedure，简称为 BH。首先对所有的 p 值从小到大排序，并记作<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">p_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">p_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>,…,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">p_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，其对应的空假设为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>,…,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">H_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>。若想控制 FDR 不超过 α ，需要找到最大的正整数 k，使得<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo>≤</mo><mfrac><mrow><mi>k</mi><mo>∗</mo><mi>α</mi></mrow><mi>m</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">P_{(k)}≤\\frac{k \\ast \\alpha}{m}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.03853em;vertical-align:-0.3551999999999999em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2251079999999999em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8801079999999999em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">∗</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.0037em;\">α</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>【公式 1】。然后，拒绝 1≤i≤k 时的所有空假设<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>,…,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">H_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>。可以看出，BH 相当于对排序后的假设提供了不同的显著性水平。FDR 为 Q 的期望，即 FDR=E[Q]，可证：</p>\n<p class='katex-block'><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>F</mi><mi>D</mi><mi>R</mi><mo>=</mo><mi>E</mi><mo stretchy=\"false\">[</mo><mi>Q</mi><mo stretchy=\"false\">]</mo><mo>≤</mo><mfrac><msub><mi>m</mi><mn>0</mn></msub><mi>m</mi></mfrac><mi>α</mi><mo>≤</mo><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">FDR=E[Q]\\leq\\frac{m_0}{m}α\\leqα\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">Q</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7935599999999998em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1075599999999999em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span></span></p>\n<p>这样就能从统计学上保证 FDR 不超过 α ，保证多重假设检验整体犯 I 类错误的概率低于预先设定的显著性水平 α 。另外，BH 是有效的条件是要求 m 个检验是相互独立的。</p>\n<p>最后再说一下 q  值 ( q -value)， <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi><mo>=</mo><mfrac><mrow><msub><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo>∗</mo><mi>m</mi></mrow><mi>K</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">q=\\frac{P_{(k)} \\ast m}{K}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.391971em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.046971em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.5686400000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3447999999999998em;margin-left:-0.13889em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5357142857142856em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3694857142857143em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">∗</span><span class=\"mord mathnormal mtight\">m</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>，相当于对【公式 1】进行变换，一般把 q  值叫做校正后的 p 值。至于 q  值有什么好处，我还没太搞明白。我自己研究的东西已经不需要更深入了，所以写到这里就结束了。</p>\n<p>参考资料：</p>\n<ul>\n<li><a href=\"https://en.wikipedia.org/wiki/False_discovery_rate\">False discovery rate - Wikipedia</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Family-wise_error_rate\">Family-wise error rate - Wikipedia</a></li>\n<li><a href=\"https://www.zhihu.com/question/35606197\">如何通俗地解释错误发现率 FDR(false discovery rate)？</a></li>\n<li><a href=\"http://sofasofa.io/forum_main_post.php?postid=1000461&amp;\">多重检验中的 FDR(false discovery rate, 错误发现率) 是什么？</a></li>\n<li><a href=\"http://wap.sciencenet.cn/home.php?mod=space&amp;uid=2827057&amp;do=blog&amp;id=968037\">生物信息学中多重检验问题的一个例子（FDR、p 值、q 值）</a></li>\n<li><a href=\"https://blog.csdn.net/sixu_9days/article/details/78992642\">p-value&amp;FPR 以及 q-value&amp;FDR</a></li>\n<li><a href=\"https://blog.csdn.net/a353833082/article/details/45530061\">多重假设检验校正为什么有效？</a></li>\n<li><a href=\"https://book.douban.com/subject/26375999/\">《统计学 - 贾俊平》第六版</a></li>\n</ul>\n"},{"title":"生信常用文件格式","abbrlink":"86e006c4","date":"2023-08-01T02:51:09.000Z","_content":"\n# 生信常用文件格式\n\n### 序列格式\n\n- fasta\n    - 一种基于文本的、用于表示核苷酸序列或氨基酸序列的格式。在这种格式中碱基对或氨基酸用单个字母来表示，且允许在序列前添加序列名及注释，文件名常以`.fasta`、`.fa`结尾。\n    \n        > **常见后缀说明：**\n        `.fasta：`普通的FASTA文件 (包括：.fas、 .fasta、.fsa、.fst、.txt和.fa等)\n        `.fna：`表示核酸序列的 FASTA 文件\n        `.faa：`表示氨基酸序列的 FASTA 文件\n        `.ffn：`整个基因组编码区的 FASTA 文件\n        `.frn：`以 DNA 字母编码表示的基因组非编码 RNA 区 ( 如tRNA、rRNA ) 的 FASTA 文件\n    \n        <!--more-->\n    \n    - 格式说明\n      \n        ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2C7QE-Z9jpII-20230801.png)\n        \n        - 每条序列的第一行是由`>`开头的任意文字说明。用于序列标记，最好每条序列的标识具有唯一性，一般会用空格把头信息分为两个部分：第一部分是序列名字，它和大于号（>）紧接在一起；第二部分是注释信息，这个可以没有。\n        - 从第二行开始为序列本身，只允许使用既定的核苷酸或氨基酸编码符号，其中核苷酸大小写均可，氨基酸只能大写。\n    \n- fastq\n    - 一种基于文本的存储测序生物序列和**对应碱基（或氨基酸）质量**的文件格式，可以看成fasta文件的变种，一条序列总共包括四个部分。\n    - 格式说明\n      \n        ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2C6gJ-2bWdZi-20230801.png)\n        \n        ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2C4NX-xloCqX-20230801.png)\n        \n        - 第一行以“@”开头，随后为Illumina 测序标识符 (Sequence Identifiers) 和描述文字 (选择性部分)。\n        - 第二行是碱基序列。\n        - 第三行以“+”开头，随后为Illumina 测序标识符 (选择性部分)。\n        - 第四行是对应碱基的测序质量，该行中每个字符对应的 ASCII 值减去 33，即为对应第二行碱基的测序质量值。\n          \n            ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2C3Kc-w9fQdw-20230801.png)\n        \n    - 常用命令\n      \n        ```bash\n        echo \"`CL100189782_L01_read_1.fq.gz | wc -l` / (4*1000000)\" | bc -l\n        # 测序碱基数计算\n        zcat trt_N061011_1.fq.gz | awk'{if(FNR%4==0) base+=length}END{print base/10^9,\"G\";}'\n        ```\n        \n\n### 序列比对格式\n\n- fasta\n    - 最常见的多序列比对格式，和序列的fasta格式类似，只是为了使整体出现最大的可能性，在序列中可能会添加一些`-`。\n    - 格式说明\n      \n        ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BZQW-cXMLlL-20230801.png)\n    \n- clustal\n    - clustal格式的文件是纯文本格式，它可以选择有一个头来声明clustal版本号。接下来是多序列比对，以及关于比对中每个位置保存程度的可选信息。\n    - 格式说明\n      \n        ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BYpp-27jIGf-20230801.png)\n    \n- NEXUS\n    - 一种文本格式，使用“块”的方式来组织信息。以#NEXUS开头，后续说明了总体信息（包括序列数量，大小，数据类型，缺失数据等\n    - 格式说明\n      \n        ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BWjs-UbrEp5-20230801.png)\n    \n- PHYLIP\n    - 主要包括两个部分：一个标题描述对齐维度（序列数量和大小），后跟多序列对齐序列。\n    - 格式说明\n      \n        ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BSwR-mTGVf3-20230801.png)\n        \n\n### 常见文件格式\n\n- Genbank\n    - 最早的生物信息学数据格式之一，包含的信息十分全面，常以`.gbff`结尾\n    - 格式说明\n      \n        ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BR9o-WShI6Z-20230801.png)\n    \n- GFF和GTF\n    - GFF (General Feature Format) 和 GTF (Gene Transfer Format) 都是用于存储注释信息的文本类型。目前常用GFF格式为第二版本的GFF2和第三版本的GFF3，GTF常用GTF2。两者前8列是相同的，GTF格式相交GFF格式更加严格。以GFF3格式为例进行说明。\n    \n    - 常用命令\n      \n        ```bash\n        # grep 匹配查询 -v 输出不匹配的行\n        gunzip Homo_sapiens.GRCh38.94.gtf.gz -c |grep -v '^#' | sed '/^[^chr]/ s/^/chr/' >GRCh38.gtf\n        ```\n        \n    - 格式说明\n      \n        ```r\n        NZ_CP068034.2   RefSeq  region  1   6018586 .   +   .   ID=NZ_CP068034.2:1..6018586;Dbxref=taxon:317;Is_circular=true;Name=ANONYMOUS;collection-date=2001-05-30;country=Belarus: Minsk region;gbkey=Src;genome=chromosome;isolation-source=Ribes nigrum leaves;lat-lon=53.893009 N 27.567444 E;mol_type=genomic DNA;nat-host=Ribes nigrum;strain=BIM B-268\n        NZ_CP068034.2   RefSeq  gene    1   1536    .   +   .   ID=gene-JJQ97_RS00005;Dbxref=GeneID:64441043;Name=dnaA;gbkey=Gene;gene=dnaA;gene_biotype=protein_coding;locus_tag=JJQ97_RS00005;old_locus_tag=JJQ97_25475\n        NZ_CP068034.2   Protein Homology    CDS 1   1536    .   +   0   ID=cds-WP_003437057.1;Parent=gene-JJQ97_RS00005;Dbxref=Genbank:WP_003437057.1,GeneID:64441043;Name=WP_003437057.1;gbkey=CDS;gene=dnaA;inference=COORDINATES: similar to AA sequence:RefSeq:NP_064721.1;locus_tag=JJQ97_RS00005;product=chromosomal replication initiator protein DnaA;protein_id=WP_003437057.1;transl_table=11\n        NZ_CP068034.2   RefSeq  gene    1575    2678    .   +   .   ID=gene-JJQ97_RS00010;Dbxref=GeneID:64441044;Name=dnaN;gbkey=Gene;gene=dnaN;gene_biotype=protein_coding;locus_tag=JJQ97_RS00010;old_locus_tag=JJQ97_25480\n        NZ_CP068034.2   Protein Homology    CDS 1575    2678    .   +   0   ID=cds-WP_201418908.1;Parent=gene-JJQ97_RS00010;Dbxref=Genbank:WP_201418908.1,GeneID:64441044;Name=WP_201418908.1;gbkey=CDS;gene=dnaN;inference=COORDINATES: similar to AA sequence:RefSeq:NP_064722.1;locus_tag=JJQ97_RS00010;product=DNA polymerase III subunit beta;protein_id=WP_201418908.1;transl_table=11\n        ```\n        \n        ```\n        seqname：序列定位，必须为染色体或组装好的\n        scaffoldsource：产生该GTF/GFF 文件的项目名称\n        feature：该段序列的特征：如 exon，CDS，enhancer等\n        start：序列起始位点\n        end：序列终止位点\n        score：得分值，如无得分，则为“.”\n        strand：正负链，用“+”和“-”表示，如不关心或者缺乏正负链信息，则为“.”\n        frame：开放阅读框，分别用0,1,2来区别，如果是非编码序列，则为“.”\n        ```\n        \n        相同点\n        feature：GTF的feature type受限于使用软件的规定，GFF的feature可以为任意内容。\n        \n        score：GTF的score一般不会被用到，都是“.”\n        \n        attribute：GTF的第九列为attribute，为序列对应的属性，其中的内容包括序列对应的 gene_id 和 transcript_id，一般还有序列中包含的外显子数量，在GFF3版本中第九列也为attribute，但不同属性中用“=”相隔，GTF格式中不同属性用“；”分隔\n        \n        group：GFF2的第九列为group，来自同一个组的不同序列都被具有相同的组名。\n        \n    \n- BED\n    - 分析过程中的bed文件一般代表区域信息\n    - 区别\n        - 表示基因注释时，gtf/gff和bed文件的区别\n            - gtf/gff文件一行表示一个exon/CDS等子区域，多行联合表示一个gene；bed文件一行表示一个gene\n            - gtf文件中碱基位置定位方式是1-based，而bed中碱基定位方式是0-based\n              \n                ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BOjr-f4u29t-20230801.png)\n        \n    - 格式说明\n        - **必须包含的3列信息：**\n            - chrom：染色体名字 (e.g.chr3, chrY, chr2_random或者scaffold10671)\n            - chromStart：基因在染色体或scaffold上的起始位置（0-based）\n            - chromEnd：基因在染色体或scaffold上的终止位置 （前闭后开）\n        - **可选的9列信息：**\n            - name：bed文件的行名\n            - score：本条基因在注释数据集文件中的评分（0-1000），在Genome Browser中会根据不同区段的评分显示对应的阴影强度（评分越高灰度越高）\n            - strand：链的方向`+`、`-`或`.` (`.`表示不确定链的方向)\n            - thickStart：CDS区（编码区）的起始位置，即起始密码子的位置。\n            - thickEnd：The endingposition at which the feature is drawn thickly (for example the stop codon ingene displays).\n            - itemRgb：RGB颜色值（如：255,0,0），方便在GenomeBrowser中查看\n            - blockCount：bed行中外显子的数目\n            - blockSizes：`逗号`分割的列，数目与blockCount值对应，每个数表示对应外显子的碱基数。\n            - blockStarts：`逗号`分割的列，数目与blockCount值对应，每个数表示对应外显子的起始位置（数值是相对ChromStart计算的）。\n    \n- SAM\n    - Alignment/Map步骤bwa/STAR/HISAT2等软件对结果的标准输出文件，**用于存储reads比对到参考基因组的比对结果**，是一个纯文本格式，文件一般较大。为了节省硬盘存储，一般使用其高效压缩的二进制格式`bam`文件。\n      \n        ```bash\n        # bam文件查看方式\n        samtools view filename.bam | less -S\n        samtools view -h filename.bam | less -S\n        \n        ###结果展示\n        @HD    VN:1.5  SO:coordinate\n        @SQ    SN:chr1 LN:248956422\n        @SQ    SN:chr10        LN:133797422\n        ......\n        @SQ    SN:chrKI270392.1        LN:971\n        @SQ    SN:chrKI270394.1        LN:970\n        @RG    ID:BH_H3K27ac_2 LB:BH_H3K27ac_2 SM:BH_H3K27ac_2\n        @PG    ID:bwa  PN:bwa  VN:0.7.15-r1140 CL:bwa mem -M -t 8 -R@RG\\tID:BH_H3K27ac_2\\tLB:BH_H3K27ac_2\\tSM:BH_H3K27ac_2\\tPL: /MP\n        @PG    ID:MarkDuplicates      VN:1.138(aa51703435dc6a423013e74e56b0b68405facd79_1439324166)   CL:picard.sam.markduplicates.\n        K00141:244:HVL3NBBXX:8:2119:27235:3145399      chr1    10016  32      115M    =      10016   115     CCCTAACCCTAACCCTAACCC\n        K00141:244:HVL3NBBXX:8:2119:27235:31453147     chr1    10016  32      115M    =      10016   -115   CCCTTACCCTAACCCTAACCC\n        \n        ```\n        \n    - 格式说明\n        - **header内容**\n            - @HD：是必须的标准文件头，包含版本信息；\n            - @SQ：参考序列染色体名字和长度信息 (SN:scaffold name; LN: length)；\n            - @RG：重要read group信息，通常包含测序平台，测序文库和样本ID等信息，分析时用于区分不同样本（重测序时用到）；\n            - @PG：生成此文件的操作过程和参数信息 (program)\n        - **record内容**\n          \n            ```html\n            1. read名称；\n            2. 比对信息位flag值；\n            3. 参考序列染色体编号；\n            4. 5′端起始位置；\n            5. MAPQ：mapping quality，描述比对的质量，数字越大，特异性越高；\n            6. CIGAR字符串，记录插入、删除、错配等信息；\n            7. 配对read所比对到的染色体，仅双端测序的数据才有；\n            8. 配对read所比对到的位置，仅双端测序的数据才有；\n            9. 插入片段的长度，仅双端测序的数据才有；\n            10. read序列；\n            11. read质量值；\n            12. 12列以后的信息都是metadata，程序用标记\n            ```\n            \n            ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BLPX-LrEqJc-20230801.png)\n    \n- BAM","source":"_posts/生信常用文件格式.md","raw":"---\ntitle: 生信常用文件格式\ncategories:\n  - notes\n  - bioinformatics\ntags:\n  - note\n  - bioinformatics\nabbrlink: 86e006c4\ndate: 2023-08-01 10:51:09\n---\n\n# 生信常用文件格式\n\n### 序列格式\n\n- fasta\n    - 一种基于文本的、用于表示核苷酸序列或氨基酸序列的格式。在这种格式中碱基对或氨基酸用单个字母来表示，且允许在序列前添加序列名及注释，文件名常以`.fasta`、`.fa`结尾。\n    \n        > **常见后缀说明：**\n        `.fasta：`普通的FASTA文件 (包括：.fas、 .fasta、.fsa、.fst、.txt和.fa等)\n        `.fna：`表示核酸序列的 FASTA 文件\n        `.faa：`表示氨基酸序列的 FASTA 文件\n        `.ffn：`整个基因组编码区的 FASTA 文件\n        `.frn：`以 DNA 字母编码表示的基因组非编码 RNA 区 ( 如tRNA、rRNA ) 的 FASTA 文件\n    \n        <!--more-->\n    \n    - 格式说明\n      \n        ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2C7QE-Z9jpII-20230801.png)\n        \n        - 每条序列的第一行是由`>`开头的任意文字说明。用于序列标记，最好每条序列的标识具有唯一性，一般会用空格把头信息分为两个部分：第一部分是序列名字，它和大于号（>）紧接在一起；第二部分是注释信息，这个可以没有。\n        - 从第二行开始为序列本身，只允许使用既定的核苷酸或氨基酸编码符号，其中核苷酸大小写均可，氨基酸只能大写。\n    \n- fastq\n    - 一种基于文本的存储测序生物序列和**对应碱基（或氨基酸）质量**的文件格式，可以看成fasta文件的变种，一条序列总共包括四个部分。\n    - 格式说明\n      \n        ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2C6gJ-2bWdZi-20230801.png)\n        \n        ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2C4NX-xloCqX-20230801.png)\n        \n        - 第一行以“@”开头，随后为Illumina 测序标识符 (Sequence Identifiers) 和描述文字 (选择性部分)。\n        - 第二行是碱基序列。\n        - 第三行以“+”开头，随后为Illumina 测序标识符 (选择性部分)。\n        - 第四行是对应碱基的测序质量，该行中每个字符对应的 ASCII 值减去 33，即为对应第二行碱基的测序质量值。\n          \n            ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2C3Kc-w9fQdw-20230801.png)\n        \n    - 常用命令\n      \n        ```bash\n        echo \"`CL100189782_L01_read_1.fq.gz | wc -l` / (4*1000000)\" | bc -l\n        # 测序碱基数计算\n        zcat trt_N061011_1.fq.gz | awk'{if(FNR%4==0) base+=length}END{print base/10^9,\"G\";}'\n        ```\n        \n\n### 序列比对格式\n\n- fasta\n    - 最常见的多序列比对格式，和序列的fasta格式类似，只是为了使整体出现最大的可能性，在序列中可能会添加一些`-`。\n    - 格式说明\n      \n        ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BZQW-cXMLlL-20230801.png)\n    \n- clustal\n    - clustal格式的文件是纯文本格式，它可以选择有一个头来声明clustal版本号。接下来是多序列比对，以及关于比对中每个位置保存程度的可选信息。\n    - 格式说明\n      \n        ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BYpp-27jIGf-20230801.png)\n    \n- NEXUS\n    - 一种文本格式，使用“块”的方式来组织信息。以#NEXUS开头，后续说明了总体信息（包括序列数量，大小，数据类型，缺失数据等\n    - 格式说明\n      \n        ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BWjs-UbrEp5-20230801.png)\n    \n- PHYLIP\n    - 主要包括两个部分：一个标题描述对齐维度（序列数量和大小），后跟多序列对齐序列。\n    - 格式说明\n      \n        ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BSwR-mTGVf3-20230801.png)\n        \n\n### 常见文件格式\n\n- Genbank\n    - 最早的生物信息学数据格式之一，包含的信息十分全面，常以`.gbff`结尾\n    - 格式说明\n      \n        ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BR9o-WShI6Z-20230801.png)\n    \n- GFF和GTF\n    - GFF (General Feature Format) 和 GTF (Gene Transfer Format) 都是用于存储注释信息的文本类型。目前常用GFF格式为第二版本的GFF2和第三版本的GFF3，GTF常用GTF2。两者前8列是相同的，GTF格式相交GFF格式更加严格。以GFF3格式为例进行说明。\n    \n    - 常用命令\n      \n        ```bash\n        # grep 匹配查询 -v 输出不匹配的行\n        gunzip Homo_sapiens.GRCh38.94.gtf.gz -c |grep -v '^#' | sed '/^[^chr]/ s/^/chr/' >GRCh38.gtf\n        ```\n        \n    - 格式说明\n      \n        ```r\n        NZ_CP068034.2   RefSeq  region  1   6018586 .   +   .   ID=NZ_CP068034.2:1..6018586;Dbxref=taxon:317;Is_circular=true;Name=ANONYMOUS;collection-date=2001-05-30;country=Belarus: Minsk region;gbkey=Src;genome=chromosome;isolation-source=Ribes nigrum leaves;lat-lon=53.893009 N 27.567444 E;mol_type=genomic DNA;nat-host=Ribes nigrum;strain=BIM B-268\n        NZ_CP068034.2   RefSeq  gene    1   1536    .   +   .   ID=gene-JJQ97_RS00005;Dbxref=GeneID:64441043;Name=dnaA;gbkey=Gene;gene=dnaA;gene_biotype=protein_coding;locus_tag=JJQ97_RS00005;old_locus_tag=JJQ97_25475\n        NZ_CP068034.2   Protein Homology    CDS 1   1536    .   +   0   ID=cds-WP_003437057.1;Parent=gene-JJQ97_RS00005;Dbxref=Genbank:WP_003437057.1,GeneID:64441043;Name=WP_003437057.1;gbkey=CDS;gene=dnaA;inference=COORDINATES: similar to AA sequence:RefSeq:NP_064721.1;locus_tag=JJQ97_RS00005;product=chromosomal replication initiator protein DnaA;protein_id=WP_003437057.1;transl_table=11\n        NZ_CP068034.2   RefSeq  gene    1575    2678    .   +   .   ID=gene-JJQ97_RS00010;Dbxref=GeneID:64441044;Name=dnaN;gbkey=Gene;gene=dnaN;gene_biotype=protein_coding;locus_tag=JJQ97_RS00010;old_locus_tag=JJQ97_25480\n        NZ_CP068034.2   Protein Homology    CDS 1575    2678    .   +   0   ID=cds-WP_201418908.1;Parent=gene-JJQ97_RS00010;Dbxref=Genbank:WP_201418908.1,GeneID:64441044;Name=WP_201418908.1;gbkey=CDS;gene=dnaN;inference=COORDINATES: similar to AA sequence:RefSeq:NP_064722.1;locus_tag=JJQ97_RS00010;product=DNA polymerase III subunit beta;protein_id=WP_201418908.1;transl_table=11\n        ```\n        \n        ```\n        seqname：序列定位，必须为染色体或组装好的\n        scaffoldsource：产生该GTF/GFF 文件的项目名称\n        feature：该段序列的特征：如 exon，CDS，enhancer等\n        start：序列起始位点\n        end：序列终止位点\n        score：得分值，如无得分，则为“.”\n        strand：正负链，用“+”和“-”表示，如不关心或者缺乏正负链信息，则为“.”\n        frame：开放阅读框，分别用0,1,2来区别，如果是非编码序列，则为“.”\n        ```\n        \n        相同点\n        feature：GTF的feature type受限于使用软件的规定，GFF的feature可以为任意内容。\n        \n        score：GTF的score一般不会被用到，都是“.”\n        \n        attribute：GTF的第九列为attribute，为序列对应的属性，其中的内容包括序列对应的 gene_id 和 transcript_id，一般还有序列中包含的外显子数量，在GFF3版本中第九列也为attribute，但不同属性中用“=”相隔，GTF格式中不同属性用“；”分隔\n        \n        group：GFF2的第九列为group，来自同一个组的不同序列都被具有相同的组名。\n        \n    \n- BED\n    - 分析过程中的bed文件一般代表区域信息\n    - 区别\n        - 表示基因注释时，gtf/gff和bed文件的区别\n            - gtf/gff文件一行表示一个exon/CDS等子区域，多行联合表示一个gene；bed文件一行表示一个gene\n            - gtf文件中碱基位置定位方式是1-based，而bed中碱基定位方式是0-based\n              \n                ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BOjr-f4u29t-20230801.png)\n        \n    - 格式说明\n        - **必须包含的3列信息：**\n            - chrom：染色体名字 (e.g.chr3, chrY, chr2_random或者scaffold10671)\n            - chromStart：基因在染色体或scaffold上的起始位置（0-based）\n            - chromEnd：基因在染色体或scaffold上的终止位置 （前闭后开）\n        - **可选的9列信息：**\n            - name：bed文件的行名\n            - score：本条基因在注释数据集文件中的评分（0-1000），在Genome Browser中会根据不同区段的评分显示对应的阴影强度（评分越高灰度越高）\n            - strand：链的方向`+`、`-`或`.` (`.`表示不确定链的方向)\n            - thickStart：CDS区（编码区）的起始位置，即起始密码子的位置。\n            - thickEnd：The endingposition at which the feature is drawn thickly (for example the stop codon ingene displays).\n            - itemRgb：RGB颜色值（如：255,0,0），方便在GenomeBrowser中查看\n            - blockCount：bed行中外显子的数目\n            - blockSizes：`逗号`分割的列，数目与blockCount值对应，每个数表示对应外显子的碱基数。\n            - blockStarts：`逗号`分割的列，数目与blockCount值对应，每个数表示对应外显子的起始位置（数值是相对ChromStart计算的）。\n    \n- SAM\n    - Alignment/Map步骤bwa/STAR/HISAT2等软件对结果的标准输出文件，**用于存储reads比对到参考基因组的比对结果**，是一个纯文本格式，文件一般较大。为了节省硬盘存储，一般使用其高效压缩的二进制格式`bam`文件。\n      \n        ```bash\n        # bam文件查看方式\n        samtools view filename.bam | less -S\n        samtools view -h filename.bam | less -S\n        \n        ###结果展示\n        @HD    VN:1.5  SO:coordinate\n        @SQ    SN:chr1 LN:248956422\n        @SQ    SN:chr10        LN:133797422\n        ......\n        @SQ    SN:chrKI270392.1        LN:971\n        @SQ    SN:chrKI270394.1        LN:970\n        @RG    ID:BH_H3K27ac_2 LB:BH_H3K27ac_2 SM:BH_H3K27ac_2\n        @PG    ID:bwa  PN:bwa  VN:0.7.15-r1140 CL:bwa mem -M -t 8 -R@RG\\tID:BH_H3K27ac_2\\tLB:BH_H3K27ac_2\\tSM:BH_H3K27ac_2\\tPL: /MP\n        @PG    ID:MarkDuplicates      VN:1.138(aa51703435dc6a423013e74e56b0b68405facd79_1439324166)   CL:picard.sam.markduplicates.\n        K00141:244:HVL3NBBXX:8:2119:27235:3145399      chr1    10016  32      115M    =      10016   115     CCCTAACCCTAACCCTAACCC\n        K00141:244:HVL3NBBXX:8:2119:27235:31453147     chr1    10016  32      115M    =      10016   -115   CCCTTACCCTAACCCTAACCC\n        \n        ```\n        \n    - 格式说明\n        - **header内容**\n            - @HD：是必须的标准文件头，包含版本信息；\n            - @SQ：参考序列染色体名字和长度信息 (SN:scaffold name; LN: length)；\n            - @RG：重要read group信息，通常包含测序平台，测序文库和样本ID等信息，分析时用于区分不同样本（重测序时用到）；\n            - @PG：生成此文件的操作过程和参数信息 (program)\n        - **record内容**\n          \n            ```html\n            1. read名称；\n            2. 比对信息位flag值；\n            3. 参考序列染色体编号；\n            4. 5′端起始位置；\n            5. MAPQ：mapping quality，描述比对的质量，数字越大，特异性越高；\n            6. CIGAR字符串，记录插入、删除、错配等信息；\n            7. 配对read所比对到的染色体，仅双端测序的数据才有；\n            8. 配对read所比对到的位置，仅双端测序的数据才有；\n            9. 插入片段的长度，仅双端测序的数据才有；\n            10. read序列；\n            11. read质量值；\n            12. 12列以后的信息都是metadata，程序用标记\n            ```\n            \n            ![Untitled](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BLPX-LrEqJc-20230801.png)\n    \n- BAM","slug":"生信常用文件格式","published":1,"updated":"2023-08-01T03:00:52.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm4peu6n0000qdbzr3fe97twy","content":"<h1 id=\"生信常用文件格式\"><a class=\"markdownIt-Anchor\" href=\"#生信常用文件格式\"></a> 生信常用文件格式</h1>\n<h3 id=\"序列格式\"><a class=\"markdownIt-Anchor\" href=\"#序列格式\"></a> 序列格式</h3>\n<ul>\n<li>\n<p>fasta</p>\n<ul>\n<li>\n<p>一种基于文本的、用于表示核苷酸序列或氨基酸序列的格式。在这种格式中碱基对或氨基酸用单个字母来表示，且允许在序列前添加序列名及注释，文件名常以<code>.fasta</code>、<code>.fa</code>结尾。</p>\n<blockquote>\n<p><strong>常见后缀说明：</strong><br />\n<code>.fasta：</code>普通的FASTA文件 (包括：.fas、 .fasta、.fsa、.fst、.txt和.fa等)<br />\n<code>.fna：</code>表示核酸序列的 FASTA 文件<br />\n<code>.faa：</code>表示氨基酸序列的 FASTA 文件<br />\n<code>.ffn：</code>整个基因组编码区的 FASTA 文件<br />\n<code>.frn：</code>以 DNA 字母编码表示的基因组非编码 RNA 区 ( 如tRNA、rRNA ) 的 FASTA 文件</p>\n</blockquote>\n  <span id=\"more\"></span>\n</li>\n<li>\n<p>格式说明</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2C7QE-Z9jpII-20230801.png\" alt=\"Untitled\" /></p>\n<ul>\n<li>每条序列的第一行是由<code>&gt;</code>开头的任意文字说明。用于序列标记，最好每条序列的标识具有唯一性，一般会用空格把头信息分为两个部分：第一部分是序列名字，它和大于号（&gt;）紧接在一起；第二部分是注释信息，这个可以没有。</li>\n<li>从第二行开始为序列本身，只允许使用既定的核苷酸或氨基酸编码符号，其中核苷酸大小写均可，氨基酸只能大写。</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>fastq</p>\n<ul>\n<li>\n<p>一种基于文本的存储测序生物序列和<strong>对应碱基（或氨基酸）质量</strong>的文件格式，可以看成fasta文件的变种，一条序列总共包括四个部分。</p>\n</li>\n<li>\n<p>格式说明</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2C6gJ-2bWdZi-20230801.png\" alt=\"Untitled\" /></p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2C4NX-xloCqX-20230801.png\" alt=\"Untitled\" /></p>\n<ul>\n<li>\n<p>第一行以“@”开头，随后为Illumina 测序标识符 (Sequence Identifiers) 和描述文字 (选择性部分)。</p>\n</li>\n<li>\n<p>第二行是碱基序列。</p>\n</li>\n<li>\n<p>第三行以“+”开头，随后为Illumina 测序标识符 (选择性部分)。</p>\n</li>\n<li>\n<p>第四行是对应碱基的测序质量，该行中每个字符对应的 ASCII 值减去 33，即为对应第二行碱基的测序质量值。</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2C3Kc-w9fQdw-20230801.png\" alt=\"Untitled\" /></p>\n</li>\n</ul>\n</li>\n<li>\n<p>常用命令</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;`CL100189782_L01_read_1.fq.gz | wc -l` / (4*1000000)&quot;</span> | bc -l</span><br><span class=\"line\"><span class=\"comment\"># 测序碱基数计算</span></span><br><span class=\"line\">zcat trt_N061011_1.fq.gz | awk<span class=\"string\">&#x27;&#123;if(FNR%4==0) base+=length&#125;END&#123;print base/10^9,&quot;G&quot;;&#125;&#x27;</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"序列比对格式\"><a class=\"markdownIt-Anchor\" href=\"#序列比对格式\"></a> 序列比对格式</h3>\n<ul>\n<li>\n<p>fasta</p>\n<ul>\n<li>\n<p>最常见的多序列比对格式，和序列的fasta格式类似，只是为了使整体出现最大的可能性，在序列中可能会添加一些<code>-</code>。</p>\n</li>\n<li>\n<p>格式说明</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BZQW-cXMLlL-20230801.png\" alt=\"Untitled\" /></p>\n</li>\n</ul>\n</li>\n<li>\n<p>clustal</p>\n<ul>\n<li>\n<p>clustal格式的文件是纯文本格式，它可以选择有一个头来声明clustal版本号。接下来是多序列比对，以及关于比对中每个位置保存程度的可选信息。</p>\n</li>\n<li>\n<p>格式说明</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BYpp-27jIGf-20230801.png\" alt=\"Untitled\" /></p>\n</li>\n</ul>\n</li>\n<li>\n<p>NEXUS</p>\n<ul>\n<li>\n<p>一种文本格式，使用“块”的方式来组织信息。以#NEXUS开头，后续说明了总体信息（包括序列数量，大小，数据类型，缺失数据等</p>\n</li>\n<li>\n<p>格式说明</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BWjs-UbrEp5-20230801.png\" alt=\"Untitled\" /></p>\n</li>\n</ul>\n</li>\n<li>\n<p>PHYLIP</p>\n<ul>\n<li>\n<p>主要包括两个部分：一个标题描述对齐维度（序列数量和大小），后跟多序列对齐序列。</p>\n</li>\n<li>\n<p>格式说明</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BSwR-mTGVf3-20230801.png\" alt=\"Untitled\" /></p>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"常见文件格式\"><a class=\"markdownIt-Anchor\" href=\"#常见文件格式\"></a> 常见文件格式</h3>\n<ul>\n<li>\n<p>Genbank</p>\n<ul>\n<li>\n<p>最早的生物信息学数据格式之一，包含的信息十分全面，常以<code>.gbff</code>结尾</p>\n</li>\n<li>\n<p>格式说明</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BR9o-WShI6Z-20230801.png\" alt=\"Untitled\" /></p>\n</li>\n</ul>\n</li>\n<li>\n<p>GFF和GTF</p>\n<ul>\n<li>\n<p>GFF (General Feature Format) 和 GTF (Gene Transfer Format) 都是用于存储注释信息的文本类型。目前常用GFF格式为第二版本的GFF2和第三版本的GFF3，GTF常用GTF2。两者前8列是相同的，GTF格式相交GFF格式更加严格。以GFF3格式为例进行说明。</p>\n</li>\n<li>\n<p>常用命令</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># grep 匹配查询 -v 输出不匹配的行</span></span><br><span class=\"line\">gunzip Homo_sapiens.GRCh38.94.gtf.gz -c |grep -v <span class=\"string\">&#x27;^#&#x27;</span> | sed <span class=\"string\">&#x27;/^[^chr]/ s/^/chr/&#x27;</span> &gt;GRCh38.gtf</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>格式说明</p>\n  <figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">NZ_CP068034.2   RefSeq  region  <span class=\"number\">1</span>   <span class=\"number\">6018586</span> .   <span class=\"operator\">+</span>   .   ID<span class=\"operator\">=</span>NZ_CP068034.2<span class=\"operator\">:</span><span class=\"number\">1.</span>.6018586;Dbxref<span class=\"operator\">=</span>taxon<span class=\"operator\">:</span><span class=\"number\">317</span>;Is_circular<span class=\"operator\">=</span>true;Name<span class=\"operator\">=</span>ANONYMOUS;collection<span class=\"operator\">-</span>date<span class=\"operator\">=</span><span class=\"number\">2001</span><span class=\"operator\">-</span><span class=\"number\">05</span><span class=\"operator\">-</span><span class=\"number\">30</span>;country<span class=\"operator\">=</span>Belarus<span class=\"operator\">:</span> Minsk region;gbkey<span class=\"operator\">=</span>Src;genome<span class=\"operator\">=</span>chromosome;isolation<span class=\"operator\">-</span>source<span class=\"operator\">=</span>Ribes nigrum leaves;lat<span class=\"operator\">-</span>lon<span class=\"operator\">=</span><span class=\"number\">53.893009</span> N <span class=\"number\">27.567444</span> E;mol_type<span class=\"operator\">=</span>genomic DNA;nat<span class=\"operator\">-</span>host<span class=\"operator\">=</span>Ribes nigrum;strain<span class=\"operator\">=</span>BIM B<span class=\"operator\">-</span><span class=\"number\">268</span></span><br><span class=\"line\">NZ_CP068034.2   RefSeq  gene    <span class=\"number\">1</span>   <span class=\"number\">1536</span>    .   <span class=\"operator\">+</span>   .   ID<span class=\"operator\">=</span>gene<span class=\"operator\">-</span>JJQ97_RS00005;Dbxref<span class=\"operator\">=</span>GeneID<span class=\"operator\">:</span><span class=\"number\">64441043</span>;Name<span class=\"operator\">=</span>dnaA;gbkey<span class=\"operator\">=</span>Gene;gene<span class=\"operator\">=</span>dnaA;gene_biotype<span class=\"operator\">=</span>protein_coding;locus_tag<span class=\"operator\">=</span>JJQ97_RS00005;old_locus_tag<span class=\"operator\">=</span>JJQ97_25475</span><br><span class=\"line\">NZ_CP068034.2   Protein Homology    CDS <span class=\"number\">1</span>   <span class=\"number\">1536</span>    .   <span class=\"operator\">+</span>   <span class=\"number\">0</span>   ID<span class=\"operator\">=</span>cds<span class=\"operator\">-</span>WP_003437057.1;Parent<span class=\"operator\">=</span>gene<span class=\"operator\">-</span>JJQ97_RS00005;Dbxref<span class=\"operator\">=</span>Genbank<span class=\"operator\">:</span>WP_003437057.1<span class=\"punctuation\">,</span>GeneID<span class=\"operator\">:</span><span class=\"number\">64441043</span>;Name<span class=\"operator\">=</span>WP_003437057.1;gbkey<span class=\"operator\">=</span>CDS;gene<span class=\"operator\">=</span>dnaA;inference<span class=\"operator\">=</span>COORDINATES<span class=\"operator\">:</span> similar to AA sequence<span class=\"operator\">:</span>RefSeq<span class=\"operator\">:</span>NP_064721.1;locus_tag<span class=\"operator\">=</span>JJQ97_RS00005;product<span class=\"operator\">=</span>chromosomal replication initiator protein DnaA;protein_id<span class=\"operator\">=</span>WP_003437057.1;transl_table<span class=\"operator\">=</span><span class=\"number\">11</span></span><br><span class=\"line\">NZ_CP068034.2   RefSeq  gene    <span class=\"number\">1575</span>    <span class=\"number\">2678</span>    .   <span class=\"operator\">+</span>   .   ID<span class=\"operator\">=</span>gene<span class=\"operator\">-</span>JJQ97_RS00010;Dbxref<span class=\"operator\">=</span>GeneID<span class=\"operator\">:</span><span class=\"number\">64441044</span>;Name<span class=\"operator\">=</span>dnaN;gbkey<span class=\"operator\">=</span>Gene;gene<span class=\"operator\">=</span>dnaN;gene_biotype<span class=\"operator\">=</span>protein_coding;locus_tag<span class=\"operator\">=</span>JJQ97_RS00010;old_locus_tag<span class=\"operator\">=</span>JJQ97_25480</span><br><span class=\"line\">NZ_CP068034.2   Protein Homology    CDS <span class=\"number\">1575</span>    <span class=\"number\">2678</span>    .   <span class=\"operator\">+</span>   <span class=\"number\">0</span>   ID<span class=\"operator\">=</span>cds<span class=\"operator\">-</span>WP_201418908.1;Parent<span class=\"operator\">=</span>gene<span class=\"operator\">-</span>JJQ97_RS00010;Dbxref<span class=\"operator\">=</span>Genbank<span class=\"operator\">:</span>WP_201418908.1<span class=\"punctuation\">,</span>GeneID<span class=\"operator\">:</span><span class=\"number\">64441044</span>;Name<span class=\"operator\">=</span>WP_201418908.1;gbkey<span class=\"operator\">=</span>CDS;gene<span class=\"operator\">=</span>dnaN;inference<span class=\"operator\">=</span>COORDINATES<span class=\"operator\">:</span> similar to AA sequence<span class=\"operator\">:</span>RefSeq<span class=\"operator\">:</span>NP_064722.1;locus_tag<span class=\"operator\">=</span>JJQ97_RS00010;product<span class=\"operator\">=</span>DNA polymerase III subunit beta;protein_id<span class=\"operator\">=</span>WP_201418908.1;transl_table<span class=\"operator\">=</span><span class=\"number\">11</span></span><br></pre></td></tr></table></figure>\n  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">seqname：序列定位，必须为染色体或组装好的</span><br><span class=\"line\">scaffoldsource：产生该GTF/GFF 文件的项目名称</span><br><span class=\"line\">feature：该段序列的特征：如 exon，CDS，enhancer等</span><br><span class=\"line\">start：序列起始位点</span><br><span class=\"line\">end：序列终止位点</span><br><span class=\"line\">score：得分值，如无得分，则为“.”</span><br><span class=\"line\">strand：正负链，用“+”和“-”表示，如不关心或者缺乏正负链信息，则为“.”</span><br><span class=\"line\">frame：开放阅读框，分别用0,1,2来区别，如果是非编码序列，则为“.”</span><br></pre></td></tr></table></figure>\n<p>相同点<br />\nfeature：GTF的feature type受限于使用软件的规定，GFF的feature可以为任意内容。</p>\n<p>score：GTF的score一般不会被用到，都是“.”</p>\n<p>attribute：GTF的第九列为attribute，为序列对应的属性，其中的内容包括序列对应的 gene_id 和 transcript_id，一般还有序列中包含的外显子数量，在GFF3版本中第九列也为attribute，但不同属性中用“=”相隔，GTF格式中不同属性用“；”分隔</p>\n<p>group：GFF2的第九列为group，来自同一个组的不同序列都被具有相同的组名。</p>\n</li>\n</ul>\n</li>\n<li>\n<p>BED</p>\n<ul>\n<li>\n<p>分析过程中的bed文件一般代表区域信息</p>\n</li>\n<li>\n<p>区别</p>\n<ul>\n<li>表示基因注释时，gtf/gff和bed文件的区别\n<ul>\n<li>\n<p>gtf/gff文件一行表示一个exon/CDS等子区域，多行联合表示一个gene；bed文件一行表示一个gene</p>\n</li>\n<li>\n<p>gtf文件中碱基位置定位方式是1-based，而bed中碱基定位方式是0-based</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BOjr-f4u29t-20230801.png\" alt=\"Untitled\" /></p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>格式说明</p>\n<ul>\n<li><strong>必须包含的3列信息：</strong>\n<ul>\n<li>chrom：染色体名字 (e.g.chr3, chrY, chr2_random或者scaffold10671)</li>\n<li>chromStart：基因在染色体或scaffold上的起始位置（0-based）</li>\n<li>chromEnd：基因在染色体或scaffold上的终止位置 （前闭后开）</li>\n</ul>\n</li>\n<li><strong>可选的9列信息：</strong>\n<ul>\n<li>name：bed文件的行名</li>\n<li>score：本条基因在注释数据集文件中的评分（0-1000），在Genome Browser中会根据不同区段的评分显示对应的阴影强度（评分越高灰度越高）</li>\n<li>strand：链的方向<code>+</code>、<code>-</code>或<code>.</code> (<code>.</code>表示不确定链的方向)</li>\n<li>thickStart：CDS区（编码区）的起始位置，即起始密码子的位置。</li>\n<li>thickEnd：The endingposition at which the feature is drawn thickly (for example the stop codon ingene displays).</li>\n<li>itemRgb：RGB颜色值（如：255,0,0），方便在GenomeBrowser中查看</li>\n<li>blockCount：bed行中外显子的数目</li>\n<li>blockSizes：<code>逗号</code>分割的列，数目与blockCount值对应，每个数表示对应外显子的碱基数。</li>\n<li>blockStarts：<code>逗号</code>分割的列，数目与blockCount值对应，每个数表示对应外显子的起始位置（数值是相对ChromStart计算的）。</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>SAM</p>\n<ul>\n<li>\n<p>Alignment/Map步骤bwa/STAR/HISAT2等软件对结果的标准输出文件，<strong>用于存储reads比对到参考基因组的比对结果</strong>，是一个纯文本格式，文件一般较大。为了节省硬盘存储，一般使用其高效压缩的二进制格式<code>bam</code>文件。</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># bam文件查看方式</span></span><br><span class=\"line\">samtools view filename.bam | less -S</span><br><span class=\"line\">samtools view -h filename.bam | less -S</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">###结果展示</span></span><br><span class=\"line\">@HD    VN:1.5  SO:coordinate</span><br><span class=\"line\">@SQ    SN:chr1 LN:248956422</span><br><span class=\"line\">@SQ    SN:chr10        LN:133797422</span><br><span class=\"line\">......</span><br><span class=\"line\">@SQ    SN:chrKI270392.1        LN:971</span><br><span class=\"line\">@SQ    SN:chrKI270394.1        LN:970</span><br><span class=\"line\">@RG    ID:BH_H3K27ac_2 LB:BH_H3K27ac_2 SM:BH_H3K27ac_2</span><br><span class=\"line\">@PG    ID:bwa  PN:bwa  VN:0.7.15-r1140 CL:bwa mem -M -t 8 -R@RG\\tID:BH_H3K27ac_2\\tLB:BH_H3K27ac_2\\tSM:BH_H3K27ac_2\\tPL: /MP</span><br><span class=\"line\">@PG    ID:MarkDuplicates      VN:1.138(aa51703435dc6a423013e74e56b0b68405facd79_1439324166)   CL:picard.sam.markduplicates.</span><br><span class=\"line\">K00141:244:HVL3NBBXX:8:2119:27235:3145399      chr1    10016  32      115M    =      10016   115     CCCTAACCCTAACCCTAACCC</span><br><span class=\"line\">K00141:244:HVL3NBBXX:8:2119:27235:31453147     chr1    10016  32      115M    =      10016   -115   CCCTTACCCTAACCCTAACCC</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>格式说明</p>\n<ul>\n<li>\n<p><strong>header内容</strong></p>\n<ul>\n<li>@HD：是必须的标准文件头，包含版本信息；</li>\n<li>@SQ：参考序列染色体名字和长度信息 (SN:scaffold name; LN: length)；</li>\n<li>@RG：重要read group信息，通常包含测序平台，测序文库和样本ID等信息，分析时用于区分不同样本（重测序时用到）；</li>\n<li>@PG：生成此文件的操作过程和参数信息 (program)</li>\n</ul>\n</li>\n<li>\n<p><strong>record内容</strong></p>\n  <figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. read名称；</span><br><span class=\"line\">2. 比对信息位flag值；</span><br><span class=\"line\">3. 参考序列染色体编号；</span><br><span class=\"line\">4. 5′端起始位置；</span><br><span class=\"line\">5. MAPQ：mapping quality，描述比对的质量，数字越大，特异性越高；</span><br><span class=\"line\">6. CIGAR字符串，记录插入、删除、错配等信息；</span><br><span class=\"line\">7. 配对read所比对到的染色体，仅双端测序的数据才有；</span><br><span class=\"line\">8. 配对read所比对到的位置，仅双端测序的数据才有；</span><br><span class=\"line\">9. 插入片段的长度，仅双端测序的数据才有；</span><br><span class=\"line\">10. read序列；</span><br><span class=\"line\">11. read质量值；</span><br><span class=\"line\">12. 12列以后的信息都是metadata，程序用标记</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BLPX-LrEqJc-20230801.png\" alt=\"Untitled\" /></p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>BAM</p>\n</li>\n</ul>\n","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":2107,"excerpt":"<h1 id=\"生信常用文件格式\"><a class=\"markdownIt-Anchor\" href=\"#生信常用文件格式\"></a> 生信常用文件格式</h1>\n<h3 id=\"序列格式\"><a class=\"markdownIt-Anchor\" href=\"#序列格式\"></a> 序列格式</h3>\n<ul>\n<li>\n<p>fasta</p>\n<ul>\n<li>\n<p>一种基于文本的、用于表示核苷酸序列或氨基酸序列的格式。在这种格式中碱基对或氨基酸用单个字母来表示，且允许在序列前添加序列名及注释，文件名常以<code>.fasta</code>、<code>.fa</code>结尾。</p>\n<blockquote>\n<p><strong>常见后缀说明：</strong><br />\n<code>.fasta：</code>普通的FASTA文件 (包括：.fas、 .fasta、.fsa、.fst、.txt和.fa等)<br />\n<code>.fna：</code>表示核酸序列的 FASTA 文件<br />\n<code>.faa：</code>表示氨基酸序列的 FASTA 文件<br />\n<code>.ffn：</code>整个基因组编码区的 FASTA 文件<br />\n<code>.frn：</code>以 DNA 字母编码表示的基因组非编码 RNA 区 ( 如tRNA、rRNA ) 的 FASTA 文件</p>\n</blockquote>","more":"</li>\n<li>\n<p>格式说明</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2C7QE-Z9jpII-20230801.png\" alt=\"Untitled\" /></p>\n<ul>\n<li>每条序列的第一行是由<code>&gt;</code>开头的任意文字说明。用于序列标记，最好每条序列的标识具有唯一性，一般会用空格把头信息分为两个部分：第一部分是序列名字，它和大于号（&gt;）紧接在一起；第二部分是注释信息，这个可以没有。</li>\n<li>从第二行开始为序列本身，只允许使用既定的核苷酸或氨基酸编码符号，其中核苷酸大小写均可，氨基酸只能大写。</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>fastq</p>\n<ul>\n<li>\n<p>一种基于文本的存储测序生物序列和<strong>对应碱基（或氨基酸）质量</strong>的文件格式，可以看成fasta文件的变种，一条序列总共包括四个部分。</p>\n</li>\n<li>\n<p>格式说明</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2C6gJ-2bWdZi-20230801.png\" alt=\"Untitled\" /></p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2C4NX-xloCqX-20230801.png\" alt=\"Untitled\" /></p>\n<ul>\n<li>\n<p>第一行以“@”开头，随后为Illumina 测序标识符 (Sequence Identifiers) 和描述文字 (选择性部分)。</p>\n</li>\n<li>\n<p>第二行是碱基序列。</p>\n</li>\n<li>\n<p>第三行以“+”开头，随后为Illumina 测序标识符 (选择性部分)。</p>\n</li>\n<li>\n<p>第四行是对应碱基的测序质量，该行中每个字符对应的 ASCII 值减去 33，即为对应第二行碱基的测序质量值。</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2C3Kc-w9fQdw-20230801.png\" alt=\"Untitled\" /></p>\n</li>\n</ul>\n</li>\n<li>\n<p>常用命令</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;`CL100189782_L01_read_1.fq.gz | wc -l` / (4*1000000)&quot;</span> | bc -l</span><br><span class=\"line\"><span class=\"comment\"># 测序碱基数计算</span></span><br><span class=\"line\">zcat trt_N061011_1.fq.gz | awk<span class=\"string\">&#x27;&#123;if(FNR%4==0) base+=length&#125;END&#123;print base/10^9,&quot;G&quot;;&#125;&#x27;</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"序列比对格式\"><a class=\"markdownIt-Anchor\" href=\"#序列比对格式\"></a> 序列比对格式</h3>\n<ul>\n<li>\n<p>fasta</p>\n<ul>\n<li>\n<p>最常见的多序列比对格式，和序列的fasta格式类似，只是为了使整体出现最大的可能性，在序列中可能会添加一些<code>-</code>。</p>\n</li>\n<li>\n<p>格式说明</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BZQW-cXMLlL-20230801.png\" alt=\"Untitled\" /></p>\n</li>\n</ul>\n</li>\n<li>\n<p>clustal</p>\n<ul>\n<li>\n<p>clustal格式的文件是纯文本格式，它可以选择有一个头来声明clustal版本号。接下来是多序列比对，以及关于比对中每个位置保存程度的可选信息。</p>\n</li>\n<li>\n<p>格式说明</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BYpp-27jIGf-20230801.png\" alt=\"Untitled\" /></p>\n</li>\n</ul>\n</li>\n<li>\n<p>NEXUS</p>\n<ul>\n<li>\n<p>一种文本格式，使用“块”的方式来组织信息。以#NEXUS开头，后续说明了总体信息（包括序列数量，大小，数据类型，缺失数据等</p>\n</li>\n<li>\n<p>格式说明</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BWjs-UbrEp5-20230801.png\" alt=\"Untitled\" /></p>\n</li>\n</ul>\n</li>\n<li>\n<p>PHYLIP</p>\n<ul>\n<li>\n<p>主要包括两个部分：一个标题描述对齐维度（序列数量和大小），后跟多序列对齐序列。</p>\n</li>\n<li>\n<p>格式说明</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BSwR-mTGVf3-20230801.png\" alt=\"Untitled\" /></p>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"常见文件格式\"><a class=\"markdownIt-Anchor\" href=\"#常见文件格式\"></a> 常见文件格式</h3>\n<ul>\n<li>\n<p>Genbank</p>\n<ul>\n<li>\n<p>最早的生物信息学数据格式之一，包含的信息十分全面，常以<code>.gbff</code>结尾</p>\n</li>\n<li>\n<p>格式说明</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BR9o-WShI6Z-20230801.png\" alt=\"Untitled\" /></p>\n</li>\n</ul>\n</li>\n<li>\n<p>GFF和GTF</p>\n<ul>\n<li>\n<p>GFF (General Feature Format) 和 GTF (Gene Transfer Format) 都是用于存储注释信息的文本类型。目前常用GFF格式为第二版本的GFF2和第三版本的GFF3，GTF常用GTF2。两者前8列是相同的，GTF格式相交GFF格式更加严格。以GFF3格式为例进行说明。</p>\n</li>\n<li>\n<p>常用命令</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># grep 匹配查询 -v 输出不匹配的行</span></span><br><span class=\"line\">gunzip Homo_sapiens.GRCh38.94.gtf.gz -c |grep -v <span class=\"string\">&#x27;^#&#x27;</span> | sed <span class=\"string\">&#x27;/^[^chr]/ s/^/chr/&#x27;</span> &gt;GRCh38.gtf</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>格式说明</p>\n  <figure class=\"highlight r\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">NZ_CP068034.2   RefSeq  region  <span class=\"number\">1</span>   <span class=\"number\">6018586</span> .   <span class=\"operator\">+</span>   .   ID<span class=\"operator\">=</span>NZ_CP068034.2<span class=\"operator\">:</span><span class=\"number\">1.</span>.6018586;Dbxref<span class=\"operator\">=</span>taxon<span class=\"operator\">:</span><span class=\"number\">317</span>;Is_circular<span class=\"operator\">=</span>true;Name<span class=\"operator\">=</span>ANONYMOUS;collection<span class=\"operator\">-</span>date<span class=\"operator\">=</span><span class=\"number\">2001</span><span class=\"operator\">-</span><span class=\"number\">05</span><span class=\"operator\">-</span><span class=\"number\">30</span>;country<span class=\"operator\">=</span>Belarus<span class=\"operator\">:</span> Minsk region;gbkey<span class=\"operator\">=</span>Src;genome<span class=\"operator\">=</span>chromosome;isolation<span class=\"operator\">-</span>source<span class=\"operator\">=</span>Ribes nigrum leaves;lat<span class=\"operator\">-</span>lon<span class=\"operator\">=</span><span class=\"number\">53.893009</span> N <span class=\"number\">27.567444</span> E;mol_type<span class=\"operator\">=</span>genomic DNA;nat<span class=\"operator\">-</span>host<span class=\"operator\">=</span>Ribes nigrum;strain<span class=\"operator\">=</span>BIM B<span class=\"operator\">-</span><span class=\"number\">268</span></span><br><span class=\"line\">NZ_CP068034.2   RefSeq  gene    <span class=\"number\">1</span>   <span class=\"number\">1536</span>    .   <span class=\"operator\">+</span>   .   ID<span class=\"operator\">=</span>gene<span class=\"operator\">-</span>JJQ97_RS00005;Dbxref<span class=\"operator\">=</span>GeneID<span class=\"operator\">:</span><span class=\"number\">64441043</span>;Name<span class=\"operator\">=</span>dnaA;gbkey<span class=\"operator\">=</span>Gene;gene<span class=\"operator\">=</span>dnaA;gene_biotype<span class=\"operator\">=</span>protein_coding;locus_tag<span class=\"operator\">=</span>JJQ97_RS00005;old_locus_tag<span class=\"operator\">=</span>JJQ97_25475</span><br><span class=\"line\">NZ_CP068034.2   Protein Homology    CDS <span class=\"number\">1</span>   <span class=\"number\">1536</span>    .   <span class=\"operator\">+</span>   <span class=\"number\">0</span>   ID<span class=\"operator\">=</span>cds<span class=\"operator\">-</span>WP_003437057.1;Parent<span class=\"operator\">=</span>gene<span class=\"operator\">-</span>JJQ97_RS00005;Dbxref<span class=\"operator\">=</span>Genbank<span class=\"operator\">:</span>WP_003437057.1<span class=\"punctuation\">,</span>GeneID<span class=\"operator\">:</span><span class=\"number\">64441043</span>;Name<span class=\"operator\">=</span>WP_003437057.1;gbkey<span class=\"operator\">=</span>CDS;gene<span class=\"operator\">=</span>dnaA;inference<span class=\"operator\">=</span>COORDINATES<span class=\"operator\">:</span> similar to AA sequence<span class=\"operator\">:</span>RefSeq<span class=\"operator\">:</span>NP_064721.1;locus_tag<span class=\"operator\">=</span>JJQ97_RS00005;product<span class=\"operator\">=</span>chromosomal replication initiator protein DnaA;protein_id<span class=\"operator\">=</span>WP_003437057.1;transl_table<span class=\"operator\">=</span><span class=\"number\">11</span></span><br><span class=\"line\">NZ_CP068034.2   RefSeq  gene    <span class=\"number\">1575</span>    <span class=\"number\">2678</span>    .   <span class=\"operator\">+</span>   .   ID<span class=\"operator\">=</span>gene<span class=\"operator\">-</span>JJQ97_RS00010;Dbxref<span class=\"operator\">=</span>GeneID<span class=\"operator\">:</span><span class=\"number\">64441044</span>;Name<span class=\"operator\">=</span>dnaN;gbkey<span class=\"operator\">=</span>Gene;gene<span class=\"operator\">=</span>dnaN;gene_biotype<span class=\"operator\">=</span>protein_coding;locus_tag<span class=\"operator\">=</span>JJQ97_RS00010;old_locus_tag<span class=\"operator\">=</span>JJQ97_25480</span><br><span class=\"line\">NZ_CP068034.2   Protein Homology    CDS <span class=\"number\">1575</span>    <span class=\"number\">2678</span>    .   <span class=\"operator\">+</span>   <span class=\"number\">0</span>   ID<span class=\"operator\">=</span>cds<span class=\"operator\">-</span>WP_201418908.1;Parent<span class=\"operator\">=</span>gene<span class=\"operator\">-</span>JJQ97_RS00010;Dbxref<span class=\"operator\">=</span>Genbank<span class=\"operator\">:</span>WP_201418908.1<span class=\"punctuation\">,</span>GeneID<span class=\"operator\">:</span><span class=\"number\">64441044</span>;Name<span class=\"operator\">=</span>WP_201418908.1;gbkey<span class=\"operator\">=</span>CDS;gene<span class=\"operator\">=</span>dnaN;inference<span class=\"operator\">=</span>COORDINATES<span class=\"operator\">:</span> similar to AA sequence<span class=\"operator\">:</span>RefSeq<span class=\"operator\">:</span>NP_064722.1;locus_tag<span class=\"operator\">=</span>JJQ97_RS00010;product<span class=\"operator\">=</span>DNA polymerase III subunit beta;protein_id<span class=\"operator\">=</span>WP_201418908.1;transl_table<span class=\"operator\">=</span><span class=\"number\">11</span></span><br></pre></td></tr></table></figure>\n  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">seqname：序列定位，必须为染色体或组装好的</span><br><span class=\"line\">scaffoldsource：产生该GTF/GFF 文件的项目名称</span><br><span class=\"line\">feature：该段序列的特征：如 exon，CDS，enhancer等</span><br><span class=\"line\">start：序列起始位点</span><br><span class=\"line\">end：序列终止位点</span><br><span class=\"line\">score：得分值，如无得分，则为“.”</span><br><span class=\"line\">strand：正负链，用“+”和“-”表示，如不关心或者缺乏正负链信息，则为“.”</span><br><span class=\"line\">frame：开放阅读框，分别用0,1,2来区别，如果是非编码序列，则为“.”</span><br></pre></td></tr></table></figure>\n<p>相同点<br />\nfeature：GTF的feature type受限于使用软件的规定，GFF的feature可以为任意内容。</p>\n<p>score：GTF的score一般不会被用到，都是“.”</p>\n<p>attribute：GTF的第九列为attribute，为序列对应的属性，其中的内容包括序列对应的 gene_id 和 transcript_id，一般还有序列中包含的外显子数量，在GFF3版本中第九列也为attribute，但不同属性中用“=”相隔，GTF格式中不同属性用“；”分隔</p>\n<p>group：GFF2的第九列为group，来自同一个组的不同序列都被具有相同的组名。</p>\n</li>\n</ul>\n</li>\n<li>\n<p>BED</p>\n<ul>\n<li>\n<p>分析过程中的bed文件一般代表区域信息</p>\n</li>\n<li>\n<p>区别</p>\n<ul>\n<li>表示基因注释时，gtf/gff和bed文件的区别\n<ul>\n<li>\n<p>gtf/gff文件一行表示一个exon/CDS等子区域，多行联合表示一个gene；bed文件一行表示一个gene</p>\n</li>\n<li>\n<p>gtf文件中碱基位置定位方式是1-based，而bed中碱基定位方式是0-based</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BOjr-f4u29t-20230801.png\" alt=\"Untitled\" /></p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>格式说明</p>\n<ul>\n<li><strong>必须包含的3列信息：</strong>\n<ul>\n<li>chrom：染色体名字 (e.g.chr3, chrY, chr2_random或者scaffold10671)</li>\n<li>chromStart：基因在染色体或scaffold上的起始位置（0-based）</li>\n<li>chromEnd：基因在染色体或scaffold上的终止位置 （前闭后开）</li>\n</ul>\n</li>\n<li><strong>可选的9列信息：</strong>\n<ul>\n<li>name：bed文件的行名</li>\n<li>score：本条基因在注释数据集文件中的评分（0-1000），在Genome Browser中会根据不同区段的评分显示对应的阴影强度（评分越高灰度越高）</li>\n<li>strand：链的方向<code>+</code>、<code>-</code>或<code>.</code> (<code>.</code>表示不确定链的方向)</li>\n<li>thickStart：CDS区（编码区）的起始位置，即起始密码子的位置。</li>\n<li>thickEnd：The endingposition at which the feature is drawn thickly (for example the stop codon ingene displays).</li>\n<li>itemRgb：RGB颜色值（如：255,0,0），方便在GenomeBrowser中查看</li>\n<li>blockCount：bed行中外显子的数目</li>\n<li>blockSizes：<code>逗号</code>分割的列，数目与blockCount值对应，每个数表示对应外显子的碱基数。</li>\n<li>blockStarts：<code>逗号</code>分割的列，数目与blockCount值对应，每个数表示对应外显子的起始位置（数值是相对ChromStart计算的）。</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>SAM</p>\n<ul>\n<li>\n<p>Alignment/Map步骤bwa/STAR/HISAT2等软件对结果的标准输出文件，<strong>用于存储reads比对到参考基因组的比对结果</strong>，是一个纯文本格式，文件一般较大。为了节省硬盘存储，一般使用其高效压缩的二进制格式<code>bam</code>文件。</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># bam文件查看方式</span></span><br><span class=\"line\">samtools view filename.bam | less -S</span><br><span class=\"line\">samtools view -h filename.bam | less -S</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">###结果展示</span></span><br><span class=\"line\">@HD    VN:1.5  SO:coordinate</span><br><span class=\"line\">@SQ    SN:chr1 LN:248956422</span><br><span class=\"line\">@SQ    SN:chr10        LN:133797422</span><br><span class=\"line\">......</span><br><span class=\"line\">@SQ    SN:chrKI270392.1        LN:971</span><br><span class=\"line\">@SQ    SN:chrKI270394.1        LN:970</span><br><span class=\"line\">@RG    ID:BH_H3K27ac_2 LB:BH_H3K27ac_2 SM:BH_H3K27ac_2</span><br><span class=\"line\">@PG    ID:bwa  PN:bwa  VN:0.7.15-r1140 CL:bwa mem -M -t 8 -R@RG\\tID:BH_H3K27ac_2\\tLB:BH_H3K27ac_2\\tSM:BH_H3K27ac_2\\tPL: /MP</span><br><span class=\"line\">@PG    ID:MarkDuplicates      VN:1.138(aa51703435dc6a423013e74e56b0b68405facd79_1439324166)   CL:picard.sam.markduplicates.</span><br><span class=\"line\">K00141:244:HVL3NBBXX:8:2119:27235:3145399      chr1    10016  32      115M    =      10016   115     CCCTAACCCTAACCCTAACCC</span><br><span class=\"line\">K00141:244:HVL3NBBXX:8:2119:27235:31453147     chr1    10016  32      115M    =      10016   -115   CCCTTACCCTAACCCTAACCC</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>格式说明</p>\n<ul>\n<li>\n<p><strong>header内容</strong></p>\n<ul>\n<li>@HD：是必须的标准文件头，包含版本信息；</li>\n<li>@SQ：参考序列染色体名字和长度信息 (SN:scaffold name; LN: length)；</li>\n<li>@RG：重要read group信息，通常包含测序平台，测序文库和样本ID等信息，分析时用于区分不同样本（重测序时用到）；</li>\n<li>@PG：生成此文件的操作过程和参数信息 (program)</li>\n</ul>\n</li>\n<li>\n<p><strong>record内容</strong></p>\n  <figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. read名称；</span><br><span class=\"line\">2. 比对信息位flag值；</span><br><span class=\"line\">3. 参考序列染色体编号；</span><br><span class=\"line\">4. 5′端起始位置；</span><br><span class=\"line\">5. MAPQ：mapping quality，描述比对的质量，数字越大，特异性越高；</span><br><span class=\"line\">6. CIGAR字符串，记录插入、删除、错配等信息；</span><br><span class=\"line\">7. 配对read所比对到的染色体，仅双端测序的数据才有；</span><br><span class=\"line\">8. 配对read所比对到的位置，仅双端测序的数据才有；</span><br><span class=\"line\">9. 插入片段的长度，仅双端测序的数据才有；</span><br><span class=\"line\">10. read序列；</span><br><span class=\"line\">11. read质量值；</span><br><span class=\"line\">12. 12列以后的信息都是metadata，程序用标记</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/2BLPX-LrEqJc-20230801.png\" alt=\"Untitled\" /></p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>BAM</p>\n</li>\n</ul>"},{"title":"简书笔记汇总","top":true,"abbrlink":"b3b948e8","date":"2023-05-17T13:54:53.000Z","_content":"\n简书作者：[生信start_site](https://www.jianshu.com/u/d3b898b259fa)\n\n## Linux 学习笔记\n\n* [《Linux 命令行与 shell 脚本编程大全》第 11 章笔记（上）](https://www.jianshu.com/p/192946dce252) \n* [《Linux 命令行与 shell 脚本编程大全》第 11 章笔记（下）](https://www.jianshu.com/p/4d1a77d3b236) \n* [结构化命令 之 if-then； if-then-else 语句](https://www.jianshu.com/p/f6edec3d8b36) \n* [结构化命令 之 test 命令 (长文慎入）](https://www.jianshu.com/p/6557b3b6ca4f) \n* [结构化命令 之 复合条件测试](https://www.jianshu.com/p/c183fdbb08ca) \n* [结构化命令 之 if-then 高级特性](https://www.jianshu.com/p/d1b0911def71) \n* [结构化命令 之 case 命令](https://www.jianshu.com/p/ee6b85e04932) \n* [结构化命令 之 for 命令](https://www.jianshu.com/p/f679a812fa0d) \n\n<!--more-->\n\n* [结构化命令 之 while 命令](https://www.jianshu.com/p/6c9ec8ae4869) \n* [结构化命令 之 until 命令](https://www.jianshu.com/p/9cc269d62a06) \n* [结构化命令 之 嵌套循环](https://www.jianshu.com/p/9c415e7f1d19) \n* [控制循环](https://www.jianshu.com/p/93bd151f83e2) \n* [处理循环的输出](https://www.jianshu.com/p/59317149d162) \n* [shell 脚本编程 -- 处理用户输入](https://www.jianshu.com/p/d630d5556543) \n* [如何使用服务器下载和处理文件 / 以及传输文件至本地文件夹](https://www.jianshu.com/p/80cef33ed41c) \n* [利用 TrimGalore 去除 adapter 以及过滤 fastq 文件](https://www.jianshu.com/p/aca43442e931) \n* [更改 Putty 主题背景](https://www.jianshu.com/p/a7620c2ea275) \n* [如何根据染色体坐标批量提取对应的 DNA 序列（bedtools）](https://www.jianshu.com/p/3e6deaf83da9) \n* [计算 bam 文件中比对上基因组的 reads 以及合并多个 bam 文件](https://www.jianshu.com/p/05cbc7bd06bc) \n* [file 命令，find 命令](https://www.jianshu.com/p/0360ac5f37ca) \n* [怎么在 linux 里访问 U 盘里的数据](https://www.jianshu.com/p/19429118636a) \n* [输入 / 输出 / 重定向](https://www.jianshu.com/p/299c0da5f341)\n\n## R 学习笔记\n\n* [如何在散点图里添加特定标签](https://www.jianshu.com/p/4adb658a60ee) \n* [如何修改操作系统分配给 R 的内存上限](https://www.jianshu.com/p/fc2382c436f1) \n* [用 R 画 Circular barplot 图（环状柱形图）](https://www.jianshu.com/p/631381890ad4) \n* [用 R 画弧形图（Arc Diagram）](https://www.jianshu.com/p/0b13f75d9a9d) \n* [GENIE3——一款预测基因调控网络的 R 包](https://www.jianshu.com/p/d71dcd4cff5a) \n* [RNA-seq 的差异基因除了热图 / 火山图，你还可以如何展示？](https://www.jianshu.com/p/c90238849858) \n* [RCircos 包的使用](https://www.jianshu.com/p/799ef8f2bfcb) \n* [洛克菲勒大学 2021 年生信课 1：Introduction to R, session 1](https://www.jianshu.com/p/c2b91bc4a033) \n* [洛克菲勒大学 2021 年生信课 2：Introduction to R, session 2](https://www.jianshu.com/p/458f59261246)\n\n## python 学习笔记\n\n* [学习 Python: 最开始的开始（入门教程 + 软件安装）](https://www.jianshu.com/p/78809acafb36) \n* [Biopython 学习笔记（一）](https://www.jianshu.com/p/7d1fe73e4d66) \n* [Biopython 学习笔记（二）序列的分析](https://www.jianshu.com/p/a804bd33b4f7) \n* [Biopython 学习笔记（三）Blast](https://www.jianshu.com/p/04d846da001b) \n* [Biopython 学习笔记（四）访问 NCBI Entrez 数据库](https://www.jianshu.com/p/30bff68b1dda) \n* [利用 scanpy 进行单细胞测序分析（一）预处理和聚类](https://www.jianshu.com/p/2855145686a6) \n* [利用 scanpy 进行单细胞测序分析（二）轨迹推断](https://www.jianshu.com/p/58cb6419de09) \n* [利用 scanpy 进行单细胞测序分析（三）Marker 基因的可视化](https://www.jianshu.com/p/e29365002cb0) \n* [ipython 的初步了解](https://www.jianshu.com/p/fbb9f2520a59) \n* [Numpy 笔记（NumPy ndarray）](https://www.jianshu.com/p/a85c9ff81ebc) \n* [Numpy 笔记（Transposing Arrays）](https://www.jianshu.com/p/ac562796aebd) \n* [Numpy 笔记 (File Input and Output with Arrays)](https://www.jianshu.com/p/a4f3b0da44f1) \n* [pandas 笔记（pandas Data Structures）](https://www.jianshu.com/p/5c779efd288b) \n* [pandas 笔记（Essential Functionality）](https://www.jianshu.com/p/8b727bba5ecf) \n* [pandas 笔记（Summarizing and Computing Descriptive Statistics）](https://www.jianshu.com/p/f9f35b3e2584) \n* [pandas 笔记（Handling Missing Data）](https://www.jianshu.com/p/c373f5b38249) \n* [pandas 笔记 (Data Transformation)](https://www.jianshu.com/p/f16e162cf7ee) \n* [python 可视化：matplotlib 学习笔记](https://www.jianshu.com/p/9a7f62a30a68) \n* [python 可视化：Plotting with pandas and seaborn](https://www.jianshu.com/p/3fde65074a9d) \n* [python 笔记：Functions](https://www.jianshu.com/p/ec120b0e42d5) \n* [python 笔记：将 function 储存在 module 里](https://www.jianshu.com/p/fee26614135b) \n* [python 笔记：Class（类）](https://www.jianshu.com/p/b6f8c44caed7) \n* [python 笔记：打开 / 访问文件](https://www.jianshu.com/p/1c25a07fb114)\n\n## perl 学习笔记\n\n* [Learning Perl 学习笔记（1）第二章 Scalar Data](https://www.jianshu.com/p/e7e9006d3a82) \n* [Learning Perl 学习笔记（2）第三章 Lists and Arrays](https://www.jianshu.com/p/448ac3434104) \n* [Learning Perl 学习笔记（3）第四章：子程序](https://www.jianshu.com/p/ecd8e26d4a96) \n* [Learning Perl 学习笔记（4）第五章 Input and Output](https://www.jianshu.com/p/5bf7ecb14361) \n* [Learning Perl 学习笔记（5）第六章 Hashes](https://www.jianshu.com/p/9ca226b57ed5) \n* [Learning Perl 学习笔记（6）第七章 正则表达式](https://www.jianshu.com/p/ac8092758ac2) \n* [Learning Perl 学习笔记（7）第八章 使用正则表达式进行 matching](https://www.jianshu.com/p/d4638b79ddea) \n* [Learning Perl 学习笔记（8）第九章 Processing Text with Regular Expressions](https://www.jianshu.com/p/cf0db9d9c671) \n* [Learning Perl 学习笔记（9）：Strings and Sorting](https://www.jianshu.com/p/f6e31c0b0ab7) \n* [circos 软件使用初探](https://www.jianshu.com/p/372d83b89229) \n* [circos 软件学习笔记：语法、颜色、字体和文件格式](https://www.jianshu.com/p/f1a206893744) \n* [circos 软件学习笔记：添加刻度](https://www.jianshu.com/p/4c8fc9d8fe78) \n* [circos 软件学习笔记：更改染色体的比例、颜色、方向](https://www.jianshu.com/p/9a57e583d7c5) \n* [circos 软件学习笔记：在圆圈里添加 lines（interaction）](https://www.jianshu.com/p/dba889089dee)\n\n## 转录组学习笔记\n\n* [RNA-seq 练习 第一部分（原始数据下载，提取 fastq 文件，fastqc 质控）](https://www.jianshu.com/p/055732b6ac99) \n* [RNA-seq 练习 第二部分（基因组序列下载，注释文件下载，索引下载，比对，比对质控, HTseq-count 计数，输出 count 矩阵文件）](https://www.jianshu.com/p/849f8ada0ab7) \n* [RNA-seq 练习 第三部分（DEseq2 筛选差异表达基因, 可视化）](https://www.jianshu.com/p/82787ddada38) \n* [理解 SAM 文件格式以及过滤 sam 文件](https://www.jianshu.com/p/7d15173540ae) \n* [GSEA 学习笔记](https://www.jianshu.com/p/aae9b0322b83) \n* [几种标准化方法的学习笔记](https://www.jianshu.com/p/c2605b5b8c0a) \n* [比对软件 STAR 的使用](https://www.jianshu.com/p/5b6dfc954315)\n\n## ChIP-seq & ATAC-seq 笔记\n\n* [ChIP-seq 实践 (H3K27Ac,enhancer 的筛选和 enhancer 相关基因的 GO 分析)](https://www.jianshu.com/p/05aae63d7c52) \n* [ChIP-seq 实践（非转录因子，非组蛋白）](https://www.jianshu.com/p/2138c99ce30a) \n* [在 IGV 里同时查看多个 region/gene](https://www.jianshu.com/p/cc01ad9db959) \n* [ATAC-seq 分析练习](https://www.jianshu.com/p/57d4420056dd) \n* [结合 CHIP-seq 和 ATAC-seq 结果进行分析](https://www.jianshu.com/p/1e3d15c325e9) \n* [GREAT 网页版学习笔记（预测顺式调控元件）](https://www.jianshu.com/p/7f6ce4f238cb) \n* [使用 HINT-ATAC 进行 ATAC-Seq 的 footprinting 分析](https://www.jianshu.com/p/6aba8f1dea56) \n* [用 MEME-CHIP 预测转录因子的结合](https://www.jianshu.com/p/66deb4c008f5)  \n* [利用 HOMER 预测目标序列的 motif（从运行程序到结果解读，以及注意事项）](https://www.jianshu.com/p/467d970ec097) \n* [Motif scanning tool: FIMO（在线版分析笔记）](https://www.jianshu.com/p/37eadb126bbf) \n* [如何提取 ATAC-seq 数据的差异 peaks?（DiffBind 包的使用）](https://www.jianshu.com/p/b74c8077d893) \n* [shadow enhancers](https://www.jianshu.com/p/0f674e88c1ce)\n\n## CUT&Tag 学习笔记\n\n* [CUT&Tag 数据分析笔记（1）](https://www.jianshu.com/p/1a23656a0713) \n* [CUT&Tag 数据分析笔记（2）](https://www.jianshu.com/p/7d45ec853ff8) \n* [CUT&Tag 数据分析笔记（3）](https://www.jianshu.com/p/47f30acd68f1)\n\n## Hi-C 学习笔记\n\n* [Hi-C 技术的初步了解](https://www.jianshu.com/p/e3c198d75345) \n* [Hi-C 分析练习（从 fastq 文件到 contact 矩阵）](https://www.jianshu.com/p/e7757fa94624) \n* [Hi-C 分析练习（从 cool 文件到可视化热图）](https://www.jianshu.com/p/495c576f0f0f)\n\n## 甲基化测序分析学习笔记\n\n* [陈巍学基因视频学习记录 -- 甲基化测序](https://www.jianshu.com/p/316faa7e0642) \n* [Bismark Bisulfite Mapper 学习笔记（一）数据预处理](https://www.jianshu.com/p/4c64858003c1) \n* [Bismark Bisulfite Mapper 学习笔记（二）甲基化信息提取以及文件解读](https://www.jianshu.com/p/e71184d03ace) \n* [WGBS vs RRBS](https://www.jianshu.com/p/f8a02e164f5a)\n\n## 单细胞转录组学习笔记\n\n* [单细胞 RNA-seq 入门文献学习](https://www.jianshu.com/p/b79171dddb0d) \n* [单细胞测序实战（第一部分）](https://www.jianshu.com/p/a70c831c95f5) \n* [单细胞测序实战（第二部分）](https://www.jianshu.com/p/b7fec167f4eb)\n* [单细胞测序实战（第三部分）](https://www.jianshu.com/p/c206818ad0c6) \n* [(Smartseq2) single cell RNA-seq 分析练习](https://www.jianshu.com/p/dee97289586c) \n* [10× 单细胞测序分析练习（一）](https://www.jianshu.com/p/705a348e8623) \n* [10× 单细胞测序分析练习（二）](https://www.jianshu.com/p/62db41020ad2) \n* [单细胞测序分析之 Monocle2 包学习笔记](https://www.jianshu.com/p/f6186755aae5) \n* [单细胞测序分析之 Seurat（3.0）包学习笔记](https://www.jianshu.com/p/26d3648b2e1f) \n* [单细胞测序分析之 scater 包学习笔记](https://www.jianshu.com/p/4c20a7866ce6) \n* [Single cell RNA-seq data analysis with R 视频学习笔记（一）](https://www.jianshu.com/p/ff637a0b7ff5) \n* [Single cell RNA-seq data analysis with R 视频学习笔记（二）](https://www.jianshu.com/p/e64b7b92f9e2) \n* [Single cell RNA-seq data analysis with R 视频学习笔记（三）](https://www.jianshu.com/p/0e13ecde84b6) \n* [Single cell RNA-seq data analysis with R 视频学习笔记（四、五）](https://www.jianshu.com/p/ca1a955f5046) \n* [单细胞测序数据整合练习（详细代码）](https://www.jianshu.com/p/3b9a0204d65b) \n* [Single cell RNA-seq data analysis with R 视频学习笔记（六）](https://www.jianshu.com/p/7af86cc04e7d) \n* [Single cell RNA-seq data analysis with R 视频学习笔记（七）](https://www.jianshu.com/p/f20cfd1fa326) \n* [Single cell RNA-seq data analysis with R 视频学习笔记（八）](https://www.jianshu.com/p/adb692e71bf9) \n* [Single cell RNA-seq data analysis with R 视频学习笔记（九：空间转录组）](https://www.jianshu.com/p/88372e79a863) \n* [单细胞轨迹推断（Trajectory inference）分析（详细代码）](https://www.jianshu.com/p/16ebecb3b5fa) \n* [RNA velocity of single cells 文献学习](https://www.jianshu.com/p/f6f48d6594ce) \n* [RNA velocity 分析练习（一）文件下载以及预处理](https://www.jianshu.com/p/e65964f39eb3) \n* [RNA velocity 分析练习（二）软件安装](https://www.jianshu.com/p/df6c16cc2bc2) \n* [RNA velocity 分析练习（三）生成 loom 文件](https://www.jianshu.com/p/bce19672879e) \n* [RNA velocity 分析练习（四）聚类以及 velocity 可视化](https://www.jianshu.com/p/d6c92dd67166) \n* [cellranger 使用的初步探索（1）](https://www.jianshu.com/p/08f75901cc3e) \n* [cellranger 使用的初步探索（2）理解 cellranger count 输出文件](https://www.jianshu.com/p/57bda7d71b18) \n* [cellranger 使用的初步探索（3）cellranger aggr](https://www.jianshu.com/p/ca726a8979d7) \n* [cellranger 使用的初步探索（4）：R 读取 cellranger 的输出文件](https://www.jianshu.com/p/0fbf5b29f2ae)\n\n## 单细胞 ATAC-seq 学习笔记\n\n* [Single-Cell ATAC-Seq 的初步了解](https://www.jianshu.com/p/7d8058efb8e5) \n* [scATAC-seq 数据分析练习（成年小鼠大脑组织）](https://www.jianshu.com/p/ef7531c7d07d) \n* [[scATAC-seq] 利用 Monocle3 构建细胞 “轨迹”](https://www.jianshu.com/p/17a0a1cafade) \n* [ArchR 官网教程学习笔记 1：Getting Started with ArchR](https://www.jianshu.com/p/a2bcdfb77961) \n* [ArchR 官网教程学习笔记 2: 基于 ArchR 推测 Doublet](https://www.jianshu.com/p/5ec81b5bb3ea) \n* [ArchR 官网教程学习笔记 3: 创建 ArchRProject](https://www.jianshu.com/p/9243973a35e6) \n* [ArchR 官网教程学习笔记 4:ArchR 的降维](https://www.jianshu.com/p/98d702592720) \n* [ArchR 官网教程学习笔记 5:ArchR 的聚类](https://www.jianshu.com/p/91007564ffdc) \n* [ArchR 官网教程学习笔记 6: 单细胞嵌入（Single-cell Embeddings）](https://www.jianshu.com/p/16904f84b8ba) \n* [ArchR 官网教程学习笔记 7:ArchR 的基因评分和 Marker 基因](https://www.jianshu.com/p/45d1d47fdcd3) \n* [ArchR 官网教程学习笔记 8: 定义与 scRNA-seq 一致的聚类](https://www.jianshu.com/p/60ce90ba67a9) \n* [ArchR 官网教程学习笔记 9:ArchR 的伪批量重复](https://www.jianshu.com/p/9aae0389875d) \n* [ArchR 官网教程学习笔记 10:ArchR 的 call peak](https://www.jianshu.com/p/30fb540e95ec) \n* [ArchR 官网教程学习笔记 11: 鉴定 Marker 峰](https://www.jianshu.com/p/79fa167c914d) \n* [ArchR 官网教程学习笔记 12:Motif 和 Feature 富集](https://www.jianshu.com/p/662c626123b5) \n* [ArchR 官网教程学习笔记 13:ChromVAR 偏差富集](https://www.jianshu.com/p/8bd8da9a9ba8) \n* [ArchR 官网教程学习笔记 14:ArchR 的 Footprinting 分析](https://www.jianshu.com/p/40946d10c63c) \n* [ArchR 官网教程学习笔记 15:ArchR 的整合分析](https://www.jianshu.com/p/b3f538f86feb) \n* [ArchR 官网教程学习笔记 16（上）:ArchR 的轨迹推断分析](https://www.jianshu.com/p/519b1a69e1d6) \n* [ArchR 官网教程学习笔记 16（下）:ArchR 的轨迹推断分析](https://www.jianshu.com/p/9de6526e45a2)\n\n## TCGA 数据库学习笔记\n\n* [TCGA 数据库的初次了解](https://www.jianshu.com/p/d662069a4a3d) \n* [如何批量下载 TCGA 里的数据（gdc-client 方法）](https://www.jianshu.com/p/43a915fc8ee9) \n* [利用 R 包 TCGAbiolinks 进行各种数据下载](https://www.jianshu.com/p/3b4c07f7e5f3) \n* [TCGA 的差异基因分析](https://www.jianshu.com/p/e18068180ee5) \n* [整合 gdc-client 批量下载的文件](https://www.jianshu.com/p/72b0fa510086) \n* [如何把从 TCGA 下载的 HTseq count 转换成 FPKM](https://www.jianshu.com/p/4afbdc8fd8ed) \n* [如何生成 WGCNA 分析所需的临床表型信息](https://www.jianshu.com/p/0ac52f582ea4) \n* [WGCNA 学习笔记](https://www.jianshu.com/p/0d05d1f007e7) \n* [TCGA 数据生存分析](https://www.jianshu.com/p/fd5e06ec260b) \n* [TCGA 甲基化数据下载以及相关临床信息整理](https://www.jianshu.com/p/1ceace2b581c) \n* [TCGA 甲基化数据质量控制和差异分析（使用 ChAMP 包）](https://www.jianshu.com/p/27269f95d9c1) \n* [如何将 WGCNA 导出的基因共表达网络进行可视化（cytoscape 软件的使用）](https://www.jianshu.com/p/d75e1199f8b1) \n* [TCGA 数据库 MAF 文件的分析以及可视化（maftools 包的使用）](https://www.jianshu.com/p/967d52171777) \n* [TCGA 数据库 copy number variation 数据分析（第一部分：从数据下载到 GISTIC 输出文件）](https://www.jianshu.com/p/b8351a86a40b) \n* [TCGA 数据库 copy number variation 数据分析（第二部分：利用 maftools 进行可视化）](https://www.jianshu.com/p/dbc90a1475c1)\n\n## GEO 数据库学习笔记\n\n* [GEO 数据库视频学习笔记（芯片数据下载和数据读取）](https://www.jianshu.com/p/51711c22934d) \n* [GEO 数据库视频学习笔记（ID 转换）](https://www.jianshu.com/p/d64a1ddf1128) \n* [GEO 数据库视频学习笔记（了解你的表达矩阵）](https://www.jianshu.com/p/c94875df0155) \n* [GEO 数据库视频学习笔记（差异分析、可视化、GSEA）](https://www.jianshu.com/p/4486c6624ef9)\n\n## cBioPortal 数据库学习笔记\n\n* [cBioPortal 学习笔记（1）](https://www.jianshu.com/p/b458796366a4) \n* [cBioPortal 学习笔记（2）](https://www.jianshu.com/p/cf0d1f407601)\n\n## WGS 学习笔记\n\n* [GATK 的初次了解](https://www.jianshu.com/p/4177a7afc798) \n* [GATK 官网学习笔记 Data pre-processing for variant discovery](https://www.jianshu.com/p/9fce93c1a337) \n* [Broad Institute 视频笔记 Introduction to High-throughput Sequencing Data](https://www.jianshu.com/p/b93f8f4a1ed7) \n* [Broad Institute 视频笔记 Introduction to Data Preprocessing](https://www.jianshu.com/p/8ace60832c13) \n* [Broad Institute 视频笔记 Introduction to Variant Discovery](https://www.jianshu.com/p/5bf73e5a3390) \n* [Broad Institute 视频笔记 Introduction to Germline Variant Discovery](https://www.jianshu.com/p/c032b7a1909c) \n* [Broad Institute 视频笔记 Introduction to Somatic Variant Discovery](https://www.jianshu.com/p/6e0b483f1234) \n* [Broad Institue 视频笔记：Variant Calling with HaplotypeCaller](https://www.jianshu.com/p/9c049c46a26d) \n* [Broad Institute 视频笔记 Hello World WDL Tutorial](https://www.jianshu.com/p/241595e0ed39) \n* [Broad Institute 视频笔记 Run Haplotypecaller（WDL+Cromwell）](https://www.jianshu.com/p/2c4a792b49fe)\n\n## 文献阅读笔记\n\n* [增强子和启动子真的是两种完全不同的调控元件吗？【Nature Reviews Genetics】文献阅读](https://www.jianshu.com/p/7cee57558c32) \n* [TT-seq 文献阅读 (TT-seq maps the human transient transcriptome)](https://www.jianshu.com/p/e21ba67460ac) \n* [eRNA 文献阅读](https://www.jianshu.com/p/61d95dd791b2) \n* [PRO-seq 文献阅读](https://www.jianshu.com/p/35d2f771669b) \n* [增强子 (enhancer) 靶向表观基因组编辑技术 enCRISPRa 和 enCRISPRi 文献学习](https://www.jianshu.com/p/f41632859d39) \n* [CROP-seq 文献学习（CRISPR 液滴测序）](https://www.jianshu.com/p/9dd472bcd5e0) \n* [SMRT 测序文献阅读笔记](https://www.jianshu.com/p/6eaca6ab8f8e) \n* [文献阅读笔记：CUT&RUN](https://www.jianshu.com/p/5a1c31ee6c51) \n* [文献阅读笔记：CUT&Tag](https://www.jianshu.com/p/335aec753039) \n* [文献阅读 Orchestrating single-cell analysis with Bioconductor](https://www.jianshu.com/p/d5b91b271fdf) \n* [文献阅读：细胞异质性的表观遗传学基础](https://www.jianshu.com/p/de867ea346ca) \n* [【文献笔记】DNA，RNA 以及组蛋白的甲基化在衰老和肿瘤中的作用](https://www.jianshu.com/p/4fe83e6e67ad)\n\n## StatQuest 视频学习笔记\n\n* [StatQuest——生物信息相关原理的入门系列 (一)](https://www.jianshu.com/p/0f8fa0b8f86d) \n* [StatQuest——生物信息相关原理的入门系列 (二)](https://www.jianshu.com/p/69b18da08a46) \n* [StatQuest（PCA 系列）step by step 为你解释 PCA 的那些事儿](https://www.jianshu.com/p/dffd1c8f99b0) \n* [StatQuest——t-SNE 视频笔记](https://www.jianshu.com/p/a2b3c68416c5) \n* [StatQuest——Hierarchical Clustering 学习笔记](https://www.jianshu.com/p/46f0aef6b5c3) \n* [StatQuest——K-means 到底是什么？](https://www.jianshu.com/p/609226bdb66f) \n* [StatQuest - 你想很轻松的理解 Covariance 和 Correlation 吗?(Part 1)](https://www.jianshu.com/p/7b797da06ed4) \n* [StatQuest - 你想很轻松的理解 Covariance 和 Correlation 吗?(Part 2)](https://www.jianshu.com/p/85023ee0a164)\n\n## Epigenetics 笔记\n\n* [Epigenetics 笔记一：Writers, Readers, Erasers](https://www.jianshu.com/p/96c8eb5561fe) \n* [Epigenetics 文献学习：Regulation of chromatin by histone modifications](https://www.jianshu.com/p/1193ab2f463c) \n* [Epigenetics 文献学习：染色质结构域](https://www.jianshu.com/p/b9869113bd10) \n* [Epigenetics 文献阅读：The molecular hallmarks of epigenetic control](https://www.jianshu.com/p/c9725c44e659) \n* [Epigenetics 文献学习：Writing, erasing and reading histone lysine methylation](https://www.jianshu.com/p/aa77686648c0) \n* [Epigenetics 文献学习：Histone H3 突变的致癌机制](https://www.jianshu.com/p/b73c50e1dbe0)\n* [Epigenetics 文献学习：组蛋白标记在控制转录周期中的功能作用](https://www.jianshu.com/p/b9d061fa238f) \n* [SWI/SNF 复合体在肿瘤里的作用](https://www.jianshu.com/p/80b321e03d11) \n* [新英格兰医学：癌症的表观遗传治疗](https://www.jianshu.com/p/1a0dd75d7a00) \n* [NATURE: 组蛋白标记 H3K36me2 招募 DNMT3A 并调节基因间 DNA 甲基化分布](https://www.jianshu.com/p/8d554f3cf96f) \n* [NATURE: 基因 - 环境协同诱导的表观遗传程序起始肿瘤发生](https://www.jianshu.com/p/a7b75ab3472e) \n* [NATURE: 组蛋白甲基转移酶 NSD3 异常活化可诱导肺鳞状细胞癌的发生](https://www.jianshu.com/p/6a7e68be2de7) \n* [NATURE: 组蛋白变体在调节染色质组织和功能中的作用](https://www.jianshu.com/p/cd4a0b857d6f) \n* [Nature Reviews Cancer: 实体瘤 \"劫持\" 组蛋白变体互作网络](https://www.jianshu.com/p/e152c798e047) \n* [Nature Reviews Genetics：3D 基因组组织工程](https://www.jianshu.com/p/b20db6b067e1) \n* [NCB: 核纤层的功能机制与异常](https://www.jianshu.com/p/2cd3158ae9ee) \n* [CUT&RUN 实验原理和步骤](https://www.jianshu.com/p/3927a7ba6176) \n* [【Nature Review Cancer】癌症中染色质修饰的 “language”](https://www.jianshu.com/p/f2f39a327ec9)\n\n","source":"_posts/简书笔记汇总.md","raw":"---\ntitle: 简书笔记汇总\ncategories:\n  - - code\n    - inbox\ntags:\n  - note\n  - bioinformatics\ntop: true\nabbrlink: b3b948e8\ndate: 2023-05-17 21:54:53\n---\n\n简书作者：[生信start_site](https://www.jianshu.com/u/d3b898b259fa)\n\n## Linux 学习笔记\n\n* [《Linux 命令行与 shell 脚本编程大全》第 11 章笔记（上）](https://www.jianshu.com/p/192946dce252) \n* [《Linux 命令行与 shell 脚本编程大全》第 11 章笔记（下）](https://www.jianshu.com/p/4d1a77d3b236) \n* [结构化命令 之 if-then； if-then-else 语句](https://www.jianshu.com/p/f6edec3d8b36) \n* [结构化命令 之 test 命令 (长文慎入）](https://www.jianshu.com/p/6557b3b6ca4f) \n* [结构化命令 之 复合条件测试](https://www.jianshu.com/p/c183fdbb08ca) \n* [结构化命令 之 if-then 高级特性](https://www.jianshu.com/p/d1b0911def71) \n* [结构化命令 之 case 命令](https://www.jianshu.com/p/ee6b85e04932) \n* [结构化命令 之 for 命令](https://www.jianshu.com/p/f679a812fa0d) \n\n<!--more-->\n\n* [结构化命令 之 while 命令](https://www.jianshu.com/p/6c9ec8ae4869) \n* [结构化命令 之 until 命令](https://www.jianshu.com/p/9cc269d62a06) \n* [结构化命令 之 嵌套循环](https://www.jianshu.com/p/9c415e7f1d19) \n* [控制循环](https://www.jianshu.com/p/93bd151f83e2) \n* [处理循环的输出](https://www.jianshu.com/p/59317149d162) \n* [shell 脚本编程 -- 处理用户输入](https://www.jianshu.com/p/d630d5556543) \n* [如何使用服务器下载和处理文件 / 以及传输文件至本地文件夹](https://www.jianshu.com/p/80cef33ed41c) \n* [利用 TrimGalore 去除 adapter 以及过滤 fastq 文件](https://www.jianshu.com/p/aca43442e931) \n* [更改 Putty 主题背景](https://www.jianshu.com/p/a7620c2ea275) \n* [如何根据染色体坐标批量提取对应的 DNA 序列（bedtools）](https://www.jianshu.com/p/3e6deaf83da9) \n* [计算 bam 文件中比对上基因组的 reads 以及合并多个 bam 文件](https://www.jianshu.com/p/05cbc7bd06bc) \n* [file 命令，find 命令](https://www.jianshu.com/p/0360ac5f37ca) \n* [怎么在 linux 里访问 U 盘里的数据](https://www.jianshu.com/p/19429118636a) \n* [输入 / 输出 / 重定向](https://www.jianshu.com/p/299c0da5f341)\n\n## R 学习笔记\n\n* [如何在散点图里添加特定标签](https://www.jianshu.com/p/4adb658a60ee) \n* [如何修改操作系统分配给 R 的内存上限](https://www.jianshu.com/p/fc2382c436f1) \n* [用 R 画 Circular barplot 图（环状柱形图）](https://www.jianshu.com/p/631381890ad4) \n* [用 R 画弧形图（Arc Diagram）](https://www.jianshu.com/p/0b13f75d9a9d) \n* [GENIE3——一款预测基因调控网络的 R 包](https://www.jianshu.com/p/d71dcd4cff5a) \n* [RNA-seq 的差异基因除了热图 / 火山图，你还可以如何展示？](https://www.jianshu.com/p/c90238849858) \n* [RCircos 包的使用](https://www.jianshu.com/p/799ef8f2bfcb) \n* [洛克菲勒大学 2021 年生信课 1：Introduction to R, session 1](https://www.jianshu.com/p/c2b91bc4a033) \n* [洛克菲勒大学 2021 年生信课 2：Introduction to R, session 2](https://www.jianshu.com/p/458f59261246)\n\n## python 学习笔记\n\n* [学习 Python: 最开始的开始（入门教程 + 软件安装）](https://www.jianshu.com/p/78809acafb36) \n* [Biopython 学习笔记（一）](https://www.jianshu.com/p/7d1fe73e4d66) \n* [Biopython 学习笔记（二）序列的分析](https://www.jianshu.com/p/a804bd33b4f7) \n* [Biopython 学习笔记（三）Blast](https://www.jianshu.com/p/04d846da001b) \n* [Biopython 学习笔记（四）访问 NCBI Entrez 数据库](https://www.jianshu.com/p/30bff68b1dda) \n* [利用 scanpy 进行单细胞测序分析（一）预处理和聚类](https://www.jianshu.com/p/2855145686a6) \n* [利用 scanpy 进行单细胞测序分析（二）轨迹推断](https://www.jianshu.com/p/58cb6419de09) \n* [利用 scanpy 进行单细胞测序分析（三）Marker 基因的可视化](https://www.jianshu.com/p/e29365002cb0) \n* [ipython 的初步了解](https://www.jianshu.com/p/fbb9f2520a59) \n* [Numpy 笔记（NumPy ndarray）](https://www.jianshu.com/p/a85c9ff81ebc) \n* [Numpy 笔记（Transposing Arrays）](https://www.jianshu.com/p/ac562796aebd) \n* [Numpy 笔记 (File Input and Output with Arrays)](https://www.jianshu.com/p/a4f3b0da44f1) \n* [pandas 笔记（pandas Data Structures）](https://www.jianshu.com/p/5c779efd288b) \n* [pandas 笔记（Essential Functionality）](https://www.jianshu.com/p/8b727bba5ecf) \n* [pandas 笔记（Summarizing and Computing Descriptive Statistics）](https://www.jianshu.com/p/f9f35b3e2584) \n* [pandas 笔记（Handling Missing Data）](https://www.jianshu.com/p/c373f5b38249) \n* [pandas 笔记 (Data Transformation)](https://www.jianshu.com/p/f16e162cf7ee) \n* [python 可视化：matplotlib 学习笔记](https://www.jianshu.com/p/9a7f62a30a68) \n* [python 可视化：Plotting with pandas and seaborn](https://www.jianshu.com/p/3fde65074a9d) \n* [python 笔记：Functions](https://www.jianshu.com/p/ec120b0e42d5) \n* [python 笔记：将 function 储存在 module 里](https://www.jianshu.com/p/fee26614135b) \n* [python 笔记：Class（类）](https://www.jianshu.com/p/b6f8c44caed7) \n* [python 笔记：打开 / 访问文件](https://www.jianshu.com/p/1c25a07fb114)\n\n## perl 学习笔记\n\n* [Learning Perl 学习笔记（1）第二章 Scalar Data](https://www.jianshu.com/p/e7e9006d3a82) \n* [Learning Perl 学习笔记（2）第三章 Lists and Arrays](https://www.jianshu.com/p/448ac3434104) \n* [Learning Perl 学习笔记（3）第四章：子程序](https://www.jianshu.com/p/ecd8e26d4a96) \n* [Learning Perl 学习笔记（4）第五章 Input and Output](https://www.jianshu.com/p/5bf7ecb14361) \n* [Learning Perl 学习笔记（5）第六章 Hashes](https://www.jianshu.com/p/9ca226b57ed5) \n* [Learning Perl 学习笔记（6）第七章 正则表达式](https://www.jianshu.com/p/ac8092758ac2) \n* [Learning Perl 学习笔记（7）第八章 使用正则表达式进行 matching](https://www.jianshu.com/p/d4638b79ddea) \n* [Learning Perl 学习笔记（8）第九章 Processing Text with Regular Expressions](https://www.jianshu.com/p/cf0db9d9c671) \n* [Learning Perl 学习笔记（9）：Strings and Sorting](https://www.jianshu.com/p/f6e31c0b0ab7) \n* [circos 软件使用初探](https://www.jianshu.com/p/372d83b89229) \n* [circos 软件学习笔记：语法、颜色、字体和文件格式](https://www.jianshu.com/p/f1a206893744) \n* [circos 软件学习笔记：添加刻度](https://www.jianshu.com/p/4c8fc9d8fe78) \n* [circos 软件学习笔记：更改染色体的比例、颜色、方向](https://www.jianshu.com/p/9a57e583d7c5) \n* [circos 软件学习笔记：在圆圈里添加 lines（interaction）](https://www.jianshu.com/p/dba889089dee)\n\n## 转录组学习笔记\n\n* [RNA-seq 练习 第一部分（原始数据下载，提取 fastq 文件，fastqc 质控）](https://www.jianshu.com/p/055732b6ac99) \n* [RNA-seq 练习 第二部分（基因组序列下载，注释文件下载，索引下载，比对，比对质控, HTseq-count 计数，输出 count 矩阵文件）](https://www.jianshu.com/p/849f8ada0ab7) \n* [RNA-seq 练习 第三部分（DEseq2 筛选差异表达基因, 可视化）](https://www.jianshu.com/p/82787ddada38) \n* [理解 SAM 文件格式以及过滤 sam 文件](https://www.jianshu.com/p/7d15173540ae) \n* [GSEA 学习笔记](https://www.jianshu.com/p/aae9b0322b83) \n* [几种标准化方法的学习笔记](https://www.jianshu.com/p/c2605b5b8c0a) \n* [比对软件 STAR 的使用](https://www.jianshu.com/p/5b6dfc954315)\n\n## ChIP-seq & ATAC-seq 笔记\n\n* [ChIP-seq 实践 (H3K27Ac,enhancer 的筛选和 enhancer 相关基因的 GO 分析)](https://www.jianshu.com/p/05aae63d7c52) \n* [ChIP-seq 实践（非转录因子，非组蛋白）](https://www.jianshu.com/p/2138c99ce30a) \n* [在 IGV 里同时查看多个 region/gene](https://www.jianshu.com/p/cc01ad9db959) \n* [ATAC-seq 分析练习](https://www.jianshu.com/p/57d4420056dd) \n* [结合 CHIP-seq 和 ATAC-seq 结果进行分析](https://www.jianshu.com/p/1e3d15c325e9) \n* [GREAT 网页版学习笔记（预测顺式调控元件）](https://www.jianshu.com/p/7f6ce4f238cb) \n* [使用 HINT-ATAC 进行 ATAC-Seq 的 footprinting 分析](https://www.jianshu.com/p/6aba8f1dea56) \n* [用 MEME-CHIP 预测转录因子的结合](https://www.jianshu.com/p/66deb4c008f5)  \n* [利用 HOMER 预测目标序列的 motif（从运行程序到结果解读，以及注意事项）](https://www.jianshu.com/p/467d970ec097) \n* [Motif scanning tool: FIMO（在线版分析笔记）](https://www.jianshu.com/p/37eadb126bbf) \n* [如何提取 ATAC-seq 数据的差异 peaks?（DiffBind 包的使用）](https://www.jianshu.com/p/b74c8077d893) \n* [shadow enhancers](https://www.jianshu.com/p/0f674e88c1ce)\n\n## CUT&Tag 学习笔记\n\n* [CUT&Tag 数据分析笔记（1）](https://www.jianshu.com/p/1a23656a0713) \n* [CUT&Tag 数据分析笔记（2）](https://www.jianshu.com/p/7d45ec853ff8) \n* [CUT&Tag 数据分析笔记（3）](https://www.jianshu.com/p/47f30acd68f1)\n\n## Hi-C 学习笔记\n\n* [Hi-C 技术的初步了解](https://www.jianshu.com/p/e3c198d75345) \n* [Hi-C 分析练习（从 fastq 文件到 contact 矩阵）](https://www.jianshu.com/p/e7757fa94624) \n* [Hi-C 分析练习（从 cool 文件到可视化热图）](https://www.jianshu.com/p/495c576f0f0f)\n\n## 甲基化测序分析学习笔记\n\n* [陈巍学基因视频学习记录 -- 甲基化测序](https://www.jianshu.com/p/316faa7e0642) \n* [Bismark Bisulfite Mapper 学习笔记（一）数据预处理](https://www.jianshu.com/p/4c64858003c1) \n* [Bismark Bisulfite Mapper 学习笔记（二）甲基化信息提取以及文件解读](https://www.jianshu.com/p/e71184d03ace) \n* [WGBS vs RRBS](https://www.jianshu.com/p/f8a02e164f5a)\n\n## 单细胞转录组学习笔记\n\n* [单细胞 RNA-seq 入门文献学习](https://www.jianshu.com/p/b79171dddb0d) \n* [单细胞测序实战（第一部分）](https://www.jianshu.com/p/a70c831c95f5) \n* [单细胞测序实战（第二部分）](https://www.jianshu.com/p/b7fec167f4eb)\n* [单细胞测序实战（第三部分）](https://www.jianshu.com/p/c206818ad0c6) \n* [(Smartseq2) single cell RNA-seq 分析练习](https://www.jianshu.com/p/dee97289586c) \n* [10× 单细胞测序分析练习（一）](https://www.jianshu.com/p/705a348e8623) \n* [10× 单细胞测序分析练习（二）](https://www.jianshu.com/p/62db41020ad2) \n* [单细胞测序分析之 Monocle2 包学习笔记](https://www.jianshu.com/p/f6186755aae5) \n* [单细胞测序分析之 Seurat（3.0）包学习笔记](https://www.jianshu.com/p/26d3648b2e1f) \n* [单细胞测序分析之 scater 包学习笔记](https://www.jianshu.com/p/4c20a7866ce6) \n* [Single cell RNA-seq data analysis with R 视频学习笔记（一）](https://www.jianshu.com/p/ff637a0b7ff5) \n* [Single cell RNA-seq data analysis with R 视频学习笔记（二）](https://www.jianshu.com/p/e64b7b92f9e2) \n* [Single cell RNA-seq data analysis with R 视频学习笔记（三）](https://www.jianshu.com/p/0e13ecde84b6) \n* [Single cell RNA-seq data analysis with R 视频学习笔记（四、五）](https://www.jianshu.com/p/ca1a955f5046) \n* [单细胞测序数据整合练习（详细代码）](https://www.jianshu.com/p/3b9a0204d65b) \n* [Single cell RNA-seq data analysis with R 视频学习笔记（六）](https://www.jianshu.com/p/7af86cc04e7d) \n* [Single cell RNA-seq data analysis with R 视频学习笔记（七）](https://www.jianshu.com/p/f20cfd1fa326) \n* [Single cell RNA-seq data analysis with R 视频学习笔记（八）](https://www.jianshu.com/p/adb692e71bf9) \n* [Single cell RNA-seq data analysis with R 视频学习笔记（九：空间转录组）](https://www.jianshu.com/p/88372e79a863) \n* [单细胞轨迹推断（Trajectory inference）分析（详细代码）](https://www.jianshu.com/p/16ebecb3b5fa) \n* [RNA velocity of single cells 文献学习](https://www.jianshu.com/p/f6f48d6594ce) \n* [RNA velocity 分析练习（一）文件下载以及预处理](https://www.jianshu.com/p/e65964f39eb3) \n* [RNA velocity 分析练习（二）软件安装](https://www.jianshu.com/p/df6c16cc2bc2) \n* [RNA velocity 分析练习（三）生成 loom 文件](https://www.jianshu.com/p/bce19672879e) \n* [RNA velocity 分析练习（四）聚类以及 velocity 可视化](https://www.jianshu.com/p/d6c92dd67166) \n* [cellranger 使用的初步探索（1）](https://www.jianshu.com/p/08f75901cc3e) \n* [cellranger 使用的初步探索（2）理解 cellranger count 输出文件](https://www.jianshu.com/p/57bda7d71b18) \n* [cellranger 使用的初步探索（3）cellranger aggr](https://www.jianshu.com/p/ca726a8979d7) \n* [cellranger 使用的初步探索（4）：R 读取 cellranger 的输出文件](https://www.jianshu.com/p/0fbf5b29f2ae)\n\n## 单细胞 ATAC-seq 学习笔记\n\n* [Single-Cell ATAC-Seq 的初步了解](https://www.jianshu.com/p/7d8058efb8e5) \n* [scATAC-seq 数据分析练习（成年小鼠大脑组织）](https://www.jianshu.com/p/ef7531c7d07d) \n* [[scATAC-seq] 利用 Monocle3 构建细胞 “轨迹”](https://www.jianshu.com/p/17a0a1cafade) \n* [ArchR 官网教程学习笔记 1：Getting Started with ArchR](https://www.jianshu.com/p/a2bcdfb77961) \n* [ArchR 官网教程学习笔记 2: 基于 ArchR 推测 Doublet](https://www.jianshu.com/p/5ec81b5bb3ea) \n* [ArchR 官网教程学习笔记 3: 创建 ArchRProject](https://www.jianshu.com/p/9243973a35e6) \n* [ArchR 官网教程学习笔记 4:ArchR 的降维](https://www.jianshu.com/p/98d702592720) \n* [ArchR 官网教程学习笔记 5:ArchR 的聚类](https://www.jianshu.com/p/91007564ffdc) \n* [ArchR 官网教程学习笔记 6: 单细胞嵌入（Single-cell Embeddings）](https://www.jianshu.com/p/16904f84b8ba) \n* [ArchR 官网教程学习笔记 7:ArchR 的基因评分和 Marker 基因](https://www.jianshu.com/p/45d1d47fdcd3) \n* [ArchR 官网教程学习笔记 8: 定义与 scRNA-seq 一致的聚类](https://www.jianshu.com/p/60ce90ba67a9) \n* [ArchR 官网教程学习笔记 9:ArchR 的伪批量重复](https://www.jianshu.com/p/9aae0389875d) \n* [ArchR 官网教程学习笔记 10:ArchR 的 call peak](https://www.jianshu.com/p/30fb540e95ec) \n* [ArchR 官网教程学习笔记 11: 鉴定 Marker 峰](https://www.jianshu.com/p/79fa167c914d) \n* [ArchR 官网教程学习笔记 12:Motif 和 Feature 富集](https://www.jianshu.com/p/662c626123b5) \n* [ArchR 官网教程学习笔记 13:ChromVAR 偏差富集](https://www.jianshu.com/p/8bd8da9a9ba8) \n* [ArchR 官网教程学习笔记 14:ArchR 的 Footprinting 分析](https://www.jianshu.com/p/40946d10c63c) \n* [ArchR 官网教程学习笔记 15:ArchR 的整合分析](https://www.jianshu.com/p/b3f538f86feb) \n* [ArchR 官网教程学习笔记 16（上）:ArchR 的轨迹推断分析](https://www.jianshu.com/p/519b1a69e1d6) \n* [ArchR 官网教程学习笔记 16（下）:ArchR 的轨迹推断分析](https://www.jianshu.com/p/9de6526e45a2)\n\n## TCGA 数据库学习笔记\n\n* [TCGA 数据库的初次了解](https://www.jianshu.com/p/d662069a4a3d) \n* [如何批量下载 TCGA 里的数据（gdc-client 方法）](https://www.jianshu.com/p/43a915fc8ee9) \n* [利用 R 包 TCGAbiolinks 进行各种数据下载](https://www.jianshu.com/p/3b4c07f7e5f3) \n* [TCGA 的差异基因分析](https://www.jianshu.com/p/e18068180ee5) \n* [整合 gdc-client 批量下载的文件](https://www.jianshu.com/p/72b0fa510086) \n* [如何把从 TCGA 下载的 HTseq count 转换成 FPKM](https://www.jianshu.com/p/4afbdc8fd8ed) \n* [如何生成 WGCNA 分析所需的临床表型信息](https://www.jianshu.com/p/0ac52f582ea4) \n* [WGCNA 学习笔记](https://www.jianshu.com/p/0d05d1f007e7) \n* [TCGA 数据生存分析](https://www.jianshu.com/p/fd5e06ec260b) \n* [TCGA 甲基化数据下载以及相关临床信息整理](https://www.jianshu.com/p/1ceace2b581c) \n* [TCGA 甲基化数据质量控制和差异分析（使用 ChAMP 包）](https://www.jianshu.com/p/27269f95d9c1) \n* [如何将 WGCNA 导出的基因共表达网络进行可视化（cytoscape 软件的使用）](https://www.jianshu.com/p/d75e1199f8b1) \n* [TCGA 数据库 MAF 文件的分析以及可视化（maftools 包的使用）](https://www.jianshu.com/p/967d52171777) \n* [TCGA 数据库 copy number variation 数据分析（第一部分：从数据下载到 GISTIC 输出文件）](https://www.jianshu.com/p/b8351a86a40b) \n* [TCGA 数据库 copy number variation 数据分析（第二部分：利用 maftools 进行可视化）](https://www.jianshu.com/p/dbc90a1475c1)\n\n## GEO 数据库学习笔记\n\n* [GEO 数据库视频学习笔记（芯片数据下载和数据读取）](https://www.jianshu.com/p/51711c22934d) \n* [GEO 数据库视频学习笔记（ID 转换）](https://www.jianshu.com/p/d64a1ddf1128) \n* [GEO 数据库视频学习笔记（了解你的表达矩阵）](https://www.jianshu.com/p/c94875df0155) \n* [GEO 数据库视频学习笔记（差异分析、可视化、GSEA）](https://www.jianshu.com/p/4486c6624ef9)\n\n## cBioPortal 数据库学习笔记\n\n* [cBioPortal 学习笔记（1）](https://www.jianshu.com/p/b458796366a4) \n* [cBioPortal 学习笔记（2）](https://www.jianshu.com/p/cf0d1f407601)\n\n## WGS 学习笔记\n\n* [GATK 的初次了解](https://www.jianshu.com/p/4177a7afc798) \n* [GATK 官网学习笔记 Data pre-processing for variant discovery](https://www.jianshu.com/p/9fce93c1a337) \n* [Broad Institute 视频笔记 Introduction to High-throughput Sequencing Data](https://www.jianshu.com/p/b93f8f4a1ed7) \n* [Broad Institute 视频笔记 Introduction to Data Preprocessing](https://www.jianshu.com/p/8ace60832c13) \n* [Broad Institute 视频笔记 Introduction to Variant Discovery](https://www.jianshu.com/p/5bf73e5a3390) \n* [Broad Institute 视频笔记 Introduction to Germline Variant Discovery](https://www.jianshu.com/p/c032b7a1909c) \n* [Broad Institute 视频笔记 Introduction to Somatic Variant Discovery](https://www.jianshu.com/p/6e0b483f1234) \n* [Broad Institue 视频笔记：Variant Calling with HaplotypeCaller](https://www.jianshu.com/p/9c049c46a26d) \n* [Broad Institute 视频笔记 Hello World WDL Tutorial](https://www.jianshu.com/p/241595e0ed39) \n* [Broad Institute 视频笔记 Run Haplotypecaller（WDL+Cromwell）](https://www.jianshu.com/p/2c4a792b49fe)\n\n## 文献阅读笔记\n\n* [增强子和启动子真的是两种完全不同的调控元件吗？【Nature Reviews Genetics】文献阅读](https://www.jianshu.com/p/7cee57558c32) \n* [TT-seq 文献阅读 (TT-seq maps the human transient transcriptome)](https://www.jianshu.com/p/e21ba67460ac) \n* [eRNA 文献阅读](https://www.jianshu.com/p/61d95dd791b2) \n* [PRO-seq 文献阅读](https://www.jianshu.com/p/35d2f771669b) \n* [增强子 (enhancer) 靶向表观基因组编辑技术 enCRISPRa 和 enCRISPRi 文献学习](https://www.jianshu.com/p/f41632859d39) \n* [CROP-seq 文献学习（CRISPR 液滴测序）](https://www.jianshu.com/p/9dd472bcd5e0) \n* [SMRT 测序文献阅读笔记](https://www.jianshu.com/p/6eaca6ab8f8e) \n* [文献阅读笔记：CUT&RUN](https://www.jianshu.com/p/5a1c31ee6c51) \n* [文献阅读笔记：CUT&Tag](https://www.jianshu.com/p/335aec753039) \n* [文献阅读 Orchestrating single-cell analysis with Bioconductor](https://www.jianshu.com/p/d5b91b271fdf) \n* [文献阅读：细胞异质性的表观遗传学基础](https://www.jianshu.com/p/de867ea346ca) \n* [【文献笔记】DNA，RNA 以及组蛋白的甲基化在衰老和肿瘤中的作用](https://www.jianshu.com/p/4fe83e6e67ad)\n\n## StatQuest 视频学习笔记\n\n* [StatQuest——生物信息相关原理的入门系列 (一)](https://www.jianshu.com/p/0f8fa0b8f86d) \n* [StatQuest——生物信息相关原理的入门系列 (二)](https://www.jianshu.com/p/69b18da08a46) \n* [StatQuest（PCA 系列）step by step 为你解释 PCA 的那些事儿](https://www.jianshu.com/p/dffd1c8f99b0) \n* [StatQuest——t-SNE 视频笔记](https://www.jianshu.com/p/a2b3c68416c5) \n* [StatQuest——Hierarchical Clustering 学习笔记](https://www.jianshu.com/p/46f0aef6b5c3) \n* [StatQuest——K-means 到底是什么？](https://www.jianshu.com/p/609226bdb66f) \n* [StatQuest - 你想很轻松的理解 Covariance 和 Correlation 吗?(Part 1)](https://www.jianshu.com/p/7b797da06ed4) \n* [StatQuest - 你想很轻松的理解 Covariance 和 Correlation 吗?(Part 2)](https://www.jianshu.com/p/85023ee0a164)\n\n## Epigenetics 笔记\n\n* [Epigenetics 笔记一：Writers, Readers, Erasers](https://www.jianshu.com/p/96c8eb5561fe) \n* [Epigenetics 文献学习：Regulation of chromatin by histone modifications](https://www.jianshu.com/p/1193ab2f463c) \n* [Epigenetics 文献学习：染色质结构域](https://www.jianshu.com/p/b9869113bd10) \n* [Epigenetics 文献阅读：The molecular hallmarks of epigenetic control](https://www.jianshu.com/p/c9725c44e659) \n* [Epigenetics 文献学习：Writing, erasing and reading histone lysine methylation](https://www.jianshu.com/p/aa77686648c0) \n* [Epigenetics 文献学习：Histone H3 突变的致癌机制](https://www.jianshu.com/p/b73c50e1dbe0)\n* [Epigenetics 文献学习：组蛋白标记在控制转录周期中的功能作用](https://www.jianshu.com/p/b9d061fa238f) \n* [SWI/SNF 复合体在肿瘤里的作用](https://www.jianshu.com/p/80b321e03d11) \n* [新英格兰医学：癌症的表观遗传治疗](https://www.jianshu.com/p/1a0dd75d7a00) \n* [NATURE: 组蛋白标记 H3K36me2 招募 DNMT3A 并调节基因间 DNA 甲基化分布](https://www.jianshu.com/p/8d554f3cf96f) \n* [NATURE: 基因 - 环境协同诱导的表观遗传程序起始肿瘤发生](https://www.jianshu.com/p/a7b75ab3472e) \n* [NATURE: 组蛋白甲基转移酶 NSD3 异常活化可诱导肺鳞状细胞癌的发生](https://www.jianshu.com/p/6a7e68be2de7) \n* [NATURE: 组蛋白变体在调节染色质组织和功能中的作用](https://www.jianshu.com/p/cd4a0b857d6f) \n* [Nature Reviews Cancer: 实体瘤 \"劫持\" 组蛋白变体互作网络](https://www.jianshu.com/p/e152c798e047) \n* [Nature Reviews Genetics：3D 基因组组织工程](https://www.jianshu.com/p/b20db6b067e1) \n* [NCB: 核纤层的功能机制与异常](https://www.jianshu.com/p/2cd3158ae9ee) \n* [CUT&RUN 实验原理和步骤](https://www.jianshu.com/p/3927a7ba6176) \n* [【Nature Review Cancer】癌症中染色质修饰的 “language”](https://www.jianshu.com/p/f2f39a327ec9)\n\n","slug":"简书笔记汇总","published":1,"updated":"2023-05-18T10:06:18.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm4peu6n0000tdbzr5rrgeac0","content":"<p>简书作者：<a href=\"https://www.jianshu.com/u/d3b898b259fa\">生信start_site</a></p>\n<h2 id=\"linux-学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#linux-学习笔记\"></a> Linux 学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/192946dce252\">《Linux 命令行与 shell 脚本编程大全》第 11 章笔记（上）</a></li>\n<li><a href=\"https://www.jianshu.com/p/4d1a77d3b236\">《Linux 命令行与 shell 脚本编程大全》第 11 章笔记（下）</a></li>\n<li><a href=\"https://www.jianshu.com/p/f6edec3d8b36\">结构化命令 之 if-then； if-then-else 语句</a></li>\n<li><a href=\"https://www.jianshu.com/p/6557b3b6ca4f\">结构化命令 之 test 命令 (长文慎入）</a></li>\n<li><a href=\"https://www.jianshu.com/p/c183fdbb08ca\">结构化命令 之 复合条件测试</a></li>\n<li><a href=\"https://www.jianshu.com/p/d1b0911def71\">结构化命令 之 if-then 高级特性</a></li>\n<li><a href=\"https://www.jianshu.com/p/ee6b85e04932\">结构化命令 之 case 命令</a></li>\n<li><a href=\"https://www.jianshu.com/p/f679a812fa0d\">结构化命令 之 for 命令</a></li>\n</ul>\n<span id=\"more\"></span>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/6c9ec8ae4869\">结构化命令 之 while 命令</a></li>\n<li><a href=\"https://www.jianshu.com/p/9cc269d62a06\">结构化命令 之 until 命令</a></li>\n<li><a href=\"https://www.jianshu.com/p/9c415e7f1d19\">结构化命令 之 嵌套循环</a></li>\n<li><a href=\"https://www.jianshu.com/p/93bd151f83e2\">控制循环</a></li>\n<li><a href=\"https://www.jianshu.com/p/59317149d162\">处理循环的输出</a></li>\n<li><a href=\"https://www.jianshu.com/p/d630d5556543\">shell 脚本编程 – 处理用户输入</a></li>\n<li><a href=\"https://www.jianshu.com/p/80cef33ed41c\">如何使用服务器下载和处理文件 / 以及传输文件至本地文件夹</a></li>\n<li><a href=\"https://www.jianshu.com/p/aca43442e931\">利用 TrimGalore 去除 adapter 以及过滤 fastq 文件</a></li>\n<li><a href=\"https://www.jianshu.com/p/a7620c2ea275\">更改 Putty 主题背景</a></li>\n<li><a href=\"https://www.jianshu.com/p/3e6deaf83da9\">如何根据染色体坐标批量提取对应的 DNA 序列（bedtools）</a></li>\n<li><a href=\"https://www.jianshu.com/p/05cbc7bd06bc\">计算 bam 文件中比对上基因组的 reads 以及合并多个 bam 文件</a></li>\n<li><a href=\"https://www.jianshu.com/p/0360ac5f37ca\">file 命令，find 命令</a></li>\n<li><a href=\"https://www.jianshu.com/p/19429118636a\">怎么在 linux 里访问 U 盘里的数据</a></li>\n<li><a href=\"https://www.jianshu.com/p/299c0da5f341\">输入 / 输出 / 重定向</a></li>\n</ul>\n<h2 id=\"r-学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#r-学习笔记\"></a> R 学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/4adb658a60ee\">如何在散点图里添加特定标签</a></li>\n<li><a href=\"https://www.jianshu.com/p/fc2382c436f1\">如何修改操作系统分配给 R 的内存上限</a></li>\n<li><a href=\"https://www.jianshu.com/p/631381890ad4\">用 R 画 Circular barplot 图（环状柱形图）</a></li>\n<li><a href=\"https://www.jianshu.com/p/0b13f75d9a9d\">用 R 画弧形图（Arc Diagram）</a></li>\n<li><a href=\"https://www.jianshu.com/p/d71dcd4cff5a\">GENIE3——一款预测基因调控网络的 R 包</a></li>\n<li><a href=\"https://www.jianshu.com/p/c90238849858\">RNA-seq 的差异基因除了热图 / 火山图，你还可以如何展示？</a></li>\n<li><a href=\"https://www.jianshu.com/p/799ef8f2bfcb\">RCircos 包的使用</a></li>\n<li><a href=\"https://www.jianshu.com/p/c2b91bc4a033\">洛克菲勒大学 2021 年生信课 1：Introduction to R, session 1</a></li>\n<li><a href=\"https://www.jianshu.com/p/458f59261246\">洛克菲勒大学 2021 年生信课 2：Introduction to R, session 2</a></li>\n</ul>\n<h2 id=\"python-学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#python-学习笔记\"></a> python 学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/78809acafb36\">学习 Python: 最开始的开始（入门教程 + 软件安装）</a></li>\n<li><a href=\"https://www.jianshu.com/p/7d1fe73e4d66\">Biopython 学习笔记（一）</a></li>\n<li><a href=\"https://www.jianshu.com/p/a804bd33b4f7\">Biopython 学习笔记（二）序列的分析</a></li>\n<li><a href=\"https://www.jianshu.com/p/04d846da001b\">Biopython 学习笔记（三）Blast</a></li>\n<li><a href=\"https://www.jianshu.com/p/30bff68b1dda\">Biopython 学习笔记（四）访问 NCBI Entrez 数据库</a></li>\n<li><a href=\"https://www.jianshu.com/p/2855145686a6\">利用 scanpy 进行单细胞测序分析（一）预处理和聚类</a></li>\n<li><a href=\"https://www.jianshu.com/p/58cb6419de09\">利用 scanpy 进行单细胞测序分析（二）轨迹推断</a></li>\n<li><a href=\"https://www.jianshu.com/p/e29365002cb0\">利用 scanpy 进行单细胞测序分析（三）Marker 基因的可视化</a></li>\n<li><a href=\"https://www.jianshu.com/p/fbb9f2520a59\">ipython 的初步了解</a></li>\n<li><a href=\"https://www.jianshu.com/p/a85c9ff81ebc\">Numpy 笔记（NumPy ndarray）</a></li>\n<li><a href=\"https://www.jianshu.com/p/ac562796aebd\">Numpy 笔记（Transposing Arrays）</a></li>\n<li><a href=\"https://www.jianshu.com/p/a4f3b0da44f1\">Numpy 笔记 (File Input and Output with Arrays)</a></li>\n<li><a href=\"https://www.jianshu.com/p/5c779efd288b\">pandas 笔记（pandas Data Structures）</a></li>\n<li><a href=\"https://www.jianshu.com/p/8b727bba5ecf\">pandas 笔记（Essential Functionality）</a></li>\n<li><a href=\"https://www.jianshu.com/p/f9f35b3e2584\">pandas 笔记（Summarizing and Computing Descriptive Statistics）</a></li>\n<li><a href=\"https://www.jianshu.com/p/c373f5b38249\">pandas 笔记（Handling Missing Data）</a></li>\n<li><a href=\"https://www.jianshu.com/p/f16e162cf7ee\">pandas 笔记 (Data Transformation)</a></li>\n<li><a href=\"https://www.jianshu.com/p/9a7f62a30a68\">python 可视化：matplotlib 学习笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/3fde65074a9d\">python 可视化：Plotting with pandas and seaborn</a></li>\n<li><a href=\"https://www.jianshu.com/p/ec120b0e42d5\">python 笔记：Functions</a></li>\n<li><a href=\"https://www.jianshu.com/p/fee26614135b\">python 笔记：将 function 储存在 module 里</a></li>\n<li><a href=\"https://www.jianshu.com/p/b6f8c44caed7\">python 笔记：Class（类）</a></li>\n<li><a href=\"https://www.jianshu.com/p/1c25a07fb114\">python 笔记：打开 / 访问文件</a></li>\n</ul>\n<h2 id=\"perl-学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#perl-学习笔记\"></a> perl 学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/e7e9006d3a82\">Learning Perl 学习笔记（1）第二章 Scalar Data</a></li>\n<li><a href=\"https://www.jianshu.com/p/448ac3434104\">Learning Perl 学习笔记（2）第三章 Lists and Arrays</a></li>\n<li><a href=\"https://www.jianshu.com/p/ecd8e26d4a96\">Learning Perl 学习笔记（3）第四章：子程序</a></li>\n<li><a href=\"https://www.jianshu.com/p/5bf7ecb14361\">Learning Perl 学习笔记（4）第五章 Input and Output</a></li>\n<li><a href=\"https://www.jianshu.com/p/9ca226b57ed5\">Learning Perl 学习笔记（5）第六章 Hashes</a></li>\n<li><a href=\"https://www.jianshu.com/p/ac8092758ac2\">Learning Perl 学习笔记（6）第七章 正则表达式</a></li>\n<li><a href=\"https://www.jianshu.com/p/d4638b79ddea\">Learning Perl 学习笔记（7）第八章 使用正则表达式进行 matching</a></li>\n<li><a href=\"https://www.jianshu.com/p/cf0db9d9c671\">Learning Perl 学习笔记（8）第九章 Processing Text with Regular Expressions</a></li>\n<li><a href=\"https://www.jianshu.com/p/f6e31c0b0ab7\">Learning Perl 学习笔记（9）：Strings and Sorting</a></li>\n<li><a href=\"https://www.jianshu.com/p/372d83b89229\">circos 软件使用初探</a></li>\n<li><a href=\"https://www.jianshu.com/p/f1a206893744\">circos 软件学习笔记：语法、颜色、字体和文件格式</a></li>\n<li><a href=\"https://www.jianshu.com/p/4c8fc9d8fe78\">circos 软件学习笔记：添加刻度</a></li>\n<li><a href=\"https://www.jianshu.com/p/9a57e583d7c5\">circos 软件学习笔记：更改染色体的比例、颜色、方向</a></li>\n<li><a href=\"https://www.jianshu.com/p/dba889089dee\">circos 软件学习笔记：在圆圈里添加 lines（interaction）</a></li>\n</ul>\n<h2 id=\"转录组学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#转录组学习笔记\"></a> 转录组学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/055732b6ac99\">RNA-seq 练习 第一部分（原始数据下载，提取 fastq 文件，fastqc 质控）</a></li>\n<li><a href=\"https://www.jianshu.com/p/849f8ada0ab7\">RNA-seq 练习 第二部分（基因组序列下载，注释文件下载，索引下载，比对，比对质控, HTseq-count 计数，输出 count 矩阵文件）</a></li>\n<li><a href=\"https://www.jianshu.com/p/82787ddada38\">RNA-seq 练习 第三部分（DEseq2 筛选差异表达基因, 可视化）</a></li>\n<li><a href=\"https://www.jianshu.com/p/7d15173540ae\">理解 SAM 文件格式以及过滤 sam 文件</a></li>\n<li><a href=\"https://www.jianshu.com/p/aae9b0322b83\">GSEA 学习笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/c2605b5b8c0a\">几种标准化方法的学习笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/5b6dfc954315\">比对软件 STAR 的使用</a></li>\n</ul>\n<h2 id=\"chip-seq-atac-seq-笔记\"><a class=\"markdownIt-Anchor\" href=\"#chip-seq-atac-seq-笔记\"></a> ChIP-seq &amp; ATAC-seq 笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/05aae63d7c52\">ChIP-seq 实践 (H3K27Ac,enhancer 的筛选和 enhancer 相关基因的 GO 分析)</a></li>\n<li><a href=\"https://www.jianshu.com/p/2138c99ce30a\">ChIP-seq 实践（非转录因子，非组蛋白）</a></li>\n<li><a href=\"https://www.jianshu.com/p/cc01ad9db959\">在 IGV 里同时查看多个 region/gene</a></li>\n<li><a href=\"https://www.jianshu.com/p/57d4420056dd\">ATAC-seq 分析练习</a></li>\n<li><a href=\"https://www.jianshu.com/p/1e3d15c325e9\">结合 CHIP-seq 和 ATAC-seq 结果进行分析</a></li>\n<li><a href=\"https://www.jianshu.com/p/7f6ce4f238cb\">GREAT 网页版学习笔记（预测顺式调控元件）</a></li>\n<li><a href=\"https://www.jianshu.com/p/6aba8f1dea56\">使用 HINT-ATAC 进行 ATAC-Seq 的 footprinting 分析</a></li>\n<li><a href=\"https://www.jianshu.com/p/66deb4c008f5\">用 MEME-CHIP 预测转录因子的结合</a></li>\n<li><a href=\"https://www.jianshu.com/p/467d970ec097\">利用 HOMER 预测目标序列的 motif（从运行程序到结果解读，以及注意事项）</a></li>\n<li><a href=\"https://www.jianshu.com/p/37eadb126bbf\">Motif scanning tool: FIMO（在线版分析笔记）</a></li>\n<li><a href=\"https://www.jianshu.com/p/b74c8077d893\">如何提取 ATAC-seq 数据的差异 peaks?（DiffBind 包的使用）</a></li>\n<li><a href=\"https://www.jianshu.com/p/0f674e88c1ce\">shadow enhancers</a></li>\n</ul>\n<h2 id=\"cuttag-学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#cuttag-学习笔记\"></a> CUT&amp;Tag 学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/1a23656a0713\">CUT&amp;Tag 数据分析笔记（1）</a></li>\n<li><a href=\"https://www.jianshu.com/p/7d45ec853ff8\">CUT&amp;Tag 数据分析笔记（2）</a></li>\n<li><a href=\"https://www.jianshu.com/p/47f30acd68f1\">CUT&amp;Tag 数据分析笔记（3）</a></li>\n</ul>\n<h2 id=\"hi-c-学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#hi-c-学习笔记\"></a> Hi-C 学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/e3c198d75345\">Hi-C 技术的初步了解</a></li>\n<li><a href=\"https://www.jianshu.com/p/e7757fa94624\">Hi-C 分析练习（从 fastq 文件到 contact 矩阵）</a></li>\n<li><a href=\"https://www.jianshu.com/p/495c576f0f0f\">Hi-C 分析练习（从 cool 文件到可视化热图）</a></li>\n</ul>\n<h2 id=\"甲基化测序分析学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#甲基化测序分析学习笔记\"></a> 甲基化测序分析学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/316faa7e0642\">陈巍学基因视频学习记录 – 甲基化测序</a></li>\n<li><a href=\"https://www.jianshu.com/p/4c64858003c1\">Bismark Bisulfite Mapper 学习笔记（一）数据预处理</a></li>\n<li><a href=\"https://www.jianshu.com/p/e71184d03ace\">Bismark Bisulfite Mapper 学习笔记（二）甲基化信息提取以及文件解读</a></li>\n<li><a href=\"https://www.jianshu.com/p/f8a02e164f5a\">WGBS vs RRBS</a></li>\n</ul>\n<h2 id=\"单细胞转录组学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#单细胞转录组学习笔记\"></a> 单细胞转录组学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/b79171dddb0d\">单细胞 RNA-seq 入门文献学习</a></li>\n<li><a href=\"https://www.jianshu.com/p/a70c831c95f5\">单细胞测序实战（第一部分）</a></li>\n<li><a href=\"https://www.jianshu.com/p/b7fec167f4eb\">单细胞测序实战（第二部分）</a></li>\n<li><a href=\"https://www.jianshu.com/p/c206818ad0c6\">单细胞测序实战（第三部分）</a></li>\n<li><a href=\"https://www.jianshu.com/p/dee97289586c\">(Smartseq2) single cell RNA-seq 分析练习</a></li>\n<li><a href=\"https://www.jianshu.com/p/705a348e8623\">10× 单细胞测序分析练习（一）</a></li>\n<li><a href=\"https://www.jianshu.com/p/62db41020ad2\">10× 单细胞测序分析练习（二）</a></li>\n<li><a href=\"https://www.jianshu.com/p/f6186755aae5\">单细胞测序分析之 Monocle2 包学习笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/26d3648b2e1f\">单细胞测序分析之 Seurat（3.0）包学习笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/4c20a7866ce6\">单细胞测序分析之 scater 包学习笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/ff637a0b7ff5\">Single cell RNA-seq data analysis with R 视频学习笔记（一）</a></li>\n<li><a href=\"https://www.jianshu.com/p/e64b7b92f9e2\">Single cell RNA-seq data analysis with R 视频学习笔记（二）</a></li>\n<li><a href=\"https://www.jianshu.com/p/0e13ecde84b6\">Single cell RNA-seq data analysis with R 视频学习笔记（三）</a></li>\n<li><a href=\"https://www.jianshu.com/p/ca1a955f5046\">Single cell RNA-seq data analysis with R 视频学习笔记（四、五）</a></li>\n<li><a href=\"https://www.jianshu.com/p/3b9a0204d65b\">单细胞测序数据整合练习（详细代码）</a></li>\n<li><a href=\"https://www.jianshu.com/p/7af86cc04e7d\">Single cell RNA-seq data analysis with R 视频学习笔记（六）</a></li>\n<li><a href=\"https://www.jianshu.com/p/f20cfd1fa326\">Single cell RNA-seq data analysis with R 视频学习笔记（七）</a></li>\n<li><a href=\"https://www.jianshu.com/p/adb692e71bf9\">Single cell RNA-seq data analysis with R 视频学习笔记（八）</a></li>\n<li><a href=\"https://www.jianshu.com/p/88372e79a863\">Single cell RNA-seq data analysis with R 视频学习笔记（九：空间转录组）</a></li>\n<li><a href=\"https://www.jianshu.com/p/16ebecb3b5fa\">单细胞轨迹推断（Trajectory inference）分析（详细代码）</a></li>\n<li><a href=\"https://www.jianshu.com/p/f6f48d6594ce\">RNA velocity of single cells 文献学习</a></li>\n<li><a href=\"https://www.jianshu.com/p/e65964f39eb3\">RNA velocity 分析练习（一）文件下载以及预处理</a></li>\n<li><a href=\"https://www.jianshu.com/p/df6c16cc2bc2\">RNA velocity 分析练习（二）软件安装</a></li>\n<li><a href=\"https://www.jianshu.com/p/bce19672879e\">RNA velocity 分析练习（三）生成 loom 文件</a></li>\n<li><a href=\"https://www.jianshu.com/p/d6c92dd67166\">RNA velocity 分析练习（四）聚类以及 velocity 可视化</a></li>\n<li><a href=\"https://www.jianshu.com/p/08f75901cc3e\">cellranger 使用的初步探索（1）</a></li>\n<li><a href=\"https://www.jianshu.com/p/57bda7d71b18\">cellranger 使用的初步探索（2）理解 cellranger count 输出文件</a></li>\n<li><a href=\"https://www.jianshu.com/p/ca726a8979d7\">cellranger 使用的初步探索（3）cellranger aggr</a></li>\n<li><a href=\"https://www.jianshu.com/p/0fbf5b29f2ae\">cellranger 使用的初步探索（4）：R 读取 cellranger 的输出文件</a></li>\n</ul>\n<h2 id=\"单细胞-atac-seq-学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#单细胞-atac-seq-学习笔记\"></a> 单细胞 ATAC-seq 学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/7d8058efb8e5\">Single-Cell ATAC-Seq 的初步了解</a></li>\n<li><a href=\"https://www.jianshu.com/p/ef7531c7d07d\">scATAC-seq 数据分析练习（成年小鼠大脑组织）</a></li>\n<li><a href=\"https://www.jianshu.com/p/17a0a1cafade\">[scATAC-seq] 利用 Monocle3 构建细胞 “轨迹”</a></li>\n<li><a href=\"https://www.jianshu.com/p/a2bcdfb77961\">ArchR 官网教程学习笔记 1：Getting Started with ArchR</a></li>\n<li><a href=\"https://www.jianshu.com/p/5ec81b5bb3ea\">ArchR 官网教程学习笔记 2: 基于 ArchR 推测 Doublet</a></li>\n<li><a href=\"https://www.jianshu.com/p/9243973a35e6\">ArchR 官网教程学习笔记 3: 创建 ArchRProject</a></li>\n<li><a href=\"https://www.jianshu.com/p/98d702592720\">ArchR 官网教程学习笔记 4:ArchR 的降维</a></li>\n<li><a href=\"https://www.jianshu.com/p/91007564ffdc\">ArchR 官网教程学习笔记 5:ArchR 的聚类</a></li>\n<li><a href=\"https://www.jianshu.com/p/16904f84b8ba\">ArchR 官网教程学习笔记 6: 单细胞嵌入（Single-cell Embeddings）</a></li>\n<li><a href=\"https://www.jianshu.com/p/45d1d47fdcd3\">ArchR 官网教程学习笔记 7:ArchR 的基因评分和 Marker 基因</a></li>\n<li><a href=\"https://www.jianshu.com/p/60ce90ba67a9\">ArchR 官网教程学习笔记 8: 定义与 scRNA-seq 一致的聚类</a></li>\n<li><a href=\"https://www.jianshu.com/p/9aae0389875d\">ArchR 官网教程学习笔记 9:ArchR 的伪批量重复</a></li>\n<li><a href=\"https://www.jianshu.com/p/30fb540e95ec\">ArchR 官网教程学习笔记 10:ArchR 的 call peak</a></li>\n<li><a href=\"https://www.jianshu.com/p/79fa167c914d\">ArchR 官网教程学习笔记 11: 鉴定 Marker 峰</a></li>\n<li><a href=\"https://www.jianshu.com/p/662c626123b5\">ArchR 官网教程学习笔记 12:Motif 和 Feature 富集</a></li>\n<li><a href=\"https://www.jianshu.com/p/8bd8da9a9ba8\">ArchR 官网教程学习笔记 13:ChromVAR 偏差富集</a></li>\n<li><a href=\"https://www.jianshu.com/p/40946d10c63c\">ArchR 官网教程学习笔记 14:ArchR 的 Footprinting 分析</a></li>\n<li><a href=\"https://www.jianshu.com/p/b3f538f86feb\">ArchR 官网教程学习笔记 15:ArchR 的整合分析</a></li>\n<li><a href=\"https://www.jianshu.com/p/519b1a69e1d6\">ArchR 官网教程学习笔记 16（上）:ArchR 的轨迹推断分析</a></li>\n<li><a href=\"https://www.jianshu.com/p/9de6526e45a2\">ArchR 官网教程学习笔记 16（下）:ArchR 的轨迹推断分析</a></li>\n</ul>\n<h2 id=\"tcga-数据库学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#tcga-数据库学习笔记\"></a> TCGA 数据库学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/d662069a4a3d\">TCGA 数据库的初次了解</a></li>\n<li><a href=\"https://www.jianshu.com/p/43a915fc8ee9\">如何批量下载 TCGA 里的数据（gdc-client 方法）</a></li>\n<li><a href=\"https://www.jianshu.com/p/3b4c07f7e5f3\">利用 R 包 TCGAbiolinks 进行各种数据下载</a></li>\n<li><a href=\"https://www.jianshu.com/p/e18068180ee5\">TCGA 的差异基因分析</a></li>\n<li><a href=\"https://www.jianshu.com/p/72b0fa510086\">整合 gdc-client 批量下载的文件</a></li>\n<li><a href=\"https://www.jianshu.com/p/4afbdc8fd8ed\">如何把从 TCGA 下载的 HTseq count 转换成 FPKM</a></li>\n<li><a href=\"https://www.jianshu.com/p/0ac52f582ea4\">如何生成 WGCNA 分析所需的临床表型信息</a></li>\n<li><a href=\"https://www.jianshu.com/p/0d05d1f007e7\">WGCNA 学习笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/fd5e06ec260b\">TCGA 数据生存分析</a></li>\n<li><a href=\"https://www.jianshu.com/p/1ceace2b581c\">TCGA 甲基化数据下载以及相关临床信息整理</a></li>\n<li><a href=\"https://www.jianshu.com/p/27269f95d9c1\">TCGA 甲基化数据质量控制和差异分析（使用 ChAMP 包）</a></li>\n<li><a href=\"https://www.jianshu.com/p/d75e1199f8b1\">如何将 WGCNA 导出的基因共表达网络进行可视化（cytoscape 软件的使用）</a></li>\n<li><a href=\"https://www.jianshu.com/p/967d52171777\">TCGA 数据库 MAF 文件的分析以及可视化（maftools 包的使用）</a></li>\n<li><a href=\"https://www.jianshu.com/p/b8351a86a40b\">TCGA 数据库 copy number variation 数据分析（第一部分：从数据下载到 GISTIC 输出文件）</a></li>\n<li><a href=\"https://www.jianshu.com/p/dbc90a1475c1\">TCGA 数据库 copy number variation 数据分析（第二部分：利用 maftools 进行可视化）</a></li>\n</ul>\n<h2 id=\"geo-数据库学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#geo-数据库学习笔记\"></a> GEO 数据库学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/51711c22934d\">GEO 数据库视频学习笔记（芯片数据下载和数据读取）</a></li>\n<li><a href=\"https://www.jianshu.com/p/d64a1ddf1128\">GEO 数据库视频学习笔记（ID 转换）</a></li>\n<li><a href=\"https://www.jianshu.com/p/c94875df0155\">GEO 数据库视频学习笔记（了解你的表达矩阵）</a></li>\n<li><a href=\"https://www.jianshu.com/p/4486c6624ef9\">GEO 数据库视频学习笔记（差异分析、可视化、GSEA）</a></li>\n</ul>\n<h2 id=\"cbioportal-数据库学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#cbioportal-数据库学习笔记\"></a> cBioPortal 数据库学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/b458796366a4\">cBioPortal 学习笔记（1）</a></li>\n<li><a href=\"https://www.jianshu.com/p/cf0d1f407601\">cBioPortal 学习笔记（2）</a></li>\n</ul>\n<h2 id=\"wgs-学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#wgs-学习笔记\"></a> WGS 学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/4177a7afc798\">GATK 的初次了解</a></li>\n<li><a href=\"https://www.jianshu.com/p/9fce93c1a337\">GATK 官网学习笔记 Data pre-processing for variant discovery</a></li>\n<li><a href=\"https://www.jianshu.com/p/b93f8f4a1ed7\">Broad Institute 视频笔记 Introduction to High-throughput Sequencing Data</a></li>\n<li><a href=\"https://www.jianshu.com/p/8ace60832c13\">Broad Institute 视频笔记 Introduction to Data Preprocessing</a></li>\n<li><a href=\"https://www.jianshu.com/p/5bf73e5a3390\">Broad Institute 视频笔记 Introduction to Variant Discovery</a></li>\n<li><a href=\"https://www.jianshu.com/p/c032b7a1909c\">Broad Institute 视频笔记 Introduction to Germline Variant Discovery</a></li>\n<li><a href=\"https://www.jianshu.com/p/6e0b483f1234\">Broad Institute 视频笔记 Introduction to Somatic Variant Discovery</a></li>\n<li><a href=\"https://www.jianshu.com/p/9c049c46a26d\">Broad Institue 视频笔记：Variant Calling with HaplotypeCaller</a></li>\n<li><a href=\"https://www.jianshu.com/p/241595e0ed39\">Broad Institute 视频笔记 Hello World WDL Tutorial</a></li>\n<li><a href=\"https://www.jianshu.com/p/2c4a792b49fe\">Broad Institute 视频笔记 Run Haplotypecaller（WDL+Cromwell）</a></li>\n</ul>\n<h2 id=\"文献阅读笔记\"><a class=\"markdownIt-Anchor\" href=\"#文献阅读笔记\"></a> 文献阅读笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/7cee57558c32\">增强子和启动子真的是两种完全不同的调控元件吗？【Nature Reviews Genetics】文献阅读</a></li>\n<li><a href=\"https://www.jianshu.com/p/e21ba67460ac\">TT-seq 文献阅读 (TT-seq maps the human transient transcriptome)</a></li>\n<li><a href=\"https://www.jianshu.com/p/61d95dd791b2\">eRNA 文献阅读</a></li>\n<li><a href=\"https://www.jianshu.com/p/35d2f771669b\">PRO-seq 文献阅读</a></li>\n<li><a href=\"https://www.jianshu.com/p/f41632859d39\">增强子 (enhancer) 靶向表观基因组编辑技术 enCRISPRa 和 enCRISPRi 文献学习</a></li>\n<li><a href=\"https://www.jianshu.com/p/9dd472bcd5e0\">CROP-seq 文献学习（CRISPR 液滴测序）</a></li>\n<li><a href=\"https://www.jianshu.com/p/6eaca6ab8f8e\">SMRT 测序文献阅读笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/5a1c31ee6c51\">文献阅读笔记：CUT&amp;RUN</a></li>\n<li><a href=\"https://www.jianshu.com/p/335aec753039\">文献阅读笔记：CUT&amp;Tag</a></li>\n<li><a href=\"https://www.jianshu.com/p/d5b91b271fdf\">文献阅读 Orchestrating single-cell analysis with Bioconductor</a></li>\n<li><a href=\"https://www.jianshu.com/p/de867ea346ca\">文献阅读：细胞异质性的表观遗传学基础</a></li>\n<li><a href=\"https://www.jianshu.com/p/4fe83e6e67ad\">【文献笔记】DNA，RNA 以及组蛋白的甲基化在衰老和肿瘤中的作用</a></li>\n</ul>\n<h2 id=\"statquest-视频学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#statquest-视频学习笔记\"></a> StatQuest 视频学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/0f8fa0b8f86d\">StatQuest——生物信息相关原理的入门系列 (一)</a></li>\n<li><a href=\"https://www.jianshu.com/p/69b18da08a46\">StatQuest——生物信息相关原理的入门系列 (二)</a></li>\n<li><a href=\"https://www.jianshu.com/p/dffd1c8f99b0\">StatQuest（PCA 系列）step by step 为你解释 PCA 的那些事儿</a></li>\n<li><a href=\"https://www.jianshu.com/p/a2b3c68416c5\">StatQuest——t-SNE 视频笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/46f0aef6b5c3\">StatQuest——Hierarchical Clustering 学习笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/609226bdb66f\">StatQuest——K-means 到底是什么？</a></li>\n<li><a href=\"https://www.jianshu.com/p/7b797da06ed4\">StatQuest - 你想很轻松的理解 Covariance 和 Correlation 吗?(Part 1)</a></li>\n<li><a href=\"https://www.jianshu.com/p/85023ee0a164\">StatQuest - 你想很轻松的理解 Covariance 和 Correlation 吗?(Part 2)</a></li>\n</ul>\n<h2 id=\"epigenetics-笔记\"><a class=\"markdownIt-Anchor\" href=\"#epigenetics-笔记\"></a> Epigenetics 笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/96c8eb5561fe\">Epigenetics 笔记一：Writers, Readers, Erasers</a></li>\n<li><a href=\"https://www.jianshu.com/p/1193ab2f463c\">Epigenetics 文献学习：Regulation of chromatin by histone modifications</a></li>\n<li><a href=\"https://www.jianshu.com/p/b9869113bd10\">Epigenetics 文献学习：染色质结构域</a></li>\n<li><a href=\"https://www.jianshu.com/p/c9725c44e659\">Epigenetics 文献阅读：The molecular hallmarks of epigenetic control</a></li>\n<li><a href=\"https://www.jianshu.com/p/aa77686648c0\">Epigenetics 文献学习：Writing, erasing and reading histone lysine methylation</a></li>\n<li><a href=\"https://www.jianshu.com/p/b73c50e1dbe0\">Epigenetics 文献学习：Histone H3 突变的致癌机制</a></li>\n<li><a href=\"https://www.jianshu.com/p/b9d061fa238f\">Epigenetics 文献学习：组蛋白标记在控制转录周期中的功能作用</a></li>\n<li><a href=\"https://www.jianshu.com/p/80b321e03d11\">SWI/SNF 复合体在肿瘤里的作用</a></li>\n<li><a href=\"https://www.jianshu.com/p/1a0dd75d7a00\">新英格兰医学：癌症的表观遗传治疗</a></li>\n<li><a href=\"https://www.jianshu.com/p/8d554f3cf96f\">NATURE: 组蛋白标记 H3K36me2 招募 DNMT3A 并调节基因间 DNA 甲基化分布</a></li>\n<li><a href=\"https://www.jianshu.com/p/a7b75ab3472e\">NATURE: 基因 - 环境协同诱导的表观遗传程序起始肿瘤发生</a></li>\n<li><a href=\"https://www.jianshu.com/p/6a7e68be2de7\">NATURE: 组蛋白甲基转移酶 NSD3 异常活化可诱导肺鳞状细胞癌的发生</a></li>\n<li><a href=\"https://www.jianshu.com/p/cd4a0b857d6f\">NATURE: 组蛋白变体在调节染色质组织和功能中的作用</a></li>\n<li><a href=\"https://www.jianshu.com/p/e152c798e047\">Nature Reviews Cancer: 实体瘤 “劫持” 组蛋白变体互作网络</a></li>\n<li><a href=\"https://www.jianshu.com/p/b20db6b067e1\">Nature Reviews Genetics：3D 基因组组织工程</a></li>\n<li><a href=\"https://www.jianshu.com/p/2cd3158ae9ee\">NCB: 核纤层的功能机制与异常</a></li>\n<li><a href=\"https://www.jianshu.com/p/3927a7ba6176\">CUT&amp;RUN 实验原理和步骤</a></li>\n<li><a href=\"https://www.jianshu.com/p/f2f39a327ec9\">【Nature Review Cancer】癌症中染色质修饰的 “language”</a></li>\n</ul>\n","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":2971,"excerpt":"<p>简书作者：<a href=\"https://www.jianshu.com/u/d3b898b259fa\">生信start_site</a></p>\n<h2 id=\"linux-学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#linux-学习笔记\"></a> Linux 学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/192946dce252\">《Linux 命令行与 shell 脚本编程大全》第 11 章笔记（上）</a></li>\n<li><a href=\"https://www.jianshu.com/p/4d1a77d3b236\">《Linux 命令行与 shell 脚本编程大全》第 11 章笔记（下）</a></li>\n<li><a href=\"https://www.jianshu.com/p/f6edec3d8b36\">结构化命令 之 if-then； if-then-else 语句</a></li>\n<li><a href=\"https://www.jianshu.com/p/6557b3b6ca4f\">结构化命令 之 test 命令 (长文慎入）</a></li>\n<li><a href=\"https://www.jianshu.com/p/c183fdbb08ca\">结构化命令 之 复合条件测试</a></li>\n<li><a href=\"https://www.jianshu.com/p/d1b0911def71\">结构化命令 之 if-then 高级特性</a></li>\n<li><a href=\"https://www.jianshu.com/p/ee6b85e04932\">结构化命令 之 case 命令</a></li>\n<li><a href=\"https://www.jianshu.com/p/f679a812fa0d\">结构化命令 之 for 命令</a></li>\n</ul>","more":"<ul>\n<li><a href=\"https://www.jianshu.com/p/6c9ec8ae4869\">结构化命令 之 while 命令</a></li>\n<li><a href=\"https://www.jianshu.com/p/9cc269d62a06\">结构化命令 之 until 命令</a></li>\n<li><a href=\"https://www.jianshu.com/p/9c415e7f1d19\">结构化命令 之 嵌套循环</a></li>\n<li><a href=\"https://www.jianshu.com/p/93bd151f83e2\">控制循环</a></li>\n<li><a href=\"https://www.jianshu.com/p/59317149d162\">处理循环的输出</a></li>\n<li><a href=\"https://www.jianshu.com/p/d630d5556543\">shell 脚本编程 – 处理用户输入</a></li>\n<li><a href=\"https://www.jianshu.com/p/80cef33ed41c\">如何使用服务器下载和处理文件 / 以及传输文件至本地文件夹</a></li>\n<li><a href=\"https://www.jianshu.com/p/aca43442e931\">利用 TrimGalore 去除 adapter 以及过滤 fastq 文件</a></li>\n<li><a href=\"https://www.jianshu.com/p/a7620c2ea275\">更改 Putty 主题背景</a></li>\n<li><a href=\"https://www.jianshu.com/p/3e6deaf83da9\">如何根据染色体坐标批量提取对应的 DNA 序列（bedtools）</a></li>\n<li><a href=\"https://www.jianshu.com/p/05cbc7bd06bc\">计算 bam 文件中比对上基因组的 reads 以及合并多个 bam 文件</a></li>\n<li><a href=\"https://www.jianshu.com/p/0360ac5f37ca\">file 命令，find 命令</a></li>\n<li><a href=\"https://www.jianshu.com/p/19429118636a\">怎么在 linux 里访问 U 盘里的数据</a></li>\n<li><a href=\"https://www.jianshu.com/p/299c0da5f341\">输入 / 输出 / 重定向</a></li>\n</ul>\n<h2 id=\"r-学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#r-学习笔记\"></a> R 学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/4adb658a60ee\">如何在散点图里添加特定标签</a></li>\n<li><a href=\"https://www.jianshu.com/p/fc2382c436f1\">如何修改操作系统分配给 R 的内存上限</a></li>\n<li><a href=\"https://www.jianshu.com/p/631381890ad4\">用 R 画 Circular barplot 图（环状柱形图）</a></li>\n<li><a href=\"https://www.jianshu.com/p/0b13f75d9a9d\">用 R 画弧形图（Arc Diagram）</a></li>\n<li><a href=\"https://www.jianshu.com/p/d71dcd4cff5a\">GENIE3——一款预测基因调控网络的 R 包</a></li>\n<li><a href=\"https://www.jianshu.com/p/c90238849858\">RNA-seq 的差异基因除了热图 / 火山图，你还可以如何展示？</a></li>\n<li><a href=\"https://www.jianshu.com/p/799ef8f2bfcb\">RCircos 包的使用</a></li>\n<li><a href=\"https://www.jianshu.com/p/c2b91bc4a033\">洛克菲勒大学 2021 年生信课 1：Introduction to R, session 1</a></li>\n<li><a href=\"https://www.jianshu.com/p/458f59261246\">洛克菲勒大学 2021 年生信课 2：Introduction to R, session 2</a></li>\n</ul>\n<h2 id=\"python-学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#python-学习笔记\"></a> python 学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/78809acafb36\">学习 Python: 最开始的开始（入门教程 + 软件安装）</a></li>\n<li><a href=\"https://www.jianshu.com/p/7d1fe73e4d66\">Biopython 学习笔记（一）</a></li>\n<li><a href=\"https://www.jianshu.com/p/a804bd33b4f7\">Biopython 学习笔记（二）序列的分析</a></li>\n<li><a href=\"https://www.jianshu.com/p/04d846da001b\">Biopython 学习笔记（三）Blast</a></li>\n<li><a href=\"https://www.jianshu.com/p/30bff68b1dda\">Biopython 学习笔记（四）访问 NCBI Entrez 数据库</a></li>\n<li><a href=\"https://www.jianshu.com/p/2855145686a6\">利用 scanpy 进行单细胞测序分析（一）预处理和聚类</a></li>\n<li><a href=\"https://www.jianshu.com/p/58cb6419de09\">利用 scanpy 进行单细胞测序分析（二）轨迹推断</a></li>\n<li><a href=\"https://www.jianshu.com/p/e29365002cb0\">利用 scanpy 进行单细胞测序分析（三）Marker 基因的可视化</a></li>\n<li><a href=\"https://www.jianshu.com/p/fbb9f2520a59\">ipython 的初步了解</a></li>\n<li><a href=\"https://www.jianshu.com/p/a85c9ff81ebc\">Numpy 笔记（NumPy ndarray）</a></li>\n<li><a href=\"https://www.jianshu.com/p/ac562796aebd\">Numpy 笔记（Transposing Arrays）</a></li>\n<li><a href=\"https://www.jianshu.com/p/a4f3b0da44f1\">Numpy 笔记 (File Input and Output with Arrays)</a></li>\n<li><a href=\"https://www.jianshu.com/p/5c779efd288b\">pandas 笔记（pandas Data Structures）</a></li>\n<li><a href=\"https://www.jianshu.com/p/8b727bba5ecf\">pandas 笔记（Essential Functionality）</a></li>\n<li><a href=\"https://www.jianshu.com/p/f9f35b3e2584\">pandas 笔记（Summarizing and Computing Descriptive Statistics）</a></li>\n<li><a href=\"https://www.jianshu.com/p/c373f5b38249\">pandas 笔记（Handling Missing Data）</a></li>\n<li><a href=\"https://www.jianshu.com/p/f16e162cf7ee\">pandas 笔记 (Data Transformation)</a></li>\n<li><a href=\"https://www.jianshu.com/p/9a7f62a30a68\">python 可视化：matplotlib 学习笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/3fde65074a9d\">python 可视化：Plotting with pandas and seaborn</a></li>\n<li><a href=\"https://www.jianshu.com/p/ec120b0e42d5\">python 笔记：Functions</a></li>\n<li><a href=\"https://www.jianshu.com/p/fee26614135b\">python 笔记：将 function 储存在 module 里</a></li>\n<li><a href=\"https://www.jianshu.com/p/b6f8c44caed7\">python 笔记：Class（类）</a></li>\n<li><a href=\"https://www.jianshu.com/p/1c25a07fb114\">python 笔记：打开 / 访问文件</a></li>\n</ul>\n<h2 id=\"perl-学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#perl-学习笔记\"></a> perl 学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/e7e9006d3a82\">Learning Perl 学习笔记（1）第二章 Scalar Data</a></li>\n<li><a href=\"https://www.jianshu.com/p/448ac3434104\">Learning Perl 学习笔记（2）第三章 Lists and Arrays</a></li>\n<li><a href=\"https://www.jianshu.com/p/ecd8e26d4a96\">Learning Perl 学习笔记（3）第四章：子程序</a></li>\n<li><a href=\"https://www.jianshu.com/p/5bf7ecb14361\">Learning Perl 学习笔记（4）第五章 Input and Output</a></li>\n<li><a href=\"https://www.jianshu.com/p/9ca226b57ed5\">Learning Perl 学习笔记（5）第六章 Hashes</a></li>\n<li><a href=\"https://www.jianshu.com/p/ac8092758ac2\">Learning Perl 学习笔记（6）第七章 正则表达式</a></li>\n<li><a href=\"https://www.jianshu.com/p/d4638b79ddea\">Learning Perl 学习笔记（7）第八章 使用正则表达式进行 matching</a></li>\n<li><a href=\"https://www.jianshu.com/p/cf0db9d9c671\">Learning Perl 学习笔记（8）第九章 Processing Text with Regular Expressions</a></li>\n<li><a href=\"https://www.jianshu.com/p/f6e31c0b0ab7\">Learning Perl 学习笔记（9）：Strings and Sorting</a></li>\n<li><a href=\"https://www.jianshu.com/p/372d83b89229\">circos 软件使用初探</a></li>\n<li><a href=\"https://www.jianshu.com/p/f1a206893744\">circos 软件学习笔记：语法、颜色、字体和文件格式</a></li>\n<li><a href=\"https://www.jianshu.com/p/4c8fc9d8fe78\">circos 软件学习笔记：添加刻度</a></li>\n<li><a href=\"https://www.jianshu.com/p/9a57e583d7c5\">circos 软件学习笔记：更改染色体的比例、颜色、方向</a></li>\n<li><a href=\"https://www.jianshu.com/p/dba889089dee\">circos 软件学习笔记：在圆圈里添加 lines（interaction）</a></li>\n</ul>\n<h2 id=\"转录组学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#转录组学习笔记\"></a> 转录组学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/055732b6ac99\">RNA-seq 练习 第一部分（原始数据下载，提取 fastq 文件，fastqc 质控）</a></li>\n<li><a href=\"https://www.jianshu.com/p/849f8ada0ab7\">RNA-seq 练习 第二部分（基因组序列下载，注释文件下载，索引下载，比对，比对质控, HTseq-count 计数，输出 count 矩阵文件）</a></li>\n<li><a href=\"https://www.jianshu.com/p/82787ddada38\">RNA-seq 练习 第三部分（DEseq2 筛选差异表达基因, 可视化）</a></li>\n<li><a href=\"https://www.jianshu.com/p/7d15173540ae\">理解 SAM 文件格式以及过滤 sam 文件</a></li>\n<li><a href=\"https://www.jianshu.com/p/aae9b0322b83\">GSEA 学习笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/c2605b5b8c0a\">几种标准化方法的学习笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/5b6dfc954315\">比对软件 STAR 的使用</a></li>\n</ul>\n<h2 id=\"chip-seq-atac-seq-笔记\"><a class=\"markdownIt-Anchor\" href=\"#chip-seq-atac-seq-笔记\"></a> ChIP-seq &amp; ATAC-seq 笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/05aae63d7c52\">ChIP-seq 实践 (H3K27Ac,enhancer 的筛选和 enhancer 相关基因的 GO 分析)</a></li>\n<li><a href=\"https://www.jianshu.com/p/2138c99ce30a\">ChIP-seq 实践（非转录因子，非组蛋白）</a></li>\n<li><a href=\"https://www.jianshu.com/p/cc01ad9db959\">在 IGV 里同时查看多个 region/gene</a></li>\n<li><a href=\"https://www.jianshu.com/p/57d4420056dd\">ATAC-seq 分析练习</a></li>\n<li><a href=\"https://www.jianshu.com/p/1e3d15c325e9\">结合 CHIP-seq 和 ATAC-seq 结果进行分析</a></li>\n<li><a href=\"https://www.jianshu.com/p/7f6ce4f238cb\">GREAT 网页版学习笔记（预测顺式调控元件）</a></li>\n<li><a href=\"https://www.jianshu.com/p/6aba8f1dea56\">使用 HINT-ATAC 进行 ATAC-Seq 的 footprinting 分析</a></li>\n<li><a href=\"https://www.jianshu.com/p/66deb4c008f5\">用 MEME-CHIP 预测转录因子的结合</a></li>\n<li><a href=\"https://www.jianshu.com/p/467d970ec097\">利用 HOMER 预测目标序列的 motif（从运行程序到结果解读，以及注意事项）</a></li>\n<li><a href=\"https://www.jianshu.com/p/37eadb126bbf\">Motif scanning tool: FIMO（在线版分析笔记）</a></li>\n<li><a href=\"https://www.jianshu.com/p/b74c8077d893\">如何提取 ATAC-seq 数据的差异 peaks?（DiffBind 包的使用）</a></li>\n<li><a href=\"https://www.jianshu.com/p/0f674e88c1ce\">shadow enhancers</a></li>\n</ul>\n<h2 id=\"cuttag-学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#cuttag-学习笔记\"></a> CUT&amp;Tag 学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/1a23656a0713\">CUT&amp;Tag 数据分析笔记（1）</a></li>\n<li><a href=\"https://www.jianshu.com/p/7d45ec853ff8\">CUT&amp;Tag 数据分析笔记（2）</a></li>\n<li><a href=\"https://www.jianshu.com/p/47f30acd68f1\">CUT&amp;Tag 数据分析笔记（3）</a></li>\n</ul>\n<h2 id=\"hi-c-学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#hi-c-学习笔记\"></a> Hi-C 学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/e3c198d75345\">Hi-C 技术的初步了解</a></li>\n<li><a href=\"https://www.jianshu.com/p/e7757fa94624\">Hi-C 分析练习（从 fastq 文件到 contact 矩阵）</a></li>\n<li><a href=\"https://www.jianshu.com/p/495c576f0f0f\">Hi-C 分析练习（从 cool 文件到可视化热图）</a></li>\n</ul>\n<h2 id=\"甲基化测序分析学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#甲基化测序分析学习笔记\"></a> 甲基化测序分析学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/316faa7e0642\">陈巍学基因视频学习记录 – 甲基化测序</a></li>\n<li><a href=\"https://www.jianshu.com/p/4c64858003c1\">Bismark Bisulfite Mapper 学习笔记（一）数据预处理</a></li>\n<li><a href=\"https://www.jianshu.com/p/e71184d03ace\">Bismark Bisulfite Mapper 学习笔记（二）甲基化信息提取以及文件解读</a></li>\n<li><a href=\"https://www.jianshu.com/p/f8a02e164f5a\">WGBS vs RRBS</a></li>\n</ul>\n<h2 id=\"单细胞转录组学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#单细胞转录组学习笔记\"></a> 单细胞转录组学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/b79171dddb0d\">单细胞 RNA-seq 入门文献学习</a></li>\n<li><a href=\"https://www.jianshu.com/p/a70c831c95f5\">单细胞测序实战（第一部分）</a></li>\n<li><a href=\"https://www.jianshu.com/p/b7fec167f4eb\">单细胞测序实战（第二部分）</a></li>\n<li><a href=\"https://www.jianshu.com/p/c206818ad0c6\">单细胞测序实战（第三部分）</a></li>\n<li><a href=\"https://www.jianshu.com/p/dee97289586c\">(Smartseq2) single cell RNA-seq 分析练习</a></li>\n<li><a href=\"https://www.jianshu.com/p/705a348e8623\">10× 单细胞测序分析练习（一）</a></li>\n<li><a href=\"https://www.jianshu.com/p/62db41020ad2\">10× 单细胞测序分析练习（二）</a></li>\n<li><a href=\"https://www.jianshu.com/p/f6186755aae5\">单细胞测序分析之 Monocle2 包学习笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/26d3648b2e1f\">单细胞测序分析之 Seurat（3.0）包学习笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/4c20a7866ce6\">单细胞测序分析之 scater 包学习笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/ff637a0b7ff5\">Single cell RNA-seq data analysis with R 视频学习笔记（一）</a></li>\n<li><a href=\"https://www.jianshu.com/p/e64b7b92f9e2\">Single cell RNA-seq data analysis with R 视频学习笔记（二）</a></li>\n<li><a href=\"https://www.jianshu.com/p/0e13ecde84b6\">Single cell RNA-seq data analysis with R 视频学习笔记（三）</a></li>\n<li><a href=\"https://www.jianshu.com/p/ca1a955f5046\">Single cell RNA-seq data analysis with R 视频学习笔记（四、五）</a></li>\n<li><a href=\"https://www.jianshu.com/p/3b9a0204d65b\">单细胞测序数据整合练习（详细代码）</a></li>\n<li><a href=\"https://www.jianshu.com/p/7af86cc04e7d\">Single cell RNA-seq data analysis with R 视频学习笔记（六）</a></li>\n<li><a href=\"https://www.jianshu.com/p/f20cfd1fa326\">Single cell RNA-seq data analysis with R 视频学习笔记（七）</a></li>\n<li><a href=\"https://www.jianshu.com/p/adb692e71bf9\">Single cell RNA-seq data analysis with R 视频学习笔记（八）</a></li>\n<li><a href=\"https://www.jianshu.com/p/88372e79a863\">Single cell RNA-seq data analysis with R 视频学习笔记（九：空间转录组）</a></li>\n<li><a href=\"https://www.jianshu.com/p/16ebecb3b5fa\">单细胞轨迹推断（Trajectory inference）分析（详细代码）</a></li>\n<li><a href=\"https://www.jianshu.com/p/f6f48d6594ce\">RNA velocity of single cells 文献学习</a></li>\n<li><a href=\"https://www.jianshu.com/p/e65964f39eb3\">RNA velocity 分析练习（一）文件下载以及预处理</a></li>\n<li><a href=\"https://www.jianshu.com/p/df6c16cc2bc2\">RNA velocity 分析练习（二）软件安装</a></li>\n<li><a href=\"https://www.jianshu.com/p/bce19672879e\">RNA velocity 分析练习（三）生成 loom 文件</a></li>\n<li><a href=\"https://www.jianshu.com/p/d6c92dd67166\">RNA velocity 分析练习（四）聚类以及 velocity 可视化</a></li>\n<li><a href=\"https://www.jianshu.com/p/08f75901cc3e\">cellranger 使用的初步探索（1）</a></li>\n<li><a href=\"https://www.jianshu.com/p/57bda7d71b18\">cellranger 使用的初步探索（2）理解 cellranger count 输出文件</a></li>\n<li><a href=\"https://www.jianshu.com/p/ca726a8979d7\">cellranger 使用的初步探索（3）cellranger aggr</a></li>\n<li><a href=\"https://www.jianshu.com/p/0fbf5b29f2ae\">cellranger 使用的初步探索（4）：R 读取 cellranger 的输出文件</a></li>\n</ul>\n<h2 id=\"单细胞-atac-seq-学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#单细胞-atac-seq-学习笔记\"></a> 单细胞 ATAC-seq 学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/7d8058efb8e5\">Single-Cell ATAC-Seq 的初步了解</a></li>\n<li><a href=\"https://www.jianshu.com/p/ef7531c7d07d\">scATAC-seq 数据分析练习（成年小鼠大脑组织）</a></li>\n<li><a href=\"https://www.jianshu.com/p/17a0a1cafade\">[scATAC-seq] 利用 Monocle3 构建细胞 “轨迹”</a></li>\n<li><a href=\"https://www.jianshu.com/p/a2bcdfb77961\">ArchR 官网教程学习笔记 1：Getting Started with ArchR</a></li>\n<li><a href=\"https://www.jianshu.com/p/5ec81b5bb3ea\">ArchR 官网教程学习笔记 2: 基于 ArchR 推测 Doublet</a></li>\n<li><a href=\"https://www.jianshu.com/p/9243973a35e6\">ArchR 官网教程学习笔记 3: 创建 ArchRProject</a></li>\n<li><a href=\"https://www.jianshu.com/p/98d702592720\">ArchR 官网教程学习笔记 4:ArchR 的降维</a></li>\n<li><a href=\"https://www.jianshu.com/p/91007564ffdc\">ArchR 官网教程学习笔记 5:ArchR 的聚类</a></li>\n<li><a href=\"https://www.jianshu.com/p/16904f84b8ba\">ArchR 官网教程学习笔记 6: 单细胞嵌入（Single-cell Embeddings）</a></li>\n<li><a href=\"https://www.jianshu.com/p/45d1d47fdcd3\">ArchR 官网教程学习笔记 7:ArchR 的基因评分和 Marker 基因</a></li>\n<li><a href=\"https://www.jianshu.com/p/60ce90ba67a9\">ArchR 官网教程学习笔记 8: 定义与 scRNA-seq 一致的聚类</a></li>\n<li><a href=\"https://www.jianshu.com/p/9aae0389875d\">ArchR 官网教程学习笔记 9:ArchR 的伪批量重复</a></li>\n<li><a href=\"https://www.jianshu.com/p/30fb540e95ec\">ArchR 官网教程学习笔记 10:ArchR 的 call peak</a></li>\n<li><a href=\"https://www.jianshu.com/p/79fa167c914d\">ArchR 官网教程学习笔记 11: 鉴定 Marker 峰</a></li>\n<li><a href=\"https://www.jianshu.com/p/662c626123b5\">ArchR 官网教程学习笔记 12:Motif 和 Feature 富集</a></li>\n<li><a href=\"https://www.jianshu.com/p/8bd8da9a9ba8\">ArchR 官网教程学习笔记 13:ChromVAR 偏差富集</a></li>\n<li><a href=\"https://www.jianshu.com/p/40946d10c63c\">ArchR 官网教程学习笔记 14:ArchR 的 Footprinting 分析</a></li>\n<li><a href=\"https://www.jianshu.com/p/b3f538f86feb\">ArchR 官网教程学习笔记 15:ArchR 的整合分析</a></li>\n<li><a href=\"https://www.jianshu.com/p/519b1a69e1d6\">ArchR 官网教程学习笔记 16（上）:ArchR 的轨迹推断分析</a></li>\n<li><a href=\"https://www.jianshu.com/p/9de6526e45a2\">ArchR 官网教程学习笔记 16（下）:ArchR 的轨迹推断分析</a></li>\n</ul>\n<h2 id=\"tcga-数据库学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#tcga-数据库学习笔记\"></a> TCGA 数据库学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/d662069a4a3d\">TCGA 数据库的初次了解</a></li>\n<li><a href=\"https://www.jianshu.com/p/43a915fc8ee9\">如何批量下载 TCGA 里的数据（gdc-client 方法）</a></li>\n<li><a href=\"https://www.jianshu.com/p/3b4c07f7e5f3\">利用 R 包 TCGAbiolinks 进行各种数据下载</a></li>\n<li><a href=\"https://www.jianshu.com/p/e18068180ee5\">TCGA 的差异基因分析</a></li>\n<li><a href=\"https://www.jianshu.com/p/72b0fa510086\">整合 gdc-client 批量下载的文件</a></li>\n<li><a href=\"https://www.jianshu.com/p/4afbdc8fd8ed\">如何把从 TCGA 下载的 HTseq count 转换成 FPKM</a></li>\n<li><a href=\"https://www.jianshu.com/p/0ac52f582ea4\">如何生成 WGCNA 分析所需的临床表型信息</a></li>\n<li><a href=\"https://www.jianshu.com/p/0d05d1f007e7\">WGCNA 学习笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/fd5e06ec260b\">TCGA 数据生存分析</a></li>\n<li><a href=\"https://www.jianshu.com/p/1ceace2b581c\">TCGA 甲基化数据下载以及相关临床信息整理</a></li>\n<li><a href=\"https://www.jianshu.com/p/27269f95d9c1\">TCGA 甲基化数据质量控制和差异分析（使用 ChAMP 包）</a></li>\n<li><a href=\"https://www.jianshu.com/p/d75e1199f8b1\">如何将 WGCNA 导出的基因共表达网络进行可视化（cytoscape 软件的使用）</a></li>\n<li><a href=\"https://www.jianshu.com/p/967d52171777\">TCGA 数据库 MAF 文件的分析以及可视化（maftools 包的使用）</a></li>\n<li><a href=\"https://www.jianshu.com/p/b8351a86a40b\">TCGA 数据库 copy number variation 数据分析（第一部分：从数据下载到 GISTIC 输出文件）</a></li>\n<li><a href=\"https://www.jianshu.com/p/dbc90a1475c1\">TCGA 数据库 copy number variation 数据分析（第二部分：利用 maftools 进行可视化）</a></li>\n</ul>\n<h2 id=\"geo-数据库学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#geo-数据库学习笔记\"></a> GEO 数据库学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/51711c22934d\">GEO 数据库视频学习笔记（芯片数据下载和数据读取）</a></li>\n<li><a href=\"https://www.jianshu.com/p/d64a1ddf1128\">GEO 数据库视频学习笔记（ID 转换）</a></li>\n<li><a href=\"https://www.jianshu.com/p/c94875df0155\">GEO 数据库视频学习笔记（了解你的表达矩阵）</a></li>\n<li><a href=\"https://www.jianshu.com/p/4486c6624ef9\">GEO 数据库视频学习笔记（差异分析、可视化、GSEA）</a></li>\n</ul>\n<h2 id=\"cbioportal-数据库学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#cbioportal-数据库学习笔记\"></a> cBioPortal 数据库学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/b458796366a4\">cBioPortal 学习笔记（1）</a></li>\n<li><a href=\"https://www.jianshu.com/p/cf0d1f407601\">cBioPortal 学习笔记（2）</a></li>\n</ul>\n<h2 id=\"wgs-学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#wgs-学习笔记\"></a> WGS 学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/4177a7afc798\">GATK 的初次了解</a></li>\n<li><a href=\"https://www.jianshu.com/p/9fce93c1a337\">GATK 官网学习笔记 Data pre-processing for variant discovery</a></li>\n<li><a href=\"https://www.jianshu.com/p/b93f8f4a1ed7\">Broad Institute 视频笔记 Introduction to High-throughput Sequencing Data</a></li>\n<li><a href=\"https://www.jianshu.com/p/8ace60832c13\">Broad Institute 视频笔记 Introduction to Data Preprocessing</a></li>\n<li><a href=\"https://www.jianshu.com/p/5bf73e5a3390\">Broad Institute 视频笔记 Introduction to Variant Discovery</a></li>\n<li><a href=\"https://www.jianshu.com/p/c032b7a1909c\">Broad Institute 视频笔记 Introduction to Germline Variant Discovery</a></li>\n<li><a href=\"https://www.jianshu.com/p/6e0b483f1234\">Broad Institute 视频笔记 Introduction to Somatic Variant Discovery</a></li>\n<li><a href=\"https://www.jianshu.com/p/9c049c46a26d\">Broad Institue 视频笔记：Variant Calling with HaplotypeCaller</a></li>\n<li><a href=\"https://www.jianshu.com/p/241595e0ed39\">Broad Institute 视频笔记 Hello World WDL Tutorial</a></li>\n<li><a href=\"https://www.jianshu.com/p/2c4a792b49fe\">Broad Institute 视频笔记 Run Haplotypecaller（WDL+Cromwell）</a></li>\n</ul>\n<h2 id=\"文献阅读笔记\"><a class=\"markdownIt-Anchor\" href=\"#文献阅读笔记\"></a> 文献阅读笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/7cee57558c32\">增强子和启动子真的是两种完全不同的调控元件吗？【Nature Reviews Genetics】文献阅读</a></li>\n<li><a href=\"https://www.jianshu.com/p/e21ba67460ac\">TT-seq 文献阅读 (TT-seq maps the human transient transcriptome)</a></li>\n<li><a href=\"https://www.jianshu.com/p/61d95dd791b2\">eRNA 文献阅读</a></li>\n<li><a href=\"https://www.jianshu.com/p/35d2f771669b\">PRO-seq 文献阅读</a></li>\n<li><a href=\"https://www.jianshu.com/p/f41632859d39\">增强子 (enhancer) 靶向表观基因组编辑技术 enCRISPRa 和 enCRISPRi 文献学习</a></li>\n<li><a href=\"https://www.jianshu.com/p/9dd472bcd5e0\">CROP-seq 文献学习（CRISPR 液滴测序）</a></li>\n<li><a href=\"https://www.jianshu.com/p/6eaca6ab8f8e\">SMRT 测序文献阅读笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/5a1c31ee6c51\">文献阅读笔记：CUT&amp;RUN</a></li>\n<li><a href=\"https://www.jianshu.com/p/335aec753039\">文献阅读笔记：CUT&amp;Tag</a></li>\n<li><a href=\"https://www.jianshu.com/p/d5b91b271fdf\">文献阅读 Orchestrating single-cell analysis with Bioconductor</a></li>\n<li><a href=\"https://www.jianshu.com/p/de867ea346ca\">文献阅读：细胞异质性的表观遗传学基础</a></li>\n<li><a href=\"https://www.jianshu.com/p/4fe83e6e67ad\">【文献笔记】DNA，RNA 以及组蛋白的甲基化在衰老和肿瘤中的作用</a></li>\n</ul>\n<h2 id=\"statquest-视频学习笔记\"><a class=\"markdownIt-Anchor\" href=\"#statquest-视频学习笔记\"></a> StatQuest 视频学习笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/0f8fa0b8f86d\">StatQuest——生物信息相关原理的入门系列 (一)</a></li>\n<li><a href=\"https://www.jianshu.com/p/69b18da08a46\">StatQuest——生物信息相关原理的入门系列 (二)</a></li>\n<li><a href=\"https://www.jianshu.com/p/dffd1c8f99b0\">StatQuest（PCA 系列）step by step 为你解释 PCA 的那些事儿</a></li>\n<li><a href=\"https://www.jianshu.com/p/a2b3c68416c5\">StatQuest——t-SNE 视频笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/46f0aef6b5c3\">StatQuest——Hierarchical Clustering 学习笔记</a></li>\n<li><a href=\"https://www.jianshu.com/p/609226bdb66f\">StatQuest——K-means 到底是什么？</a></li>\n<li><a href=\"https://www.jianshu.com/p/7b797da06ed4\">StatQuest - 你想很轻松的理解 Covariance 和 Correlation 吗?(Part 1)</a></li>\n<li><a href=\"https://www.jianshu.com/p/85023ee0a164\">StatQuest - 你想很轻松的理解 Covariance 和 Correlation 吗?(Part 2)</a></li>\n</ul>\n<h2 id=\"epigenetics-笔记\"><a class=\"markdownIt-Anchor\" href=\"#epigenetics-笔记\"></a> Epigenetics 笔记</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/96c8eb5561fe\">Epigenetics 笔记一：Writers, Readers, Erasers</a></li>\n<li><a href=\"https://www.jianshu.com/p/1193ab2f463c\">Epigenetics 文献学习：Regulation of chromatin by histone modifications</a></li>\n<li><a href=\"https://www.jianshu.com/p/b9869113bd10\">Epigenetics 文献学习：染色质结构域</a></li>\n<li><a href=\"https://www.jianshu.com/p/c9725c44e659\">Epigenetics 文献阅读：The molecular hallmarks of epigenetic control</a></li>\n<li><a href=\"https://www.jianshu.com/p/aa77686648c0\">Epigenetics 文献学习：Writing, erasing and reading histone lysine methylation</a></li>\n<li><a href=\"https://www.jianshu.com/p/b73c50e1dbe0\">Epigenetics 文献学习：Histone H3 突变的致癌机制</a></li>\n<li><a href=\"https://www.jianshu.com/p/b9d061fa238f\">Epigenetics 文献学习：组蛋白标记在控制转录周期中的功能作用</a></li>\n<li><a href=\"https://www.jianshu.com/p/80b321e03d11\">SWI/SNF 复合体在肿瘤里的作用</a></li>\n<li><a href=\"https://www.jianshu.com/p/1a0dd75d7a00\">新英格兰医学：癌症的表观遗传治疗</a></li>\n<li><a href=\"https://www.jianshu.com/p/8d554f3cf96f\">NATURE: 组蛋白标记 H3K36me2 招募 DNMT3A 并调节基因间 DNA 甲基化分布</a></li>\n<li><a href=\"https://www.jianshu.com/p/a7b75ab3472e\">NATURE: 基因 - 环境协同诱导的表观遗传程序起始肿瘤发生</a></li>\n<li><a href=\"https://www.jianshu.com/p/6a7e68be2de7\">NATURE: 组蛋白甲基转移酶 NSD3 异常活化可诱导肺鳞状细胞癌的发生</a></li>\n<li><a href=\"https://www.jianshu.com/p/cd4a0b857d6f\">NATURE: 组蛋白变体在调节染色质组织和功能中的作用</a></li>\n<li><a href=\"https://www.jianshu.com/p/e152c798e047\">Nature Reviews Cancer: 实体瘤 “劫持” 组蛋白变体互作网络</a></li>\n<li><a href=\"https://www.jianshu.com/p/b20db6b067e1\">Nature Reviews Genetics：3D 基因组组织工程</a></li>\n<li><a href=\"https://www.jianshu.com/p/2cd3158ae9ee\">NCB: 核纤层的功能机制与异常</a></li>\n<li><a href=\"https://www.jianshu.com/p/3927a7ba6176\">CUT&amp;RUN 实验原理和步骤</a></li>\n<li><a href=\"https://www.jianshu.com/p/f2f39a327ec9\">【Nature Review Cancer】癌症中染色质修饰的 “language”</a></li>\n</ul>"},{"title":"Memory Tfh","abbrlink":"a14b8b86","date":"2023-05-22T09:57:41.000Z","_content":"\n# Memory Tfh\n\n### <span style=\"color: #1B5E20\"><span style=\"background-color: #f1f8e9\">💡 Meta Data</span></span>\n\n**<span style=\"color: #1b5e20\">Title: </span>** <span style=\"background-color: #dbeedd\">Memory T Follicular Helper CD4 T Cells</span>\n\n**<span style=\"color: #1b5e20\">Journal: </span>** <span style=\"background-color: #dbeedd\">Frontiers in Immunology</span>\n\n**<span style=\"color: #1b5e20\">Authors: </span>** <span style=\"background-color: #dbeedd\">J. Scott Hale; Rafi Ahmed</span>\n\n**<span style=\"color: #1b5e20\">Pub.date: </span>** <span style=\"background-color: #dbeedd\">2015</span>\n\n**<span style=\"color: #1b5e20\">DOI: </span>** <span style=\"background-color: #dbeedd\"><a href=\"https://doi.org/10.3389/fimmu.2015.00016\" rel=\"noopener noreferrer nofollow\">10.3389/fimmu.2015.00016</a></span>\n\n### <span style=\"color: #E65100\"><span style=\"background-color: #fff8e1\">📜 研究背景 &amp; 基础 &amp; 目的</span></span>\n\n---\n\n* **Tfh的身份，功能，特征总结**\n\n    > <span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FWKECEGFV%22%2C%22pageLabel%22%3A%221%22%2C%22position%22%3A%7B%22pageIndex%22%3A0%2C%22rects%22%3A%5B%5B175.127%2C643.183%2C549.845%2C651.833%5D%2C%5B176.263%2C631.228%2C549.845%2C639.878%5D%2C%5B176.263%2C619.273%2C549.845%2C627.923%5D%2C%5B176.263%2C607.318%2C549.845%2C615.968%5D%2C%5B176.263%2C595.362%2C549.845%2C604.012%5D%2C%5B176.263%2C583.407%2C549.845%2C592.057%5D%2C%5B176.263%2C571.452%2C222.551%2C580.102%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FST2QQLY8%22%5D%2C%22locator%22%3A%221%22%7D%7D\">“T follicular helper (Tfh) cells are the subset of CD4T helper cells that are required for generation and maintenance of germinal center reactions and the generation of long-lived humoral immunity. This specialized T helper subset provides help to cognate B cells via their expression of CD40 ligand, IL-21, IL-4, and other molecules. Tfh cells are characterized by their expression of the chemokine receptor CXCR5, expression of the transcriptional repressor Bcl6, and their capacity to migrate to the follicle and promote germinal center B cell responses.”</span>\n\n* <span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FWKECEGFV%22%2C%22pageLabel%22%3A%221%22%2C%22position%22%3A%7B%22pageIndex%22%3A0%2C%22rects%22%3A%5B%5B84.128%2C237.87%2C291.863%2C246.946%5D%2C%5B45.354%2C226.413%2C251.697%2C235.489%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FST2QQLY8%22%5D%2C%22locator%22%3A%221%22%7D%7D\">“Tfh cells play a **critical role** in the generation of effective and long-lived humoral immune responses to antigens”</span>\n\n* **Th1与Th2的Signature**\n\n    > <span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FWKECEGFV%22%2C%22pageLabel%22%3A%221%22%2C%22position%22%3A%7B%22pageIndex%22%3A0%2C%22rects%22%3A%5B%5B151.919%2C100.31%2C291.878%2C109.774%5D%2C%5B45.354%2C88.929%2C184.418%2C98.005%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FST2QQLY8%22%5D%2C%22locator%22%3A%221%22%7D%7D\">“Th1 signature cytokine IFNγ or the Th2 cytokines IL-4, IL-5, and IL-13”</span>\n\n<img src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/3ZWjS-ztJofW-20230314.png\" style=\"zoom:50%;\" />\n\n* BCL6是Tfh产生维持所必需的，也促进了Tfh的分化，部分是通过抑制转录调节因子 <u>Tbet、RORγt、GATA3</u>\n\n    和 <u>PRDM1</u>的转录\n\n### <span style=\"color: #2E7D32\"><span style=\"background-color: #f1f8e9\">📊 研究内容</span></span>\n\n---\n\n* 记忆T细胞相比NaiveT的优势\n\n    * 抗原特异性记忆细胞的**数量**相对于其幼稚的抗原特异性前体而言有所**增加**，从而提供更好的覆盖范围和对病原体再攻击的更快速的细胞反应。\n    * 其次，记忆细胞并不局限于血液循环和次级淋巴器官，而是还可以**运输并驻留在非淋巴组织**中，如果它们的特定病原体进入该特定解剖部位，它们可以在非淋巴组织中迅速发挥效应功能。\n    * 记忆 T 细胞在细胞内在编程方面发生了变化，使它们能够**快速回忆起它们的效应功能**，例如特定效应细胞因子、趋化因子和细胞毒性分子的快速表达\n    * 寿命更\n\n* 问题\n\n    * First, do Tfh cells survive to become memory cells?\n    * Second, do memory cells derived from Tfh cells maintain their commitment/programing to recall Tfh effector cells？\n    * Third, instead possess pluripotency/plasticity to become cells of other T helper lineages?\n\n* Tfh并非注定死亡，而是有部分发展成为记忆细胞\n\n    > <span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FWKECEGFV%22%2C%22annotationKey%22%3A%227WXYGK7S%22%2C%22color%22%3A%22%23ff6666%22%2C%22pageLabel%22%3A%223%22%2C%22position%22%3A%7B%22pageIndex%22%3A2%2C%22rects%22%3A%5B%5B303.333%2C445.427%2C549.855%2C454.503%5D%2C%5B303.333%2C433.97%2C549.855%2C443.046%5D%2C%5B303.333%2C422.513%2C549.855%2C431.589%5D%2C%5B303.333%2C411.056%2C529.96%2C420.132%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FST2QQLY8%22%5D%2C%22locator%22%3A%223%22%7D%7D\">“Together, these studies clearly demonstrate that not all Tfh effector cells are terminally differentiated and fated to die. Instead, some Tfh effector cells progress to become memory cells that have some similar features compared to their Tfh effector predecessors.”</span>\n\n* 记忆Tfh细胞形成有**两种模型**\n\n    * Lineage Commitment Model\n    * Degrees of Commitment Model\n\n* 记忆Tfh细胞恢复自己的记忆可能存在**四种潜在的机制**\n\n    * cell-intrinsic programs\n    * Tfh associated transcription factors\n    * Localization and trafficking\n    * Epigenetic regulation\n\n### <span style=\"color: #4a148c\"><span style=\"background-color: #f5f5f5\">🚩 研究结论</span></span>\n\n---\n\n* 表型独特的 CXCR5+ 记忆 CD4 T 细胞亚群具有特定于 Tfh 功能的记忆潜力这一发现引发了未来研究的重要问题，这些研究将为传染病的疫苗接种策略提供信息。\n* 了解 Tfh 记忆细胞如何获得和保存 Tfh 基因表达程序并在重新激活时优先回忆这些程序的机制将为了解这些细胞的谱系维持和可塑性提供重要的见解。\n* 最后，未来的工作需要确定在初免和加强免疫期间利用 Tfh 记忆细胞的最佳方法，以促进提高保护性和长寿命抗体反应的方法\n\n### <span style=\"color: #006064\"><span style=\"background-color: #e0f7fa\">📌 感想 &amp; 疑问</span></span>\n\n---\n\n### <span style=\"color: #1565C0\"><span style=\"background-color: #e1f5fe\">🔬 研究方法</span></span>\n\n---\n\nReferred in [主笔记](zotero://note/u/FNQNUGED/?ignore=1&line=-1)\n","source":"_posts/记忆Tfh.md","raw":"---\ntitle: Memory Tfh\ncategories:\n  - paper\n  - review\n  - celltype\ntags:\n  - paper\n  - celltype\n  - Tfh\nabbrlink: a14b8b86\ndate: 2023-05-22 17:57:41\n---\n\n# Memory Tfh\n\n### <span style=\"color: #1B5E20\"><span style=\"background-color: #f1f8e9\">💡 Meta Data</span></span>\n\n**<span style=\"color: #1b5e20\">Title: </span>** <span style=\"background-color: #dbeedd\">Memory T Follicular Helper CD4 T Cells</span>\n\n**<span style=\"color: #1b5e20\">Journal: </span>** <span style=\"background-color: #dbeedd\">Frontiers in Immunology</span>\n\n**<span style=\"color: #1b5e20\">Authors: </span>** <span style=\"background-color: #dbeedd\">J. Scott Hale; Rafi Ahmed</span>\n\n**<span style=\"color: #1b5e20\">Pub.date: </span>** <span style=\"background-color: #dbeedd\">2015</span>\n\n**<span style=\"color: #1b5e20\">DOI: </span>** <span style=\"background-color: #dbeedd\"><a href=\"https://doi.org/10.3389/fimmu.2015.00016\" rel=\"noopener noreferrer nofollow\">10.3389/fimmu.2015.00016</a></span>\n\n### <span style=\"color: #E65100\"><span style=\"background-color: #fff8e1\">📜 研究背景 &amp; 基础 &amp; 目的</span></span>\n\n---\n\n* **Tfh的身份，功能，特征总结**\n\n    > <span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FWKECEGFV%22%2C%22pageLabel%22%3A%221%22%2C%22position%22%3A%7B%22pageIndex%22%3A0%2C%22rects%22%3A%5B%5B175.127%2C643.183%2C549.845%2C651.833%5D%2C%5B176.263%2C631.228%2C549.845%2C639.878%5D%2C%5B176.263%2C619.273%2C549.845%2C627.923%5D%2C%5B176.263%2C607.318%2C549.845%2C615.968%5D%2C%5B176.263%2C595.362%2C549.845%2C604.012%5D%2C%5B176.263%2C583.407%2C549.845%2C592.057%5D%2C%5B176.263%2C571.452%2C222.551%2C580.102%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FST2QQLY8%22%5D%2C%22locator%22%3A%221%22%7D%7D\">“T follicular helper (Tfh) cells are the subset of CD4T helper cells that are required for generation and maintenance of germinal center reactions and the generation of long-lived humoral immunity. This specialized T helper subset provides help to cognate B cells via their expression of CD40 ligand, IL-21, IL-4, and other molecules. Tfh cells are characterized by their expression of the chemokine receptor CXCR5, expression of the transcriptional repressor Bcl6, and their capacity to migrate to the follicle and promote germinal center B cell responses.”</span>\n\n* <span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FWKECEGFV%22%2C%22pageLabel%22%3A%221%22%2C%22position%22%3A%7B%22pageIndex%22%3A0%2C%22rects%22%3A%5B%5B84.128%2C237.87%2C291.863%2C246.946%5D%2C%5B45.354%2C226.413%2C251.697%2C235.489%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FST2QQLY8%22%5D%2C%22locator%22%3A%221%22%7D%7D\">“Tfh cells play a **critical role** in the generation of effective and long-lived humoral immune responses to antigens”</span>\n\n* **Th1与Th2的Signature**\n\n    > <span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FWKECEGFV%22%2C%22pageLabel%22%3A%221%22%2C%22position%22%3A%7B%22pageIndex%22%3A0%2C%22rects%22%3A%5B%5B151.919%2C100.31%2C291.878%2C109.774%5D%2C%5B45.354%2C88.929%2C184.418%2C98.005%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FST2QQLY8%22%5D%2C%22locator%22%3A%221%22%7D%7D\">“Th1 signature cytokine IFNγ or the Th2 cytokines IL-4, IL-5, and IL-13”</span>\n\n<img src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/3ZWjS-ztJofW-20230314.png\" style=\"zoom:50%;\" />\n\n* BCL6是Tfh产生维持所必需的，也促进了Tfh的分化，部分是通过抑制转录调节因子 <u>Tbet、RORγt、GATA3</u>\n\n    和 <u>PRDM1</u>的转录\n\n### <span style=\"color: #2E7D32\"><span style=\"background-color: #f1f8e9\">📊 研究内容</span></span>\n\n---\n\n* 记忆T细胞相比NaiveT的优势\n\n    * 抗原特异性记忆细胞的**数量**相对于其幼稚的抗原特异性前体而言有所**增加**，从而提供更好的覆盖范围和对病原体再攻击的更快速的细胞反应。\n    * 其次，记忆细胞并不局限于血液循环和次级淋巴器官，而是还可以**运输并驻留在非淋巴组织**中，如果它们的特定病原体进入该特定解剖部位，它们可以在非淋巴组织中迅速发挥效应功能。\n    * 记忆 T 细胞在细胞内在编程方面发生了变化，使它们能够**快速回忆起它们的效应功能**，例如特定效应细胞因子、趋化因子和细胞毒性分子的快速表达\n    * 寿命更\n\n* 问题\n\n    * First, do Tfh cells survive to become memory cells?\n    * Second, do memory cells derived from Tfh cells maintain their commitment/programing to recall Tfh effector cells？\n    * Third, instead possess pluripotency/plasticity to become cells of other T helper lineages?\n\n* Tfh并非注定死亡，而是有部分发展成为记忆细胞\n\n    > <span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FWKECEGFV%22%2C%22annotationKey%22%3A%227WXYGK7S%22%2C%22color%22%3A%22%23ff6666%22%2C%22pageLabel%22%3A%223%22%2C%22position%22%3A%7B%22pageIndex%22%3A2%2C%22rects%22%3A%5B%5B303.333%2C445.427%2C549.855%2C454.503%5D%2C%5B303.333%2C433.97%2C549.855%2C443.046%5D%2C%5B303.333%2C422.513%2C549.855%2C431.589%5D%2C%5B303.333%2C411.056%2C529.96%2C420.132%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FST2QQLY8%22%5D%2C%22locator%22%3A%223%22%7D%7D\">“Together, these studies clearly demonstrate that not all Tfh effector cells are terminally differentiated and fated to die. Instead, some Tfh effector cells progress to become memory cells that have some similar features compared to their Tfh effector predecessors.”</span>\n\n* 记忆Tfh细胞形成有**两种模型**\n\n    * Lineage Commitment Model\n    * Degrees of Commitment Model\n\n* 记忆Tfh细胞恢复自己的记忆可能存在**四种潜在的机制**\n\n    * cell-intrinsic programs\n    * Tfh associated transcription factors\n    * Localization and trafficking\n    * Epigenetic regulation\n\n### <span style=\"color: #4a148c\"><span style=\"background-color: #f5f5f5\">🚩 研究结论</span></span>\n\n---\n\n* 表型独特的 CXCR5+ 记忆 CD4 T 细胞亚群具有特定于 Tfh 功能的记忆潜力这一发现引发了未来研究的重要问题，这些研究将为传染病的疫苗接种策略提供信息。\n* 了解 Tfh 记忆细胞如何获得和保存 Tfh 基因表达程序并在重新激活时优先回忆这些程序的机制将为了解这些细胞的谱系维持和可塑性提供重要的见解。\n* 最后，未来的工作需要确定在初免和加强免疫期间利用 Tfh 记忆细胞的最佳方法，以促进提高保护性和长寿命抗体反应的方法\n\n### <span style=\"color: #006064\"><span style=\"background-color: #e0f7fa\">📌 感想 &amp; 疑问</span></span>\n\n---\n\n### <span style=\"color: #1565C0\"><span style=\"background-color: #e1f5fe\">🔬 研究方法</span></span>\n\n---\n\nReferred in [主笔记](zotero://note/u/FNQNUGED/?ignore=1&line=-1)\n","slug":"记忆Tfh","published":1,"updated":"2023-05-22T10:25:38.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm4peu6n3002wdbzrezqt1l0g","content":"<h1 id=\"memory-tfh\"><a class=\"markdownIt-Anchor\" href=\"#memory-tfh\"></a> Memory Tfh</h1>\n<h3 id=\"span-stylecolor-1b5e20span-stylebackground-color-f1f8e9-meta-dataspanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-1b5e20span-stylebackground-color-f1f8e9-meta-dataspanspan\"></a> <span style=\"color: #1B5E20\"><span style=\"background-color: #f1f8e9\">💡 Meta Data</span></span></h3>\n<p><strong><span style=\"color: #1b5e20\">Title: </span></strong> <span style=\"background-color: #dbeedd\">Memory T Follicular Helper CD4 T Cells</span></p>\n<p><strong><span style=\"color: #1b5e20\">Journal: </span></strong> <span style=\"background-color: #dbeedd\">Frontiers in Immunology</span></p>\n<p><strong><span style=\"color: #1b5e20\">Authors: </span></strong> <span style=\"background-color: #dbeedd\">J. Scott Hale; Rafi Ahmed</span></p>\n<p><strong><span style=\"color: #1b5e20\">Pub.date: </span></strong> <span style=\"background-color: #dbeedd\">2015</span></p>\n<p><strong><span style=\"color: #1b5e20\">DOI: </span></strong> <span style=\"background-color: #dbeedd\"><a href=\"https://doi.org/10.3389/fimmu.2015.00016\" rel=\"noopener noreferrer nofollow\">10.3389/fimmu.2015.00016</a></span></p>\n<h3 id=\"span-stylecolor-e65100span-stylebackground-color-fff8e1-研究背景-基础-目的spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-e65100span-stylebackground-color-fff8e1-研究背景-基础-目的spanspan\"></a> <span style=\"color: #E65100\"><span style=\"background-color: #fff8e1\">📜 研究背景 &amp; 基础 &amp; 目的</span></span></h3>\n<hr />\n<ul>\n<li>\n<p><strong>Tfh的身份，功能，特征总结</strong></p>\n<blockquote>\n<p><span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FWKECEGFV%22%2C%22pageLabel%22%3A%221%22%2C%22position%22%3A%7B%22pageIndex%22%3A0%2C%22rects%22%3A%5B%5B175.127%2C643.183%2C549.845%2C651.833%5D%2C%5B176.263%2C631.228%2C549.845%2C639.878%5D%2C%5B176.263%2C619.273%2C549.845%2C627.923%5D%2C%5B176.263%2C607.318%2C549.845%2C615.968%5D%2C%5B176.263%2C595.362%2C549.845%2C604.012%5D%2C%5B176.263%2C583.407%2C549.845%2C592.057%5D%2C%5B176.263%2C571.452%2C222.551%2C580.102%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FST2QQLY8%22%5D%2C%22locator%22%3A%221%22%7D%7D\">“T follicular helper (Tfh) cells are the subset of CD4T helper cells that are required for generation and maintenance of germinal center reactions and the generation of long-lived humoral immunity. This specialized T helper subset provides help to cognate B cells via their expression of CD40 ligand, IL-21, IL-4, and other molecules. Tfh cells are characterized by their expression of the chemokine receptor CXCR5, expression of the transcriptional repressor Bcl6, and their capacity to migrate to the follicle and promote germinal center B cell responses.”</span></p>\n</blockquote>\n</li>\n<li>\n<p><span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FWKECEGFV%22%2C%22pageLabel%22%3A%221%22%2C%22position%22%3A%7B%22pageIndex%22%3A0%2C%22rects%22%3A%5B%5B84.128%2C237.87%2C291.863%2C246.946%5D%2C%5B45.354%2C226.413%2C251.697%2C235.489%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FST2QQLY8%22%5D%2C%22locator%22%3A%221%22%7D%7D\">“Tfh cells play a <strong>critical role</strong> in the generation of effective and long-lived humoral immune responses to antigens”</span></p>\n</li>\n<li>\n<p><strong>Th1与Th2的Signature</strong></p>\n<blockquote>\n<p><span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FWKECEGFV%22%2C%22pageLabel%22%3A%221%22%2C%22position%22%3A%7B%22pageIndex%22%3A0%2C%22rects%22%3A%5B%5B151.919%2C100.31%2C291.878%2C109.774%5D%2C%5B45.354%2C88.929%2C184.418%2C98.005%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FST2QQLY8%22%5D%2C%22locator%22%3A%221%22%7D%7D\">“Th1 signature cytokine IFNγ or the Th2 cytokines IL-4, IL-5, and IL-13”</span></p>\n</blockquote>\n</li>\n</ul>\n<img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/3ZWjS-ztJofW-20230314.png\" style=\"zoom:50%;\" />\n<ul>\n<li>\n<p>BCL6是Tfh产生维持所必需的，也促进了Tfh的分化，部分是通过抑制转录调节因子 <u>Tbet、RORγt、GATA3</u></p>\n<p>和 <u>PRDM1</u>的转录</p>\n</li>\n</ul>\n<h3 id=\"span-stylecolor-2e7d32span-stylebackground-color-f1f8e9-研究内容spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-2e7d32span-stylebackground-color-f1f8e9-研究内容spanspan\"></a> <span style=\"color: #2E7D32\"><span style=\"background-color: #f1f8e9\">📊 研究内容</span></span></h3>\n<hr />\n<ul>\n<li>\n<p>记忆T细胞相比NaiveT的优势</p>\n<ul>\n<li>抗原特异性记忆细胞的<strong>数量</strong>相对于其幼稚的抗原特异性前体而言有所<strong>增加</strong>，从而提供更好的覆盖范围和对病原体再攻击的更快速的细胞反应。</li>\n<li>其次，记忆细胞并不局限于血液循环和次级淋巴器官，而是还可以<strong>运输并驻留在非淋巴组织</strong>中，如果它们的特定病原体进入该特定解剖部位，它们可以在非淋巴组织中迅速发挥效应功能。</li>\n<li>记忆 T 细胞在细胞内在编程方面发生了变化，使它们能够<strong>快速回忆起它们的效应功能</strong>，例如特定效应细胞因子、趋化因子和细胞毒性分子的快速表达</li>\n<li>寿命更</li>\n</ul>\n</li>\n<li>\n<p>问题</p>\n<ul>\n<li>First, do Tfh cells survive to become memory cells?</li>\n<li>Second, do memory cells derived from Tfh cells maintain their commitment/programing to recall Tfh effector cells？</li>\n<li>Third, instead possess pluripotency/plasticity to become cells of other T helper lineages?</li>\n</ul>\n</li>\n<li>\n<p>Tfh并非注定死亡，而是有部分发展成为记忆细胞</p>\n<blockquote>\n<p><span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FWKECEGFV%22%2C%22annotationKey%22%3A%227WXYGK7S%22%2C%22color%22%3A%22%23ff6666%22%2C%22pageLabel%22%3A%223%22%2C%22position%22%3A%7B%22pageIndex%22%3A2%2C%22rects%22%3A%5B%5B303.333%2C445.427%2C549.855%2C454.503%5D%2C%5B303.333%2C433.97%2C549.855%2C443.046%5D%2C%5B303.333%2C422.513%2C549.855%2C431.589%5D%2C%5B303.333%2C411.056%2C529.96%2C420.132%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FST2QQLY8%22%5D%2C%22locator%22%3A%223%22%7D%7D\">“Together, these studies clearly demonstrate that not all Tfh effector cells are terminally differentiated and fated to die. Instead, some Tfh effector cells progress to become memory cells that have some similar features compared to their Tfh effector predecessors.”</span></p>\n</blockquote>\n</li>\n<li>\n<p>记忆Tfh细胞形成有<strong>两种模型</strong></p>\n<ul>\n<li>Lineage Commitment Model</li>\n<li>Degrees of Commitment Model</li>\n</ul>\n</li>\n<li>\n<p>记忆Tfh细胞恢复自己的记忆可能存在<strong>四种潜在的机制</strong></p>\n<ul>\n<li>cell-intrinsic programs</li>\n<li>Tfh associated transcription factors</li>\n<li>Localization and trafficking</li>\n<li>Epigenetic regulation</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"span-stylecolor-4a148cspan-stylebackground-color-f5f5f5-研究结论spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-4a148cspan-stylebackground-color-f5f5f5-研究结论spanspan\"></a> <span style=\"color: #4a148c\"><span style=\"background-color: #f5f5f5\">🚩 研究结论</span></span></h3>\n<hr />\n<ul>\n<li>表型独特的 CXCR5+ 记忆 CD4 T 细胞亚群具有特定于 Tfh 功能的记忆潜力这一发现引发了未来研究的重要问题，这些研究将为传染病的疫苗接种策略提供信息。</li>\n<li>了解 Tfh 记忆细胞如何获得和保存 Tfh 基因表达程序并在重新激活时优先回忆这些程序的机制将为了解这些细胞的谱系维持和可塑性提供重要的见解。</li>\n<li>最后，未来的工作需要确定在初免和加强免疫期间利用 Tfh 记忆细胞的最佳方法，以促进提高保护性和长寿命抗体反应的方法</li>\n</ul>\n<h3 id=\"span-stylecolor-006064span-stylebackground-color-e0f7fa-感想-疑问spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-006064span-stylebackground-color-e0f7fa-感想-疑问spanspan\"></a> <span style=\"color: #006064\"><span style=\"background-color: #e0f7fa\">📌 感想 &amp; 疑问</span></span></h3>\n<hr />\n<h3 id=\"span-stylecolor-1565c0span-stylebackground-color-e1f5fe-研究方法spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-1565c0span-stylebackground-color-e1f5fe-研究方法spanspan\"></a> <span style=\"color: #1565C0\"><span style=\"background-color: #e1f5fe\">🔬 研究方法</span></span></h3>\n<hr />\n<p>Referred in <a href=\"zotero://note/u/FNQNUGED/?ignore=1&amp;line=-1\">主笔记</a></p>\n","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":1302,"excerpt":"","more":"<h1 id=\"memory-tfh\"><a class=\"markdownIt-Anchor\" href=\"#memory-tfh\"></a> Memory Tfh</h1>\n<h3 id=\"span-stylecolor-1b5e20span-stylebackground-color-f1f8e9-meta-dataspanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-1b5e20span-stylebackground-color-f1f8e9-meta-dataspanspan\"></a> <span style=\"color: #1B5E20\"><span style=\"background-color: #f1f8e9\">💡 Meta Data</span></span></h3>\n<p><strong><span style=\"color: #1b5e20\">Title: </span></strong> <span style=\"background-color: #dbeedd\">Memory T Follicular Helper CD4 T Cells</span></p>\n<p><strong><span style=\"color: #1b5e20\">Journal: </span></strong> <span style=\"background-color: #dbeedd\">Frontiers in Immunology</span></p>\n<p><strong><span style=\"color: #1b5e20\">Authors: </span></strong> <span style=\"background-color: #dbeedd\">J. Scott Hale; Rafi Ahmed</span></p>\n<p><strong><span style=\"color: #1b5e20\">Pub.date: </span></strong> <span style=\"background-color: #dbeedd\">2015</span></p>\n<p><strong><span style=\"color: #1b5e20\">DOI: </span></strong> <span style=\"background-color: #dbeedd\"><a href=\"https://doi.org/10.3389/fimmu.2015.00016\" rel=\"noopener noreferrer nofollow\">10.3389/fimmu.2015.00016</a></span></p>\n<h3 id=\"span-stylecolor-e65100span-stylebackground-color-fff8e1-研究背景-基础-目的spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-e65100span-stylebackground-color-fff8e1-研究背景-基础-目的spanspan\"></a> <span style=\"color: #E65100\"><span style=\"background-color: #fff8e1\">📜 研究背景 &amp; 基础 &amp; 目的</span></span></h3>\n<hr />\n<ul>\n<li>\n<p><strong>Tfh的身份，功能，特征总结</strong></p>\n<blockquote>\n<p><span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FWKECEGFV%22%2C%22pageLabel%22%3A%221%22%2C%22position%22%3A%7B%22pageIndex%22%3A0%2C%22rects%22%3A%5B%5B175.127%2C643.183%2C549.845%2C651.833%5D%2C%5B176.263%2C631.228%2C549.845%2C639.878%5D%2C%5B176.263%2C619.273%2C549.845%2C627.923%5D%2C%5B176.263%2C607.318%2C549.845%2C615.968%5D%2C%5B176.263%2C595.362%2C549.845%2C604.012%5D%2C%5B176.263%2C583.407%2C549.845%2C592.057%5D%2C%5B176.263%2C571.452%2C222.551%2C580.102%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FST2QQLY8%22%5D%2C%22locator%22%3A%221%22%7D%7D\">“T follicular helper (Tfh) cells are the subset of CD4T helper cells that are required for generation and maintenance of germinal center reactions and the generation of long-lived humoral immunity. This specialized T helper subset provides help to cognate B cells via their expression of CD40 ligand, IL-21, IL-4, and other molecules. Tfh cells are characterized by their expression of the chemokine receptor CXCR5, expression of the transcriptional repressor Bcl6, and their capacity to migrate to the follicle and promote germinal center B cell responses.”</span></p>\n</blockquote>\n</li>\n<li>\n<p><span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FWKECEGFV%22%2C%22pageLabel%22%3A%221%22%2C%22position%22%3A%7B%22pageIndex%22%3A0%2C%22rects%22%3A%5B%5B84.128%2C237.87%2C291.863%2C246.946%5D%2C%5B45.354%2C226.413%2C251.697%2C235.489%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FST2QQLY8%22%5D%2C%22locator%22%3A%221%22%7D%7D\">“Tfh cells play a <strong>critical role</strong> in the generation of effective and long-lived humoral immune responses to antigens”</span></p>\n</li>\n<li>\n<p><strong>Th1与Th2的Signature</strong></p>\n<blockquote>\n<p><span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FWKECEGFV%22%2C%22pageLabel%22%3A%221%22%2C%22position%22%3A%7B%22pageIndex%22%3A0%2C%22rects%22%3A%5B%5B151.919%2C100.31%2C291.878%2C109.774%5D%2C%5B45.354%2C88.929%2C184.418%2C98.005%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FST2QQLY8%22%5D%2C%22locator%22%3A%221%22%7D%7D\">“Th1 signature cytokine IFNγ or the Th2 cytokines IL-4, IL-5, and IL-13”</span></p>\n</blockquote>\n</li>\n</ul>\n<img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/3ZWjS-ztJofW-20230314.png\" style=\"zoom:50%;\" />\n<ul>\n<li>\n<p>BCL6是Tfh产生维持所必需的，也促进了Tfh的分化，部分是通过抑制转录调节因子 <u>Tbet、RORγt、GATA3</u></p>\n<p>和 <u>PRDM1</u>的转录</p>\n</li>\n</ul>\n<h3 id=\"span-stylecolor-2e7d32span-stylebackground-color-f1f8e9-研究内容spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-2e7d32span-stylebackground-color-f1f8e9-研究内容spanspan\"></a> <span style=\"color: #2E7D32\"><span style=\"background-color: #f1f8e9\">📊 研究内容</span></span></h3>\n<hr />\n<ul>\n<li>\n<p>记忆T细胞相比NaiveT的优势</p>\n<ul>\n<li>抗原特异性记忆细胞的<strong>数量</strong>相对于其幼稚的抗原特异性前体而言有所<strong>增加</strong>，从而提供更好的覆盖范围和对病原体再攻击的更快速的细胞反应。</li>\n<li>其次，记忆细胞并不局限于血液循环和次级淋巴器官，而是还可以<strong>运输并驻留在非淋巴组织</strong>中，如果它们的特定病原体进入该特定解剖部位，它们可以在非淋巴组织中迅速发挥效应功能。</li>\n<li>记忆 T 细胞在细胞内在编程方面发生了变化，使它们能够<strong>快速回忆起它们的效应功能</strong>，例如特定效应细胞因子、趋化因子和细胞毒性分子的快速表达</li>\n<li>寿命更</li>\n</ul>\n</li>\n<li>\n<p>问题</p>\n<ul>\n<li>First, do Tfh cells survive to become memory cells?</li>\n<li>Second, do memory cells derived from Tfh cells maintain their commitment/programing to recall Tfh effector cells？</li>\n<li>Third, instead possess pluripotency/plasticity to become cells of other T helper lineages?</li>\n</ul>\n</li>\n<li>\n<p>Tfh并非注定死亡，而是有部分发展成为记忆细胞</p>\n<blockquote>\n<p><span class=\"highlight\" data-annotation=\"%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FWKECEGFV%22%2C%22annotationKey%22%3A%227WXYGK7S%22%2C%22color%22%3A%22%23ff6666%22%2C%22pageLabel%22%3A%223%22%2C%22position%22%3A%7B%22pageIndex%22%3A2%2C%22rects%22%3A%5B%5B303.333%2C445.427%2C549.855%2C454.503%5D%2C%5B303.333%2C433.97%2C549.855%2C443.046%5D%2C%5B303.333%2C422.513%2C549.855%2C431.589%5D%2C%5B303.333%2C411.056%2C529.96%2C420.132%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F9243551%2Fitems%2FST2QQLY8%22%5D%2C%22locator%22%3A%223%22%7D%7D\">“Together, these studies clearly demonstrate that not all Tfh effector cells are terminally differentiated and fated to die. Instead, some Tfh effector cells progress to become memory cells that have some similar features compared to their Tfh effector predecessors.”</span></p>\n</blockquote>\n</li>\n<li>\n<p>记忆Tfh细胞形成有<strong>两种模型</strong></p>\n<ul>\n<li>Lineage Commitment Model</li>\n<li>Degrees of Commitment Model</li>\n</ul>\n</li>\n<li>\n<p>记忆Tfh细胞恢复自己的记忆可能存在<strong>四种潜在的机制</strong></p>\n<ul>\n<li>cell-intrinsic programs</li>\n<li>Tfh associated transcription factors</li>\n<li>Localization and trafficking</li>\n<li>Epigenetic regulation</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"span-stylecolor-4a148cspan-stylebackground-color-f5f5f5-研究结论spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-4a148cspan-stylebackground-color-f5f5f5-研究结论spanspan\"></a> <span style=\"color: #4a148c\"><span style=\"background-color: #f5f5f5\">🚩 研究结论</span></span></h3>\n<hr />\n<ul>\n<li>表型独特的 CXCR5+ 记忆 CD4 T 细胞亚群具有特定于 Tfh 功能的记忆潜力这一发现引发了未来研究的重要问题，这些研究将为传染病的疫苗接种策略提供信息。</li>\n<li>了解 Tfh 记忆细胞如何获得和保存 Tfh 基因表达程序并在重新激活时优先回忆这些程序的机制将为了解这些细胞的谱系维持和可塑性提供重要的见解。</li>\n<li>最后，未来的工作需要确定在初免和加强免疫期间利用 Tfh 记忆细胞的最佳方法，以促进提高保护性和长寿命抗体反应的方法</li>\n</ul>\n<h3 id=\"span-stylecolor-006064span-stylebackground-color-e0f7fa-感想-疑问spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-006064span-stylebackground-color-e0f7fa-感想-疑问spanspan\"></a> <span style=\"color: #006064\"><span style=\"background-color: #e0f7fa\">📌 感想 &amp; 疑问</span></span></h3>\n<hr />\n<h3 id=\"span-stylecolor-1565c0span-stylebackground-color-e1f5fe-研究方法spanspan\"><a class=\"markdownIt-Anchor\" href=\"#span-stylecolor-1565c0span-stylebackground-color-e1f5fe-研究方法spanspan\"></a> <span style=\"color: #1565C0\"><span style=\"background-color: #e1f5fe\">🔬 研究方法</span></span></h3>\n<hr />\n<p>Referred in <a href=\"zotero://note/u/FNQNUGED/?ignore=1&amp;line=-1\">主笔记</a></p>\n"},{"title":"有意思的图片","abbrlink":"fa92398f","_content":"\n## 有意思的图片\n\n> 注：此文所有图片引用自“熊言熊语”博主：[主页](https://kaopubear.top/)\n\n1. 学习流程\n\n    ![image](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/45BE6-APSzoV-20231218.png)\n\n    <!--more-->\t\n\n    ​\t博主的整个学习流程大概分为5个步骤：收集各种各样的信息，利用自己的标准（例如：兴趣与专业等）对信息进行筛选，接下来对感兴趣的信息进一步扩展以及深入学习，最后将知识整理进自己的系统内，并通过多种渠道进行输出。\n\n    ​\t这个流程引发我的一些思考，本科也曾经构建了一个自己的“黑白洞学习理论”，但还不完善。\n\n    * 黑洞（输入）：\n\n        * 结构\n            * 表层：碎片化阅读吸收的信息\n            * 中层：从表层提炼的、深度阅读、专业学习\n            * 底层：系统性的知识，内在的关联逻辑\n        * 执行\n            * 道：计划、总结、反思......\n            * 术：每日规划表、番茄钟、脑图......\n\n    * 白洞（输出）\n\n        * 结构\n            * 表层：易于理解与阅读的信息\n            * 中层：信息内部的逻辑\n            * 底层：思维方式、价值观念\n        * 执行\n            * 道：逻辑自洽......\n            * 术：笔记、博客......\n\n        博主的流程可以提供一些具体化的路线以及步骤，接下来继续完善自己的学习理论并执行。\n\n        图片来源：[把飞书融入日常学习流程](https://kaopubear.notion.site/8e9e9699333e4c41980c5d2b146ff486)\n\n2. 知识的提炼\n\n    <img src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/4btae-ZknVes-20231218.png\" alt=\"202212151633618\" style=\"zoom: 50%;\" />\n\n    ​\t知识的串联过程：数据中的包含了许多各种各样的“信息”，存在价值的“信息”才是真正的信息，信息转化成知识是需要先验知识的串联，形成比较完整的有逻辑的信息链，而新见解就是在信息链上之前不存在的一些信息，最后经历过时间的考验，某些信息链就成为了大家的智慧，带来新的影响\n\n    ​\t图片来源：[从2002年的Nature论文到2022年的亿元营收](https://kaopubear.top/blog/2022-12-15-mammaprint-intro-from-nature-to-product/)\n\n3. 项目做与讲的方式\n\n    <img src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/4fVAq-HcFuEB-20231218.png\" alt=\"faab6afe-3be1-4bf5-b704-4b232bd0289c\" style=\"zoom:67%;\" />\n\n    ​\t做项目的过程应该像是一个灯泡，来源于一个有趣的观察，中间进行大量的尝试，最后一个具体的特殊的发现。\n\n    ​\t讲项目的过程应该像是一个沙漏，背景要尽可能的详实，精炼的发现只占中间一小部分，在领域内的意义和应用也要丰富。\n\n4. 待续......\n\n","source":"_posts/有意思的图片.md","raw":"---\ntitle: 有意思的图片\ncategories:\n  - notes\n  - essay\ntags:\n  - knowledge\n  - essay\nabbrlink: fa92398f\n---\n\n## 有意思的图片\n\n> 注：此文所有图片引用自“熊言熊语”博主：[主页](https://kaopubear.top/)\n\n1. 学习流程\n\n    ![image](https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/45BE6-APSzoV-20231218.png)\n\n    <!--more-->\t\n\n    ​\t博主的整个学习流程大概分为5个步骤：收集各种各样的信息，利用自己的标准（例如：兴趣与专业等）对信息进行筛选，接下来对感兴趣的信息进一步扩展以及深入学习，最后将知识整理进自己的系统内，并通过多种渠道进行输出。\n\n    ​\t这个流程引发我的一些思考，本科也曾经构建了一个自己的“黑白洞学习理论”，但还不完善。\n\n    * 黑洞（输入）：\n\n        * 结构\n            * 表层：碎片化阅读吸收的信息\n            * 中层：从表层提炼的、深度阅读、专业学习\n            * 底层：系统性的知识，内在的关联逻辑\n        * 执行\n            * 道：计划、总结、反思......\n            * 术：每日规划表、番茄钟、脑图......\n\n    * 白洞（输出）\n\n        * 结构\n            * 表层：易于理解与阅读的信息\n            * 中层：信息内部的逻辑\n            * 底层：思维方式、价值观念\n        * 执行\n            * 道：逻辑自洽......\n            * 术：笔记、博客......\n\n        博主的流程可以提供一些具体化的路线以及步骤，接下来继续完善自己的学习理论并执行。\n\n        图片来源：[把飞书融入日常学习流程](https://kaopubear.notion.site/8e9e9699333e4c41980c5d2b146ff486)\n\n2. 知识的提炼\n\n    <img src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/4btae-ZknVes-20231218.png\" alt=\"202212151633618\" style=\"zoom: 50%;\" />\n\n    ​\t知识的串联过程：数据中的包含了许多各种各样的“信息”，存在价值的“信息”才是真正的信息，信息转化成知识是需要先验知识的串联，形成比较完整的有逻辑的信息链，而新见解就是在信息链上之前不存在的一些信息，最后经历过时间的考验，某些信息链就成为了大家的智慧，带来新的影响\n\n    ​\t图片来源：[从2002年的Nature论文到2022年的亿元营收](https://kaopubear.top/blog/2022-12-15-mammaprint-intro-from-nature-to-product/)\n\n3. 项目做与讲的方式\n\n    <img src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/4fVAq-HcFuEB-20231218.png\" alt=\"faab6afe-3be1-4bf5-b704-4b232bd0289c\" style=\"zoom:67%;\" />\n\n    ​\t做项目的过程应该像是一个灯泡，来源于一个有趣的观察，中间进行大量的尝试，最后一个具体的特殊的发现。\n\n    ​\t讲项目的过程应该像是一个沙漏，背景要尽可能的详实，精炼的发现只占中间一小部分，在领域内的意义和应用也要丰富。\n\n4. 待续......\n\n","slug":"有意思的图片","published":1,"date":"2023-12-18T09:50:22.000Z","updated":"2023-12-18T09:50:22.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm4peu6n4002xdbzr57q05v5s","content":"<h2 id=\"有意思的图片\"><a class=\"markdownIt-Anchor\" href=\"#有意思的图片\"></a> 有意思的图片</h2>\n<blockquote>\n<p>注：此文所有图片引用自“熊言熊语”博主：<a href=\"https://kaopubear.top/\">主页</a></p>\n</blockquote>\n<ol>\n<li>\n<p>学习流程</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/45BE6-APSzoV-20231218.png\" alt=\"image\" /></p>\n <span id=\"more\"></span>\t\n<p>​\t博主的整个学习流程大概分为5个步骤：收集各种各样的信息，利用自己的标准（例如：兴趣与专业等）对信息进行筛选，接下来对感兴趣的信息进一步扩展以及深入学习，最后将知识整理进自己的系统内，并通过多种渠道进行输出。</p>\n<p>​\t这个流程引发我的一些思考，本科也曾经构建了一个自己的“黑白洞学习理论”，但还不完善。</p>\n<ul>\n<li>\n<p>黑洞（输入）：</p>\n<ul>\n<li>结构\n<ul>\n<li>表层：碎片化阅读吸收的信息</li>\n<li>中层：从表层提炼的、深度阅读、专业学习</li>\n<li>底层：系统性的知识，内在的关联逻辑</li>\n</ul>\n</li>\n<li>执行\n<ul>\n<li>道：计划、总结、反思…</li>\n<li>术：每日规划表、番茄钟、脑图…</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>白洞（输出）</p>\n<ul>\n<li>结构\n<ul>\n<li>表层：易于理解与阅读的信息</li>\n<li>中层：信息内部的逻辑</li>\n<li>底层：思维方式、价值观念</li>\n</ul>\n</li>\n<li>执行\n<ul>\n<li>道：逻辑自洽…</li>\n<li>术：笔记、博客…</li>\n</ul>\n</li>\n</ul>\n<p>博主的流程可以提供一些具体化的路线以及步骤，接下来继续完善自己的学习理论并执行。</p>\n<p>图片来源：<a href=\"https://kaopubear.notion.site/8e9e9699333e4c41980c5d2b146ff486\">把飞书融入日常学习流程</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p>知识的提炼</p>\n <img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/4btae-ZknVes-20231218.png\" alt=\"202212151633618\" style=\"zoom: 50%;\" />\n<p>​\t知识的串联过程：数据中的包含了许多各种各样的“信息”，存在价值的“信息”才是真正的信息，信息转化成知识是需要先验知识的串联，形成比较完整的有逻辑的信息链，而新见解就是在信息链上之前不存在的一些信息，最后经历过时间的考验，某些信息链就成为了大家的智慧，带来新的影响</p>\n<p>​\t图片来源：<a href=\"https://kaopubear.top/blog/2022-12-15-mammaprint-intro-from-nature-to-product/\">从2002年的Nature论文到2022年的亿元营收</a></p>\n</li>\n<li>\n<p>项目做与讲的方式</p>\n <img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/4fVAq-HcFuEB-20231218.png\" alt=\"faab6afe-3be1-4bf5-b704-4b232bd0289c\" style=\"zoom:67%;\" />\n<p>​\t做项目的过程应该像是一个灯泡，来源于一个有趣的观察，中间进行大量的尝试，最后一个具体的特殊的发现。</p>\n<p>​\t讲项目的过程应该像是一个沙漏，背景要尽可能的详实，精炼的发现只占中间一小部分，在领域内的意义和应用也要丰富。</p>\n</li>\n<li>\n<p>待续…</p>\n</li>\n</ol>\n","site":{"data":{"styles":"body {\n  background: url(\"/images/background.png\");\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-position: 50% 50%;\n  background-size: cover;\n  -webkit-background-size: cover;\n  -o-background-size: cover;\n  -moz-background-size: cover;\n  -ms-background-size: cover;\n  opacity: 0.8;\n}\nbody #footer > div > div {\n  color: #000;\n}\n.header-inner {\n  background: #fff;\n  opacity: 1;\n}\n.main-inner {\n  background: #fff;\n  background-color: transparent;\n  opacity: 1;\n}\n.posts-expand .post-tags a {\n  display: inline-block;\n  font-size: 0.8em;\n  padding: 0px 10px;\n  border-radius: 8px;\n  color: #555;\n  border: 0px;\n}\n"}},"length":624,"excerpt":"<h2 id=\"有意思的图片\"><a class=\"markdownIt-Anchor\" href=\"#有意思的图片\"></a> 有意思的图片</h2>\n<blockquote>\n<p>注：此文所有图片引用自“熊言熊语”博主：<a href=\"https://kaopubear.top/\">主页</a></p>\n</blockquote>\n<ol>\n<li>\n<p>学习流程</p>\n<p><img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/45BE6-APSzoV-20231218.png\" alt=\"image\" /></p>","more":"<p>​\t博主的整个学习流程大概分为5个步骤：收集各种各样的信息，利用自己的标准（例如：兴趣与专业等）对信息进行筛选，接下来对感兴趣的信息进一步扩展以及深入学习，最后将知识整理进自己的系统内，并通过多种渠道进行输出。</p>\n<p>​\t这个流程引发我的一些思考，本科也曾经构建了一个自己的“黑白洞学习理论”，但还不完善。</p>\n<ul>\n<li>\n<p>黑洞（输入）：</p>\n<ul>\n<li>结构\n<ul>\n<li>表层：碎片化阅读吸收的信息</li>\n<li>中层：从表层提炼的、深度阅读、专业学习</li>\n<li>底层：系统性的知识，内在的关联逻辑</li>\n</ul>\n</li>\n<li>执行\n<ul>\n<li>道：计划、总结、反思…</li>\n<li>术：每日规划表、番茄钟、脑图…</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>白洞（输出）</p>\n<ul>\n<li>结构\n<ul>\n<li>表层：易于理解与阅读的信息</li>\n<li>中层：信息内部的逻辑</li>\n<li>底层：思维方式、价值观念</li>\n</ul>\n</li>\n<li>执行\n<ul>\n<li>道：逻辑自洽…</li>\n<li>术：笔记、博客…</li>\n</ul>\n</li>\n</ul>\n<p>博主的流程可以提供一些具体化的路线以及步骤，接下来继续完善自己的学习理论并执行。</p>\n<p>图片来源：<a href=\"https://kaopubear.notion.site/8e9e9699333e4c41980c5d2b146ff486\">把飞书融入日常学习流程</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p>知识的提炼</p>\n <img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/4btae-ZknVes-20231218.png\" alt=\"202212151633618\" style=\"zoom: 50%;\" />\n<p>​\t知识的串联过程：数据中的包含了许多各种各样的“信息”，存在价值的“信息”才是真正的信息，信息转化成知识是需要先验知识的串联，形成比较完整的有逻辑的信息链，而新见解就是在信息链上之前不存在的一些信息，最后经历过时间的考验，某些信息链就成为了大家的智慧，带来新的影响</p>\n<p>​\t图片来源：<a href=\"https://kaopubear.top/blog/2022-12-15-mammaprint-intro-from-nature-to-product/\">从2002年的Nature论文到2022年的亿元营收</a></p>\n</li>\n<li>\n<p>项目做与讲的方式</p>\n <img data-src=\"https://whalege-1258362576.cos.ap-guangzhou.myqcloud.com/Typora/img/4fVAq-HcFuEB-20231218.png\" alt=\"faab6afe-3be1-4bf5-b704-4b232bd0289c\" style=\"zoom:67%;\" />\n<p>​\t做项目的过程应该像是一个灯泡，来源于一个有趣的观察，中间进行大量的尝试，最后一个具体的特殊的发现。</p>\n<p>​\t讲项目的过程应该像是一个沙漏，背景要尽可能的详实，精炼的发现只占中间一小部分，在领域内的意义和应用也要丰富。</p>\n</li>\n<li>\n<p>待续…</p>\n</li>\n</ol>"}],"PostAsset":[],"PostCategory":[{"post_id":"cm4peu6mz0009dbzr1w2kcg5u","category_id":"cm4peu6my0004dbzr5jyd1xhl","_id":"cm4peu6n1000wdbzr49zwg3h3"},{"post_id":"cm4peu6mz0009dbzr1w2kcg5u","category_id":"cm4peu6n0000ndbzrfzl4cqq1","_id":"cm4peu6n1000zdbzra8gqa5jw"},{"post_id":"cm4peu6mw0001dbzreguc9t3p","category_id":"cm4peu6my0004dbzr5jyd1xhl","_id":"cm4peu6n10011dbzr7s505cm6"},{"post_id":"cm4peu6mw0001dbzreguc9t3p","category_id":"cm4peu6n0000ndbzrfzl4cqq1","_id":"cm4peu6n10015dbzreicjb48w"},{"post_id":"cm4peu6mx0003dbzr8jzr2wz8","category_id":"cm4peu6mz000cdbzr3awq3gx3","_id":"cm4peu6n1001cdbzr9ep7al5c"},{"post_id":"cm4peu6mx0003dbzr8jzr2wz8","category_id":"cm4peu6n10016dbzr44zu31e1","_id":"cm4peu6n1001fdbzrhz37g1vm"},{"post_id":"cm4peu6n0000ldbzr66wdh28k","category_id":"cm4peu6mz000cdbzr3awq3gx3","_id":"cm4peu6n2001ldbzr4syv1yis"},{"post_id":"cm4peu6n0000ldbzr66wdh28k","category_id":"cm4peu6n1001bdbzrawjac8k4","_id":"cm4peu6n2001odbzr8k8y1l7v"},{"post_id":"cm4peu6my0007dbzr8bjv3oil","category_id":"cm4peu6my0004dbzr5jyd1xhl","_id":"cm4peu6n2001qdbzrftm0g30n"},{"post_id":"cm4peu6my0007dbzr8bjv3oil","category_id":"cm4peu6n0000ndbzrfzl4cqq1","_id":"cm4peu6n2001sdbzrdse3ekvu"},{"post_id":"cm4peu6n0000pdbzr1j7c5uzz","category_id":"cm4peu6n2001pdbzrgihfbaat","_id":"cm4peu6n2001ydbzr9q8d10lk"},{"post_id":"cm4peu6n0000qdbzr3fe97twy","category_id":"cm4peu6mz000cdbzr3awq3gx3","_id":"cm4peu6n20022dbzr6mt55fe7"},{"post_id":"cm4peu6n0000qdbzr3fe97twy","category_id":"cm4peu6n2001udbzr85bj9ez6","_id":"cm4peu6n20025dbzr9pzientn"},{"post_id":"cm4peu6n0000tdbzr5rrgeac0","category_id":"cm4peu6my0004dbzr5jyd1xhl","_id":"cm4peu6n3002adbzr8wtsaulx"},{"post_id":"cm4peu6n0000tdbzr5rrgeac0","category_id":"cm4peu6n2001zdbzrch2b1guu","_id":"cm4peu6n3002bdbzr4kf92ovb"},{"post_id":"cm4peu6mz000gdbzr3v2j2agw","category_id":"cm4peu6n10013dbzr5fj9d6ra","_id":"cm4peu6n3002idbzrekmqfc8y"},{"post_id":"cm4peu6mz000gdbzr3v2j2agw","category_id":"cm4peu6n30028dbzr6bsn1fw0","_id":"cm4peu6n3002kdbzr8jpl25ys"},{"post_id":"cm4peu6mz000idbzr05uo8ddt","category_id":"cm4peu6n10013dbzr5fj9d6ra","_id":"cm4peu6n3002ndbzr8pihfi8m"},{"post_id":"cm4peu6mz000idbzr05uo8ddt","category_id":"cm4peu6n30028dbzr6bsn1fw0","_id":"cm4peu6n3002pdbzr6cwhaiao"},{"post_id":"cm4peu6n0000mdbzr752x5417","category_id":"cm4peu6n10013dbzr5fj9d6ra","_id":"cm4peu6n3002rdbzr28r43kc9"},{"post_id":"cm4peu6n0000mdbzr752x5417","category_id":"cm4peu6n30028dbzr6bsn1fw0","_id":"cm4peu6n3002sdbzrc8sd4szi"},{"post_id":"cm4peu6mz000bdbzr6a759x4u","category_id":"cm4peu6n1000vdbzre4ki0myt","_id":"cm4peu6n3002tdbzr6qpd7595"},{"post_id":"cm4peu6mz000bdbzr6a759x4u","category_id":"cm4peu6n20023dbzr7w6n48hz","_id":"cm4peu6n3002udbzrfza5bkef"},{"post_id":"cm4peu6mz000bdbzr6a759x4u","category_id":"cm4peu6n3002ldbzr4m15769c","_id":"cm4peu6n3002vdbzr6edwc642"},{"post_id":"cm4peu6n3002wdbzrezqt1l0g","category_id":"cm4peu6n1000vdbzre4ki0myt","_id":"cm4peu6n40032dbzrcdct6dlm"},{"post_id":"cm4peu6n3002wdbzrezqt1l0g","category_id":"cm4peu6n20023dbzr7w6n48hz","_id":"cm4peu6n40034dbzr8dmc4wpc"},{"post_id":"cm4peu6n3002wdbzrezqt1l0g","category_id":"cm4peu6n3002ldbzr4m15769c","_id":"cm4peu6n40035dbzr3oh1cd6v"},{"post_id":"cm4peu6n4002xdbzr57q05v5s","category_id":"cm4peu6mz000cdbzr3awq3gx3","_id":"cm4peu6n40038dbzrgsje81va"},{"post_id":"cm4peu6n4002xdbzr57q05v5s","category_id":"cm4peu6n40031dbzr5q04c4jd","_id":"cm4peu6n40039dbzr7ltb9j3w"}],"PostTag":[{"post_id":"cm4peu6mz0009dbzr1w2kcg5u","tag_id":"cm4peu6my0005dbzrbo0o9gy1","_id":"cm4peu6mz000edbzr26m0dpku"},{"post_id":"cm4peu6mw0001dbzreguc9t3p","tag_id":"cm4peu6my0005dbzrbo0o9gy1","_id":"cm4peu6mz000hdbzrhyy197o6"},{"post_id":"cm4peu6mx0003dbzr8jzr2wz8","tag_id":"cm4peu6mz000ddbzr12os9fw3","_id":"cm4peu6n1000udbzr97ugezpk"},{"post_id":"cm4peu6mx0003dbzr8jzr2wz8","tag_id":"cm4peu6mz000kdbzr3p1492tv","_id":"cm4peu6n1000xdbzrgplhfic9"},{"post_id":"cm4peu6mx0003dbzr8jzr2wz8","tag_id":"cm4peu6n0000odbzrbkfr6zjv","_id":"cm4peu6n10010dbzrhqu55acd"},{"post_id":"cm4peu6my0007dbzr8bjv3oil","tag_id":"cm4peu6my0005dbzrbo0o9gy1","_id":"cm4peu6n10012dbzr9fnb74fr"},{"post_id":"cm4peu6mz000bdbzr6a759x4u","tag_id":"cm4peu6n1000ydbzrgaf17fml","_id":"cm4peu6n1001adbzr7v4a5kr9"},{"post_id":"cm4peu6mz000bdbzr6a759x4u","tag_id":"cm4peu6n10014dbzraifkf8g1","_id":"cm4peu6n1001ddbzr3tri2py9"},{"post_id":"cm4peu6mz000bdbzr6a759x4u","tag_id":"cm4peu6n10017dbzr20he6sy8","_id":"cm4peu6n1001gdbzr5mg9b7yd"},{"post_id":"cm4peu6mz000gdbzr3v2j2agw","tag_id":"cm4peu6n10019dbzreefbdnp1","_id":"cm4peu6n2001jdbzr331k59v9"},{"post_id":"cm4peu6mz000gdbzr3v2j2agw","tag_id":"cm4peu6n1001edbzr3zkg1v1e","_id":"cm4peu6n2001mdbzrd2mzhqil"},{"post_id":"cm4peu6mz000idbzr05uo8ddt","tag_id":"cm4peu6n10019dbzreefbdnp1","_id":"cm4peu6n2001tdbzr6frkbp49"},{"post_id":"cm4peu6mz000idbzr05uo8ddt","tag_id":"cm4peu6n1001edbzr3zkg1v1e","_id":"cm4peu6n2001vdbzre6hs0ni5"},{"post_id":"cm4peu6n0000ldbzr66wdh28k","tag_id":"cm4peu6mz000ddbzr12os9fw3","_id":"cm4peu6n2001xdbzr5t716om3"},{"post_id":"cm4peu6n0000ldbzr66wdh28k","tag_id":"cm4peu6n2001rdbzr8ege5vnv","_id":"cm4peu6n20020dbzr1tsm8m9u"},{"post_id":"cm4peu6n0000mdbzr752x5417","tag_id":"cm4peu6n10019dbzreefbdnp1","_id":"cm4peu6n30026dbzrdzh67srh"},{"post_id":"cm4peu6n0000mdbzr752x5417","tag_id":"cm4peu6n1001edbzr3zkg1v1e","_id":"cm4peu6n30027dbzrf8nehuvq"},{"post_id":"cm4peu6n0000pdbzr1j7c5uzz","tag_id":"cm4peu6n20024dbzr96wyhort","_id":"cm4peu6n3002edbzreu4weh3w"},{"post_id":"cm4peu6n0000pdbzr1j7c5uzz","tag_id":"cm4peu6n30029dbzrb6nq6fcx","_id":"cm4peu6n3002fdbzrd73x9a78"},{"post_id":"cm4peu6n0000qdbzr3fe97twy","tag_id":"cm4peu6mz000ddbzr12os9fw3","_id":"cm4peu6n3002jdbzrhvhlfcfu"},{"post_id":"cm4peu6n0000qdbzr3fe97twy","tag_id":"cm4peu6n3002ddbzrf8heccs5","_id":"cm4peu6n3002mdbzr9668aay0"},{"post_id":"cm4peu6n0000tdbzr5rrgeac0","tag_id":"cm4peu6mz000ddbzr12os9fw3","_id":"cm4peu6n3002odbzrhuycfci8"},{"post_id":"cm4peu6n0000tdbzr5rrgeac0","tag_id":"cm4peu6n3002ddbzrf8heccs5","_id":"cm4peu6n3002qdbzr9f9z7oyq"},{"post_id":"cm4peu6n3002wdbzrezqt1l0g","tag_id":"cm4peu6n1000ydbzrgaf17fml","_id":"cm4peu6n4002ydbzr3pm72488"},{"post_id":"cm4peu6n3002wdbzrezqt1l0g","tag_id":"cm4peu6n10014dbzraifkf8g1","_id":"cm4peu6n40030dbzr8dqwcu5r"},{"post_id":"cm4peu6n3002wdbzrezqt1l0g","tag_id":"cm4peu6n10017dbzr20he6sy8","_id":"cm4peu6n40033dbzrcllzf4r9"},{"post_id":"cm4peu6n4002xdbzr57q05v5s","tag_id":"cm4peu6n30029dbzrb6nq6fcx","_id":"cm4peu6n40036dbzrabasal87"},{"post_id":"cm4peu6n4002xdbzr57q05v5s","tag_id":"cm4peu6n4002zdbzr8c6sapck","_id":"cm4peu6n40037dbzrhg945mfk"}],"Tag":[{"name":"R","_id":"cm4peu6my0005dbzrbo0o9gy1"},{"name":"note","_id":"cm4peu6mz000ddbzr12os9fw3"},{"name":"ATAC","_id":"cm4peu6mz000kdbzr3p1492tv"},{"name":"pipeline","_id":"cm4peu6n0000odbzrbkfr6zjv"},{"name":"paper","_id":"cm4peu6n1000ydbzrgaf17fml"},{"name":"celltype","_id":"cm4peu6n10014dbzraifkf8g1"},{"name":"Tfh","_id":"cm4peu6n10017dbzr20he6sy8"},{"name":"tool","_id":"cm4peu6n10019dbzreefbdnp1"},{"name":"linux","_id":"cm4peu6n1001edbzr3zkg1v1e"},{"name":"immune","_id":"cm4peu6n2001rdbzr8ege5vnv"},{"name":"statistics","_id":"cm4peu6n20024dbzr96wyhort"},{"name":"knowledge","_id":"cm4peu6n30029dbzrb6nq6fcx"},{"name":"bioinformatics","_id":"cm4peu6n3002ddbzrf8heccs5"},{"name":"essay","_id":"cm4peu6n4002zdbzr8c6sapck"}]}}